var Et=Object.defineProperty,Wt=Object.defineProperties;var Ot=Object.getOwnPropertyDescriptors;var rt=Object.getOwnPropertySymbols;var Ut=Object.prototype.hasOwnProperty,Gt=Object.prototype.propertyIsEnumerable;var nt=(r,t,e)=>t in r?Et(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,_=(r,t)=>{for(var e in t||(t={}))Ut.call(t,e)&&nt(r,e,t[e]);if(rt)for(var e of rt(t))Gt.call(t,e)&&nt(r,e,t[e]);return r},D=(r,t)=>Wt(r,Ot(t));import{PublicKey as Xt}from"@solana/web3.js";import at,{isBN as ut}from"bn.js";import{bits as Zr,BitStructure as Qr,blob as qt,Blob as $r,cstr as en,f32 as tn,f32be as rn,f64 as nn,f64be as on,greedy as sn,Layout as Ht,ns64 as an,ns64be as un,nu64 as cn,nu64be as ln,offset as dn,s16 as pn,s16be as mn,s24 as fn,s24be as yn,s32 as gn,s32be as bn,s40 as hn,s40be as wn,s48 as Tn,s48be as xn,s8 as Pn,seq as jt,struct as Sn,Structure as Yt,u16 as kn,u16be as In,u24 as Ln,u24be as An,u32 as Rn,u32be as Bn,u40 as Kn,u40be as Cn,u48 as Vn,u48be as _n,u8 as zt,UInt as Jt,union as Fn,Union as Mn,unionLayoutDiscriminator as Dn,utf8 as Nn}from"@solana/buffer-layout";var Ie=Ht,ot=Yt;var Le=Jt;var it=zt;var st=jt;var j=qt;var Z=class extends Ie{constructor(e,n,o){super(e,o);this.blob=j(e),this.signed=n}decode(e,n=0){let o=new at(this.blob.decode(e,n),10,"le");return this.signed?o.fromTwos(this.span*8).clone():o}encode(e,n,o=0){return typeof e=="number"&&(e=new at(e)),this.signed&&(e=e.toTwos(this.span*8)),this.blob.encode(e.toArrayLike(Buffer,"le",this.span),n,o)}};function k(r){return new Le(1,r)}function Q(r){return new Le(4,r)}function u(r){return new Z(8,!1,r)}function O(r){return new Z(16,!1,r)}function ct(r){return new Z(1,!0,r)}function ye(r){return new Z(8,!0,r)}var fe=class extends Ie{constructor(e,n,o,a){super(e.span,a);this.layout=e,this.decoder=n,this.encoder=o}decode(e,n){return this.decoder(this.layout.decode(e,n))}encode(e,n,o){return this.layout.encode(this.encoder(e),n,o)}getSpan(e,n){return this.layout.getSpan(e,n)}};function h(r){return new fe(j(32),t=>new Xt(t),t=>t.toBuffer(),r)}function oe(r){return new fe(it(),Zt,Qt,r)}function Zt(r){if(r===0)return!1;if(r===1)return!0;throw new Error("Invalid bool: "+r)}function Qt(r){return r?1:0}var Ae=class extends ot{decode(t,e){return super.decode(t,e)}};function P(r,t,e){return new Ae(r,t,e)}function R(r,t,e){let n,o=typeof t=="number"?t:ut(t)?t.toNumber():new Proxy(t,{get(a,s){if(!n){let c=Reflect.get(a,"count");n=ut(c)?c.toNumber():c,Reflect.set(a,"count",n)}return Reflect.get(a,s)},set(a,s,c){return s==="count"&&(n=c),Reflect.set(a,s,c)}});return st(r,o,e)}import{PublicKey as Be}from"@solana/web3.js";import{get as lt,set as $t}from"lodash";var Re=class{constructor(t){this.logLevel=t.logLevel!==void 0?t.logLevel:0,this.name=t.name}set level(t){this.logLevel=t}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(t){return t<=this.logLevel}error(...t){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...t),this):this}logWithError(...t){let e=t.map(n=>typeof n=="object"?JSON.stringify(n):n).join(", ");throw new Error(e)}warning(...t){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...t),this):this}info(...t){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...t),this):this}debug(...t){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...t),this):this}},dt={},er={};function K(r){let t=lt(dt,r);if(!t){let e=lt(er,r);t=new Re({name:r,logLevel:e}),$t(dt,r,t)}return t}import{PublicKey as f}from"@solana/web3.js";var pt=new f("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),mt=new f("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),ft=new f("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),yt=new f("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),$n=new f("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),eo=new f("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),to=new f("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),ro=new f("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),no=new f("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),oo=new f("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),io=new f("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),so=new f("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),ao=new f("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),uo=new f("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),co=new f("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),lo=new f("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),po=new f("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),mo=new f("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),fo=new f("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),yo=new f("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),go=new f("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),bo=new f("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),ho=new f("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),wo=new f("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),To=new f("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),xo=new f("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),Po=new f("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),So=new f("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),ko=new f("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),Io=new f("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),Lo=new f("6s1xP3hpbAfFoNtUNF8mfHsjr2Bd97JxFJRWLbL6aHuX");var ie={OPEN_BOOK_PROGRAM:new f("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),SERUM_PROGRAM_ID_V3:new f("Ray1111111111111111111111111111111111111111"),AMM_V4:new f("DRaya7Kj3aMWQSy19kSjvmuwq9docCHofyP9kanQGaav"),AMM_STABLE:new f("DRayDdXc1NZQ9C3hRWmoSf8zK4iapgMnjdNZWrfwsP8m"),CLMM_PROGRAM_ID:new f("DRayAUgENGQBKVaX8owNhgzkEDyoHTGVEGHVJT1E9pfH"),CLMM_LOCK_PROGRAM_ID:new f("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),CLMM_LOCK_AUTH_ID:new f("6Aoh8h2Lw2m5UGxYR8AdAL87jTWYeKoxM52mJRzfYwN"),CREATE_CPMM_POOL_PROGRAM:new f("DRaycpLY18LhpbydsBWbVJtxpNv9oXPgjRSfpF2bWpYb"),CREATE_CPMM_POOL_AUTH:new f("CXniRufdq5xL8t8jZAPxsPZDpuudwuJSPWnbcD5Y5Nxq"),CREATE_CPMM_POOL_FEE_ACC:new f("3oE58BKVt8KuYkGxx8zBojugnymWmBiyafWgMrnb6eYy"),LOCK_CPMM_PROGRAM:new f("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),LOCK_CPMM_AUTH:new f("7qWVV8UY2bRJfDLP4s37YzBPKUkVB46DStYJBpYbQzu3"),UTIL1216:f.default,Router:new f("DRaybByLpbUL57LJARs3j8BitTxVfzBg351EaMr5UTCd"),FARM_PROGRAM_ID_V3:new f("DRayWyrLmEW5KEeqs8kdTMMaBabapqagaBC7KWpGtJeZ"),FARM_PROGRAM_ID_V4:new f("Ray1111111111111111111111111111111111111111"),FARM_PROGRAM_ID_V5:new f("DRayiCGSZgku1GTK6rXD6mVDdingXy6APAH1R6R5L2LC"),FARM_PROGRAM_ID_V6:new f("DRayzbYakXs45ELHkzH6vC3fuhQqTAnv5A68gdFuvZyZ"),LAUNCHPAD_PROGRAM:new f("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),LAUNCHPAD_AUTH:new f("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),LAUNCHPAD_PLATFORM:new f("2Jx4KTDrVSdWNazuGpcA8n3ZLTRGGBDxAWhuKe2Xcj2a"),LAUNCHPAD_CONFIG:new f("7ZR4zD7PYfY2XxoG1Gxcy2EgEeGYrpxrwzPuwdUBssEt"),FEE_DESTINATION_ID:new f("9y8ENuuZ3b19quffx9hQvRVygG5ky6snHfRvGpuSfeJy"),MODEL_DATA_PUBKEY:new f("Ray1111111111111111111111111111111111111111")};import{NATIVE_MINT as tr}from"@solana/spl-token";var Mo=K("Raydium_farm_config"),Do=new Be("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),No=new Be("FrspKwj8i3pNmKwXreTveC4fu7KL5ZbGeXdZBe2XViu1"),vo=tr,Eo=new Be("3TRTX4dXUpp2eqxi3tvQDFYUV7SdDJjcPE3Y4mbtftaX"),gt={3:ht,5:wt,6:Tt},bt={3:se,5:xt,6:Pt},Wo=r=>[3,4,5,6].indexOf(r)!==-1,Oo=r=>{var s;let{version:t,rewardInfos:e,rewardTokenAccountsPublicKeys:n}=r,o=`rewardInfo:${JSON.stringify(e)}, rewardAccount:${JSON.stringify(n)}`,a={3:()=>{if(e.length!==1||n.length!==1)return`rewardInfos or rewardTokenAccounts lengths not equal 1: ${o}`},5:()=>{if(e.length!==n.length)return`rewardInfos and rewardTokenAccounts lengths not equal: ${o}`},6:()=>{if(!n.length||e.length!==n.length)return`no rewardTokenAccounts or rewardInfos and rewardTokenAccounts lengths not equal: ${o}`}};return(s=a[t])==null?void 0:s.call(a)},$={"Standard SPL":0,"Option tokens":1},Uo={[pt.toString()]:3,[mt.toString()]:4,[ft.toString()]:5,[yt.toString()]:6,[ie.FARM_PROGRAM_ID_V3.toString()]:3,[ie.FARM_PROGRAM_ID_V4.toString()]:4,[ie.FARM_PROGRAM_ID_V5.toString()]:5,[ie.FARM_PROGRAM_ID_V6.toString()]:6};var Ke=P([k("instruction")]),Ce=P([k("instruction")]),rr=P([u("rewardState"),u("rewardOpenTime"),u("rewardEndTime"),u("rewardLastUpdateTime"),u("totalReward"),u("totalRewardEmissioned"),u("rewardClaimed"),u("rewardPerSecond"),O("accRewardPerShare"),h("rewardVault"),h("rewardMint"),h("rewardSender"),u("rewardType"),R(u(),15,"padding")]),nr=P([u("state"),u("nonce"),h("lpVault"),h("rewardVault"),h(),h(),u(),u(),u("totalReward"),O("perShareReward"),u("lastSlot"),u("perSlotReward")]),or=P([u("state"),u("nonce"),h("lpVault"),h("rewardVaultA"),u("totalRewardA"),O("perShareRewardA"),u("perSlotRewardA"),k("option"),h("rewardVaultB"),j(7),u("totalRewardB"),O("perShareRewardB"),u("perSlotRewardB"),u("lastSlot"),h()]),ir=P([u(),u("state"),u("nonce"),u("validRewardTokenNum"),O("rewardMultiplier"),u("rewardPeriodMax"),u("rewardPeriodMin"),u("rewardPeriodExtend"),h("lpMint"),h("lpVault"),R(rr,5,"rewardInfos"),h("creator"),h(),R(u(),32,"padding")]),ht=new Proxy(nr,{get(r,t,e){return t==="decode"?(...n)=>{let o=r.decode(...n);return D(_({},o),{version:3,rewardInfos:[{rewardVault:o.rewardVault,totalReward:o.totalReward,perSlotReward:o.perSlotReward,perShareReward:o.perShareReward}]})}:Reflect.get(r,t,e)}}),wt=new Proxy(or,{get(r,t,e){return t==="decode"?(...n)=>{let o=r.decode(...n);return D(_({},o),{version:5,rewardInfos:[{rewardVault:o.rewardVaultA,totalReward:o.totalRewardA,perSlotReward:o.perSlotRewardA,perShareReward:o.perShareRewardA},{rewardVault:o.rewardVaultB,totalReward:o.totalRewardB,perSlotReward:o.perSlotRewardB,perShareReward:o.perShareRewardB}]})}:Reflect.get(r,t,e)}}),Tt=new Proxy(ir,{get(r,t,e){return t==="decode"?(...n)=>{let o=r.decode(...n);return D(_({},o),{version:6,rewardInfos:o.rewardInfos.map(a=>{var s;return D(_({},a),{rewardType:((s=Object.entries($).find(c=>String(c[1])===a.rewardType.toString()))!=null?s:["Standard SPL"])[0]})})})}:Reflect.get(r,t,e)}}),sr=P([u("isSet"),u("rewardPerSecond"),u("rewardOpenTime"),u("rewardEndTime"),u("rewardType")]),Ve=P([k("instruction"),u("nonce"),R(sr,5,"rewardTimeInfo")]),_e=P([k("instruction"),u("rewardReopenTime"),u("rewardEndTime"),u("rewardPerSecond")]),Fe=P([k("instruction"),u("isSet"),u("rewardPerSecond"),u("rewardOpenTime"),u("rewardEndTime"),u("rewardType")]),Jo=P([u("state"),h("id"),h("owner"),u("deposited"),R(u(),1,"rewardDebts")]),se=P([u("state"),h("id"),h("owner"),u("deposited"),R(O(),1,"rewardDebts"),u(""),u("voteLockedBalance"),R(u(),15)]),Xo=P([u("state"),h("id"),h("owner"),u("deposited"),R(u(),2,"rewardDebts")]),xt=P([u("state"),h("id"),h("owner"),u("deposited"),R(O(),2,"rewardDebts"),R(u(),17)]),Pt=P([u(),u("state"),h("id"),h("owner"),u("deposited"),R(O(),5,"rewardDebts"),R(u(),16)]),F=P([k("instruction"),u("amount")]),ar=P([h("mint"),h("grantAuthority"),u("baselineVoteWeightScaledFactor"),u("maxExtraLockupVoteWeightScaledFactor"),u("lockupSaturationSecs"),ct("digitShift"),R(k(),7,"reserved1"),R(u(),7,"reserved2")]),St=P([j(8),h("governanceProgramId"),h("realm"),h("realmGoverningTokenMint"),h("realmAuthority"),R(k(),32,"reserved1"),R(ar,4,"votingMints"),ye("timeOffset"),k("bump"),R(k(),7,"reserved2"),R(u(),11,"reserved3")]),ur=P([ye("startTime"),ye("endTime"),k("kind"),R(k(),15,"reserved")]),cr=P([R(ur,1,"lockup"),u("amountDeposited_native"),u("amountInitiallyLockedNative"),oe("isUsed"),oe("allowClawback"),k("votingMintConfigIdx"),R(k(),29,"reserved")]),kt=P([j(8),h("voterAuthority"),h("registrar"),R(cr,32,"deposits"),k("voterBump"),k("voterWweightRecordBump"),R(k(),94,"reserved")]);import N from"bn.js";import{PublicKey as lr}from"@solana/web3.js";import{MINT_SIZE as ii,TOKEN_PROGRAM_ID as si,getTransferFeeConfig as ai,unpackMint as ui}from"@solana/spl-token";var Me=K("Raydium_accountInfo_util");async function It(r,t,e){let{batchRequest:n,commitment:o="confirmed",chunkCount:a=100}=_({batchRequest:!1},e),s=De(t,a),c=new Array(s.length).fill([]);if(n){let m=s.map(y=>{let d=r._buildArgs([y.map(p=>p.toBase58())],o,"base64");return{methodName:"getMultipleAccounts",args:d}}),l=De(m,10);c=(await(await Promise.all(l.map(async y=>await r._rpcBatchRequest(y)))).flat()).map(y=>(y.error&&Me.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${y.error.message}`),y.result.value.map(d=>{if(d){let{data:p,executable:S,lamports:A,owner:L,rentEpoch:V}=d;return p.length!==2&&p[1]!=="base64"&&Me.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(p[0],"base64"),executable:S,lamports:A,owner:new lr(L),rentEpoch:V}}return null})))}else try{c=await Promise.all(s.map(m=>r.getMultipleAccountsInfo(m,o)))}catch(m){m instanceof Error&&Me.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${m.message}`)}return c.flat()}async function Lt(r,t,e){let n=await It(r,t.map(o=>o.pubkey),e);return t.map((o,a)=>D(_({},o),{accountInfo:n[a]}))}import q from"bn.js";import Ns from"decimal.js";import hr from"big.js";import he from"bn.js";import dr from"toformat";var pr=dr,ae=pr;import be from"big.js";import fr from"bn.js";import yr from"decimal.js-light";import ue from"bn.js";var At=9007199254740991;function x(r){let t=K("Raydium_parseBigNumberish");if(r instanceof ue)return r;if(typeof r=="string"){if(r.match(/^-?[0-9]+$/))return new ue(r);t.logWithError(`invalid BigNumberish string: ${r}`)}return typeof r=="number"?(r%1&&t.logWithError(`BigNumberish number underflow: ${r}`),(r>=At||r<=-At)&&t.logWithError(`BigNumberish number overflow: ${r}`),new ue(String(r))):typeof r=="bigint"?new ue(r.toString()):(t.error(`invalid BigNumberish value: ${r}`),new ue(0))}var ge=K("module/fraction"),ve=ae(be),ce=ae(yr),gr={[0]:ce.ROUND_DOWN,[1]:ce.ROUND_HALF_UP,[2]:ce.ROUND_UP},br={[0]:be.roundDown,[1]:be.roundHalfUp,[2]:be.roundUp},I=class{constructor(t,e=new fr(1)){this.numerator=x(t),this.denominator=x(e)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new I(this.denominator,this.numerator)}add(t){let e=t instanceof I?t:new I(x(t));return this.denominator.eq(e.denominator)?new I(this.numerator.add(e.numerator),this.denominator):new I(this.numerator.mul(e.denominator).add(e.numerator.mul(this.denominator)),this.denominator.mul(e.denominator))}sub(t){let e=t instanceof I?t:new I(x(t));return this.denominator.eq(e.denominator)?new I(this.numerator.sub(e.numerator),this.denominator):new I(this.numerator.mul(e.denominator).sub(e.numerator.mul(this.denominator)),this.denominator.mul(e.denominator))}mul(t){let e=t instanceof I?t:new I(x(t));return new I(this.numerator.mul(e.numerator),this.denominator.mul(e.denominator))}div(t){let e=t instanceof I?t:new I(x(t));return new I(this.numerator.mul(e.denominator),this.denominator.mul(e.numerator))}toSignificant(t,e={groupSeparator:""},n=1){Number.isInteger(t)||ge.logWithError(`${t} is not an integer.`),t<=0&&ge.logWithError(`${t} is not positive.`),ce.set({precision:t+1,rounding:gr[n]});let o=new ce(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(t);return o.toFormat(o.decimalPlaces(),e)}toFixed(t,e={groupSeparator:""},n=1){return Number.isInteger(t)||ge.logWithError(`${t} is not an integer.`),t<0&&ge.logWithError(`${t} is negative.`),ve.DP=t,ve.RM=br[n]||1,new ve(this.numerator.toString()).div(this.denominator.toString()).toFormat(t,e)}isZero(){return this.numerator.isZero()}};var wr=K("Raydium_amount"),Rt=ae(hr);function Tr(r,t){let e="0",n="0";if(r.includes(".")){let o=r.split(".");o.length===2?([e,n]=o,n=n.padEnd(t,"0")):wr.logWithError(`invalid number string, num: ${r}`)}else e=r;return[e,n.slice(0,t)||n]}var U=class extends I{constructor(e,n,o=!0,a){let s=new he(0),c=Ee.pow(new he(e.decimals));if(o)s=x(n);else{let m=new he(0),l=new he(0);if(typeof n=="string"||typeof n=="number"||typeof n=="bigint"){let[b,y]=Tr(n.toString(),e.decimals);m=x(b),l=x(y)}m=m.mul(c),s=m.add(l)}super(s,c);this.logger=K(a||"TokenAmount"),this.token=e}get raw(){return this.numerator}isZero(){return this.raw.isZero()}gt(e){return this.token.equals(e.token)||this.logger.logWithError("gt token not equals"),this.raw.gt(e.raw)}lt(e){return this.token.equals(e.token)||this.logger.logWithError("lt token not equals"),this.raw.lt(e.raw)}add(e){return this.token.equals(e.token)||this.logger.logWithError("add token not equals"),new U(this.token,this.raw.add(e.raw))}subtract(e){return this.token.equals(e.token)||this.logger.logWithError("sub token not equals"),new U(this.token,this.raw.sub(e.raw))}toSignificant(e=this.token.decimals,n,o=0){return super.toSignificant(e,n,o)}toFixed(e=this.token.decimals,n,o=0){return e>this.token.decimals&&this.logger.logWithError("decimals overflow"),super.toFixed(e,n,o)}toExact(e={groupSeparator:""}){return Rt.DP=this.token.decimals,new Rt(this.numerator.toString()).div(this.denominator.toString()).toFormat(e)}};import{PublicKey as xr}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Bt}from"@solana/spl-token";var Kt={chainId:101,address:xr.default.toBase58(),programId:Bt.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},Y={chainId:101,address:"So11111111111111111111111111111111111111112",programId:Bt.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};import{PublicKey as Ge}from"@solana/web3.js";import{PublicKey as B,SystemProgram as Ct,SYSVAR_RENT_PUBKEY as Pr}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Sr}from"@solana/spl-token";function i({pubkey:r,isSigner:t=!1,isWritable:e=!0}){return{pubkey:r,isWritable:e,isSigner:t}}var We=[i({pubkey:Sr,isWritable:!1}),i({pubkey:Ct.programId,isWritable:!1}),i({pubkey:Pr,isWritable:!1})];function Vt({publicKey:r,transformSol:t}){let e=Oe(r.toString());if(e instanceof B)return t&&e.equals(z)?Ne:e;if(t&&e.toString()===z.toBase58())return Ne;if(typeof e=="string"){if(e===B.default.toBase58())return B.default;try{return new B(e)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function Oe(r){try{return new B(r)}catch{return r}}var Oi=new B("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),Ui=new B("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),Ue=new B("SysvarRent111111111111111111111111111111111"),Gi=new B("SysvarC1ock11111111111111111111111111111111"),qi=new B("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),we=new B("Sysvar1nstructions1111111111111111111111111"),Hi=Ct.programId,ji=new B("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),Yi=new B("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),zi=new B("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),Ji=new B("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),Xi=new B("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),Zi=new B("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),Qi=new B("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),$i=new B("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),es=new B("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),ts=new B("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),rs=new B("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),Ne=new B("So11111111111111111111111111111111111111112"),z=B.default;var qe=class{constructor({mint:t,decimals:e,symbol:n,name:o,skipMint:a=!1,isToken2022:s=!1}){if(t===z.toBase58()||t instanceof Ge&&z.equals(t)){this.decimals=Y.decimals,this.symbol=Y.symbol,this.name=Y.name,this.mint=new Ge(Y.address),this.isToken2022=!1;return}this.decimals=e,this.symbol=n||t.toString().substring(0,6),this.name=o||t.toString().substring(0,6),this.mint=a?Ge.default:Vt({publicKey:t}),this.isToken2022=s}equals(t){return this===t?!0:this.mint.equals(t.mint)}},J=qe;J.WSOL=new qe(D(_({},Y),{mint:Y.address}));var He=class{constructor({decimals:t,symbol:e="UNKNOWN",name:n="UNKNOWN"}){this.decimals=t,this.symbol=e,this.name=n}equals(t){return this===t}},Te=He;Te.SOL=new He(Kt);import kr from"bn.js";var _t=new I(new kr(100)),ee=class extends I{toSignificant(t=5,e,n){return this.mul(_t).toSignificant(t,e,n)}toFixed(t=2,e,n){return this.mul(_t).toFixed(t,e,n)}};var Ir=K("Raydium_price"),G=class extends I{constructor(e){let{baseToken:n,quoteToken:o,numerator:a,denominator:s}=e;super(a,s);this.baseToken=n,this.quoteToken=o,this.scalar=new I(je(n.decimals),je(o.decimals))}get raw(){return new I(this.numerator,this.denominator)}get adjusted(){return super.mul(this.scalar)}invert(){return new G({baseToken:this.quoteToken,quoteToken:this.baseToken,denominator:this.numerator,numerator:this.denominator})}mul(e){this.quoteToken!==e.baseToken&&Ir.logWithError("mul token not equals");let n=super.mul(e);return new G({baseToken:this.baseToken,quoteToken:e.quoteToken,denominator:n.denominator,numerator:n.numerator})}toSignificant(e=this.quoteToken.decimals,n,o){return this.adjusted.toSignificant(e,n,o)}toFixed(e=this.quoteToken.decimals,n,o){return this.adjusted.toFixed(e,n,o)}};var Lr=new q(0),js=new q(1),Ys=new q(2),zs=new q(3),Js=new q(5),Ee=new q(10),Xs=new q(100),Zs=new q(1e3),Qs=new q(1e4);function je(r){return Ee.pow(x(r))}var Ft=r=>typeof r=="number";function Mt(r,t,e){let n=Ft(t)?t*((e==null?void 0:e.unit)==="s"?1e3:1):t;return new Date(r).getTime()<=n}function Dt(r,t,e){let n=Ft(t)?t*((e==null?void 0:e.unit)==="s"?1e3:1):t;return new Date(r).getTime()>n}function De(r,t=1,e=[]){let n=[...r];if(t<=0)return e;for(;n.length;)e.push(n.splice(0,t));return e}import{PublicKey as Rr}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Br}from"@solana/spl-token";import{ComputeBudgetProgram as sa,Keypair as ca,PublicKey as Ar,Transaction as da,TransactionMessage as ma,VersionedTransaction as fa}from"@solana/web3.js";var te={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",ClmmLockPosition:"ClmmLockPosition",ClmmHarvestLockPosition:"ClmmHarvestLockPosition",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV4Withdraw:"FarmV4Withdraw",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut",CpmmLockLp:"CpmmLockLp",CpmmCollectLockFee:"CpmmCollectLockFee",TransferTip:"TransferTip"};import{TOKEN_PROGRAM_ID as ha}from"@solana/spl-token";var wa=K("Raydium_txUtil");function E(r,t){let[e,n]=Ar.findProgramAddressSync(r,t);return{publicKey:e,nonce:n}}function le(r,t,e){return E([r.toBuffer(),(e!=null?e:Br).toBuffer(),t.toBuffer()],new Rr("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"))}import La from"bn.js";import{PublicKey as Ka,AddressLookupTableAccount as Ca}from"@solana/web3.js";import{PublicKey as Ja,sendAndConfirmTransaction as Xa,SystemProgram as $a,Transaction as eu,TransactionMessage as ru,VersionedTransaction as nu}from"@solana/web3.js";import iu from"axios";import{PublicKey as Kr}from"@solana/web3.js";import Cr from"bn.js";function Vr(r){return typeof r=="object"&&r!==null&&![J,U,Kr,I,Cr,G,ee].some(t=>typeof t=="object"&&r instanceof t)}function xe(r){return typeof r=="string"?Oe(r):Array.isArray(r)?r.map(t=>xe(t)):Vr(r)?Object.fromEntries(Object.entries(r).map(([t,e])=>[t,xe(e)])):r}import _r from"bn.js";var hu=new _r(1e6);var Ye=P([h("mint"),h("owner"),u("amount"),Q("delegateOption"),h("delegate"),k("state"),Q("isNativeOption"),u("isNative"),u("delegatedAmount"),Q("closeAuthorityOption"),h("closeAuthority")]);var de=K("Raydium.farm.util");function ec({programId:r,poolId:t,mint:e,type:n}){let{publicKey:o}=E([t.toBuffer(),e.toBuffer(),Buffer.from(n==="lpVault"?"lp_vault_associated_seed":n==="rewardVault"?"reward_vault_associated_seed":"","utf-8")],r);return o}function W({programId:r,poolId:t,owner:e,version:n}){let{publicKey:o}=E([t.toBuffer(),e.toBuffer(),Buffer.from(n===6?"farmer_info_associated_seed":"staker_info_v2_associated_seed","utf-8")],r);return o}var tc=({programId:r,poolId:t})=>E([t.toBuffer()],r);function rc(r){return{isSet:new N(1),rewardPerSecond:x(r.perSecond),rewardOpenTime:x(r.openTime),rewardEndTime:x(r.endTime),rewardType:x($[r.rewardType])}}function nc(r){return x(r.endTime).sub(x(r.openTime)).mul(x(r.perSecond))}function Fr(r){let t=bt[r];return t||de.logWithError("invalid version",r),t}function Mr(r){let t=gt[r];return t||de.logWithError("invalid version",r),t}function Dr(r,t,e,n){if(r.version===3||r.version===5){if(r.lastSlot.gte(new N(e)))return r;let o=new N(e).sub(r.lastSlot);r.lastSlot=new N(e);for(let a of r.rewardInfos){if(t.amount.eq(new N(0)))continue;let s=a.perSlotReward.mul(o);a.perShareReward=a.perShareReward.add(s.mul(new N(10).pow(new N(r.version===3?9:15))).div(t.amount)),a.totalReward=a.totalReward.add(s)}}else if(r.version===6)for(let o of r.rewardInfos){if(o.rewardState.eq(new N(0)))continue;let a=N.min(new N(n),o.rewardEndTime);if(o.rewardOpenTime.gte(a))continue;let c=a.sub(o.rewardLastUpdateTime).mul(o.rewardPerSecond),m=o.totalReward.sub(o.totalRewardEmissioned);m.lt(c)?(c=m,o.rewardLastUpdateTime=o.rewardLastUpdateTime.add(m.div(o.rewardPerSecond))):o.rewardLastUpdateTime=a,!t.amount.eq(new N(0))&&(o.accRewardPerShare=o.accRewardPerShare.add(c.mul(r.rewardMultiplier).div(t.amount)),o.totalRewardEmissioned=o.totalRewardEmissioned.add(c))}return r}async function oc({connection:r,farmPools:t,owner:e,config:n,chainTime:o}){let a=!1,s=!1,c=new N(10),m=[];for(let d of t){let p=xe(d);p.version===6?s=!0:a=!0,m.push({pubkey:p.id,version:p.version,key:"state",poolId:p.id},{pubkey:p.lpVault,version:p.version,key:"lpVault",poolId:p.id}),e&&m.push({pubkey:W({programId:p.programId,poolId:p.id,owner:e,version:d.version}),version:p.version,key:"ledger",poolId:p.id})}let l={},b=await Lt(r,m,n);for(let{pubkey:d,version:p,key:S,poolId:A,accountInfo:L}of b){let V=A.toBase58();if(l[V]=_({},l[V]),S==="state"){let M=Mr(p);(!L||!L.data||L.data.length!==M.span)&&de.logWithError(`invalid farm state account info, pools.id, ${d}`),l[V].state=M.decode(L.data)}else if(S==="lpVault")(!L||!L.data||L.data.length!==Ye.span)&&de.logWithError(`invalid farm lp vault account info, pools.lpVault, ${d}`),l[V].lpVault=Ye.decode(L.data);else if(S==="ledger"){let M=Fr(p);L&&L.data&&(L.data.length!==M.span&&de.logWithError(`invalid farm ledger account info, ledger, ${d}`),l[V].ledger=M.decode(L.data))}}let y=s||a?await r.getSlot():0;for(let d of Object.keys(l))l[d]!==void 0&&(l[d].state=Dr(l[d].state,l[d].lpVault,y,o));for(let[d,{state:p,ledger:S}]of Object.entries(l))if(S){let A=p.version===6?p.rewardMultiplier:p.rewardInfos.length===1?c.pow(new N(9)):c.pow(new N(15)),L=p.rewardInfos.map((V,M)=>{let H=S.rewardDebts[M];return S.deposited.mul(p.version===6?V.accRewardPerShare:V.perShareReward).div(A).sub(H)});l[d].wrapped=D(_({},l[d].wrapped),{pendingRewards:L})}return l}function ic(r,t=Date.now()){if(r.version===6){let e=r.state.rewardInfos;if(e.every(({rewardOpenTime:n})=>Mt(t,n.toNumber(),{unit:"s"})))return"upcoming pool";if(e.every(({rewardEndTime:n})=>Dt(t,n.toNumber(),{unit:"s"})))return"closed pool"}else{let e=r.state.rewardInfos.map(({perSlotReward:n})=>n);if(e.length===2){if(String(e[0])==="0"&&String(e[1])!=="0")return"normal fusion pool";if(String(e[0])!=="0"&&String(e[1])!=="0")return"dual fusion pool";if(String(e[0])==="0"&&String(e[1])==="0")return"closed pool"}else if(e.length===1&&String(e[0])==="0")return"closed pool"}}async function ze(r,t,e,n){let o=await r.getAccountInfo(t);if(o===null)throw Error("registrar info check error");let s=St.decode(o.data).votingMints.findIndex(b=>b.mint.equals(n));if(s===-1)throw Error("find voter mint error");let c=await r.getAccountInfo(e);if(c===null)return{index:s,isInit:!1};let l=kt.decode(c.data).deposits.findIndex(b=>b.isUsed&&b.votingMintConfigIdx===s);return l===-1?{index:s,isInit:!1}:{index:l,isInit:!0}}import{PublicKey as g,SystemProgram as X,SYSVAR_CLOCK_PUBKEY as re,SYSVAR_RENT_PUBKEY as Nr,TransactionInstruction as C}from"@solana/web3.js";import Pe from"bn.js";import{ASSOCIATED_TOKEN_PROGRAM_ID as vr,createAssociatedTokenAccountIdempotentInstruction as Er,TOKEN_PROGRAM_ID as v}from"@solana/spl-token";function Je(r,t,e){return E([t.toBuffer(),Buffer.from("registrar","utf8"),e.toBuffer()],r)}function Xe(r,t){return E([t.toBuffer(),Buffer.from("voting_mint_seed","utf8")],r)}function Ze(r,t){return E([t.toBuffer()],r)}function Qe(r,t,e){return E([t.toBuffer(),Buffer.from("voter","utf8"),e.toBuffer()],r)}function $e(r,t,e){return E([t.toBuffer(),Buffer.from("voter-weight-record","utf8"),e.toBuffer()],r)}function et(r,t,e,n){return E([Buffer.from("governance","utf8"),t.toBuffer(),e.toBuffer(),n.toBuffer()],r)}var Wr=K("Raydium_farm_instruction"),pe={voterStakeRegistryCreateVoter:Buffer.from([6,24,245,52,243,255,148,25]),voterStakeRegistryCreateDepositEntry:Buffer.from([185,131,167,186,159,125,19,67]),voterStakeRegistryDeposit:Buffer.from([242,35,198,137,82,225,242,182]),voterStakeRegistryWithdraw:Buffer.from([183,18,70,156,148,109,161,34]),voterStakeRegistryUpdateVoterWeightRecord:Buffer.from([45,185,3,36,109,190,115,169])};function Sc(r){let{version:t,id:e,ledger:n,programId:o,owner:a}=r,s={3:9,5:10}[t];s||Wr.logWithError(`invalid farm pool version: ${t}`);let c=Buffer.alloc(Ke.span);Ke.encode({instruction:s},c);let m=[i({pubkey:e}),i({pubkey:n}),i({pubkey:a,isWritable:!1}),i({pubkey:X.programId,isWritable:!1}),i({pubkey:Nr,isWritable:!1})];return{instruction:new C({programId:o,keys:m,data:c}),instructionType:te.FarmV3CreateLedger}}function kc(r){var n;let t=Buffer.alloc(Ve.span);Ve.encode({instruction:0,nonce:new Pe(r.nonce),rewardTimeInfo:r.rewardInfoConfig},t);let e=[...We,i({pubkey:r.farmId}),i({pubkey:r.farmAuthority,isWritable:!1}),i({pubkey:r.lpVault}),i({pubkey:r.lpMint,isWritable:!1}),i({pubkey:r.lockVault}),i({pubkey:r.lockMint,isWritable:!1}),i({pubkey:(n=r.lockUserAccount)!=null?n:z}),i({pubkey:r.owner,isWritable:!1,isSigner:!0})];for(let o of r.rewardInfo)e.push(i({pubkey:o.rewardMint,isWritable:!1}),i({pubkey:o.rewardVault}),i({pubkey:o.userRewardToken}));return{instruction:new C({programId:r.programId,keys:e,data:t}),instructionType:te.FarmV6Create}}function Ic(r){let t=Buffer.alloc(Ce.span);Ce.encode({instruction:5},t);let e=[i({pubkey:v,isWritable:!1}),i({pubkey:r.id}),i({pubkey:r.authority,isWritable:!1}),i({pubkey:r.lpVault,isWritable:!1}),i({pubkey:r.rewardVault}),i({pubkey:r.userRewardToken}),i({pubkey:r.owner,isWritable:!1,isSigner:!0})];return{instruction:new C({programId:r.programId,keys:e,data:t}),instructionType:te.FarmV6CreatorWithdraw}}function Or(r,t,e,n,o,a,s,c,m,l,b,y,d){let p=P([k("depositEntryIndex"),u("amount")]),S=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:v,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:b,isSigner:!1,isWritable:!1},{pubkey:we,isSigner:!1,isWritable:!1}],A=Buffer.alloc(p.span);p.encode({depositEntryIndex:y,amount:d},A);let L=Buffer.from([...pe.voterStakeRegistryDeposit,...A]);return new C({keys:S,programId:r,data:L})}function Ur(r,t,e,n){let o=P([]),a=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:e,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:X.programId,isSigner:!1,isWritable:!1}],s=Buffer.alloc(o.span);o.encode({},s);let c=Buffer.from([...pe.voterStakeRegistryUpdateVoterWeightRecord,...s]);return new C({keys:a,programId:r,data:c})}function Gr(r,t,e,n,o,a,s,c,m,l,b,y,d,p,S){let A=P([k("depositEntryIndex"),u("amount")]),L=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:v,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:b,isSigner:!1,isWritable:!0},{pubkey:y,isSigner:!1,isWritable:!1},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:we,isSigner:!1,isWritable:!1}],V=Buffer.alloc(A.span);A.encode({depositEntryIndex:p,amount:S},V);let M=Buffer.from([...pe.voterStakeRegistryWithdraw,...V]);return new C({keys:L,programId:r,data:M})}function qr(r,t,e,n,o,a){let s=P([k("ins")]),c=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:e,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!0,isWritable:!0},{pubkey:X.programId,isSigner:!1,isWritable:!1}],m=Buffer.alloc(s.span);return s.encode({ins:23},m),new C({keys:c,programId:r,data:m})}function Hr(r,t,e,n,o,a,s,c){let m=P([k("voterBump"),k("voterWeightRecordBump")]),l=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!0,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!0,isWritable:!0},{pubkey:X.programId,isSigner:!1,isWritable:!1},{pubkey:Ue,isSigner:!1,isWritable:!1},{pubkey:we,isSigner:!1,isWritable:!1}],b=Buffer.alloc(m.span);m.encode({voterBump:s,voterWeightRecordBump:c},b);let y=Buffer.from([...pe.voterStakeRegistryCreateVoter,...b]);return new C({keys:l,programId:r,data:y})}function jr(r,t,e,n,o,a,s,c,m,l,b,y){let d=P([k("depositEntryIndex"),k("kind"),k("option"),u("startTs"),Q("periods"),oe("allowClawback")]),p=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!0,isWritable:!1},{pubkey:a,isSigner:!0,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:X.programId,isSigner:!1,isWritable:!1},{pubkey:v,isSigner:!1,isWritable:!1},{pubkey:vr,isSigner:!1,isWritable:!1},{pubkey:Ue,isSigner:!1,isWritable:!1}],S=Buffer.alloc(d.span);d.encode({depositEntryIndex:c,kind:m,option:l===void 0?0:1,startTs:l,periods:b,allowClawback:y},S);let A=Buffer.from([...pe.voterStakeRegistryCreateDepositEntry,...S]);return new C({keys:p,programId:r,data:A})}async function Lc({connection:r,programId:t,governanceProgramId:e,voteWeightAddinProgramId:n,realm:o,communityTokenMint:a,owner:s,poolId:c,tokenProgram:m}){let l=Je(n,o,a).publicKey,b=W({programId:t,poolId:c,owner:s,version:3}),y=await r.getAccountInfo(b);if(y===null)throw Error("user is not staker");let d=se.decode(y.data),p=d.deposited.sub(d.voteLockedBalance);if(console.log("amount",p.toString()),p.eq(new Pe(0)))throw Error("user do not has new stake amount");let S=Xe(t,c).publicKey,A=Ze(t,c).publicKey,{publicKey:L,nonce:V}=Qe(n,l,s),M=le(L,S,m).publicKey,{publicKey:H,nonce:me}=$e(n,l,s),Se=et(e,o,a,s).publicKey,ne=[],ke=le(s,S,m).publicKey;if(await r.getAccountInfo(ke)===null&&ne.push(Er(s,ke,s,S)),await r.getAccountInfo(L)===null){let vt=qr(e,o,s,a,s,Se);ne.push(vt,Hr(n,l,L,H,s,s,V,me))}let{index:tt,isInit:Nt}=await ze(r,l,L,S);return Nt||ne.push(jr(n,l,L,M,s,s,S,tt,0,void 0,0,!1)),ne.push(Or(n,l,L,M,ke,s,b,c,S,A,t,tt,p),Ur(n,l,L,H)),ne}async function Ac({connection:r,programId:t,governanceProgramId:e,voteWeightAddinProgramId:n,realm:o,communityTokenMint:a,owner:s,poolId:c,tokenProgram:m}){let l=Je(n,o,a).publicKey,b=W({programId:t,poolId:c,owner:s,version:3}),y=await r.getAccountInfo(b);if(y===null)throw Error("user is not staker");let d=se.decode(y.data);if(d.voteLockedBalance.eq(new Pe(0)))throw Error("user has vote locked balance = 0");let p=Xe(t,c).publicKey,S=Ze(t,c).publicKey,{publicKey:A}=Qe(n,l,s),L=le(A,p,m).publicKey,{publicKey:V}=$e(n,l,s),M=et(e,o,a,s).publicKey,H=[],{index:me,isInit:Se}=await ze(r,l,A,p);if(!Se)throw Error("deposit entry index check error");return H.push(Gr(n,l,A,s,M,V,L,le(s,p,m).publicKey,b,c,p,S,t,me,d.voteLockedBalance)),H}function Rc({payer:r,rewardVault:t,userRewardTokenPub:e,farmKeys:n,rewardInfo:o}){let a=Buffer.alloc(_e.span);_e.encode({instruction:3,rewardReopenTime:x(o.openTime),rewardEndTime:x(o.endTime),rewardPerSecond:x(o.perSecond)},a);let s=[i({pubkey:v,isWritable:!1}),i({pubkey:n.id}),i({pubkey:n.lpVault,isWritable:!1}),i({pubkey:t}),i({pubkey:e}),i({pubkey:r,isWritable:!1,isSigner:!0})];return new C({programId:n.programId,keys:s,data:a})}function Bc({payer:r,userRewardTokenPub:t,farmKeys:e,rewardVault:n,rewardInfo:o}){let a=Buffer.alloc(Fe.span);Fe.encode({instruction:4,isSet:new Pe(1),rewardPerSecond:x(o.perSecond),rewardOpenTime:x(o.openTime),rewardEndTime:x(o.endTime),rewardType:x($[o.rewardType])},a);let s=[...We,i({pubkey:e.id}),i({pubkey:e.authority,isWritable:!1}),i({pubkey:o.mint,isWritable:!1}),i({pubkey:n}),i({pubkey:t}),i({pubkey:r,isWritable:!1,isSigner:!0})];return new C({programId:e.programId,keys:s,data:a})}function Kc(r){let{farmInfo:t,farmKeys:e,version:n,lpAccount:o,rewardAccounts:a,owner:s,instruction:c,amount:m,deposit:l}=r,[b,y]=[new g(t.programId),new g(t.id)],d=W({programId:b,poolId:y,owner:s,version:n}),p=Buffer.alloc(F.span);F.encode({instruction:c,amount:m},p);let S=n===6?[i({pubkey:v,isWritable:!1}),...l?[i({pubkey:X.programId,isWritable:!1})]:[],i({pubkey:y}),i({pubkey:new g(e.authority),isWritable:!1}),i({pubkey:new g(e.lpVault)}),i({pubkey:d}),i({pubkey:s,isWritable:!1,isSigner:!0}),i({pubkey:o})]:[i({pubkey:y}),i({pubkey:new g(e.authority),isWritable:!1}),i({pubkey:d}),i({pubkey:s,isWritable:!1,isSigner:!0}),i({pubkey:o}),i({pubkey:new g(e.lpVault)}),i({pubkey:a[0]}),i({pubkey:new g(e.rewardInfos[0].vault)}),i({pubkey:re,isWritable:!1}),i({pubkey:v,isWritable:!1})];if(n===5)for(let A=1;A<e.rewardInfos.length;A++)S.push(i({pubkey:a[A]})),S.push(i({pubkey:new g(e.rewardInfos[A].vault)}));if(n===6)for(let A=0;A<e.rewardInfos.length;A++)S.push(i({pubkey:new g(e.rewardInfos[A].vault)})),S.push(i({pubkey:a[A]}));return new C({programId:b,keys:S,data:p})}function Cc(r){let{farmInfo:t,farmKeys:e,lpAccount:n,rewardAccounts:o,owner:a,amount:s}=r,[c,m]=[new g(t.programId),new g(t.id)],l=W({programId:c,poolId:m,owner:a,version:6}),b=Buffer.alloc(F.span);F.encode({instruction:2,amount:x(s)},b);let y=[i({pubkey:v,isWritable:!1}),i({pubkey:m}),i({pubkey:new g(e.authority),isWritable:!1}),i({pubkey:new g(e.lpVault)}),i({pubkey:l}),i({pubkey:a,isWritable:!1,isSigner:!0}),i({pubkey:n})];for(let d=0;d<e.rewardInfos.length;d++)y.push(i({pubkey:new g(e.rewardInfos[d].vault)})),y.push(i({pubkey:o[d]}));return new C({programId:c,keys:y,data:b})}function Vc(r){let{farmInfo:t,farmKeys:e,lpAccount:n,rewardAccounts:o,owner:a,amount:s,userAuxiliaryLedgers:c}=r,[m,l]=[new g(t.programId),new g(t.id)],b=W({programId:m,poolId:l,owner:a,version:5}),y=Buffer.alloc(F.span);F.encode({instruction:12,amount:x(s)},y);let d=[i({pubkey:l}),i({pubkey:new g(e.authority),isWritable:!1}),i({pubkey:b}),i({pubkey:a,isWritable:!1,isSigner:!0}),i({pubkey:n}),i({pubkey:new g(e.lpVault)}),i({pubkey:o[0]}),i({pubkey:new g(e.rewardInfos[0].vault)}),i({pubkey:re,isWritable:!1}),i({pubkey:v,isWritable:!1})];for(let p=1;p<e.rewardInfos.length;p++)d.push(i({pubkey:o[p]})),d.push(i({pubkey:new g(e.rewardInfos[p].vault)}));if(c)for(let p of c)d.push(i({pubkey:p}));return new C({programId:m,keys:d,data:y})}function _c(r){let{farmInfo:t,farmKeys:e,lpAccount:n,rewardAccounts:o,owner:a,amount:s,userAuxiliaryLedgers:c}=r,[m,l]=[new g(t.programId),new g(t.id)],b=P([k("instruction"),u("amount")]),y=[i({pubkey:l}),i({pubkey:new g(e.authority),isWritable:!1}),i({pubkey:c[0]}),i({pubkey:a,isSigner:!0,isWritable:!1}),i({pubkey:n}),i({pubkey:new g(e.lpVault)}),i({pubkey:o[0]}),i({pubkey:new g(e.rewardInfos[0].vault)}),i({pubkey:re,isWritable:!1}),i({pubkey:v,isWritable:!1}),i({pubkey:o[1]}),i({pubkey:new g(e.rewardInfos[1].vault)})],d=Buffer.alloc(b.span);return b.encode({instruction:2,amount:s},d),new C({keys:y,programId:m,data:d})}function Fc(r){let{farmInfo:t,farmKeys:e,lpAccount:n,rewardAccounts:o,owner:a,amount:s,userAuxiliaryLedgers:c}=r,[m,l]=[new g(t.programId),new g(t.id)],b=W({programId:m,poolId:l,owner:a,version:3}),y=Buffer.alloc(F.span);F.encode({instruction:11,amount:x(s)},y);let d=[i({pubkey:l}),i({pubkey:new g(e.authority),isWritable:!1}),i({pubkey:b}),i({pubkey:a,isWritable:!1,isSigner:!0}),i({pubkey:n}),i({pubkey:new g(e.lpVault)}),i({pubkey:o[0]}),i({pubkey:new g(e.rewardInfos[0].vault)}),i({pubkey:re,isWritable:!1}),i({pubkey:v,isWritable:!1})];if(c)for(let p of c)d.push(i({pubkey:p}));return new C({programId:m,keys:d,data:y})}function Mc(r){let{farmInfo:t,farmKeys:e,lpAccount:n,rewardAccounts:o,owner:a,amount:s,userAuxiliaryLedgers:c}=r,[m,l]=[new g(t.programId),new g(t.id)],b=W({programId:m,poolId:l,owner:a,version:3}),y=Buffer.alloc(F.span);F.encode({instruction:10,amount:x(s)},y);let d=[i({pubkey:l}),i({pubkey:new g(e.authority),isWritable:!1}),i({pubkey:b}),i({pubkey:a,isWritable:!1,isSigner:!0}),i({pubkey:n}),i({pubkey:new g(e.lpVault)}),i({pubkey:o[0]}),i({pubkey:new g(e.rewardInfos[0].vault)}),i({pubkey:re,isWritable:!1}),i({pubkey:v,isWritable:!1})];if(c)for(let p of c)d.push(i({pubkey:p}));return new C({programId:m,keys:d,data:y})}function Dc(r){let{farmInfo:t,farmKeys:e,lpAccount:n,rewardAccounts:o,owner:a,amount:s,userAuxiliaryLedgers:c}=r,[m,l]=[new g(t.programId),new g(t.id)],b=W({programId:m,poolId:l,owner:a,version:5}),y=Buffer.alloc(F.span);F.encode({instruction:11,amount:x(s)},y);let d=[i({pubkey:l}),i({pubkey:new g(e.authority),isWritable:!1}),i({pubkey:b}),i({pubkey:a,isWritable:!1,isSigner:!0}),i({pubkey:n}),i({pubkey:new g(e.lpVault)}),i({pubkey:o[0]}),i({pubkey:new g(e.rewardInfos[0].vault)}),i({pubkey:re,isWritable:!1}),i({pubkey:v,isWritable:!1})];for(let p=1;p<e.rewardInfos.length;p++)d.push(i({pubkey:o[p]})),d.push(i({pubkey:new g(e.rewardInfos[p].vault)}));if(c)for(let p of c)d.push(i({pubkey:p}));return new C({programId:m,keys:d,data:y})}function Nc(r){let{farmInfo:t,farmKeys:e,lpAccount:n,rewardAccounts:o,owner:a,amount:s}=r,[c,m]=[new g(t.programId),new g(t.id)],l=W({programId:c,poolId:m,owner:a,version:6}),b=Buffer.alloc(F.span);F.encode({instruction:1,amount:x(s)},b);let y=[i({pubkey:v,isWritable:!1}),i({pubkey:X.programId,isWritable:!1}),i({pubkey:m}),i({pubkey:new g(e.authority),isWritable:!1}),i({pubkey:new g(e.lpVault)}),i({pubkey:l}),i({pubkey:a,isWritable:!1,isSigner:!0}),i({pubkey:n})];for(let d=0;d<e.rewardInfos.length;d++)y.push(i({pubkey:new g(e.rewardInfos[d].vault)})),y.push(i({pubkey:o[d]}));return new C({programId:c,keys:y,data:b})}export{vo as DEV_FARM_LOCK_MINT,Eo as DEV_FARM_LOCK_VAULT,Do as FARM_LOCK_MINT,No as FARM_LOCK_VAULT,Uo as FARM_PROGRAM_TO_VERSION,bt as FARM_VERSION_TO_LEDGER_LAYOUT,gt as FARM_VERSION_TO_STATE_LAYOUT,kt as Voter,cr as VoterDepositEntry,ur as VoterLockup,St as VoterRegistrar,ar as VoterVotingMintConfig,Ke as associatedLedgerAccountLayout,nc as calFarmRewardAmount,Sc as createAssociatedLedgerAccountInstruction,F as dwLayout,Fe as farmAddRewardLayout,Jo as farmLedgerLayoutV3_1,se as farmLedgerLayoutV3_2,Xo as farmLedgerLayoutV5_1,xt as farmLedgerLayoutV5_2,Pt as farmLedgerLayoutV6_1,rc as farmRewardInfoToConfig,Ve as farmRewardLayout,_e as farmRewardRestartLayout,sr as farmRewardTimeInfoLayout,ht as farmStateV3Layout,wt as farmStateV5Layout,Tt as farmStateV6Layout,oc as fetchMultipleFarmInfoAndUpdate,tc as getAssociatedAuthority,W as getAssociatedLedgerAccount,ec as getAssociatedLedgerPoolAccount,ze as getDepositEntryIndex,Fr as getFarmLedgerLayout,Mr as getFarmStateLayout,Je as getRegistrarAddress,et as getTokenOwnerRecordAddress,Qe as getVoterAddress,$e as getVoterWeightRecordAddress,Ze as getVotingMintAuthority,Xe as getVotingTokenMint,qr as governanceCreateTokenOwnerRecord,Wo as isValidFarmVersion,ic as judgeFarmType,Bc as makeAddNewRewardInstruction,kc as makeCreateFarmInstruction,Ic as makeCreatorWithdrawFarmRewardInstruction,Mc as makeDepositInstructionV3,Dc as makeDepositInstructionV5,Nc as makeDepositInstructionV6,Lc as makeDepositTokenInstruction,Kc as makeDepositWithdrawInstruction,Rc as makeRestartRewardInstruction,Fc as makeWithdrawInstructionV3,_c as makeWithdrawInstructionV4,Vc as makeWithdrawInstructionV5,Cc as makeWithdrawInstructionV6,Ac as makeWithdrawTokenInstruction,$ as poolTypeV6,nr as realFarmStateV3Layout,or as realFarmStateV5Layout,ir as realFarmV6Layout,Dr as updateFarmPoolInfo,Oo as validateFarmRewards,jr as voterStakeRegistryCreateDepositEntry,Hr as voterStakeRegistryCreateVoter,Or as voterStakeRegistryDeposit,Ur as voterStakeRegistryUpdateVoterWeightRecord,Gr as voterStakeRegistryWithdraw,Ce as withdrawRewardLayout};
//# sourceMappingURL=index.mjs.map