var Ot=Object.defineProperty,Ut=Object.defineProperties;var Gt=Object.getOwnPropertyDescriptors;var rt=Object.getOwnPropertySymbols;var qt=Object.prototype.hasOwnProperty,jt=Object.prototype.propertyIsEnumerable;var nt=(r,t,e)=>t in r?Ot(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,F=(r,t)=>{for(var e in t||(t={}))qt.call(t,e)&&nt(r,e,t[e]);if(rt)for(var e of rt(t))jt.call(t,e)&&nt(r,e,t[e]);return r},D=(r,t)=>Ut(r,Gt(t));import{PublicKey as Qt}from"@solana/web3.js";import at,{isBN as ut}from"bn.js";import{bits as en,BitStructure as tn,blob as Ht,Blob as rn,cstr as nn,f32 as on,f32be as sn,f64 as an,f64be as un,greedy as cn,Layout as zt,ns64 as ln,ns64be as dn,nu64 as pn,nu64be as mn,offset as fn,s16 as yn,s16be as gn,s24 as bn,s24be as hn,s32 as wn,s32be as Tn,s40 as xn,s40be as Pn,s48 as Sn,s48be as kn,s8 as An,seq as Yt,struct as In,Structure as Xt,u16 as Ln,u16be as Bn,u24 as Rn,u24be as Cn,u32 as Kn,u32be as Vn,u40 as Fn,u40be as _n,u48 as Mn,u48be as Dn,u8 as Zt,UInt as Jt,union as Nn,Union as vn,unionLayoutDiscriminator as En,utf8 as Wn}from"@solana/buffer-layout";var Ae=zt,ot=Xt;var Ie=Jt;var it=Zt;var st=Yt;var H=Ht;var J=class extends Ae{constructor(e,n,o){super(e,o);this.blob=H(e),this.signed=n}decode(e,n=0){let o=new at(this.blob.decode(e,n),10,"le");return this.signed?o.fromTwos(this.span*8).clone():o}encode(e,n,o=0){return typeof e=="number"&&(e=new at(e)),this.signed&&(e=e.toTwos(this.span*8)),this.blob.encode(e.toArrayLike(Buffer,"le",this.span),n,o)}};function k(r){return new Ie(1,r)}function Q(r){return new Ie(4,r)}function u(r){return new J(8,!1,r)}function O(r){return new J(16,!1,r)}function ct(r){return new J(1,!0,r)}function ye(r){return new J(8,!0,r)}var fe=class extends Ae{constructor(e,n,o,a){super(e.span,a);this.layout=e,this.decoder=n,this.encoder=o}decode(e,n){return this.decoder(this.layout.decode(e,n))}encode(e,n,o){return this.layout.encode(this.encoder(e),n,o)}getSpan(e,n){return this.layout.getSpan(e,n)}};function h(r){return new fe(H(32),t=>new Qt(t),t=>t.toBuffer(),r)}function oe(r){return new fe(it(),$t,er,r)}function $t(r){if(r===0)return!1;if(r===1)return!0;throw new Error("Invalid bool: "+r)}function er(r){return r?1:0}var Le=class extends ot{decode(t,e){return super.decode(t,e)}};function P(r,t,e){return new Le(r,t,e)}function B(r,t,e){let n,o=typeof t=="number"?t:ut(t)?t.toNumber():new Proxy(t,{get(a,s){if(!n){let c=Reflect.get(a,"count");n=ut(c)?c.toNumber():c,Reflect.set(a,"count",n)}return Reflect.get(a,s)},set(a,s,c){return s==="count"&&(n=c),Reflect.set(a,s,c)}});return st(r,o,e)}import{PublicKey as Re}from"@solana/web3.js";import{get as lt,set as tr}from"lodash";var Be=class{constructor(t){this.logLevel=t.logLevel!==void 0?t.logLevel:0,this.name=t.name}set level(t){this.logLevel=t}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(t){return t<=this.logLevel}error(...t){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...t),this):this}logWithError(...t){let e=t.map(n=>typeof n=="object"?JSON.stringify(n):n).join(", ");throw new Error(e)}warning(...t){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...t),this):this}info(...t){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...t),this):this}debug(...t){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...t),this):this}},dt={},rr={};function C(r){let t=lt(dt,r);if(!t){let e=lt(rr,r);t=new Be({name:r,logLevel:e}),tr(dt,r,t)}return t}import{PublicKey as f}from"@solana/web3.js";var pt=new f("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),mt=new f("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),ft=new f("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),yt=new f("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),ro=new f("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),no=new f("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),oo=new f("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),io=new f("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),so=new f("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),ao=new f("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),uo=new f("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),co=new f("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),lo=new f("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),po=new f("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),mo=new f("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),fo=new f("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),yo=new f("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),go=new f("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),bo=new f("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),ho=new f("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),wo=new f("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),To=new f("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),xo=new f("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),Po=new f("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),So=new f("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),ko=new f("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),Ao=new f("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),Io=new f("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),Lo=new f("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),Bo=new f("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),Ro=new f("6s1xP3hpbAfFoNtUNF8mfHsjr2Bd97JxFJRWLbL6aHuX");var ie={OPEN_BOOK_PROGRAM:new f("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),SERUM_PROGRAM_ID_V3:new f("Ray1111111111111111111111111111111111111111"),AMM_V4:new f("DRaya7Kj3aMWQSy19kSjvmuwq9docCHofyP9kanQGaav"),AMM_STABLE:new f("DRayDdXc1NZQ9C3hRWmoSf8zK4iapgMnjdNZWrfwsP8m"),CLMM_PROGRAM_ID:new f("DRayAUgENGQBKVaX8owNhgzkEDyoHTGVEGHVJT1E9pfH"),CLMM_LOCK_PROGRAM_ID:new f("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),CLMM_LOCK_AUTH_ID:new f("6Aoh8h2Lw2m5UGxYR8AdAL87jTWYeKoxM52mJRzfYwN"),CREATE_CPMM_POOL_PROGRAM:new f("DRaycpLY18LhpbydsBWbVJtxpNv9oXPgjRSfpF2bWpYb"),CREATE_CPMM_POOL_AUTH:new f("CXniRufdq5xL8t8jZAPxsPZDpuudwuJSPWnbcD5Y5Nxq"),CREATE_CPMM_POOL_FEE_ACC:new f("3oE58BKVt8KuYkGxx8zBojugnymWmBiyafWgMrnb6eYy"),LOCK_CPMM_PROGRAM:new f("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),LOCK_CPMM_AUTH:new f("7qWVV8UY2bRJfDLP4s37YzBPKUkVB46DStYJBpYbQzu3"),UTIL1216:f.default,Router:new f("DRaybByLpbUL57LJARs3j8BitTxVfzBg351EaMr5UTCd"),FARM_PROGRAM_ID_V3:new f("DRayWyrLmEW5KEeqs8kdTMMaBabapqagaBC7KWpGtJeZ"),FARM_PROGRAM_ID_V4:new f("Ray1111111111111111111111111111111111111111"),FARM_PROGRAM_ID_V5:new f("DRayiCGSZgku1GTK6rXD6mVDdingXy6APAH1R6R5L2LC"),FARM_PROGRAM_ID_V6:new f("DRayzbYakXs45ELHkzH6vC3fuhQqTAnv5A68gdFuvZyZ"),LAUNCHPAD_PROGRAM:new f("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),LAUNCHPAD_AUTH:new f("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),LAUNCHPAD_PLATFORM:new f("2Jx4KTDrVSdWNazuGpcA8n3ZLTRGGBDxAWhuKe2Xcj2a"),LAUNCHPAD_CONFIG:new f("7ZR4zD7PYfY2XxoG1Gxcy2EgEeGYrpxrwzPuwdUBssEt"),FEE_DESTINATION_ID:new f("9y8ENuuZ3b19quffx9hQvRVygG5ky6snHfRvGpuSfeJy"),MODEL_DATA_PUBKEY:new f("Ray1111111111111111111111111111111111111111")};import{NATIVE_MINT as nr}from"@solana/spl-token";var vo=C("Raydium_farm_config"),Eo=new Re("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),Wo=new Re("FrspKwj8i3pNmKwXreTveC4fu7KL5ZbGeXdZBe2XViu1"),Oo=nr,Uo=new Re("3TRTX4dXUpp2eqxi3tvQDFYUV7SdDJjcPE3Y4mbtftaX"),gt={3:ht,5:wt,6:Tt},bt={3:se,5:xt,6:Pt},Go=r=>[3,4,5,6].indexOf(r)!==-1,qo=r=>{var s;let{version:t,rewardInfos:e,rewardTokenAccountsPublicKeys:n}=r,o=`rewardInfo:${JSON.stringify(e)}, rewardAccount:${JSON.stringify(n)}`,a={3:()=>{if(e.length!==1||n.length!==1)return`rewardInfos or rewardTokenAccounts lengths not equal 1: ${o}`},5:()=>{if(e.length!==n.length)return`rewardInfos and rewardTokenAccounts lengths not equal: ${o}`},6:()=>{if(!n.length||e.length!==n.length)return`no rewardTokenAccounts or rewardInfos and rewardTokenAccounts lengths not equal: ${o}`}};return(s=a[t])==null?void 0:s.call(a)},$={"Standard SPL":0,"Option tokens":1},jo={[pt.toString()]:3,[mt.toString()]:4,[ft.toString()]:5,[yt.toString()]:6,[ie.FARM_PROGRAM_ID_V3.toString()]:3,[ie.FARM_PROGRAM_ID_V4.toString()]:4,[ie.FARM_PROGRAM_ID_V5.toString()]:5,[ie.FARM_PROGRAM_ID_V6.toString()]:6};var Ce=P([k("instruction")]),Ke=P([k("instruction")]),or=P([u("rewardState"),u("rewardOpenTime"),u("rewardEndTime"),u("rewardLastUpdateTime"),u("totalReward"),u("totalRewardEmissioned"),u("rewardClaimed"),u("rewardPerSecond"),O("accRewardPerShare"),h("rewardVault"),h("rewardMint"),h("rewardSender"),u("rewardType"),B(u(),15,"padding")]),ir=P([u("state"),u("nonce"),h("lpVault"),h("rewardVault"),h(),h(),u(),u(),u("totalReward"),O("perShareReward"),u("lastSlot"),u("perSlotReward")]),sr=P([u("state"),u("nonce"),h("lpVault"),h("rewardVaultA"),u("totalRewardA"),O("perShareRewardA"),u("perSlotRewardA"),k("option"),h("rewardVaultB"),H(7),u("totalRewardB"),O("perShareRewardB"),u("perSlotRewardB"),u("lastSlot"),h()]),ar=P([u(),u("state"),u("nonce"),u("validRewardTokenNum"),O("rewardMultiplier"),u("rewardPeriodMax"),u("rewardPeriodMin"),u("rewardPeriodExtend"),h("lpMint"),h("lpVault"),B(or,5,"rewardInfos"),h("creator"),h(),B(u(),32,"padding")]),ht=new Proxy(ir,{get(r,t,e){return t==="decode"?(...n)=>{let o=r.decode(...n);return D(F({},o),{version:3,rewardInfos:[{rewardVault:o.rewardVault,totalReward:o.totalReward,perSlotReward:o.perSlotReward,perShareReward:o.perShareReward}]})}:Reflect.get(r,t,e)}}),wt=new Proxy(sr,{get(r,t,e){return t==="decode"?(...n)=>{let o=r.decode(...n);return D(F({},o),{version:5,rewardInfos:[{rewardVault:o.rewardVaultA,totalReward:o.totalRewardA,perSlotReward:o.perSlotRewardA,perShareReward:o.perShareRewardA},{rewardVault:o.rewardVaultB,totalReward:o.totalRewardB,perSlotReward:o.perSlotRewardB,perShareReward:o.perShareRewardB}]})}:Reflect.get(r,t,e)}}),Tt=new Proxy(ar,{get(r,t,e){return t==="decode"?(...n)=>{let o=r.decode(...n);return D(F({},o),{version:6,rewardInfos:o.rewardInfos.map(a=>{var s;return D(F({},a),{rewardType:((s=Object.entries($).find(c=>String(c[1])===a.rewardType.toString()))!=null?s:["Standard SPL"])[0]})})})}:Reflect.get(r,t,e)}}),ur=P([u("isSet"),u("rewardPerSecond"),u("rewardOpenTime"),u("rewardEndTime"),u("rewardType")]),Ve=P([k("instruction"),u("nonce"),B(ur,5,"rewardTimeInfo")]),Fe=P([k("instruction"),u("rewardReopenTime"),u("rewardEndTime"),u("rewardPerSecond")]),_e=P([k("instruction"),u("isSet"),u("rewardPerSecond"),u("rewardOpenTime"),u("rewardEndTime"),u("rewardType")]),Qo=P([u("state"),h("id"),h("owner"),u("deposited"),B(u(),1,"rewardDebts")]),se=P([u("state"),h("id"),h("owner"),u("deposited"),B(O(),1,"rewardDebts"),u(""),u("voteLockedBalance"),B(u(),15)]),$o=P([u("state"),h("id"),h("owner"),u("deposited"),B(u(),2,"rewardDebts")]),xt=P([u("state"),h("id"),h("owner"),u("deposited"),B(O(),2,"rewardDebts"),B(u(),17)]),Pt=P([u(),u("state"),h("id"),h("owner"),u("deposited"),B(O(),5,"rewardDebts"),B(u(),16)]),_=P([k("instruction"),u("amount")]),cr=P([h("mint"),h("grantAuthority"),u("baselineVoteWeightScaledFactor"),u("maxExtraLockupVoteWeightScaledFactor"),u("lockupSaturationSecs"),ct("digitShift"),B(k(),7,"reserved1"),B(u(),7,"reserved2")]),St=P([H(8),h("governanceProgramId"),h("realm"),h("realmGoverningTokenMint"),h("realmAuthority"),B(k(),32,"reserved1"),B(cr,4,"votingMints"),ye("timeOffset"),k("bump"),B(k(),7,"reserved2"),B(u(),11,"reserved3")]),lr=P([ye("startTime"),ye("endTime"),k("kind"),B(k(),15,"reserved")]),dr=P([B(lr,1,"lockup"),u("amountDeposited_native"),u("amountInitiallyLockedNative"),oe("isUsed"),oe("allowClawback"),k("votingMintConfigIdx"),B(k(),29,"reserved")]),kt=P([H(8),h("voterAuthority"),h("registrar"),B(dr,32,"deposits"),k("voterBump"),k("voterWweightRecordBump"),B(k(),94,"reserved")]);import N from"bn.js";import{PublicKey as pr}from"@solana/web3.js";import{MINT_SIZE as ui,TOKEN_PROGRAM_ID as ci,getTransferFeeConfig as li,unpackMint as di}from"@solana/spl-token";var Me=C("Raydium_accountInfo_util");async function At(r,t,e){let{batchRequest:n,commitment:o="confirmed",chunkCount:a=100}=F({batchRequest:!1},e),s=De(t,a),c=new Array(s.length).fill([]);if(n){let m=s.map(y=>{let d=r._buildArgs([y.map(p=>p.toBase58())],o,"base64");return{methodName:"getMultipleAccounts",args:d}}),l=De(m,10);c=(await(await Promise.all(l.map(async y=>await r._rpcBatchRequest(y)))).flat()).map(y=>(y.error&&Me.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${y.error.message}`),y.result.value.map(d=>{if(d){let{data:p,executable:S,lamports:L,owner:I,rentEpoch:V}=d;return p.length!==2&&p[1]!=="base64"&&Me.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(p[0],"base64"),executable:S,lamports:L,owner:new pr(I),rentEpoch:V}}return null})))}else try{c=await Promise.all(s.map(m=>r.getMultipleAccountsInfo(m,o)))}catch(m){m instanceof Error&&Me.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${m.message}`)}return c.flat()}async function It(r,t,e){let n=await At(r,t.map(o=>o.pubkey),e);return t.map((o,a)=>D(F({},o),{accountInfo:n[a]}))}import q from"bn.js";import js from"decimal.js";import Tr from"big.js";import he from"bn.js";import mr from"toformat";var fr=mr,ae=fr;import be from"big.js";import gr from"bn.js";import br from"decimal.js-light";import ue from"bn.js";var Lt=9007199254740991;function x(r){let t=C("Raydium_parseBigNumberish");if(r instanceof ue)return r;if(typeof r=="string"){if(r.match(/^-?[0-9]+$/))return new ue(r);t.logWithError(`invalid BigNumberish string: ${r}`)}return typeof r=="number"?(r%1&&t.logWithError(`BigNumberish number underflow: ${r}`),(r>=Lt||r<=-Lt)&&t.logWithError(`BigNumberish number overflow: ${r}`),new ue(String(r))):typeof r=="bigint"?new ue(r.toString()):(t.error(`invalid BigNumberish value: ${r}`),new ue(0))}var ge=C("module/fraction"),ve=ae(be),ce=ae(br),hr={[0]:ce.ROUND_DOWN,[1]:ce.ROUND_HALF_UP,[2]:ce.ROUND_UP},wr={[0]:be.roundDown,[1]:be.roundHalfUp,[2]:be.roundUp},A=class{constructor(t,e=new gr(1)){this.numerator=x(t),this.denominator=x(e)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new A(this.denominator,this.numerator)}add(t){let e=t instanceof A?t:new A(x(t));return this.denominator.eq(e.denominator)?new A(this.numerator.add(e.numerator),this.denominator):new A(this.numerator.mul(e.denominator).add(e.numerator.mul(this.denominator)),this.denominator.mul(e.denominator))}sub(t){let e=t instanceof A?t:new A(x(t));return this.denominator.eq(e.denominator)?new A(this.numerator.sub(e.numerator),this.denominator):new A(this.numerator.mul(e.denominator).sub(e.numerator.mul(this.denominator)),this.denominator.mul(e.denominator))}mul(t){let e=t instanceof A?t:new A(x(t));return new A(this.numerator.mul(e.numerator),this.denominator.mul(e.denominator))}div(t){let e=t instanceof A?t:new A(x(t));return new A(this.numerator.mul(e.denominator),this.denominator.mul(e.numerator))}toSignificant(t,e={groupSeparator:""},n=1){Number.isInteger(t)||ge.logWithError(`${t} is not an integer.`),t<=0&&ge.logWithError(`${t} is not positive.`),ce.set({precision:t+1,rounding:hr[n]});let o=new ce(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(t);return o.toFormat(o.decimalPlaces(),e)}toFixed(t,e={groupSeparator:""},n=1){return Number.isInteger(t)||ge.logWithError(`${t} is not an integer.`),t<0&&ge.logWithError(`${t} is negative.`),ve.DP=t,ve.RM=wr[n]||1,new ve(this.numerator.toString()).div(this.denominator.toString()).toFormat(t,e)}isZero(){return this.numerator.isZero()}};var xr=C("Raydium_amount"),Bt=ae(Tr);function Pr(r,t){let e="0",n="0";if(r.includes(".")){let o=r.split(".");o.length===2?([e,n]=o,n=n.padEnd(t,"0")):xr.logWithError(`invalid number string, num: ${r}`)}else e=r;return[e,n.slice(0,t)||n]}var U=class extends A{constructor(e,n,o=!0,a){let s=new he(0),c=Ee.pow(new he(e.decimals));if(o)s=x(n);else{let m=new he(0),l=new he(0);if(typeof n=="string"||typeof n=="number"||typeof n=="bigint"){let[b,y]=Pr(n.toString(),e.decimals);m=x(b),l=x(y)}m=m.mul(c),s=m.add(l)}super(s,c);this.logger=C(a||"TokenAmount"),this.token=e}get raw(){return this.numerator}isZero(){return this.raw.isZero()}gt(e){return this.token.equals(e.token)||this.logger.logWithError("gt token not equals"),this.raw.gt(e.raw)}lt(e){return this.token.equals(e.token)||this.logger.logWithError("lt token not equals"),this.raw.lt(e.raw)}add(e){return this.token.equals(e.token)||this.logger.logWithError("add token not equals"),new U(this.token,this.raw.add(e.raw))}subtract(e){return this.token.equals(e.token)||this.logger.logWithError("sub token not equals"),new U(this.token,this.raw.sub(e.raw))}toSignificant(e=this.token.decimals,n,o=0){return super.toSignificant(e,n,o)}toFixed(e=this.token.decimals,n,o=0){return e>this.token.decimals&&this.logger.logWithError("decimals overflow"),super.toFixed(e,n,o)}toExact(e={groupSeparator:""}){return Bt.DP=this.token.decimals,new Bt(this.numerator.toString()).div(this.denominator.toString()).toFormat(e)}};import{PublicKey as Sr}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Rt}from"@solana/spl-token";var Ct={chainId:101,address:Sr.default.toBase58(),programId:Rt.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},z={chainId:101,address:"So11111111111111111111111111111111111111112",programId:Rt.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};import{PublicKey as Ge}from"@solana/web3.js";import{PublicKey as R,SystemProgram as Kt,SYSVAR_RENT_PUBKEY as kr}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Ar}from"@solana/spl-token";function i({pubkey:r,isSigner:t=!1,isWritable:e=!0}){return{pubkey:r,isWritable:e,isSigner:t}}var We=[i({pubkey:Ar,isWritable:!1}),i({pubkey:Kt.programId,isWritable:!1}),i({pubkey:kr,isWritable:!1})];function Vt({publicKey:r,transformSol:t}){let e=Oe(r.toString());if(e instanceof R)return t&&e.equals(Y)?Ne:e;if(t&&e.toString()===Y.toBase58())return Ne;if(typeof e=="string"){if(e===R.default.toBase58())return R.default;try{return new R(e)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function Oe(r){try{return new R(r)}catch{return r}}var qi=new R("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),ji=new R("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),Ue=new R("SysvarRent111111111111111111111111111111111"),Hi=new R("SysvarC1ock11111111111111111111111111111111"),zi=new R("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),we=new R("Sysvar1nstructions1111111111111111111111111"),Yi=Kt.programId,Xi=new R("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),Zi=new R("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),Ji=new R("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),Qi=new R("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),$i=new R("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),es=new R("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),ts=new R("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),rs=new R("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),ns=new R("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),os=new R("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),is=new R("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),Ne=new R("So11111111111111111111111111111111111111112"),Y=R.default;var qe=class{constructor({mint:t,decimals:e,symbol:n,name:o,skipMint:a=!1,isToken2022:s=!1}){if(t===Y.toBase58()||t instanceof Ge&&Y.equals(t)){this.decimals=z.decimals,this.symbol=z.symbol,this.name=z.name,this.mint=new Ge(z.address),this.isToken2022=!1;return}this.decimals=e,this.symbol=n||t.toString().substring(0,6),this.name=o||t.toString().substring(0,6),this.mint=a?Ge.default:Vt({publicKey:t}),this.isToken2022=s}equals(t){return this===t?!0:this.mint.equals(t.mint)}},X=qe;X.WSOL=new qe(D(F({},z),{mint:z.address}));var je=class{constructor({decimals:t,symbol:e="UNKNOWN",name:n="UNKNOWN"}){this.decimals=t,this.symbol=e,this.name=n}equals(t){return this===t}},Te=je;Te.SOL=new je(Ct);import Ir from"bn.js";var Ft=new A(new Ir(100)),ee=class extends A{toSignificant(t=5,e,n){return this.mul(Ft).toSignificant(t,e,n)}toFixed(t=2,e,n){return this.mul(Ft).toFixed(t,e,n)}};var Lr=C("Raydium_price"),G=class extends A{constructor(e){let{baseToken:n,quoteToken:o,numerator:a,denominator:s}=e;super(a,s);this.baseToken=n,this.quoteToken=o,this.scalar=new A(He(n.decimals),He(o.decimals))}get raw(){return new A(this.numerator,this.denominator)}get adjusted(){return super.mul(this.scalar)}invert(){return new G({baseToken:this.quoteToken,quoteToken:this.baseToken,denominator:this.numerator,numerator:this.denominator})}mul(e){this.quoteToken!==e.baseToken&&Lr.logWithError("mul token not equals");let n=super.mul(e);return new G({baseToken:this.baseToken,quoteToken:e.quoteToken,denominator:n.denominator,numerator:n.numerator})}toSignificant(e=this.quoteToken.decimals,n,o){return this.adjusted.toSignificant(e,n,o)}toFixed(e=this.quoteToken.decimals,n,o){return this.adjusted.toFixed(e,n,o)}};import{PublicKey as Rr}from"@solana/web3.js";import Cr from"bn.js";function _t(r){return typeof r=="object"&&r!==null&&![X,U,Rr,A,Cr,G,ee].some(t=>typeof t=="object"&&r instanceof t)}function xe(r){return typeof r=="string"?Oe(r):Array.isArray(r)?r.map(t=>xe(t)):_t(r)?Object.fromEntries(Object.entries(r).map(([t,e])=>[t,xe(e)])):r}var Br=new q(0),ta=new q(1),ra=new q(2),na=new q(3),oa=new q(5),Ee=new q(10),ia=new q(100),sa=new q(1e3),aa=new q(1e4);function He(r){return Ee.pow(x(r))}var Mt=r=>typeof r=="number";function Dt(r,t,e){let n=Mt(t)?t*((e==null?void 0:e.unit)==="s"?1e3:1):t;return new Date(r).getTime()<=n}function Nt(r,t,e){let n=Mt(t)?t*((e==null?void 0:e.unit)==="s"?1e3:1):t;return new Date(r).getTime()>n}function De(r,t=1,e=[]){let n=[...r];if(t<=0)return e;for(;n.length;)e.push(n.splice(0,t));return e}import{PublicKey as Vr}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Fr}from"@solana/spl-token";import{ComputeBudgetProgram as ya,Keypair as ha,PublicKey as Kr,Transaction as Ta,TransactionMessage as Pa,VersionedTransaction as Sa}from"@solana/web3.js";var te={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",ClmmLockPosition:"ClmmLockPosition",ClmmHarvestLockPosition:"ClmmHarvestLockPosition",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV4Withdraw:"FarmV4Withdraw",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut",CpmmLockLp:"CpmmLockLp",CpmmCollectLockFee:"CpmmCollectLockFee",TransferTip:"TransferTip"};import{TOKEN_PROGRAM_ID as La}from"@solana/spl-token";var Ba=C("Raydium_txUtil");function E(r,t){let[e,n]=Kr.findProgramAddressSync(r,t);return{publicKey:e,nonce:n}}function le(r,t,e){return E([r.toBuffer(),(e!=null?e:Fr).toBuffer(),t.toBuffer()],new Vr("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"))}import Ma from"bn.js";import{PublicKey as _r,AddressLookupTableAccount as vt}from"@solana/web3.js";var Mr={AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU:new vt({key:new _r("AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU"),state:vt.deserialize(Buffer.from("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","base64"))})};import{PublicKey as eu,sendAndConfirmTransaction as tu,SystemProgram as ou,Transaction as iu,TransactionMessage as au,VersionedTransaction as uu}from"@solana/web3.js";import lu from"axios";import Dr from"bn.js";var bu=new Dr(1e6);var ze=P([h("mint"),h("owner"),u("amount"),Q("delegateOption"),h("delegate"),k("state"),Q("isNativeOption"),u("isNative"),u("delegatedAmount"),Q("closeAuthorityOption"),h("closeAuthority")]);var de=C("Raydium.farm.util");function $u({programId:r,poolId:t,mint:e,type:n}){let{publicKey:o}=E([t.toBuffer(),e.toBuffer(),Buffer.from(n==="lpVault"?"lp_vault_associated_seed":n==="rewardVault"?"reward_vault_associated_seed":"","utf-8")],r);return o}function W({programId:r,poolId:t,owner:e,version:n}){let{publicKey:o}=E([t.toBuffer(),e.toBuffer(),Buffer.from(n===6?"farmer_info_associated_seed":"staker_info_v2_associated_seed","utf-8")],r);return o}var ec=({programId:r,poolId:t})=>E([t.toBuffer()],r);function tc(r){return{isSet:new N(1),rewardPerSecond:x(r.perSecond),rewardOpenTime:x(r.openTime),rewardEndTime:x(r.endTime),rewardType:x($[r.rewardType])}}function rc(r){return x(r.endTime).sub(x(r.openTime)).mul(x(r.perSecond))}function Nr(r){let t=bt[r];return t||de.logWithError("invalid version",r),t}function vr(r){let t=gt[r];return t||de.logWithError("invalid version",r),t}function Er(r,t,e,n){if(r.version===3||r.version===5){if(r.lastSlot.gte(new N(e)))return r;let o=new N(e).sub(r.lastSlot);r.lastSlot=new N(e);for(let a of r.rewardInfos){if(t.amount.eq(new N(0)))continue;let s=a.perSlotReward.mul(o);a.perShareReward=a.perShareReward.add(s.mul(new N(10).pow(new N(r.version===3?9:15))).div(t.amount)),a.totalReward=a.totalReward.add(s)}}else if(r.version===6)for(let o of r.rewardInfos){if(o.rewardState.eq(new N(0)))continue;let a=N.min(new N(n),o.rewardEndTime);if(o.rewardOpenTime.gte(a))continue;let c=a.sub(o.rewardLastUpdateTime).mul(o.rewardPerSecond),m=o.totalReward.sub(o.totalRewardEmissioned);m.lt(c)?(c=m,o.rewardLastUpdateTime=o.rewardLastUpdateTime.add(m.div(o.rewardPerSecond))):o.rewardLastUpdateTime=a,!t.amount.eq(new N(0))&&(o.accRewardPerShare=o.accRewardPerShare.add(c.mul(r.rewardMultiplier).div(t.amount)),o.totalRewardEmissioned=o.totalRewardEmissioned.add(c))}return r}async function nc({connection:r,farmPools:t,owner:e,config:n,chainTime:o}){let a=!1,s=!1,c=new N(10),m=[];for(let d of t){let p=xe(d);p.version===6?s=!0:a=!0,m.push({pubkey:p.id,version:p.version,key:"state",poolId:p.id},{pubkey:p.lpVault,version:p.version,key:"lpVault",poolId:p.id}),e&&m.push({pubkey:W({programId:p.programId,poolId:p.id,owner:e,version:d.version}),version:p.version,key:"ledger",poolId:p.id})}let l={},b=await It(r,m,n);for(let{pubkey:d,version:p,key:S,poolId:L,accountInfo:I}of b){let V=L.toBase58();if(l[V]=F({},l[V]),S==="state"){let M=vr(p);(!I||!I.data||I.data.length!==M.span)&&de.logWithError(`invalid farm state account info, pools.id, ${d}`),l[V].state=M.decode(I.data)}else if(S==="lpVault")(!I||!I.data||I.data.length!==ze.span)&&de.logWithError(`invalid farm lp vault account info, pools.lpVault, ${d}`),l[V].lpVault=ze.decode(I.data);else if(S==="ledger"){let M=Nr(p);I&&I.data&&(I.data.length!==M.span&&de.logWithError(`invalid farm ledger account info, ledger, ${d}`),l[V].ledger=M.decode(I.data))}}let y=s||a?await r.getSlot():0;for(let d of Object.keys(l))l[d]!==void 0&&(l[d].state=Er(l[d].state,l[d].lpVault,y,o));for(let[d,{state:p,ledger:S}]of Object.entries(l))if(S){let L=p.version===6?p.rewardMultiplier:p.rewardInfos.length===1?c.pow(new N(9)):c.pow(new N(15)),I=p.rewardInfos.map((V,M)=>{let j=S.rewardDebts[M];return S.deposited.mul(p.version===6?V.accRewardPerShare:V.perShareReward).div(L).sub(j)});l[d].wrapped=D(F({},l[d].wrapped),{pendingRewards:I})}return l}function oc(r,t=Date.now()){if(r.version===6){let e=r.state.rewardInfos;if(e.every(({rewardOpenTime:n})=>Dt(t,n.toNumber(),{unit:"s"})))return"upcoming pool";if(e.every(({rewardEndTime:n})=>Nt(t,n.toNumber(),{unit:"s"})))return"closed pool"}else{let e=r.state.rewardInfos.map(({perSlotReward:n})=>n);if(e.length===2){if(String(e[0])==="0"&&String(e[1])!=="0")return"normal fusion pool";if(String(e[0])!=="0"&&String(e[1])!=="0")return"dual fusion pool";if(String(e[0])==="0"&&String(e[1])==="0")return"closed pool"}else if(e.length===1&&String(e[0])==="0")return"closed pool"}}async function Ye(r,t,e,n){let o=await r.getAccountInfo(t);if(o===null)throw Error("registrar info check error");let s=St.decode(o.data).votingMints.findIndex(b=>b.mint.equals(n));if(s===-1)throw Error("find voter mint error");let c=await r.getAccountInfo(e);if(c===null)return{index:s,isInit:!1};let l=kt.decode(c.data).deposits.findIndex(b=>b.isUsed&&b.votingMintConfigIdx===s);return l===-1?{index:s,isInit:!1}:{index:l,isInit:!0}}import{PublicKey as g,SystemProgram as Z,SYSVAR_CLOCK_PUBKEY as re,SYSVAR_RENT_PUBKEY as Wr,TransactionInstruction as K}from"@solana/web3.js";import Pe from"bn.js";import{ASSOCIATED_TOKEN_PROGRAM_ID as Or,createAssociatedTokenAccountIdempotentInstruction as Ur,TOKEN_PROGRAM_ID as v}from"@solana/spl-token";function Xe(r,t,e){return E([t.toBuffer(),Buffer.from("registrar","utf8"),e.toBuffer()],r)}function Ze(r,t){return E([t.toBuffer(),Buffer.from("voting_mint_seed","utf8")],r)}function Je(r,t){return E([t.toBuffer()],r)}function Qe(r,t,e){return E([t.toBuffer(),Buffer.from("voter","utf8"),e.toBuffer()],r)}function $e(r,t,e){return E([t.toBuffer(),Buffer.from("voter-weight-record","utf8"),e.toBuffer()],r)}function et(r,t,e,n){return E([Buffer.from("governance","utf8"),t.toBuffer(),e.toBuffer(),n.toBuffer()],r)}var Gr=C("Raydium_farm_instruction"),pe={voterStakeRegistryCreateVoter:Buffer.from([6,24,245,52,243,255,148,25]),voterStakeRegistryCreateDepositEntry:Buffer.from([185,131,167,186,159,125,19,67]),voterStakeRegistryDeposit:Buffer.from([242,35,198,137,82,225,242,182]),voterStakeRegistryWithdraw:Buffer.from([183,18,70,156,148,109,161,34]),voterStakeRegistryUpdateVoterWeightRecord:Buffer.from([45,185,3,36,109,190,115,169])};function Pc(r){let{version:t,id:e,ledger:n,programId:o,owner:a}=r,s={3:9,5:10}[t];s||Gr.logWithError(`invalid farm pool version: ${t}`);let c=Buffer.alloc(Ce.span);Ce.encode({instruction:s},c);let m=[i({pubkey:e}),i({pubkey:n}),i({pubkey:a,isWritable:!1}),i({pubkey:Z.programId,isWritable:!1}),i({pubkey:Wr,isWritable:!1})];return{instruction:new K({programId:o,keys:m,data:c}),instructionType:te.FarmV3CreateLedger}}function Sc(r){var n;let t=Buffer.alloc(Ve.span);Ve.encode({instruction:0,nonce:new Pe(r.nonce),rewardTimeInfo:r.rewardInfoConfig},t);let e=[...We,i({pubkey:r.farmId}),i({pubkey:r.farmAuthority,isWritable:!1}),i({pubkey:r.lpVault}),i({pubkey:r.lpMint,isWritable:!1}),i({pubkey:r.lockVault}),i({pubkey:r.lockMint,isWritable:!1}),i({pubkey:(n=r.lockUserAccount)!=null?n:Y}),i({pubkey:r.owner,isWritable:!1,isSigner:!0})];for(let o of r.rewardInfo)e.push(i({pubkey:o.rewardMint,isWritable:!1}),i({pubkey:o.rewardVault}),i({pubkey:o.userRewardToken}));return{instruction:new K({programId:r.programId,keys:e,data:t}),instructionType:te.FarmV6Create}}function kc(r){let t=Buffer.alloc(Ke.span);Ke.encode({instruction:5},t);let e=[i({pubkey:v,isWritable:!1}),i({pubkey:r.id}),i({pubkey:r.authority,isWritable:!1}),i({pubkey:r.lpVault,isWritable:!1}),i({pubkey:r.rewardVault}),i({pubkey:r.userRewardToken}),i({pubkey:r.owner,isWritable:!1,isSigner:!0})];return{instruction:new K({programId:r.programId,keys:e,data:t}),instructionType:te.FarmV6CreatorWithdraw}}function qr(r,t,e,n,o,a,s,c,m,l,b,y,d){let p=P([k("depositEntryIndex"),u("amount")]),S=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:v,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:b,isSigner:!1,isWritable:!1},{pubkey:we,isSigner:!1,isWritable:!1}],L=Buffer.alloc(p.span);p.encode({depositEntryIndex:y,amount:d},L);let I=Buffer.from([...pe.voterStakeRegistryDeposit,...L]);return new K({keys:S,programId:r,data:I})}function jr(r,t,e,n){let o=P([]),a=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:e,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:Z.programId,isSigner:!1,isWritable:!1}],s=Buffer.alloc(o.span);o.encode({},s);let c=Buffer.from([...pe.voterStakeRegistryUpdateVoterWeightRecord,...s]);return new K({keys:a,programId:r,data:c})}function Hr(r,t,e,n,o,a,s,c,m,l,b,y,d,p,S){let L=P([k("depositEntryIndex"),u("amount")]),I=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:v,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:b,isSigner:!1,isWritable:!0},{pubkey:y,isSigner:!1,isWritable:!1},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:we,isSigner:!1,isWritable:!1}],V=Buffer.alloc(L.span);L.encode({depositEntryIndex:p,amount:S},V);let M=Buffer.from([...pe.voterStakeRegistryWithdraw,...V]);return new K({keys:I,programId:r,data:M})}function zr(r,t,e,n,o,a){let s=P([k("ins")]),c=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:e,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!0,isWritable:!0},{pubkey:Z.programId,isSigner:!1,isWritable:!1}],m=Buffer.alloc(s.span);return s.encode({ins:23},m),new K({keys:c,programId:r,data:m})}function Yr(r,t,e,n,o,a,s,c){let m=P([k("voterBump"),k("voterWeightRecordBump")]),l=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!0,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!0,isWritable:!0},{pubkey:Z.programId,isSigner:!1,isWritable:!1},{pubkey:Ue,isSigner:!1,isWritable:!1},{pubkey:we,isSigner:!1,isWritable:!1}],b=Buffer.alloc(m.span);m.encode({voterBump:s,voterWeightRecordBump:c},b);let y=Buffer.from([...pe.voterStakeRegistryCreateVoter,...b]);return new K({keys:l,programId:r,data:y})}function Xr(r,t,e,n,o,a,s,c,m,l,b,y){let d=P([k("depositEntryIndex"),k("kind"),k("option"),u("startTs"),Q("periods"),oe("allowClawback")]),p=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!0,isWritable:!1},{pubkey:a,isSigner:!0,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:Z.programId,isSigner:!1,isWritable:!1},{pubkey:v,isSigner:!1,isWritable:!1},{pubkey:Or,isSigner:!1,isWritable:!1},{pubkey:Ue,isSigner:!1,isWritable:!1}],S=Buffer.alloc(d.span);d.encode({depositEntryIndex:c,kind:m,option:l===void 0?0:1,startTs:l,periods:b,allowClawback:y},S);let L=Buffer.from([...pe.voterStakeRegistryCreateDepositEntry,...S]);return new K({keys:p,programId:r,data:L})}async function Ac({connection:r,programId:t,governanceProgramId:e,voteWeightAddinProgramId:n,realm:o,communityTokenMint:a,owner:s,poolId:c,tokenProgram:m}){let l=Xe(n,o,a).publicKey,b=W({programId:t,poolId:c,owner:s,version:3}),y=await r.getAccountInfo(b);if(y===null)throw Error("user is not staker");let d=se.decode(y.data),p=d.deposited.sub(d.voteLockedBalance);if(console.log("amount",p.toString()),p.eq(new Pe(0)))throw Error("user do not has new stake amount");let S=Ze(t,c).publicKey,L=Je(t,c).publicKey,{publicKey:I,nonce:V}=Qe(n,l,s),M=le(I,S,m).publicKey,{publicKey:j,nonce:me}=$e(n,l,s),Se=et(e,o,a,s).publicKey,ne=[],ke=le(s,S,m).publicKey;if(await r.getAccountInfo(ke)===null&&ne.push(Ur(s,ke,s,S)),await r.getAccountInfo(I)===null){let Wt=zr(e,o,s,a,s,Se);ne.push(Wt,Yr(n,l,I,j,s,s,V,me))}let{index:tt,isInit:Et}=await Ye(r,l,I,S);return Et||ne.push(Xr(n,l,I,M,s,s,S,tt,0,void 0,0,!1)),ne.push(qr(n,l,I,M,ke,s,b,c,S,L,t,tt,p),jr(n,l,I,j)),ne}async function Ic({connection:r,programId:t,governanceProgramId:e,voteWeightAddinProgramId:n,realm:o,communityTokenMint:a,owner:s,poolId:c,tokenProgram:m}){let l=Xe(n,o,a).publicKey,b=W({programId:t,poolId:c,owner:s,version:3}),y=await r.getAccountInfo(b);if(y===null)throw Error("user is not staker");let d=se.decode(y.data);if(d.voteLockedBalance.eq(new Pe(0)))throw Error("user has vote locked balance = 0");let p=Ze(t,c).publicKey,S=Je(t,c).publicKey,{publicKey:L}=Qe(n,l,s),I=le(L,p,m).publicKey,{publicKey:V}=$e(n,l,s),M=et(e,o,a,s).publicKey,j=[],{index:me,isInit:Se}=await Ye(r,l,L,p);if(!Se)throw Error("deposit entry index check error");return j.push(Hr(n,l,L,s,M,V,I,le(s,p,m).publicKey,b,c,p,S,t,me,d.voteLockedBalance)),j}function Lc({payer:r,rewardVault:t,userRewardTokenPub:e,farmKeys:n,rewardInfo:o}){let a=Buffer.alloc(Fe.span);Fe.encode({instruction:3,rewardReopenTime:x(o.openTime),rewardEndTime:x(o.endTime),rewardPerSecond:x(o.perSecond)},a);let s=[i({pubkey:v,isWritable:!1}),i({pubkey:n.id}),i({pubkey:n.lpVault,isWritable:!1}),i({pubkey:t}),i({pubkey:e}),i({pubkey:r,isWritable:!1,isSigner:!0})];return new K({programId:n.programId,keys:s,data:a})}function Bc({payer:r,userRewardTokenPub:t,farmKeys:e,rewardVault:n,rewardInfo:o}){let a=Buffer.alloc(_e.span);_e.encode({instruction:4,isSet:new Pe(1),rewardPerSecond:x(o.perSecond),rewardOpenTime:x(o.openTime),rewardEndTime:x(o.endTime),rewardType:x($[o.rewardType])},a);let s=[...We,i({pubkey:e.id}),i({pubkey:e.authority,isWritable:!1}),i({pubkey:o.mint,isWritable:!1}),i({pubkey:n}),i({pubkey:t}),i({pubkey:r,isWritable:!1,isSigner:!0})];return new K({programId:e.programId,keys:s,data:a})}function Rc(r){let{farmInfo:t,farmKeys:e,version:n,lpAccount:o,rewardAccounts:a,owner:s,instruction:c,amount:m,deposit:l}=r,[b,y]=[new g(t.programId),new g(t.id)],d=W({programId:b,poolId:y,owner:s,version:n}),p=Buffer.alloc(_.span);_.encode({instruction:c,amount:m},p);let S=n===6?[i({pubkey:v,isWritable:!1}),...l?[i({pubkey:Z.programId,isWritable:!1})]:[],i({pubkey:y}),i({pubkey:new g(e.authority),isWritable:!1}),i({pubkey:new g(e.lpVault)}),i({pubkey:d}),i({pubkey:s,isWritable:!1,isSigner:!0}),i({pubkey:o})]:[i({pubkey:y}),i({pubkey:new g(e.authority),isWritable:!1}),i({pubkey:d}),i({pubkey:s,isWritable:!1,isSigner:!0}),i({pubkey:o}),i({pubkey:new g(e.lpVault)}),i({pubkey:a[0]}),i({pubkey:new g(e.rewardInfos[0].vault)}),i({pubkey:re,isWritable:!1}),i({pubkey:v,isWritable:!1})];if(n===5)for(let L=1;L<e.rewardInfos.length;L++)S.push(i({pubkey:a[L]})),S.push(i({pubkey:new g(e.rewardInfos[L].vault)}));if(n===6)for(let L=0;L<e.rewardInfos.length;L++)S.push(i({pubkey:new g(e.rewardInfos[L].vault)})),S.push(i({pubkey:a[L]}));return new K({programId:b,keys:S,data:p})}function Cc(r){let{farmInfo:t,farmKeys:e,lpAccount:n,rewardAccounts:o,owner:a,amount:s}=r,[c,m]=[new g(t.programId),new g(t.id)],l=W({programId:c,poolId:m,owner:a,version:6}),b=Buffer.alloc(_.span);_.encode({instruction:2,amount:x(s)},b);let y=[i({pubkey:v,isWritable:!1}),i({pubkey:m}),i({pubkey:new g(e.authority),isWritable:!1}),i({pubkey:new g(e.lpVault)}),i({pubkey:l}),i({pubkey:a,isWritable:!1,isSigner:!0}),i({pubkey:n})];for(let d=0;d<e.rewardInfos.length;d++)y.push(i({pubkey:new g(e.rewardInfos[d].vault)})),y.push(i({pubkey:o[d]}));return new K({programId:c,keys:y,data:b})}function Kc(r){let{farmInfo:t,farmKeys:e,lpAccount:n,rewardAccounts:o,owner:a,amount:s,userAuxiliaryLedgers:c}=r,[m,l]=[new g(t.programId),new g(t.id)],b=W({programId:m,poolId:l,owner:a,version:5}),y=Buffer.alloc(_.span);_.encode({instruction:12,amount:x(s)},y);let d=[i({pubkey:l}),i({pubkey:new g(e.authority),isWritable:!1}),i({pubkey:b}),i({pubkey:a,isWritable:!1,isSigner:!0}),i({pubkey:n}),i({pubkey:new g(e.lpVault)}),i({pubkey:o[0]}),i({pubkey:new g(e.rewardInfos[0].vault)}),i({pubkey:re,isWritable:!1}),i({pubkey:v,isWritable:!1})];for(let p=1;p<e.rewardInfos.length;p++)d.push(i({pubkey:o[p]})),d.push(i({pubkey:new g(e.rewardInfos[p].vault)}));if(c)for(let p of c)d.push(i({pubkey:p}));return new K({programId:m,keys:d,data:y})}function Vc(r){let{farmInfo:t,farmKeys:e,lpAccount:n,rewardAccounts:o,owner:a,amount:s,userAuxiliaryLedgers:c}=r,[m,l]=[new g(t.programId),new g(t.id)],b=P([k("instruction"),u("amount")]),y=[i({pubkey:l}),i({pubkey:new g(e.authority),isWritable:!1}),i({pubkey:c[0]}),i({pubkey:a,isSigner:!0,isWritable:!1}),i({pubkey:n}),i({pubkey:new g(e.lpVault)}),i({pubkey:o[0]}),i({pubkey:new g(e.rewardInfos[0].vault)}),i({pubkey:re,isWritable:!1}),i({pubkey:v,isWritable:!1}),i({pubkey:o[1]}),i({pubkey:new g(e.rewardInfos[1].vault)})],d=Buffer.alloc(b.span);return b.encode({instruction:2,amount:s},d),new K({keys:y,programId:m,data:d})}function Fc(r){let{farmInfo:t,farmKeys:e,lpAccount:n,rewardAccounts:o,owner:a,amount:s,userAuxiliaryLedgers:c}=r,[m,l]=[new g(t.programId),new g(t.id)],b=W({programId:m,poolId:l,owner:a,version:3}),y=Buffer.alloc(_.span);_.encode({instruction:11,amount:x(s)},y);let d=[i({pubkey:l}),i({pubkey:new g(e.authority),isWritable:!1}),i({pubkey:b}),i({pubkey:a,isWritable:!1,isSigner:!0}),i({pubkey:n}),i({pubkey:new g(e.lpVault)}),i({pubkey:o[0]}),i({pubkey:new g(e.rewardInfos[0].vault)}),i({pubkey:re,isWritable:!1}),i({pubkey:v,isWritable:!1})];if(c)for(let p of c)d.push(i({pubkey:p}));return new K({programId:m,keys:d,data:y})}function _c(r){let{farmInfo:t,farmKeys:e,lpAccount:n,rewardAccounts:o,owner:a,amount:s,userAuxiliaryLedgers:c}=r,[m,l]=[new g(t.programId),new g(t.id)],b=W({programId:m,poolId:l,owner:a,version:3}),y=Buffer.alloc(_.span);_.encode({instruction:10,amount:x(s)},y);let d=[i({pubkey:l}),i({pubkey:new g(e.authority),isWritable:!1}),i({pubkey:b}),i({pubkey:a,isWritable:!1,isSigner:!0}),i({pubkey:n}),i({pubkey:new g(e.lpVault)}),i({pubkey:o[0]}),i({pubkey:new g(e.rewardInfos[0].vault)}),i({pubkey:re,isWritable:!1}),i({pubkey:v,isWritable:!1})];if(c)for(let p of c)d.push(i({pubkey:p}));return new K({programId:m,keys:d,data:y})}function Mc(r){let{farmInfo:t,farmKeys:e,lpAccount:n,rewardAccounts:o,owner:a,amount:s,userAuxiliaryLedgers:c}=r,[m,l]=[new g(t.programId),new g(t.id)],b=W({programId:m,poolId:l,owner:a,version:5}),y=Buffer.alloc(_.span);_.encode({instruction:11,amount:x(s)},y);let d=[i({pubkey:l}),i({pubkey:new g(e.authority),isWritable:!1}),i({pubkey:b}),i({pubkey:a,isWritable:!1,isSigner:!0}),i({pubkey:n}),i({pubkey:new g(e.lpVault)}),i({pubkey:o[0]}),i({pubkey:new g(e.rewardInfos[0].vault)}),i({pubkey:re,isWritable:!1}),i({pubkey:v,isWritable:!1})];for(let p=1;p<e.rewardInfos.length;p++)d.push(i({pubkey:o[p]})),d.push(i({pubkey:new g(e.rewardInfos[p].vault)}));if(c)for(let p of c)d.push(i({pubkey:p}));return new K({programId:m,keys:d,data:y})}function Dc(r){let{farmInfo:t,farmKeys:e,lpAccount:n,rewardAccounts:o,owner:a,amount:s}=r,[c,m]=[new g(t.programId),new g(t.id)],l=W({programId:c,poolId:m,owner:a,version:6}),b=Buffer.alloc(_.span);_.encode({instruction:1,amount:x(s)},b);let y=[i({pubkey:v,isWritable:!1}),i({pubkey:Z.programId,isWritable:!1}),i({pubkey:m}),i({pubkey:new g(e.authority),isWritable:!1}),i({pubkey:new g(e.lpVault)}),i({pubkey:l}),i({pubkey:a,isWritable:!1,isSigner:!0}),i({pubkey:n})];for(let d=0;d<e.rewardInfos.length;d++)y.push(i({pubkey:new g(e.rewardInfos[d].vault)})),y.push(i({pubkey:o[d]}));return new K({programId:c,keys:y,data:b})}export{Oo as DEV_FARM_LOCK_MINT,Uo as DEV_FARM_LOCK_VAULT,Eo as FARM_LOCK_MINT,Wo as FARM_LOCK_VAULT,jo as FARM_PROGRAM_TO_VERSION,bt as FARM_VERSION_TO_LEDGER_LAYOUT,gt as FARM_VERSION_TO_STATE_LAYOUT,kt as Voter,dr as VoterDepositEntry,lr as VoterLockup,St as VoterRegistrar,cr as VoterVotingMintConfig,Ce as associatedLedgerAccountLayout,rc as calFarmRewardAmount,Pc as createAssociatedLedgerAccountInstruction,_ as dwLayout,_e as farmAddRewardLayout,Qo as farmLedgerLayoutV3_1,se as farmLedgerLayoutV3_2,$o as farmLedgerLayoutV5_1,xt as farmLedgerLayoutV5_2,Pt as farmLedgerLayoutV6_1,tc as farmRewardInfoToConfig,Ve as farmRewardLayout,Fe as farmRewardRestartLayout,ur as farmRewardTimeInfoLayout,ht as farmStateV3Layout,wt as farmStateV5Layout,Tt as farmStateV6Layout,nc as fetchMultipleFarmInfoAndUpdate,ec as getAssociatedAuthority,W as getAssociatedLedgerAccount,$u as getAssociatedLedgerPoolAccount,Ye as getDepositEntryIndex,Nr as getFarmLedgerLayout,vr as getFarmStateLayout,Xe as getRegistrarAddress,et as getTokenOwnerRecordAddress,Qe as getVoterAddress,$e as getVoterWeightRecordAddress,Je as getVotingMintAuthority,Ze as getVotingTokenMint,zr as governanceCreateTokenOwnerRecord,Go as isValidFarmVersion,oc as judgeFarmType,Bc as makeAddNewRewardInstruction,Sc as makeCreateFarmInstruction,kc as makeCreatorWithdrawFarmRewardInstruction,_c as makeDepositInstructionV3,Mc as makeDepositInstructionV5,Dc as makeDepositInstructionV6,Ac as makeDepositTokenInstruction,Rc as makeDepositWithdrawInstruction,Lc as makeRestartRewardInstruction,Fc as makeWithdrawInstructionV3,Vc as makeWithdrawInstructionV4,Kc as makeWithdrawInstructionV5,Cc as makeWithdrawInstructionV6,Ic as makeWithdrawTokenInstruction,$ as poolTypeV6,ir as realFarmStateV3Layout,sr as realFarmStateV5Layout,ar as realFarmV6Layout,Er as updateFarmPoolInfo,qo as validateFarmRewards,Xr as voterStakeRegistryCreateDepositEntry,Yr as voterStakeRegistryCreateVoter,qr as voterStakeRegistryDeposit,jr as voterStakeRegistryUpdateVoterWeightRecord,Hr as voterStakeRegistryWithdraw,Ke as withdrawRewardLayout};
//# sourceMappingURL=index.mjs.map