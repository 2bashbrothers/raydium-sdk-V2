var kt=Object.defineProperty,It=Object.defineProperties;var Ct=Object.getOwnPropertyDescriptors;var Ie=Object.getOwnPropertySymbols;var nt=Object.prototype.hasOwnProperty,rt=Object.prototype.propertyIsEnumerable;var tt=(r,e,t)=>e in r?kt(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,V=(r,e)=>{for(var t in e||(e={}))nt.call(e,t)&&tt(r,t,e[t]);if(Ie)for(var t of Ie(e))rt.call(e,t)&&tt(r,t,e[t]);return r},Y=(r,e)=>It(r,Ct(e));var de=(r,e)=>{var t={};for(var n in r)nt.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&Ie)for(var n of Ie(r))e.indexOf(n)<0&&rt.call(r,n)&&(t[n]=r[n]);return t};import{PublicKey as un,Transaction as et,TransactionInstruction as cn}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as ln}from"@solana/spl-token";import Lt from"bn.js";import{PublicKey as Nt}from"@solana/web3.js";import{get as ot,set as Rt}from"lodash";var Fe=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:0,this.name=e.name}set level(e){this.logLevel=e}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let t=e.map(n=>typeof n=="object"?JSON.stringify(n):n).join(", ");throw new Error(t)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},it={},Dt={};function U(r){let e=ot(it,r);if(!e){let t=ot(Dt,r);e=new Fe({name:r,logLevel:t}),Rt(it,r,e)}return e}import{MINT_SIZE as Pn,TOKEN_PROGRAM_ID as wn,getTransferFeeConfig as An,unpackMint as Sn}from"@solana/spl-token";var Ke=U("Raydium_accountInfo_util");async function Ce(r,e,t){let{batchRequest:n,commitment:l="confirmed",chunkCount:p=100}=V({batchRequest:!1},t),f=Ve(e,p),o=new Array(f.length).fill([]);if(n){let S=f.map(b=>{let x=r._buildArgs([b.map(w=>w.toBase58())],l,"base64");return{methodName:"getMultipleAccounts",args:x}}),P=Ve(S,10);o=(await(await Promise.all(P.map(async b=>await r._rpcBatchRequest(b)))).flat()).map(b=>(b.error&&Ke.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${b.error.message}`),b.result.value.map(x=>{if(x){let{data:w,executable:m,lamports:h,owner:a,rentEpoch:L}=x;return w.length!==2&&w[1]!=="base64"&&Ke.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(w[0],"base64"),executable:m,lamports:h,owner:new Nt(a),rentEpoch:L}}return null})))}else try{o=await Promise.all(f.map(S=>r.getMultipleAccountsInfo(S,l)))}catch(S){S instanceof Error&&Ke.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${S.message}`)}return o.flat()}import Q from"bn.js";import yo from"decimal.js";import vt from"big.js";import Un from"bn.js";import Mt from"toformat";var Ot=Mt,fe=Ot;import De from"big.js";import _t from"bn.js";import Ft from"decimal.js-light";import ge from"bn.js";var st=9007199254740991;function Z(r){let e=U("Raydium_parseBigNumberish");if(r instanceof ge)return r;if(typeof r=="string"){if(r.match(/^-?[0-9]+$/))return new ge(r);e.logWithError(`invalid BigNumberish string: ${r}`)}return typeof r=="number"?(r%1&&e.logWithError(`BigNumberish number underflow: ${r}`),(r>=st||r<=-st)&&e.logWithError(`BigNumberish number overflow: ${r}`),new ge(String(r))):typeof r=="bigint"?new ge(r.toString()):(e.error(`invalid BigNumberish value: ${r}`),new ge(0))}var Re=U("module/fraction"),We=fe(De),he=fe(Ft),Kt={[0]:he.ROUND_DOWN,[1]:he.ROUND_HALF_UP,[2]:he.ROUND_UP},Vt={[0]:De.roundDown,[1]:De.roundHalfUp,[2]:De.roundUp},E=class{constructor(e,t=new _t(1)){this.numerator=Z(e),this.denominator=Z(t)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new E(this.denominator,this.numerator)}add(e){let t=e instanceof E?e:new E(Z(e));return this.denominator.eq(t.denominator)?new E(this.numerator.add(t.numerator),this.denominator):new E(this.numerator.mul(t.denominator).add(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}sub(e){let t=e instanceof E?e:new E(Z(e));return this.denominator.eq(t.denominator)?new E(this.numerator.sub(t.numerator),this.denominator):new E(this.numerator.mul(t.denominator).sub(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}mul(e){let t=e instanceof E?e:new E(Z(e));return new E(this.numerator.mul(t.numerator),this.denominator.mul(t.denominator))}div(e){let t=e instanceof E?e:new E(Z(e));return new E(this.numerator.mul(t.denominator),this.denominator.mul(t.numerator))}toSignificant(e,t={groupSeparator:""},n=1){Number.isInteger(e)||Re.logWithError(`${e} is not an integer.`),e<=0&&Re.logWithError(`${e} is not positive.`),he.set({precision:e+1,rounding:Kt[n]});let l=new he(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return l.toFormat(l.decimalPlaces(),t)}toFixed(e,t={groupSeparator:""},n=1){return Number.isInteger(e)||Re.logWithError(`${e} is not an integer.`),e<0&&Re.logWithError(`${e} is negative.`),We.DP=e,We.RM=Vt[n]||1,new We(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,t)}isZero(){return this.numerator.isZero()}};var Zn=U("Raydium_amount"),Qn=fe(vt);import{PublicKey as Ut}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as at}from"@solana/spl-token";var ut={chainId:101,address:Ut.default.toBase58(),programId:at.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},re={chainId:101,address:"So11111111111111111111111111111111111111112",programId:at.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};import{PublicKey as qe}from"@solana/web3.js";import{PublicKey as _,SystemProgram as ct,SYSVAR_RENT_PUBKEY as qt}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Gt}from"@solana/spl-token";function Ue({pubkey:r,isSigner:e=!1,isWritable:t=!0}){return{pubkey:r,isWritable:t,isSigner:e}}var sr=[Ue({pubkey:Gt,isWritable:!1}),Ue({pubkey:ct.programId,isWritable:!1}),Ue({pubkey:qt,isWritable:!1})];function lt({publicKey:r,transformSol:e}){let t=mt(r.toString());if(t instanceof _)return e&&t.equals(ye)?ve:t;if(e&&t.toString()===ye.toBase58())return ve;if(typeof t=="string"){if(t===_.default.toBase58())return _.default;try{return new _(t)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function mt(r){try{return new _(r)}catch{return r}}var ar=new _("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),ur=new _("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),cr=new _("SysvarRent111111111111111111111111111111111"),lr=new _("SysvarC1ock11111111111111111111111111111111"),mr=new _("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),pr=new _("Sysvar1nstructions1111111111111111111111111"),dr=ct.programId,fr=new _("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),gr=new _("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),hr=new _("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),yr=new _("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),br=new _("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),Tr=new _("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),xr=new _("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),Pr=new _("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),wr=new _("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),Ar=new _("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),Sr=new _("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),ve=new _("So11111111111111111111111111111111111111112"),ye=_.default;var Ge=class{constructor({mint:e,decimals:t,symbol:n,name:l,skipMint:p=!1,isToken2022:f=!1}){if(e===ye.toBase58()||e instanceof qe&&ye.equals(e)){this.decimals=re.decimals,this.symbol=re.symbol,this.name=re.name,this.mint=new qe(re.address),this.isToken2022=!1;return}this.decimals=t,this.symbol=n||e.toString().substring(0,6),this.name=l||e.toString().substring(0,6),this.mint=p?qe.default:lt({publicKey:e}),this.isToken2022=f}equals(e){return this===e?!0:this.mint.equals(e.mint)}},H=Ge;H.WSOL=new Ge(Y(V({},re),{mint:re.address}));var He=class{constructor({decimals:e,symbol:t="UNKNOWN",name:n="UNKNOWN"}){this.decimals=e,this.symbol=t,this.name=n}equals(e){return this===e}},Ne=He;Ne.SOL=new He(ut);import Ht from"bn.js";var _r=new E(new Ht(100));var Ur=U("Raydium_price");import{PublicKey as io}from"@solana/web3.js";import ao from"bn.js";var jt=new Q(0),ko=new Q(1),Io=new Q(2),Co=new Q(3),Ro=new Q(5),Wt=new Q(10),Do=new Q(100),No=new Q(1e3),Mo=new Q(1e4);function Ve(r,e=1,t=[]){let n=[...r];if(e<=0)return t;for(;n.length;)t.push(n.splice(0,e));return t}var j=class{constructor(e){this._owner=e}get publicKey(){return j.isKeyPair(this._owner)?this._owner.publicKey:this._owner}get signer(){return j.isKeyPair(this._owner)?this._owner:void 0}get isKeyPair(){return j.isKeyPair(this._owner)}get isPublicKey(){return j.isPublicKey(this._owner)}static isKeyPair(e){return e.secretKey!==void 0}static isPublicKey(e){return!j.isKeyPair(e)}};import{PublicKey as Yo}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Qo}from"@solana/spl-token";import{ComputeBudgetProgram as gt,Keypair as yt,PublicKey as zt,Transaction as bt,TransactionMessage as Jt,VersionedTransaction as Tt}from"@solana/web3.js";var be={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",ClmmLockPosition:"ClmmLockPosition",ClmmHarvestLockPosition:"ClmmHarvestLockPosition",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV4Withdraw:"FarmV4Withdraw",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut",CpmmLockLp:"CpmmLockLp",CpmmCollectLockFee:"CpmmCollectLockFee",TransferTip:"TransferTip"};import{TOKEN_PROGRAM_ID as Xt}from"@solana/spl-token";var ht=U("Raydium_txUtil"),xt=1644;function Te(r){let e=[],t=[];return r.microLamports&&(e.push(gt.setComputeUnitPrice({microLamports:r.microLamports})),t.push(be.SetComputeUnitPrice)),r.units&&(e.push(gt.setComputeUnitLimit({units:r.units})),t.push(be.SetComputeUnitLimit)),{instructions:e,instructionTypes:t}}async function oe(r,e){var n,l;let t=e!=null?e:"confirmed";return(l=await((n=r.getLatestBlockhash)==null?void 0:n.call(r,{commitment:t})))==null?void 0:l.blockhash}async function xe(r,e){return r.getSignatureStatuses([e]),new Promise((t,n)=>{let l=setTimeout(n,6e4);r.onSignature(e,p=>{if(clearTimeout(l),!p.err){t("");return}n(Object.assign(p.err,{txId:e}))},"confirmed")})}function je(r,e){r.length<1&&ht.logWithError(`no instructions provided: ${r.toString()}`),e.length<1&&ht.logWithError(`no signers provided:, ${e.toString()}`);let t=new bt;t.recentBlockhash="11111111111111111111111111111111",t.feePayer=e[0],t.add(...r);try{return Buffer.from(t.serialize({verifySignatures:!1})).toString("base64").length<xt}catch{return!1}}function Me(r,e){let[t,n]=zt.findProgramAddressSync(r,e);return{publicKey:t,nonce:n}}function Pe({instructions:r,payer:e,signers:t}){return je(r,[e,...t])}function $({instructions:r,payer:e,lookupTableAddressAccount:t,recentBlockhash:n=yt.generate().publicKey.toString()}){let p=new Jt({payerKey:e,recentBlockhash:n,instructions:r}).compileToV0Message(Object.values(t!=null?t:{}));try{return Buffer.from(new Tt(p).serialize()).toString("base64").length<xt}catch{return!1}}var Yt=r=>Buffer.isBuffer(r)?r:r instanceof Uint8Array?Buffer.from(r.buffer,r.byteOffset,r.byteLength):Buffer.from(r),Zt=r=>{let e=r.serialize({requireAllSignatures:!1,verifySignatures:!1});r instanceof Tt&&(e=Yt(e));try{return e instanceof Buffer?e.toString("base64"):Buffer.from(e).toString("base64")}catch{return e.toString("base64")}};function ne(r){let e=[];return r.forEach(t=>{t instanceof bt&&(t.recentBlockhash||(t.recentBlockhash=Xt.toBase58()),t.feePayer||(t.feePayer=yt.generate().publicKey)),e.push(Zt(t))}),console.log("simulate tx string:",e),e}import{PublicKey as g}from"@solana/web3.js";var ni=new g("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),ri=new g("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),oi=new g("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),ii=new g("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),si=new g("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),ai=new g("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),ui=new g("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),ci=new g("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),li=new g("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),mi=new g("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),pi=new g("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),di=new g("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),fi=new g("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),gi=new g("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),hi=new g("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),yi=new g("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),bi=new g("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),Ti=new g("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),xi=new g("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),Pi=new g("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),wi=new g("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),Ai=new g("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),Si=new g("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),Bi=new g("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),Li=new g("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),ki=new g("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),Ii=new g("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),Ci=new g("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),Ri=new g("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),Di=new g("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),Ni=new g("6s1xP3hpbAfFoNtUNF8mfHsjr2Bd97JxFJRWLbL6aHuX");var Mi={OPEN_BOOK_PROGRAM:new g("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),SERUM_PROGRAM_ID_V3:new g("Ray1111111111111111111111111111111111111111"),AMM_V4:new g("DRaya7Kj3aMWQSy19kSjvmuwq9docCHofyP9kanQGaav"),AMM_STABLE:new g("DRayDdXc1NZQ9C3hRWmoSf8zK4iapgMnjdNZWrfwsP8m"),CLMM_PROGRAM_ID:new g("DRayAUgENGQBKVaX8owNhgzkEDyoHTGVEGHVJT1E9pfH"),CLMM_LOCK_PROGRAM_ID:new g("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),CLMM_LOCK_AUTH_ID:new g("6Aoh8h2Lw2m5UGxYR8AdAL87jTWYeKoxM52mJRzfYwN"),CREATE_CPMM_POOL_PROGRAM:new g("DRaycpLY18LhpbydsBWbVJtxpNv9oXPgjRSfpF2bWpYb"),CREATE_CPMM_POOL_AUTH:new g("CXniRufdq5xL8t8jZAPxsPZDpuudwuJSPWnbcD5Y5Nxq"),CREATE_CPMM_POOL_FEE_ACC:new g("3oE58BKVt8KuYkGxx8zBojugnymWmBiyafWgMrnb6eYy"),LOCK_CPMM_PROGRAM:new g("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),LOCK_CPMM_AUTH:new g("7qWVV8UY2bRJfDLP4s37YzBPKUkVB46DStYJBpYbQzu3"),UTIL1216:g.default,Router:new g("DRaybByLpbUL57LJARs3j8BitTxVfzBg351EaMr5UTCd"),FARM_PROGRAM_ID_V3:new g("DRayWyrLmEW5KEeqs8kdTMMaBabapqagaBC7KWpGtJeZ"),FARM_PROGRAM_ID_V4:new g("Ray1111111111111111111111111111111111111111"),FARM_PROGRAM_ID_V5:new g("DRayiCGSZgku1GTK6rXD6mVDdingXy6APAH1R6R5L2LC"),FARM_PROGRAM_ID_V6:new g("DRayzbYakXs45ELHkzH6vC3fuhQqTAnv5A68gdFuvZyZ"),LAUNCHPAD_PROGRAM:new g("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),LAUNCHPAD_AUTH:new g("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),LAUNCHPAD_PLATFORM:new g("2Jx4KTDrVSdWNazuGpcA8n3ZLTRGGBDxAWhuKe2Xcj2a"),LAUNCHPAD_CONFIG:new g("7ZR4zD7PYfY2XxoG1Gxcy2EgEeGYrpxrwzPuwdUBssEt"),FEE_DESTINATION_ID:new g("9y8ENuuZ3b19quffx9hQvRVygG5ky6snHfRvGpuSfeJy"),MODEL_DATA_PUBKEY:new g("Ray1111111111111111111111111111111111111111")};import _i from"bn.js";import{PublicKey as ze,AddressLookupTableAccount as ue}from"@solana/web3.js";async function Oe({connection:r,address:e,cluster:t="mainnet"}){let n=await Ce(r,[...new Set(e.map(p=>p.toString()))].map(p=>new ze(p))),l={};for(let p=0;p<e.length;p++){let f=n[p],o=e[p];if(!f)continue;let S=new ue({key:o,state:ue.deserialize(f.data)});l[o.toString()]=S,t==="devnet"?ae[o.toString()]=S:we[o.toString()]=S}return l}var we={AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU:new ue({key:new ze("AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU"),state:ue.deserialize(Buffer.from("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","base64"))})},ae={},Ee=async r=>{let e="EFhMuDw1PKEuckuFRW9PavNfTH4LKP5uKHgyXDmWpFCq";if(ae[e])return ae;let t=new ze(e),n=await r.getAccountInfo(t);return n&&(ae[e]=new ue({key:t,state:ue.deserialize(n.data)})),ae};import{PublicKey as ie,sendAndConfirmTransaction as Je,SystemProgram as Qt,Transaction as Ae,TransactionMessage as ee,VersionedTransaction as te}from"@solana/web3.js";import $t from"axios";var Se=2e3,Be=class{constructor(e){this.instructions=[];this.endInstructions=[];this.lookupTableAddress=[];this.signers=[];this.instructionTypes=[];this.endInstructionTypes=[];this.connection=e.connection,this.feePayer=e.feePayer,this.signAllTransactions=e.signAllTransactions,this.owner=e.owner,this.cluster=e.cluster,this.blockhashCommitment=e.blockhashCommitment,this.loopMultiTxStatus=!!e.loopMultiTxStatus}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers,instructionTypes:this.instructionTypes,endInstructionTypes:this.endInstructionTypes,lookupTableAddress:this.lookupTableAddress}}get allInstructions(){return[...this.instructions,...this.endInstructions]}async getComputeBudgetConfig(){var n;let e=(await $t.get(`https://solanacompass.com/api/fees?cacheFreshTime=${3e5}`)).data,{avg:t}=(n=e==null?void 0:e[15])!=null?n:{};if(!!t)return{units:6e5,microLamports:Math.min(Math.ceil(t*1e6/6e5),25e3)}}addCustomComputeBudget(e){if(e){let{instructions:t,instructionTypes:n}=Te(e);return this.instructions.unshift(...t),this.instructionTypes.unshift(...n),!0}return!1}addTipInstruction(e){var t;return e?(this.endInstructions.push(Qt.transfer({fromPubkey:(t=e.feePayer)!=null?t:this.feePayer,toPubkey:new ie(e.address),lamports:BigInt(e.amount.toString())})),this.endInstructionTypes.push(be.TransferTip),!0):!1}async calComputeBudget({config:e,defaultIns:t}){try{let n=e||await this.getComputeBudgetConfig();if(this.addCustomComputeBudget(n))return;t&&this.instructions.unshift(...t)}catch{t&&this.instructions.unshift(...t)}}addInstruction({instructions:e=[],endInstructions:t=[],signers:n=[],instructionTypes:l=[],endInstructionTypes:p=[],lookupTableAddress:f=[]}){return this.instructions.push(...e),this.endInstructions.push(...t),this.signers.push(...n),this.instructionTypes.push(...l),this.endInstructionTypes.push(...p),this.lookupTableAddress.push(...f.filter(o=>o!==ie.default.toString())),this}async versionBuild({txVersion:e,extInfo:t}){return e===0?await this.buildV0(V({},t||{})):this.build(t)}build(e){var n;let t=new Ae;return this.allInstructions.length&&t.add(...this.allInstructions),t.feePayer=this.feePayer,((n=this.owner)==null?void 0:n.signer)&&!this.signers.some(l=>l.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer),{builder:this,transaction:t,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async l=>{var d;let{recentBlockHash:p,skipPreflight:f=!0,sendAndConfirm:o,notSendToRpc:S}=l||{},P=p!=null?p:await oe(this.connection,this.blockhashCommitment);if(t.recentBlockhash=P,this.signers.length&&t.sign(...this.signers),ne([t]),(d=this.owner)!=null&&d.isKeyPair)return{txId:o?await Je(this.connection,t,this.signers.find(x=>x.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:f}):await this.connection.sendRawTransaction(t.serialize(),{skipPreflight:f}),signedTx:t};if(this.signAllTransactions){let b=await this.signAllTransactions([t]);if(this.signers.length)for(let x of b)try{x.sign(...this.signers)}catch{}return{txId:S?"":await this.connection.sendRawTransaction(b[0].serialize(),{skipPreflight:f}),signedTx:b[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:e||{}}}buildMultiTx(e){var P;let{extraPreBuildData:t=[],extInfo:n}=e,{transaction:l}=this.build(n),p=t.filter(d=>d.transaction.instructions.length>0),f=[l,...p.map(d=>d.transaction)],o=[this.signers,...p.map(d=>d.signers)],S=[...this.instructionTypes,...p.map(d=>d.instructionTypes).flat()];return(P=this.owner)!=null&&P.signer&&o.forEach(d=>{d.some(b=>b.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),{builder:this,transactions:f,signers:o,instructionTypes:S,execute:async d=>{var L;let{sequentially:b,onTxUpdate:x,skipTxCount:w=0,recentBlockHash:m,skipPreflight:h=!0}=d||{},a=m!=null?m:await oe(this.connection,this.blockhashCommitment);if((L=this.owner)!=null&&L.isKeyPair){if(b){let T=[],C=0;for(let u of f){if(++C,C<=w)continue;let i=await Je(this.connection,u,this.signers.find(s=>s.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:h});T.push(i)}return{txIds:T,signedTxs:f}}return{txIds:await await Promise.all(f.map(async T=>(T.recentBlockhash=a,await this.connection.sendRawTransaction(T.serialize(),{skipPreflight:h})))),signedTxs:f}}if(this.signAllTransactions){let T=f.map((u,i)=>(u.recentBlockhash=a,o[i].length&&u.sign(...o[i]),u));ne(T);let C=await this.signAllTransactions(T);if(b){let u=0,i=[],s=async()=>{if(!C[u])return;let y=await this.connection.sendRawTransaction(C[u].serialize(),{skipPreflight:h});i.push({txId:y,status:"sent",signedTx:C[u]}),x==null||x([...i]),u++;let c=!1,B=null,M=null,R=A=>{B!==null&&clearInterval(B),M!==null&&this.connection.removeSignatureListener(M);let k=i.findIndex(I=>I.txId===y);if(k>-1){if(i[k].status==="error"||i[k].status==="success")return;i[k].status=A.err?"error":"success"}x==null||x([...i]),A.err||s()};this.loopMultiTxStatus&&(B=setInterval(async()=>{var A;if(c){clearInterval(B);return}try{let k=await this.connection.getTransaction(y,{commitment:"confirmed",maxSupportedTransactionVersion:0});k&&(c=!0,clearInterval(B),R({err:((A=k.meta)==null?void 0:A.err)||null}),console.log("tx status from getTransaction:",y))}catch(k){c=!0,clearInterval(B),console.error("getTransaction timeout:",k,y)}},Se)),M=this.connection.onSignature(y,A=>{if(c){this.connection.removeSignatureListener(M);return}c=!0,R(A)},"confirmed"),this.connection.getSignatureStatus(y)};return await s(),{txIds:i.map(y=>y.txId),signedTxs:C}}else{let u=[];for(let i=0;i<C.length;i+=1){let s=await this.connection.sendRawTransaction(C[i].serialize(),{skipPreflight:h});u.push(s)}return{txIds:u,signedTxs:C}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:n||{}}}async versionMultiBuild({extraPreBuildData:e,txVersion:t,extInfo:n}){return t===0?await this.buildV0MultiTx({extraPreBuildData:e,buildProps:n||{}}):this.buildMultiTx({extraPreBuildData:e,extInfo:n})}async buildV0(e){var h;let m=e||{},{lookupTableCache:t={},lookupTableAddress:n=[],forerunCreate:l,recentBlockhash:p}=m,f=de(m,["lookupTableCache","lookupTableAddress","forerunCreate","recentBlockhash"]),o=V(V({},this.cluster==="devnet"?await Ee(this.connection):we),t),S=Array.from(new Set([...n,...this.lookupTableAddress])),P=[];for(let a of S)o[a]===void 0&&P.push(new ie(a));let d=await Oe({connection:this.connection,address:P});for(let[a,L]of Object.entries(d))o[a]=L;let b=l?ie.default.toBase58():p!=null?p:await oe(this.connection,this.blockhashCommitment),x=new ee({payerKey:this.feePayer,recentBlockhash:b,instructions:[...this.allInstructions]}).compileToV0Message(Object.values(o));((h=this.owner)==null?void 0:h.signer)&&!this.signers.some(a=>a.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer);let w=new te(x);return w.sign(this.signers),{builder:this,transaction:w,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async a=>{var u;let{skipPreflight:L=!0,sendAndConfirm:T,notSendToRpc:C}=a||{};if(ne([w]),(u=this.owner)!=null&&u.isKeyPair){let i=await this.connection.sendTransaction(w,{skipPreflight:L});return T&&await xe(this.connection,i),{txId:i,signedTx:w}}if(this.signAllTransactions){let i=await this.signAllTransactions([w]);if(this.signers.length)for(let s of i)try{s.sign(this.signers)}catch{}return{txId:C?"":await this.connection.sendTransaction(i[0],{skipPreflight:L}),signedTx:i[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:f||{}}}async buildV0MultiTx(e){var P;let{extraPreBuildData:t=[],buildProps:n}=e,{transaction:l}=await this.buildV0(n),p=t.filter(d=>d.builder.instructions.length>0),f=[l,...p.map(d=>d.transaction)],o=[this.signers,...p.map(d=>d.signers)],S=[...this.instructionTypes,...p.map(d=>d.instructionTypes).flat()];return(P=this.owner)!=null&&P.signer&&o.forEach(d=>{d.some(b=>b.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),f.forEach(async(d,b)=>{d.sign(o[b])}),{builder:this,transactions:f,signers:o,instructionTypes:S,buildProps:n,execute:async d=>{var h;let{sequentially:b,onTxUpdate:x,recentBlockHash:w,skipPreflight:m=!0}=d||{};if(w&&f.forEach(a=>a.message.recentBlockhash=w),ne(f),(h=this.owner)!=null&&h.isKeyPair){if(b){let a=[];for(let L of f){let T=await this.connection.sendTransaction(L,{skipPreflight:m});await xe(this.connection,T),a.push(T)}return{txIds:a,signedTxs:f}}return{txIds:await Promise.all(f.map(async a=>await this.connection.sendTransaction(a,{skipPreflight:m}))),signedTxs:f}}if(this.signAllTransactions){let a=await this.signAllTransactions(f);if(b){let L=0,T=[],C=async()=>{if(!a[L])return;let u=await this.connection.sendTransaction(a[L],{skipPreflight:m});T.push({txId:u,status:"sent",signedTx:a[L]}),x==null||x([...T]),L++;let i=!1,s=null,y=null,c=B=>{s!==null&&clearInterval(s),y!==null&&this.connection.removeSignatureListener(y);let M=T.findIndex(R=>R.txId===u);if(M>-1){if(T[M].status==="error"||T[M].status==="success")return;T[M].status=B.err?"error":"success"}x==null||x([...T]),B.err||C()};this.loopMultiTxStatus&&(s=setInterval(async()=>{var B;if(i){clearInterval(s);return}try{let M=await this.connection.getTransaction(u,{commitment:"confirmed",maxSupportedTransactionVersion:0});M&&(i=!0,clearInterval(s),c({err:((B=M.meta)==null?void 0:B.err)||null}),console.log("tx status from getTransaction:",u))}catch(M){i=!0,clearInterval(s),console.error("getTransaction timeout:",M,u)}},Se)),y=this.connection.onSignature(u,B=>{if(i){this.connection.removeSignatureListener(y);return}i=!0,c(B)},"confirmed"),this.connection.getSignatureStatus(u)};return C(),{txIds:[],signedTxs:a}}else{let L=[];for(let T=0;T<a.length;T+=1){let C=await this.connection.sendTransaction(a[T],{skipPreflight:m});L.push(C)}return{txIds:L,signedTxs:a}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:n||{}}}async sizeCheckBuild(e){var x;let b=e||{},{splitIns:t=[],computeBudgetConfig:n}=b,l=de(b,["splitIns","computeBudgetConfig"]),p=n?Te(n):{instructions:[],instructionTypes:[]},f=this.signers.reduce((w,m)=>Y(V({},w),{[m.publicKey.toBase58()]:m}),{}),o=[],S=[],P=[],d=0;if(this.allInstructions.forEach(w=>{let m=[...P,w],h=n?[...p.instructions,...m]:m,L=[...new Set(m.map(T=>T.keys.filter(C=>C.isSigner).map(C=>C.pubkey.toString())).flat()).values()].map(T=>new ie(T));if(w!==t[d]&&P.length<12&&(Pe({instructions:h,payer:this.feePayer,signers:L})||Pe({instructions:m,payer:this.feePayer,signers:L})))P.push(w);else{if(P.length===0)throw Error("item ins too big");d+=w===t[d]?1:0,Pe({instructions:n?[...p.instructions,...P]:[...P],payer:this.feePayer,signers:L})?o.push(new Ae().add(...p.instructions,...P)):o.push(new Ae().add(...P)),S.push(Array.from(new Set(P.map(T=>T.keys.filter(C=>C.isSigner).map(C=>C.pubkey.toString())).flat())).map(T=>f[T]).filter(T=>T!==void 0)),P=[w]}}),P.length>0){let m=[...new Set(P.map(h=>h.keys.filter(a=>a.isSigner).map(a=>a.pubkey.toString())).flat()).values()].map(h=>f[h]).filter(h=>h!==void 0);Pe({instructions:n?[...p.instructions,...P]:[...P],payer:this.feePayer,signers:m.map(h=>h.publicKey)})?o.push(new Ae().add(...p.instructions,...P)):o.push(new Ae().add(...P)),S.push(m)}return o.forEach(w=>w.feePayer=this.feePayer),(x=this.owner)!=null&&x.signer&&S.forEach(w=>{w.some(m=>m.publicKey.equals(this.owner.publicKey))||w.push(this.owner.signer)}),{builder:this,transactions:o,signers:S,instructionTypes:this.instructionTypes,execute:async w=>{var u;let{sequentially:m,onTxUpdate:h,skipTxCount:a=0,recentBlockHash:L,skipPreflight:T=!0}=w||{},C=L!=null?L:await oe(this.connection,this.blockhashCommitment);if(o.forEach(async(i,s)=>{i.recentBlockhash=C,S[s].length&&i.sign(...S[s])}),ne(o),(u=this.owner)!=null&&u.isKeyPair){if(m){let i=0,s=[];for(let y of o){if(++i,i<=a){s.push("tx skipped");continue}let c=await Je(this.connection,y,this.signers.find(B=>B.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:T});s.push(c)}return{txIds:s,signedTxs:o}}return{txIds:await Promise.all(o.map(async i=>await this.connection.sendRawTransaction(i.serialize(),{skipPreflight:T}))),signedTxs:o}}if(this.signAllTransactions){let i=await this.signAllTransactions(o.slice(a,o.length)),s=[...o.slice(0,a),...i];if(m){let y=0,c=[],B=async()=>{if(!s[y])return;y<a&&(c.push({txId:"",status:"success",signedTx:s[y]}),h==null||h([...c]),y++,B());let M=await this.connection.sendRawTransaction(s[y].serialize(),{skipPreflight:T});c.push({txId:M,status:"sent",signedTx:s[y]}),h==null||h([...c]),y++;let R=!1,A=null,k=null,I=F=>{A!==null&&clearInterval(A),k!==null&&this.connection.removeSignatureListener(k);let O=c.findIndex(q=>q.txId===M);if(O>-1){if(c[O].status==="error"||c[O].status==="success")return;c[O].status=F.err?"error":"success"}h==null||h([...c]),F.err||B()};this.loopMultiTxStatus&&(A=setInterval(async()=>{var F;if(R){clearInterval(A);return}try{let O=await this.connection.getTransaction(M,{commitment:"confirmed",maxSupportedTransactionVersion:0});O&&(R=!0,clearInterval(A),I({err:((F=O.meta)==null?void 0:F.err)||null}),console.log("tx status from getTransaction:",M))}catch(O){R=!0,clearInterval(A),console.error("getTransaction timeout:",O,M)}},Se)),k=this.connection.onSignature(M,F=>{if(R){this.connection.removeSignatureListener(k);return}R=!0,I(F)},"confirmed"),this.connection.getSignatureStatus(M)};return await B(),{txIds:c.map(M=>M.txId),signedTxs:s}}else{let y=[];for(let c=0;c<s.length;c+=1){let B=await this.connection.sendRawTransaction(s[c].serialize(),{skipPreflight:T});y.push(B)}return{txIds:y,signedTxs:s}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:l||{}}}async sizeCheckBuildV0(e){var C;let T=e||{},{computeBudgetConfig:t,splitIns:n=[],lookupTableCache:l={},lookupTableAddress:p=[]}=T,f=de(T,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),o=V(V({},this.cluster==="devnet"?await Ee(this.connection):we),l),S=Array.from(new Set([...this.lookupTableAddress,...p])),P=[];for(let u of S)o[u]===void 0&&P.push(new ie(u));let d=await Oe({connection:this.connection,address:P});for(let[u,i]of Object.entries(d))o[u]=i;let b=t?Te(t):{instructions:[],instructionTypes:[]},x=await oe(this.connection,this.blockhashCommitment),w=this.signers.reduce((u,i)=>Y(V({},u),{[i.publicKey.toBase58()]:i}),{}),m=[],h=[],a=[],L=0;if(this.allInstructions.forEach(u=>{let i=[...a,u],s=t?[...b.instructions,...i]:i;if(u!==n[L]&&a.length<12&&($({instructions:s,payer:this.feePayer,lookupTableAddressAccount:o})||$({instructions:i,payer:this.feePayer,lookupTableAddressAccount:o})))a.push(u);else{if(a.length===0)throw Error("item ins too big");L+=u===n[L]?1:0;let y={};for(let c of[...new Set(S)])o[c]!==void 0&&(y[c]=o[c]);if(t&&$({instructions:[...b.instructions,...a],payer:this.feePayer,lookupTableAddressAccount:o,recentBlockhash:x})){let c=new ee({payerKey:this.feePayer,recentBlockhash:x,instructions:[...b.instructions,...a]}).compileToV0Message(Object.values(o));m.push(new te(c))}else{let c=new ee({payerKey:this.feePayer,recentBlockhash:x,instructions:[...a]}).compileToV0Message(Object.values(o));m.push(new te(c))}h.push(Array.from(new Set(a.map(c=>c.keys.filter(B=>B.isSigner).map(B=>B.pubkey.toString())).flat())).map(c=>w[c]).filter(c=>c!==void 0)),a=[u]}}),a.length>0){let i=[...new Set(a.map(s=>s.keys.filter(y=>y.isSigner).map(y=>y.pubkey.toString())).flat()).values()].map(s=>w[s]).filter(s=>s!==void 0);if(t&&$({instructions:[...b.instructions,...a],payer:this.feePayer,lookupTableAddressAccount:o,recentBlockhash:x})){let s=new ee({payerKey:this.feePayer,recentBlockhash:x,instructions:[...b.instructions,...a]}).compileToV0Message(Object.values(o));m.push(new te(s))}else{let s=new ee({payerKey:this.feePayer,recentBlockhash:x,instructions:[...a]}).compileToV0Message(Object.values(o));m.push(new te(s))}h.push(i)}return(C=this.owner)!=null&&C.signer&&h.forEach(u=>{u.some(i=>i.publicKey.equals(this.owner.publicKey))||u.push(this.owner.signer)}),m.forEach((u,i)=>{u.sign(h[i])}),{builder:this,transactions:m,buildProps:e,signers:h,instructionTypes:this.instructionTypes,execute:async u=>{var M;let{sequentially:i,onTxUpdate:s,skipTxCount:y=0,recentBlockHash:c,skipPreflight:B=!0}=u||{};if(m.map(async(R,A)=>{h[A].length&&R.sign(h[A]),c&&(R.message.recentBlockhash=c)}),ne(m),(M=this.owner)!=null&&M.isKeyPair){if(i){let R=0,A=[];for(let k of m){if(++R,R<=y){console.log("skip tx: ",R),A.push("tx skipped");continue}let I=await this.connection.sendTransaction(k,{skipPreflight:B});await xe(this.connection,I),A.push(I)}return{txIds:A,signedTxs:m}}return{txIds:await Promise.all(m.map(async R=>await this.connection.sendTransaction(R,{skipPreflight:B}))),signedTxs:m}}if(this.signAllTransactions){let R=await this.signAllTransactions(m.slice(y,m.length)),A=[...m.slice(0,y),...R];if(i){let k=0,I=[],F=async()=>{if(!A[k])return;if(k<y){I.push({txId:"",status:"success",signedTx:A[k]}),s==null||s([...I]),k++,F();return}let O=await this.connection.sendTransaction(A[k],{skipPreflight:B});I.push({txId:O,status:"sent",signedTx:A[k]}),s==null||s([...I]),k++;let q=!1,G=null,X=null,pe=W=>{G!==null&&clearInterval(G),X!==null&&this.connection.removeSignatureListener(X);let K=I.findIndex(_e=>_e.txId===O);if(K>-1){if(I[K].status==="error"||I[K].status==="success")return;I[K].status=W.err?"error":"success"}s==null||s([...I]),W.err||F()};this.loopMultiTxStatus&&(G=setInterval(async()=>{var W;if(q){clearInterval(G);return}try{let K=await this.connection.getTransaction(O,{commitment:"confirmed",maxSupportedTransactionVersion:0});K&&(q=!0,clearInterval(G),pe({err:((W=K.meta)==null?void 0:W.err)||null}),console.log("tx status from getTransaction:",O))}catch(K){q=!0,clearInterval(G),console.error("getTransaction timeout:",K,O)}},Se)),X=this.connection.onSignature(O,W=>{if(q){this.connection.removeSignatureListener(X);return}q=!0,pe(W)},"confirmed"),this.connection.getSignatureStatus(O)};return F(),{txIds:[],signedTxs:A}}else{let k=[];for(let I=0;I<A.length;I+=1){let F=await this.connection.sendTransaction(A[I],{skipPreflight:B});k.push(F)}return{txIds:k,signedTxs:A}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:f||{}}}async buildSniperTransaction(e){var C;let T=e||{},{computeBudgetConfig:t,splitIns:n=[],lookupTableCache:l={},lookupTableAddress:p=[]}=T,f=de(T,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),o=V(V({},this.cluster==="devnet"?await Ee(this.connection):we),l),S=Array.from(new Set([...this.lookupTableAddress,...p])),P=[];for(let u of S)o[u]===void 0&&P.push(new ie(u));let d=await Oe({connection:this.connection,address:P});for(let[u,i]of Object.entries(d))o[u]=i;let b=t?Te(t):{instructions:[],instructionTypes:[]},x=await oe(this.connection,this.blockhashCommitment),w=this.signers.reduce((u,i)=>Y(V({},u),{[i.publicKey.toBase58()]:i}),{}),m=[],h=[],a=[],L=0;if(this.allInstructions.forEach(u=>{let i=[...a,u],s=t?[...b.instructions,...i]:i;if(u!==n[L]&&a.length<12&&($({instructions:s,payer:this.feePayer,lookupTableAddressAccount:o})||$({instructions:i,payer:this.feePayer,lookupTableAddressAccount:o})))a.push(u);else{if(a.length===0)throw Error("item ins too big");L+=u===n[L]?1:0;let y={};for(let c of[...new Set(S)])o[c]!==void 0&&(y[c]=o[c]);if(t&&$({instructions:[...b.instructions,...a],payer:this.feePayer,lookupTableAddressAccount:o,recentBlockhash:x})){let c=new ee({payerKey:this.feePayer,recentBlockhash:x,instructions:[...b.instructions,...a]}).compileToV0Message(Object.values(o));m.push(new te(c))}else{let c=new ee({payerKey:this.feePayer,recentBlockhash:x,instructions:[...a]}).compileToV0Message(Object.values(o));m.push(new te(c))}h.push(Array.from(new Set(a.map(c=>c.keys.filter(B=>B.isSigner).map(B=>B.pubkey.toString())).flat())).map(c=>w[c]).filter(c=>c!==void 0)),a=[u]}}),a.length>0){let i=[...new Set(a.map(s=>s.keys.filter(y=>y.isSigner).map(y=>y.pubkey.toString())).flat()).values()].map(s=>w[s]).filter(s=>s!==void 0);if(t&&$({instructions:[...b.instructions,...a],payer:this.feePayer,lookupTableAddressAccount:o,recentBlockhash:x})){let s=new ee({payerKey:this.feePayer,recentBlockhash:x,instructions:[...b.instructions,...a]}).compileToV0Message(Object.values(o));m.push(new te(s))}else{let s=new ee({payerKey:this.feePayer,recentBlockhash:x,instructions:[...a]}).compileToV0Message(Object.values(o));m.push(new te(s))}h.push(i)}return(C=this.owner)!=null&&C.signer&&h.forEach(u=>{u.some(i=>i.publicKey.equals(this.owner.publicKey))||u.push(this.owner.signer)}),m.forEach((u,i)=>{u.sign(h[i])}),{builder:this,transactions:m,buildProps:e,signers:h,instructionTypes:this.instructionTypes,execute:async u=>{var M;let{sequentially:i,onTxUpdate:s,skipTxCount:y=0,recentBlockHash:c,skipPreflight:B=!0}=u||{};if(m.map(async(R,A)=>{h[A].length&&R.sign(h[A]),c&&(R.message.recentBlockhash=c)}),ne(m),(M=this.owner)!=null&&M.isKeyPair){if(i){let R=0,A=[];for(let k of m){if(++R,R<=y){console.log("skip tx: ",R),A.push("tx skipped");continue}let I=await this.connection.sendTransaction(k,{skipPreflight:B});await xe(this.connection,I),A.push(I)}return{txIds:A,signedTxs:m}}return{txIds:await Promise.all(m.map(async R=>await this.connection.sendTransaction(R,{skipPreflight:B}))),signedTxs:m}}if(this.signAllTransactions){let R=await this.signAllTransactions(m.slice(y,m.length)),A=[...m.slice(0,y),...R];if(i){let k=0,I=[],F=async()=>{if(!A[k])return;if(k<y){I.push({txId:"",status:"success",signedTx:A[k]}),s==null||s([...I]),k++,F();return}let O=await this.connection.sendTransaction(A[k],{skipPreflight:B});I.push({txId:O,status:"sent",signedTx:A[k]}),s==null||s([...I]),k++;let q=!1,G=null,X=null,pe=W=>{G!==null&&clearInterval(G),X!==null&&this.connection.removeSignatureListener(X);let K=I.findIndex(_e=>_e.txId===O);if(K>-1){if(I[K].status==="error"||I[K].status==="success")return;I[K].status=W.err?"error":"success"}s==null||s([...I]),W.err||F()};this.loopMultiTxStatus&&(G=setInterval(async()=>{var W;if(q){clearInterval(G);return}try{let K=await this.connection.getTransaction(O,{commitment:"confirmed",maxSupportedTransactionVersion:0});K&&(q=!0,clearInterval(G),pe({err:((W=K.meta)==null?void 0:W.err)||null}),console.log("tx status from getTransaction:",O))}catch(K){q=!0,clearInterval(G),console.error("getTransaction timeout:",K,O)}},Se)),X=this.connection.onSignature(O,W=>{if(q){this.connection.removeSignatureListener(X);return}q=!0,pe(W)},"confirmed"),this.connection.getSignatureStatus(O)};return F(),{txIds:[],signedTxs:A}}else{let k=[];for(let I=0;I<A.length;I+=1){let F=await this.connection.sendTransaction(A[I],{skipPreflight:B});k.push(F)}return{txIds:k,signedTxs:A}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:f||{}}}};import en from"bn.js";var ns=new en(1e6);import{PublicKey as an}from"@solana/web3.js";import St,{isBN as Bt}from"bn.js";import{bits as Ss,BitStructure as Bs,blob as tn,Blob as Ls,cstr as ks,f32 as Is,f32be as Cs,f64 as Rs,f64be as Ds,greedy as Ns,Layout as nn,ns64 as Ms,ns64be as Os,nu64 as Es,nu64be as _s,offset as Fs,s16 as Ks,s16be as Vs,s24 as vs,s24be as Ws,s32 as Us,s32be as qs,s40 as Gs,s40be as Hs,s48 as js,s48be as zs,s8 as Js,seq as rn,struct as Xs,Structure as on,u16 as Ys,u16be as Zs,u24 as Qs,u24be as $s,u32 as ea,u32be as ta,u40 as na,u40be as ra,u48 as oa,u48be as ia,u8 as sa,UInt as sn,union as aa,Union as ua,unionLayoutDiscriminator as ca,utf8 as la}from"@solana/buffer-layout";var Xe=nn,Pt=on;var wt=sn;var At=rn;var ce=tn;var Ye=class extends Xe{constructor(t,n,l){super(t,l);this.blob=ce(t),this.signed=n}decode(t,n=0){let l=new St(this.blob.decode(t,n),10,"le");return this.signed?l.fromTwos(this.span*8).clone():l}encode(t,n,l=0){return typeof t=="number"&&(t=new St(t)),this.signed&&(t=t.toTwos(this.span*8)),this.blob.encode(t.toArrayLike(Buffer,"le",this.span),n,l)}};function le(r){return new wt(1,r)}function z(r){return new Ye(8,!1,r)}var Ze=class extends Xe{constructor(t,n,l,p){super(t.span,p);this.layout=t,this.decoder=n,this.encoder=l}decode(t,n){return this.decoder(this.layout.decode(t,n))}encode(t,n,l){return this.layout.encode(this.encoder(t),n,l)}getSpan(t,n){return this.layout.getSpan(t,n)}};function se(r){return new Ze(ce(32),e=>new an(e),e=>e.toBuffer(),r)}var Qe=class extends Pt{decode(e,t){return super.decode(e,t)}};function me(r,e,t){return new Qe(r,e,t)}function Le(r,e,t){let n,l=typeof e=="number"?e:Bt(e)?e.toNumber():new Proxy(e,{get(p,f){if(!n){let o=Reflect.get(p,"count");n=Bt(o)?o.toNumber():o,Reflect.set(p,"count",n)}return Reflect.get(p,f)},set(p,f,o){return f==="count"&&(n=o),Reflect.set(p,f,o)}});return At(r,l,t)}var $e=(...r)=>r.map(e=>{try{return typeof e=="object"?JSON.stringify(e):e}catch{return e}}).join(", "),ke=class{constructor({scope:e,moduleName:t}){this.disabled=!1;this.scope=e,this.logger=U(t)}createTxBuilder(e){return this.scope.checkOwner(),new Be({connection:this.scope.connection,feePayer:e||this.scope.ownerPubKey,cluster:this.scope.cluster,owner:this.scope.owner,blockhashCommitment:this.scope.blockhashCommitment,loopMultiTxStatus:this.scope.loopMultiTxStatus,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}createSniperTxBuilder(e,t){let n=new j(e);return new Be({connection:this.scope.connection,feePayer:t,cluster:this.scope.cluster,owner:n,blockhashCommitment:this.scope.blockhashCommitment,loopMultiTxStatus:this.scope.loopMultiTxStatus,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}logDebug(...e){this.logger.debug($e(e))}logInfo(...e){this.logger.info($e(e))}logAndCreateError(...e){let t=$e(e);throw new Error(t)}checkDisabled(){(this.disabled||!this.scope)&&this.logAndCreateError("module not working")}};var v=class extends ke{static getPdaPoolId(e,t){return Me([v.SEED_CONFIG.pool.id,t.toBuffer()],e)}static getPdaOwnerId(e,t,n,l){return Me([v.SEED_CONFIG.owner.id,t.toBuffer(),n.toBuffer(),Buffer.from(new Lt(l).toArray())],e)}static async getAllInfo({connection:e,programId:t,poolIds:n,wallet:l,chainTime:p}){if(n.length===0)return[];let f=n.map(d=>v.getPdaPoolId(t,d).publicKey),o=[];for(let d=0;d<v.VERSION_PROJECT.length;d++)o.push(...f.map(b=>v.getPdaOwnerId(t,b,l,d).publicKey));let S=await Ce(e,[...f,...o]),P=[];for(let d=0;d<S.length;d++){let b=Math.floor(d/n.length),x=d%n.length,w=f[x],m=o[d],h=S[x],a=S[n.length+d];if(!(h&&a)||h.data.length!==v.POOL_LAYOUT.span||a.data.length!==v.OWNER_LAYOUT.span)continue;let L=v.POOL_LAYOUT.decode(h.data),T=v.OWNER_LAYOUT.decode(a.data),C=L.openTime.toNumber(),u=L.endTime.toNumber(),i=T.tokenInfo.map(c=>c.debtAmount.gt(new Lt(0))).filter(c=>!c).length!==3,s=p>C&&p<u&&L.status===1,y=i&&s;P.push({programId:t,poolId:w,ammId:L.ammId,ownerAccountId:m,snapshotLpAmount:T.lpAmount,project:v.VERSION_PROJECT[b],openTime:C,endTime:u,canClaim:y,canClaimErrorType:i?s?void 0:"outOfOperationalTime":"alreadyClaimIt",tokenInfo:L.tokenInfo.map((c,B)=>({mintAddress:c.mintAddress,mintVault:c.mintVault,mintDecimals:c.mintDecimals,perLpLoss:c.perLpLoss,debtAmount:T.tokenInfo[B].debtAmount.add(T.tokenInfo[B].claimedAmount)}))})}return P}async makeClaimTransaction({poolInfo:e,ownerInfo:t,feePayer:n}){t.wallet||this.scope.checkOwner();let l=this.createTxBuilder(n),p=t.wallet||this.scope.ownerPubKey,f=[];for(let P of e.tokenInfo){let{account:d,instructionParams:b}=await this.scope.account.getOrCreateTokenAccount({mint:P.mintAddress,owner:this.scope.ownerPubKey,notUseTokenAccount:P.mintAddress.equals(H.WSOL.mint),createInfo:{payer:p,amount:0},skipCloseAccount:!P.mintAddress.equals(H.WSOL.mint),associatedOnly:P.mintAddress.equals(H.WSOL.mint)?!1:t.associatedOnly});b&&l.addInstruction(b),f.push(d)}l.addInstruction({instructions:[v.makeClaimInstruction({programId:e.programId,poolInfo:e,ownerInfo:{wallet:p,ownerPda:e.ownerAccountId,claimAddress:f}})]});let{transaction:o,signers:S}=l.build();return[{transaction:o,signer:S}]}async makeClaimAllTransaction({poolInfos:e,ownerInfo:t,feePayer:n}){let l=this.createTxBuilder(n),p=t.wallet||this.scope.ownerPubKey,f={};for(let d of e){let b=[];for(let x of d.tokenInfo){let{account:w,instructionParams:m}=await this.scope.account.getOrCreateTokenAccount({mint:x.mintAddress,owner:this.scope.ownerPubKey,notUseTokenAccount:x.mintAddress.equals(H.WSOL.mint),createInfo:{payer:p,amount:0},skipCloseAccount:!x.mintAddress.equals(H.WSOL.mint),associatedOnly:x.mintAddress.equals(H.WSOL.mint)?!1:t.associatedOnly});m&&l.addInstruction(m),w&&(f[x.mintAddress.toString()]=w,b.push(w))}l.addInstruction({instructions:[v.makeClaimInstruction({programId:d.programId,poolInfo:d,ownerInfo:{wallet:p,ownerPda:d.ownerAccountId,claimAddress:b}})]})}let{transaction:o,signers:S}=l.build(),P=l.allInstructions;return je(P,[p,...S.map(d=>d.publicKey)])?[{transaction:o,signer:S}]:[{transaction:new et().add(...P.slice(0,l.AllTxData.instructions.length-1)),signer:S},{transaction:new et().add(...P.slice(l.AllTxData.instructions.length-1)),signer:[]},{transaction:new et().add(...l.AllTxData.endInstructions),signer:[]}]}static makeClaimInstruction({programId:e,poolInfo:t,ownerInfo:n}){let l=me([]),p=[{pubkey:n.wallet,isSigner:!0,isWritable:!0},{pubkey:t.poolId,isSigner:!1,isWritable:!0},{pubkey:n.ownerPda,isSigner:!1,isWritable:!0},...n.claimAddress.map(S=>({pubkey:S,isSigner:!1,isWritable:!0})),...t.tokenInfo.map(({mintVault:S})=>({pubkey:S,isSigner:!1,isWritable:!0})),{pubkey:ln,isSigner:!1,isWritable:!1}],f=Buffer.alloc(l.span);l.encode({},f);let o=Buffer.from([10,66,208,184,161,6,191,98,...f]);return new cn({keys:p,programId:e,data:o})}},J=v;J.CLAIMED_NUM=3,J.POOL_LAYOUT=me([ce(8),le("bump"),le("status"),z("openTime"),z("endTime"),se("ammId"),Le(me([le("mintDecimals"),se("mintAddress"),se("mintVault"),z("perLpLoss"),z("totalClaimedAmount")]),v.CLAIMED_NUM,"tokenInfo"),Le(z(),10,"padding")]),J.OWNER_LAYOUT=me([ce(8),le("bump"),le("version"),se("poolId"),se("owner"),z("lpAmount"),Le(me([se("mintAddress"),z("debtAmount"),z("claimedAmount")]),v.CLAIMED_NUM,"tokenInfo"),Le(z(),4,"padding")]),J.DEFAULT_POOL_ID=["58oQChx4yWmvKdwLLZzBi4ChoCc2fqCUWBkwMihLYQo2","6UmmUiYoBjSrhakAobJw8BvkmJtDVxaeBtbt7rxWo1mg","AVs9TA4nWDzfPJE9gGVNJMVhcQy3V9PGazuz33BfG2RA","DVa7Qmb5ct9RCpaU7UTpSaf3GVMYz17vNVU67XpdCRut","7XawhbbxtsRcQA8KTkHT9f9nc6d69UwqCDh6U5EEbEmX","6a1CsrpeZubDjEJE9s1CMVheB6HWM5d7m1cj2jkhyXhj","EoNrn8iUhwgJySD1pHu8Qxm5gSQqLK3za4m8xzD2RuEb","AceAyRTWt4PyB2pHqf2qhDgNZDtKVNaxgL8Ru3V4aN1P","6tmFJbMk5yVHFcFy7X2K8RwHjKLr6KVFLYXpgpBNeAxB"].map(e=>new un(e)),J.SEED_CONFIG={pool:{id:Buffer.from("pool_seed","utf8")},owner:{id:Buffer.from("user_claim_seed","utf8")}},J.VERSION_PROJECT=[void 0,"Francium","Tulip","Larix"];export{J as default};
//# sourceMappingURL=index.mjs.map