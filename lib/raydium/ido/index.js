var vt=Object.create;var le=Object.defineProperty,Wt=Object.defineProperties,Ut=Object.getOwnPropertyDescriptor,qt=Object.getOwnPropertyDescriptors,Gt=Object.getOwnPropertyNames,Ie=Object.getOwnPropertySymbols,jt=Object.getPrototypeOf,ve=Object.prototype.hasOwnProperty,ut=Object.prototype.propertyIsEnumerable;var at=(n,e,t)=>e in n?le(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,F=(n,e)=>{for(var t in e||(e={}))ve.call(e,t)&&at(n,t,e[t]);if(Ie)for(var t of Ie(e))ut.call(e,t)&&at(n,t,e[t]);return n},G=(n,e)=>Wt(n,qt(e));var ke=(n,e)=>{var t={};for(var r in n)ve.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&Ie)for(var r of Ie(n))e.indexOf(r)<0&&ut.call(n,r)&&(t[r]=n[r]);return t};var Ht=(n,e)=>{for(var t in e)le(n,t,{get:e[t],enumerable:!0})},ct=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of Gt(e))!ve.call(n,o)&&o!==t&&le(n,o,{get:()=>e[o],enumerable:!(r=Ut(e,o))||r.enumerable});return n};var V=(n,e,t)=>(t=n!=null?vt(jt(n)):{},ct(e||!n||!n.__esModule?le(t,"default",{value:n,enumerable:!0}):t,n)),zt=n=>ct(le({},"__esModule",{value:!0}),n);var bn={};Ht(bn,{claimLayout:()=>ae,default:()=>Ae,makeClaimInstruction:()=>we,makeClaimInstructionV4:()=>Ve,makePurchaseInstruction:()=>yn,purchaseLayout:()=>Fe});module.exports=zt(bn);var ce=require("@solana/web3.js"),it=V(require("bn.js"));var l=require("@solana/web3.js"),xn=new l.PublicKey("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),Pn=new l.PublicKey("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),wn=new l.PublicKey("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),An=new l.PublicKey("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),Sn=new l.PublicKey("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),In=new l.PublicKey("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),kn=new l.PublicKey("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),Bn=new l.PublicKey("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),Ln=new l.PublicKey("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),Cn=new l.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Rn=new l.PublicKey("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),Dn=new l.PublicKey("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),Mn=new l.PublicKey("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),Nn=new l.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),_n=new l.PublicKey("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),En=new l.PublicKey("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),Zt=new l.PublicKey("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),Jt=new l.PublicKey("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),Qt=new l.PublicKey("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),Xt=new l.PublicKey("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),On=new l.PublicKey("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),Fn=new l.PublicKey("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),Kn=new l.PublicKey("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),Vn=new l.PublicKey("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),vn=new l.PublicKey("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),Wn=new l.PublicKey("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),Un=new l.PublicKey("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),qn=new l.PublicKey("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),Gn=new l.PublicKey("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),jn=new l.PublicKey("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),Hn=new l.PublicKey("6s1xP3hpbAfFoNtUNF8mfHsjr2Bd97JxFJRWLbL6aHuX"),me={IDO_PROGRAM_ID_V1:Zt,IDO_PROGRAM_ID_V2:Jt,IDO_PROGRAM_ID_V3:Qt,IDO_PROGRAM_ID_V4:Xt};var zn={OPEN_BOOK_PROGRAM:new l.PublicKey("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),SERUM_PROGRAM_ID_V3:new l.PublicKey("Ray1111111111111111111111111111111111111111"),AMM_V4:new l.PublicKey("DRaya7Kj3aMWQSy19kSjvmuwq9docCHofyP9kanQGaav"),AMM_STABLE:new l.PublicKey("DRayDdXc1NZQ9C3hRWmoSf8zK4iapgMnjdNZWrfwsP8m"),CLMM_PROGRAM_ID:new l.PublicKey("DRayAUgENGQBKVaX8owNhgzkEDyoHTGVEGHVJT1E9pfH"),CLMM_LOCK_PROGRAM_ID:new l.PublicKey("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),CLMM_LOCK_AUTH_ID:new l.PublicKey("6Aoh8h2Lw2m5UGxYR8AdAL87jTWYeKoxM52mJRzfYwN"),CREATE_CPMM_POOL_PROGRAM:new l.PublicKey("DRaycpLY18LhpbydsBWbVJtxpNv9oXPgjRSfpF2bWpYb"),CREATE_CPMM_POOL_AUTH:new l.PublicKey("CXniRufdq5xL8t8jZAPxsPZDpuudwuJSPWnbcD5Y5Nxq"),CREATE_CPMM_POOL_FEE_ACC:new l.PublicKey("3oE58BKVt8KuYkGxx8zBojugnymWmBiyafWgMrnb6eYy"),LOCK_CPMM_PROGRAM:new l.PublicKey("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),LOCK_CPMM_AUTH:new l.PublicKey("7qWVV8UY2bRJfDLP4s37YzBPKUkVB46DStYJBpYbQzu3"),UTIL1216:l.PublicKey.default,Router:new l.PublicKey("DRaybByLpbUL57LJARs3j8BitTxVfzBg351EaMr5UTCd"),FARM_PROGRAM_ID_V3:new l.PublicKey("DRayWyrLmEW5KEeqs8kdTMMaBabapqagaBC7KWpGtJeZ"),FARM_PROGRAM_ID_V4:new l.PublicKey("Ray1111111111111111111111111111111111111111"),FARM_PROGRAM_ID_V5:new l.PublicKey("DRayiCGSZgku1GTK6rXD6mVDdingXy6APAH1R6R5L2LC"),FARM_PROGRAM_ID_V6:new l.PublicKey("DRayzbYakXs45ELHkzH6vC3fuhQqTAnv5A68gdFuvZyZ"),LAUNCHPAD_PROGRAM:new l.PublicKey("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),LAUNCHPAD_AUTH:new l.PublicKey("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),LAUNCHPAD_PLATFORM:new l.PublicKey("2Jx4KTDrVSdWNazuGpcA8n3ZLTRGGBDxAWhuKe2Xcj2a"),LAUNCHPAD_CONFIG:new l.PublicKey("7ZR4zD7PYfY2XxoG1Gxcy2EgEeGYrpxrwzPuwdUBssEt"),FEE_DESTINATION_ID:new l.PublicKey("9y8ENuuZ3b19quffx9hQvRVygG5ky6snHfRvGpuSfeJy"),MODEL_DATA_PUBKEY:new l.PublicKey("Ray1111111111111111111111111111111111111111")};var M=require("@solana/web3.js"),lt=require("@solana/spl-token");function We({pubkey:n,isSigner:e=!1,isWritable:t=!0}){return{pubkey:n,isWritable:t,isSigner:e}}var Qn=[We({pubkey:lt.TOKEN_PROGRAM_ID,isWritable:!1}),We({pubkey:M.SystemProgram.programId,isWritable:!1}),We({pubkey:M.SYSVAR_RENT_PUBKEY,isWritable:!1})];function mt({publicKey:n,transformSol:e}){let t=Ue(n.toString());if(t instanceof M.PublicKey)return e&&t.equals(pe)?ne:t;if(e&&t.toString()===pe.toBase58())return ne;if(typeof t=="string"){if(t===M.PublicKey.default.toBase58())return M.PublicKey.default;try{return new M.PublicKey(t)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function Ue(n){try{return new M.PublicKey(n)}catch{return n}}var Xn=new M.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),Yn=new M.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),pt=new M.PublicKey("SysvarRent111111111111111111111111111111111"),qe=new M.PublicKey("SysvarC1ock11111111111111111111111111111111"),$n=new M.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),er=new M.PublicKey("Sysvar1nstructions1111111111111111111111111"),dt=M.SystemProgram.programId,tr=new M.PublicKey("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),nr=new M.PublicKey("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),rr=new M.PublicKey("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),or=new M.PublicKey("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),ir=new M.PublicKey("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),sr=new M.PublicKey("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),ar=new M.PublicKey("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),ur=new M.PublicKey("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),cr=new M.PublicKey("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),lr=new M.PublicKey("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),mr=new M.PublicKey("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),ne=new M.PublicKey("So11111111111111111111111111111111111111112"),pe=M.PublicKey.default;var Nt=require("@solana/web3.js"),_t=V(require("bn.js"));var Mt=V(require("big.js")),xe=V(require("bn.js"));var H=V(require("bn.js")),sn=V(require("decimal.js"));var ft=require("@solana/web3.js"),Ge=require("@solana/spl-token"),gt={chainId:101,address:ft.PublicKey.default.toBase58(),programId:Ge.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},Y={chainId:101,address:"So11111111111111111111111111111111111111112",programId:Ge.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};var Be=require("@solana/web3.js");var je=class{constructor({mint:e,decimals:t,symbol:r,name:o,skipMint:a=!1,isToken2022:m=!1}){if(e===pe.toBase58()||e instanceof Be.PublicKey&&pe.equals(e)){this.decimals=Y.decimals,this.symbol=Y.symbol,this.name=Y.name,this.mint=new Be.PublicKey(Y.address),this.isToken2022=!1;return}this.decimals=t,this.symbol=r||e.toString().substring(0,6),this.name=o||e.toString().substring(0,6),this.mint=a?Be.PublicKey.default:mt({publicKey:e}),this.isToken2022=m}equals(e){return this===e?!0:this.mint.equals(e.mint)}},$=je;$.WSOL=new je(G(F({},Y),{mint:Y.address}));var He=class{constructor({decimals:e,symbol:t="UNKNOWN",name:r="UNKNOWN"}){this.decimals=e,this.symbol=t,this.name=r}equals(e){return this===e}},Le=He;Le.SOL=new He(gt);var ge=V(require("big.js")),Tt=V(require("bn.js")),xt=V(require("decimal.js-light"));var de=require("lodash");var ze=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:0,this.name=e.name}set level(e){this.logLevel=e}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let t=e.map(r=>typeof r=="object"?JSON.stringify(r):r).join(", ");throw new Error(t)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},yt={},Yt={};function v(n){let e=(0,de.get)(yt,n);if(!e){let t=(0,de.get)(Yt,n);e=new ze({name:n,logLevel:t}),(0,de.set)(yt,n,e)}return e}var re=V(require("bn.js"));var ht=9007199254740991;function q(n){let e=v("Raydium_parseBigNumberish");if(n instanceof re.default)return n;if(typeof n=="string"){if(n.match(/^-?[0-9]+$/))return new re.default(n);e.logWithError(`invalid BigNumberish string: ${n}`)}return typeof n=="number"?(n%1&&e.logWithError(`BigNumberish number underflow: ${n}`),(n>=ht||n<=-ht)&&e.logWithError(`BigNumberish number overflow: ${n}`),new re.default(String(n))):typeof n=="bigint"?new re.default(n.toString()):(e.error(`invalid BigNumberish value: ${n}`),new re.default(0))}var bt=V(require("toformat")),$t=bt.default,fe=$t;var Ce=v("module/fraction"),Ze=fe(ge.default),ye=fe(xt.default),tn={[0]:ye.ROUND_DOWN,[1]:ye.ROUND_HALF_UP,[2]:ye.ROUND_UP},nn={[0]:ge.default.roundDown,[1]:ge.default.roundHalfUp,[2]:ge.default.roundUp},L=class{constructor(e,t=new Tt.default(1)){this.numerator=q(e),this.denominator=q(t)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new L(this.denominator,this.numerator)}add(e){let t=e instanceof L?e:new L(q(e));return this.denominator.eq(t.denominator)?new L(this.numerator.add(t.numerator),this.denominator):new L(this.numerator.mul(t.denominator).add(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}sub(e){let t=e instanceof L?e:new L(q(e));return this.denominator.eq(t.denominator)?new L(this.numerator.sub(t.numerator),this.denominator):new L(this.numerator.mul(t.denominator).sub(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}mul(e){let t=e instanceof L?e:new L(q(e));return new L(this.numerator.mul(t.numerator),this.denominator.mul(t.denominator))}div(e){let t=e instanceof L?e:new L(q(e));return new L(this.numerator.mul(t.denominator),this.denominator.mul(t.numerator))}toSignificant(e,t={groupSeparator:""},r=1){Number.isInteger(e)||Ce.logWithError(`${e} is not an integer.`),e<=0&&Ce.logWithError(`${e} is not positive.`),ye.set({precision:e+1,rounding:tn[r]});let o=new ye(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return o.toFormat(o.decimalPlaces(),t)}toFixed(e,t={groupSeparator:""},r=1){return Number.isInteger(e)||Ce.logWithError(`${e} is not an integer.`),e<0&&Ce.logWithError(`${e} is negative.`),Ze.DP=e,Ze.RM=nn[r]||1,new Ze(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,t)}isZero(){return this.numerator.isZero()}};var wt=V(require("bn.js"));var Pt=new L(new wt.default(100)),oe=class extends L{toSignificant(e=5,t,r){return this.mul(Pt).toSignificant(e,t,r)}toFixed(e=2,t,r){return this.mul(Pt).toFixed(e,t,r)}};var rn=v("Raydium_price"),Z=class extends L{constructor(t){let{baseToken:r,quoteToken:o,numerator:a,denominator:m}=t;super(a,m);this.baseToken=r,this.quoteToken=o,this.scalar=new L(Je(r.decimals),Je(o.decimals))}get raw(){return new L(this.numerator,this.denominator)}get adjusted(){return super.mul(this.scalar)}invert(){return new Z({baseToken:this.quoteToken,quoteToken:this.baseToken,denominator:this.numerator,numerator:this.denominator})}mul(t){this.quoteToken!==t.baseToken&&rn.logWithError("mul token not equals");let r=super.mul(t);return new Z({baseToken:this.baseToken,quoteToken:t.quoteToken,denominator:r.denominator,numerator:r.numerator})}toSignificant(t=this.quoteToken.decimals,r,o){return this.adjusted.toSignificant(t,r,o)}toFixed(t=this.quoteToken.decimals,r,o){return this.adjusted.toFixed(t,r,o)}};var on=new H.default(0),Yr=new H.default(1),$r=new H.default(2),eo=new H.default(3),to=new H.default(5),Qe=new H.default(10),no=new H.default(100),ro=new H.default(1e3),oo=new H.default(1e4);function Je(n){return Qe.pow(q(n))}var St=require("@solana/web3.js");var Re=require("@solana/spl-token"),Xe=v("Raydium_accountInfo_util");async function It(n,e,t){let{batchRequest:r,commitment:o="confirmed",chunkCount:a=100}=F({batchRequest:!1},t),m=Ye(e,a),i=new Array(m.length).fill([]);if(r){let A=m.map(x=>{let S=n._buildArgs([x.map(b=>b.toBase58())],o,"base64");return{methodName:"getMultipleAccounts",args:S}}),s=Ye(A,10);i=(await(await Promise.all(s.map(async x=>await n._rpcBatchRequest(x)))).flat()).map(x=>(x.error&&Xe.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${x.error.message}`),x.result.value.map(S=>{if(S){let{data:b,executable:f,lamports:T,owner:u,rentEpoch:k}=S;return b.length!==2&&b[1]!=="base64"&&Xe.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(b[0],"base64"),executable:f,lamports:T,owner:new St.PublicKey(u),rentEpoch:k}}return null})))}else try{i=await Promise.all(m.map(A=>n.getMultipleAccountsInfo(A,o)))}catch(A){A instanceof Error&&Xe.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${A.message}`)}return i.flat()}function Ye(n,e=1,t=[]){let r=[...n];if(e<=0)return t;for(;r.length;)t.push(r.splice(0,e));return t}var ln=require("@solana/web3.js"),mn=require("@solana/spl-token");var W=require("@solana/web3.js");var he={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",ClmmLockPosition:"ClmmLockPosition",ClmmHarvestLockPosition:"ClmmHarvestLockPosition",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV4Withdraw:"FarmV4Withdraw",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut",CpmmLockLp:"CpmmLockLp",CpmmCollectLockFee:"CpmmCollectLockFee",TransferTip:"TransferTip"};var Bt=require("@solana/spl-token"),kt=v("Raydium_txUtil"),Lt=1644;function De(n){let e=[],t=[];return n.microLamports&&(e.push(W.ComputeBudgetProgram.setComputeUnitPrice({microLamports:n.microLamports})),t.push(he.SetComputeUnitPrice)),n.units&&(e.push(W.ComputeBudgetProgram.setComputeUnitLimit({units:n.units})),t.push(he.SetComputeUnitLimit)),{instructions:e,instructionTypes:t}}async function ie(n,e){var r,o;let t=e!=null?e:"confirmed";return(o=await((r=n.getLatestBlockhash)==null?void 0:r.call(n,{commitment:t})))==null?void 0:o.blockhash}async function Me(n,e){return n.getSignatureStatuses([e]),new Promise((t,r)=>{let o=setTimeout(r,6e4);n.onSignature(e,a=>{if(clearTimeout(o),!a.err){t("");return}r(Object.assign(a.err,{txId:e}))},"confirmed")})}function an(n,e){n.length<1&&kt.logWithError(`no instructions provided: ${n.toString()}`),e.length<1&&kt.logWithError(`no signers provided:, ${e.toString()}`);let t=new W.Transaction;t.recentBlockhash="11111111111111111111111111111111",t.feePayer=e[0],t.add(...n);try{return Buffer.from(t.serialize({verifySignatures:!1})).toString("base64").length<Lt}catch{return!1}}function be({instructions:n,payer:e,signers:t}){return an(n,[e,...t])}function Te({instructions:n,payer:e,lookupTableAddressAccount:t,recentBlockhash:r=W.Keypair.generate().publicKey.toString()}){let a=new W.TransactionMessage({payerKey:e,recentBlockhash:r,instructions:n}).compileToV0Message(Object.values(t!=null?t:{}));try{return Buffer.from(new W.VersionedTransaction(a).serialize()).toString("base64").length<Lt}catch{return!1}}var un=n=>Buffer.isBuffer(n)?n:n instanceof Uint8Array?Buffer.from(n.buffer,n.byteOffset,n.byteLength):Buffer.from(n),cn=n=>{let e=n.serialize({requireAllSignatures:!1,verifySignatures:!1});n instanceof W.VersionedTransaction&&(e=un(e));try{return e instanceof Buffer?e.toString("base64"):Buffer.from(e).toString("base64")}catch{return e.toString("base64")}};function ee(n){let e=[];return n.forEach(t=>{t instanceof W.Transaction&&(t.recentBlockhash||(t.recentBlockhash=Bt.TOKEN_PROGRAM_ID.toBase58()),t.feePayer||(t.feePayer=W.Keypair.generate().publicKey)),e.push(cn(t))}),console.log("simulate tx string:",e),e}var pn=V(require("bn.js"));var j=require("@solana/web3.js");async function $e({connection:n,address:e,cluster:t="mainnet"}){let r=await It(n,[...new Set(e.map(a=>a.toString()))].map(a=>new j.PublicKey(a))),o={};for(let a=0;a<e.length;a++){let m=r[a],i=e[a];if(!m)continue;let A=new j.AddressLookupTableAccount({key:i,state:j.AddressLookupTableAccount.deserialize(m.data)});o[i.toString()]=A,t==="devnet"?se[i.toString()]=A:Ne[i.toString()]=A}return o}var Ne={AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU:new j.AddressLookupTableAccount({key:new j.PublicKey("AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU"),state:j.AddressLookupTableAccount.deserialize(Buffer.from("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","base64"))})},se={},et=async n=>{let e="EFhMuDw1PKEuckuFRW9PavNfTH4LKP5uKHgyXDmWpFCq";if(se[e])return se;let t=new j.PublicKey(e),r=await n.getAccountInfo(t);return r&&(se[e]=new j.AddressLookupTableAccount({key:t,state:j.AddressLookupTableAccount.deserialize(r.data)})),se};var C=require("@solana/web3.js"),Ct=V(require("axios"));var _e=2e3,Ee=class{constructor(e){this.instructions=[];this.endInstructions=[];this.lookupTableAddress=[];this.signers=[];this.instructionTypes=[];this.endInstructionTypes=[];this.connection=e.connection,this.feePayer=e.feePayer,this.signAllTransactions=e.signAllTransactions,this.owner=e.owner,this.cluster=e.cluster,this.blockhashCommitment=e.blockhashCommitment,this.loopMultiTxStatus=!!e.loopMultiTxStatus}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers,instructionTypes:this.instructionTypes,endInstructionTypes:this.endInstructionTypes,lookupTableAddress:this.lookupTableAddress}}get allInstructions(){return[...this.instructions,...this.endInstructions]}async getComputeBudgetConfig(){var r;let e=(await Ct.default.get(`https://solanacompass.com/api/fees?cacheFreshTime=${3e5}`)).data,{avg:t}=(r=e==null?void 0:e[15])!=null?r:{};if(!!t)return{units:6e5,microLamports:Math.min(Math.ceil(t*1e6/6e5),25e3)}}addCustomComputeBudget(e){if(e){let{instructions:t,instructionTypes:r}=De(e);return this.instructions.unshift(...t),this.instructionTypes.unshift(...r),!0}return!1}addTipInstruction(e){var t;return e?(this.endInstructions.push(C.SystemProgram.transfer({fromPubkey:(t=e.feePayer)!=null?t:this.feePayer,toPubkey:new C.PublicKey(e.address),lamports:BigInt(e.amount.toString())})),this.endInstructionTypes.push(he.TransferTip),!0):!1}async calComputeBudget({config:e,defaultIns:t}){try{let r=e||await this.getComputeBudgetConfig();if(this.addCustomComputeBudget(r))return;t&&this.instructions.unshift(...t)}catch{t&&this.instructions.unshift(...t)}}addInstruction({instructions:e=[],endInstructions:t=[],signers:r=[],instructionTypes:o=[],endInstructionTypes:a=[],lookupTableAddress:m=[]}){return this.instructions.push(...e),this.endInstructions.push(...t),this.signers.push(...r),this.instructionTypes.push(...o),this.endInstructionTypes.push(...a),this.lookupTableAddress.push(...m.filter(i=>i!==C.PublicKey.default.toString())),this}async versionBuild({txVersion:e,extInfo:t}){return e===0?await this.buildV0(F({},t||{})):this.build(t)}build(e){var r;let t=new C.Transaction;return this.allInstructions.length&&t.add(...this.allInstructions),t.feePayer=this.feePayer,((r=this.owner)==null?void 0:r.signer)&&!this.signers.some(o=>o.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer),{builder:this,transaction:t,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async o=>{var h;let{recentBlockHash:a,skipPreflight:m=!0,sendAndConfirm:i,notSendToRpc:A}=o||{},s=a!=null?a:await ie(this.connection,this.blockhashCommitment);if(t.recentBlockhash=s,this.signers.length&&t.sign(...this.signers),ee([t]),(h=this.owner)!=null&&h.isKeyPair)return{txId:i?await(0,C.sendAndConfirmTransaction)(this.connection,t,this.signers.find(S=>S.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:m}):await this.connection.sendRawTransaction(t.serialize(),{skipPreflight:m}),signedTx:t};if(this.signAllTransactions){let x=await this.signAllTransactions([t]);if(this.signers.length)for(let S of x)try{S.sign(...this.signers)}catch{}return{txId:A?"":await this.connection.sendRawTransaction(x[0].serialize(),{skipPreflight:m}),signedTx:x[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:e||{}}}buildMultiTx(e){var s;let{extraPreBuildData:t=[],extInfo:r}=e,{transaction:o}=this.build(r),a=t.filter(h=>h.transaction.instructions.length>0),m=[o,...a.map(h=>h.transaction)],i=[this.signers,...a.map(h=>h.signers)],A=[...this.instructionTypes,...a.map(h=>h.instructionTypes).flat()];return(s=this.owner)!=null&&s.signer&&i.forEach(h=>{h.some(x=>x.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),{builder:this,transactions:m,signers:i,instructionTypes:A,execute:async h=>{var k;let{sequentially:x,onTxUpdate:S,skipTxCount:b=0,recentBlockHash:f,skipPreflight:T=!0}=h||{},u=f!=null?f:await ie(this.connection,this.blockhashCommitment);if((k=this.owner)!=null&&k.isKeyPair){if(x){let y=[],R=0;for(let g of m){if(++R,R<=b)continue;let c=await(0,C.sendAndConfirmTransaction)(this.connection,g,this.signers.find(p=>p.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:T});y.push(c)}return{txIds:y,signedTxs:m}}return{txIds:await await Promise.all(m.map(async y=>(y.recentBlockhash=u,await this.connection.sendRawTransaction(y.serialize(),{skipPreflight:T})))),signedTxs:m}}if(this.signAllTransactions){let y=m.map((g,c)=>(g.recentBlockhash=u,i[c].length&&g.sign(...i[c]),g));ee(y);let R=await this.signAllTransactions(y);if(x){let g=0,c=[],p=async()=>{if(!R[g])return;let w=await this.connection.sendRawTransaction(R[g].serialize(),{skipPreflight:T});c.push({txId:w,status:"sent",signedTx:R[g]}),S==null||S([...c]),g++;let P=!1,B=null,N=null,E=D=>{B!==null&&clearInterval(B),N!==null&&this.connection.removeSignatureListener(N);let _=c.findIndex(O=>O.txId===w);if(_>-1){if(c[_].status==="error"||c[_].status==="success")return;c[_].status=D.err?"error":"success"}S==null||S([...c]),D.err||p()};this.loopMultiTxStatus&&(B=setInterval(async()=>{var D;if(P){clearInterval(B);return}try{let _=await this.connection.getTransaction(w,{commitment:"confirmed",maxSupportedTransactionVersion:0});_&&(P=!0,clearInterval(B),E({err:((D=_.meta)==null?void 0:D.err)||null}),console.log("tx status from getTransaction:",w))}catch(_){P=!0,clearInterval(B),console.error("getTransaction timeout:",_,w)}},_e)),N=this.connection.onSignature(w,D=>{if(P){this.connection.removeSignatureListener(N);return}P=!0,E(D)},"confirmed"),this.connection.getSignatureStatus(w)};return await p(),{txIds:c.map(w=>w.txId),signedTxs:R}}else{let g=[];for(let c=0;c<R.length;c+=1){let p=await this.connection.sendRawTransaction(R[c].serialize(),{skipPreflight:T});g.push(p)}return{txIds:g,signedTxs:R}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async versionMultiBuild({extraPreBuildData:e,txVersion:t,extInfo:r}){return t===0?await this.buildV0MultiTx({extraPreBuildData:e,buildProps:r||{}}):this.buildMultiTx({extraPreBuildData:e,extInfo:r})}async buildV0(e){var T;let f=e||{},{lookupTableCache:t={},lookupTableAddress:r=[],forerunCreate:o,recentBlockhash:a}=f,m=ke(f,["lookupTableCache","lookupTableAddress","forerunCreate","recentBlockhash"]),i=F(F({},this.cluster==="devnet"?await et(this.connection):Ne),t),A=Array.from(new Set([...r,...this.lookupTableAddress])),s=[];for(let u of A)i[u]===void 0&&s.push(new C.PublicKey(u));let h=await $e({connection:this.connection,address:s});for(let[u,k]of Object.entries(h))i[u]=k;let x=o?C.PublicKey.default.toBase58():a!=null?a:await ie(this.connection,this.blockhashCommitment),S=new C.TransactionMessage({payerKey:this.feePayer,recentBlockhash:x,instructions:[...this.allInstructions]}).compileToV0Message(Object.values(i));((T=this.owner)==null?void 0:T.signer)&&!this.signers.some(u=>u.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer);let b=new C.VersionedTransaction(S);return b.sign(this.signers),{builder:this,transaction:b,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async u=>{var g;let{skipPreflight:k=!0,sendAndConfirm:y,notSendToRpc:R}=u||{};if(ee([b]),(g=this.owner)!=null&&g.isKeyPair){let c=await this.connection.sendTransaction(b,{skipPreflight:k});return y&&await Me(this.connection,c),{txId:c,signedTx:b}}if(this.signAllTransactions){let c=await this.signAllTransactions([b]);if(this.signers.length)for(let p of c)try{p.sign(this.signers)}catch{}return{txId:R?"":await this.connection.sendTransaction(c[0],{skipPreflight:k}),signedTx:c[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:m||{}}}async buildV0MultiTx(e){var s;let{extraPreBuildData:t=[],buildProps:r}=e,{transaction:o}=await this.buildV0(r),a=t.filter(h=>h.builder.instructions.length>0),m=[o,...a.map(h=>h.transaction)],i=[this.signers,...a.map(h=>h.signers)],A=[...this.instructionTypes,...a.map(h=>h.instructionTypes).flat()];return(s=this.owner)!=null&&s.signer&&i.forEach(h=>{h.some(x=>x.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),m.forEach(async(h,x)=>{h.sign(i[x])}),{builder:this,transactions:m,signers:i,instructionTypes:A,buildProps:r,execute:async h=>{var T;let{sequentially:x,onTxUpdate:S,recentBlockHash:b,skipPreflight:f=!0}=h||{};if(b&&m.forEach(u=>u.message.recentBlockhash=b),ee(m),(T=this.owner)!=null&&T.isKeyPair){if(x){let u=[];for(let k of m){let y=await this.connection.sendTransaction(k,{skipPreflight:f});await Me(this.connection,y),u.push(y)}return{txIds:u,signedTxs:m}}return{txIds:await Promise.all(m.map(async u=>await this.connection.sendTransaction(u,{skipPreflight:f}))),signedTxs:m}}if(this.signAllTransactions){let u=await this.signAllTransactions(m);if(x){let k=0,y=[],R=async()=>{if(!u[k])return;let g=await this.connection.sendTransaction(u[k],{skipPreflight:f});y.push({txId:g,status:"sent",signedTx:u[k]}),S==null||S([...y]),k++;let c=!1,p=null,w=null,P=B=>{p!==null&&clearInterval(p),w!==null&&this.connection.removeSignatureListener(w);let N=y.findIndex(E=>E.txId===g);if(N>-1){if(y[N].status==="error"||y[N].status==="success")return;y[N].status=B.err?"error":"success"}S==null||S([...y]),B.err||R()};this.loopMultiTxStatus&&(p=setInterval(async()=>{var B;if(c){clearInterval(p);return}try{let N=await this.connection.getTransaction(g,{commitment:"confirmed",maxSupportedTransactionVersion:0});N&&(c=!0,clearInterval(p),P({err:((B=N.meta)==null?void 0:B.err)||null}),console.log("tx status from getTransaction:",g))}catch(N){c=!0,clearInterval(p),console.error("getTransaction timeout:",N,g)}},_e)),w=this.connection.onSignature(g,B=>{if(c){this.connection.removeSignatureListener(w);return}c=!0,P(B)},"confirmed"),this.connection.getSignatureStatus(g)};return R(),{txIds:[],signedTxs:u}}else{let k=[];for(let y=0;y<u.length;y+=1){let R=await this.connection.sendTransaction(u[y],{skipPreflight:f});k.push(R)}return{txIds:k,signedTxs:u}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async sizeCheckBuild(e){var S;let x=e||{},{splitIns:t=[],computeBudgetConfig:r}=x,o=ke(x,["splitIns","computeBudgetConfig"]),a=r?De(r):{instructions:[],instructionTypes:[]},m=this.signers.reduce((b,f)=>G(F({},b),{[f.publicKey.toBase58()]:f}),{}),i=[],A=[],s=[],h=0;if(this.allInstructions.forEach(b=>{let f=[...s,b],T=r?[...a.instructions,...f]:f,k=[...new Set(f.map(y=>y.keys.filter(R=>R.isSigner).map(R=>R.pubkey.toString())).flat()).values()].map(y=>new C.PublicKey(y));if(b!==t[h]&&s.length<12&&(be({instructions:T,payer:this.feePayer,signers:k})||be({instructions:f,payer:this.feePayer,signers:k})))s.push(b);else{if(s.length===0)throw Error("item ins too big");h+=b===t[h]?1:0,be({instructions:r?[...a.instructions,...s]:[...s],payer:this.feePayer,signers:k})?i.push(new C.Transaction().add(...a.instructions,...s)):i.push(new C.Transaction().add(...s)),A.push(Array.from(new Set(s.map(y=>y.keys.filter(R=>R.isSigner).map(R=>R.pubkey.toString())).flat())).map(y=>m[y]).filter(y=>y!==void 0)),s=[b]}}),s.length>0){let f=[...new Set(s.map(T=>T.keys.filter(u=>u.isSigner).map(u=>u.pubkey.toString())).flat()).values()].map(T=>m[T]).filter(T=>T!==void 0);be({instructions:r?[...a.instructions,...s]:[...s],payer:this.feePayer,signers:f.map(T=>T.publicKey)})?i.push(new C.Transaction().add(...a.instructions,...s)):i.push(new C.Transaction().add(...s)),A.push(f)}return i.forEach(b=>b.feePayer=this.feePayer),(S=this.owner)!=null&&S.signer&&A.forEach(b=>{b.some(f=>f.publicKey.equals(this.owner.publicKey))||b.push(this.owner.signer)}),{builder:this,transactions:i,signers:A,instructionTypes:this.instructionTypes,execute:async b=>{var g;let{sequentially:f,onTxUpdate:T,skipTxCount:u=0,recentBlockHash:k,skipPreflight:y=!0}=b||{},R=k!=null?k:await ie(this.connection,this.blockhashCommitment);if(i.forEach(async(c,p)=>{c.recentBlockhash=R,A[p].length&&c.sign(...A[p])}),ee(i),(g=this.owner)!=null&&g.isKeyPair){if(f){let c=0,p=[];for(let w of i){if(++c,c<=u){p.push("tx skipped");continue}let P=await(0,C.sendAndConfirmTransaction)(this.connection,w,this.signers.find(B=>B.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:y});p.push(P)}return{txIds:p,signedTxs:i}}return{txIds:await Promise.all(i.map(async c=>await this.connection.sendRawTransaction(c.serialize(),{skipPreflight:y}))),signedTxs:i}}if(this.signAllTransactions){let c=await this.signAllTransactions(i.slice(u,i.length)),p=[...i.slice(0,u),...c];if(f){let w=0,P=[],B=async()=>{if(!p[w])return;w<u&&(P.push({txId:"",status:"success",signedTx:p[w]}),T==null||T([...P]),w++,B());let N=await this.connection.sendRawTransaction(p[w].serialize(),{skipPreflight:y});P.push({txId:N,status:"sent",signedTx:p[w]}),T==null||T([...P]),w++;let E=!1,D=null,_=null,O=U=>{D!==null&&clearInterval(D),_!==null&&this.connection.removeSignatureListener(_);let K=P.findIndex(Q=>Q.txId===N);if(K>-1){if(P[K].status==="error"||P[K].status==="success")return;P[K].status=U.err?"error":"success"}T==null||T([...P]),U.err||B()};this.loopMultiTxStatus&&(D=setInterval(async()=>{var U;if(E){clearInterval(D);return}try{let K=await this.connection.getTransaction(N,{commitment:"confirmed",maxSupportedTransactionVersion:0});K&&(E=!0,clearInterval(D),O({err:((U=K.meta)==null?void 0:U.err)||null}),console.log("tx status from getTransaction:",N))}catch(K){E=!0,clearInterval(D),console.error("getTransaction timeout:",K,N)}},_e)),_=this.connection.onSignature(N,U=>{if(E){this.connection.removeSignatureListener(_);return}E=!0,O(U)},"confirmed"),this.connection.getSignatureStatus(N)};return await B(),{txIds:P.map(N=>N.txId),signedTxs:p}}else{let w=[];for(let P=0;P<p.length;P+=1){let B=await this.connection.sendRawTransaction(p[P].serialize(),{skipPreflight:y});w.push(B)}return{txIds:w,signedTxs:p}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:o||{}}}async sizeCheckBuildV0(e){var R;let y=e||{},{computeBudgetConfig:t,splitIns:r=[],lookupTableCache:o={},lookupTableAddress:a=[]}=y,m=ke(y,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),i=F(F({},this.cluster==="devnet"?await et(this.connection):Ne),o),A=Array.from(new Set([...this.lookupTableAddress,...a])),s=[];for(let g of A)i[g]===void 0&&s.push(new C.PublicKey(g));let h=await $e({connection:this.connection,address:s});for(let[g,c]of Object.entries(h))i[g]=c;let x=t?De(t):{instructions:[],instructionTypes:[]},S=await ie(this.connection,this.blockhashCommitment),b=this.signers.reduce((g,c)=>G(F({},g),{[c.publicKey.toBase58()]:c}),{}),f=[],T=[],u=[],k=0;if(this.allInstructions.forEach(g=>{let c=[...u,g],p=t?[...x.instructions,...c]:c;if(g!==r[k]&&u.length<12&&(Te({instructions:p,payer:this.feePayer,lookupTableAddressAccount:i})||Te({instructions:c,payer:this.feePayer,lookupTableAddressAccount:i})))u.push(g);else{if(u.length===0)throw Error("item ins too big");k+=g===r[k]?1:0;let w={};for(let P of[...new Set(A)])i[P]!==void 0&&(w[P]=i[P]);if(t&&Te({instructions:[...x.instructions,...u],payer:this.feePayer,lookupTableAddressAccount:i,recentBlockhash:S})){let P=new C.TransactionMessage({payerKey:this.feePayer,recentBlockhash:S,instructions:[...x.instructions,...u]}).compileToV0Message(Object.values(i));f.push(new C.VersionedTransaction(P))}else{let P=new C.TransactionMessage({payerKey:this.feePayer,recentBlockhash:S,instructions:[...u]}).compileToV0Message(Object.values(i));f.push(new C.VersionedTransaction(P))}T.push(Array.from(new Set(u.map(P=>P.keys.filter(B=>B.isSigner).map(B=>B.pubkey.toString())).flat())).map(P=>b[P]).filter(P=>P!==void 0)),u=[g]}}),u.length>0){let c=[...new Set(u.map(p=>p.keys.filter(w=>w.isSigner).map(w=>w.pubkey.toString())).flat()).values()].map(p=>b[p]).filter(p=>p!==void 0);if(t&&Te({instructions:[...x.instructions,...u],payer:this.feePayer,lookupTableAddressAccount:i,recentBlockhash:S})){let p=new C.TransactionMessage({payerKey:this.feePayer,recentBlockhash:S,instructions:[...x.instructions,...u]}).compileToV0Message(Object.values(i));f.push(new C.VersionedTransaction(p))}else{let p=new C.TransactionMessage({payerKey:this.feePayer,recentBlockhash:S,instructions:[...u]}).compileToV0Message(Object.values(i));f.push(new C.VersionedTransaction(p))}T.push(c)}return(R=this.owner)!=null&&R.signer&&T.forEach(g=>{g.some(c=>c.publicKey.equals(this.owner.publicKey))||g.push(this.owner.signer)}),f.forEach((g,c)=>{g.sign(T[c])}),{builder:this,transactions:f,buildProps:e,signers:T,instructionTypes:this.instructionTypes,execute:async g=>{var N;let{sequentially:c,onTxUpdate:p,skipTxCount:w=0,recentBlockHash:P,skipPreflight:B=!0}=g||{};if(f.map(async(E,D)=>{T[D].length&&E.sign(T[D]),P&&(E.message.recentBlockhash=P)}),ee(f),(N=this.owner)!=null&&N.isKeyPair){if(c){let E=0,D=[];for(let _ of f){if(++E,E<=w){console.log("skip tx: ",E),D.push("tx skipped");continue}let O=await this.connection.sendTransaction(_,{skipPreflight:B});await Me(this.connection,O),D.push(O)}return{txIds:D,signedTxs:f}}return{txIds:await Promise.all(f.map(async E=>await this.connection.sendTransaction(E,{skipPreflight:B}))),signedTxs:f}}if(this.signAllTransactions){let E=await this.signAllTransactions(f.slice(w,f.length)),D=[...f.slice(0,w),...E];if(c){let _=0,O=[],U=async()=>{if(!D[_])return;if(_<w){O.push({txId:"",status:"success",signedTx:D[_]}),p==null||p([...O]),_++,U();return}let K=await this.connection.sendTransaction(D[_],{skipPreflight:B});O.push({txId:K,status:"sent",signedTx:D[_]}),p==null||p([...O]),_++;let Q=!1,te=null,Se=null,st=X=>{te!==null&&clearInterval(te),Se!==null&&this.connection.removeSignatureListener(Se);let z=O.findIndex(Vt=>Vt.txId===K);if(z>-1){if(O[z].status==="error"||O[z].status==="success")return;O[z].status=X.err?"error":"success"}p==null||p([...O]),X.err||U()};this.loopMultiTxStatus&&(te=setInterval(async()=>{var X;if(Q){clearInterval(te);return}try{let z=await this.connection.getTransaction(K,{commitment:"confirmed",maxSupportedTransactionVersion:0});z&&(Q=!0,clearInterval(te),st({err:((X=z.meta)==null?void 0:X.err)||null}),console.log("tx status from getTransaction:",K))}catch(z){Q=!0,clearInterval(te),console.error("getTransaction timeout:",z,K)}},_e)),Se=this.connection.onSignature(K,X=>{if(Q){this.connection.removeSignatureListener(Se);return}Q=!0,st(X)},"confirmed"),this.connection.getSignatureStatus(K)};return U(),{txIds:[],signedTxs:D}}else{let _=[];for(let O=0;O<D.length;O+=1){let U=await this.connection.sendTransaction(D[O],{skipPreflight:B});_.push(U)}return{txIds:_,signedTxs:D}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:m||{}}}};var Rt=V(require("bn.js")),jo=new Rt.default(1e6);var dn=v("Raydium_amount"),Dt=fe(Mt.default);function fn(n,e){let t="0",r="0";if(n.includes(".")){let o=n.split(".");o.length===2?([t,r]=o,r=r.padEnd(e,"0")):dn.logWithError(`invalid number string, num: ${n}`)}else t=n;return[t,r.slice(0,e)||r]}var J=class extends L{constructor(t,r,o=!0,a){let m=new xe.default(0),i=Qe.pow(new xe.default(t.decimals));if(o)m=q(r);else{let A=new xe.default(0),s=new xe.default(0);if(typeof r=="string"||typeof r=="number"||typeof r=="bigint"){let[h,x]=fn(r.toString(),t.decimals);A=q(h),s=q(x)}A=A.mul(i),m=A.add(s)}super(m,i);this.logger=v(a||"TokenAmount"),this.token=t}get raw(){return this.numerator}isZero(){return this.raw.isZero()}gt(t){return this.token.equals(t.token)||this.logger.logWithError("gt token not equals"),this.raw.gt(t.raw)}lt(t){return this.token.equals(t.token)||this.logger.logWithError("lt token not equals"),this.raw.lt(t.raw)}add(t){return this.token.equals(t.token)||this.logger.logWithError("add token not equals"),new J(this.token,this.raw.add(t.raw))}subtract(t){return this.token.equals(t.token)||this.logger.logWithError("sub token not equals"),new J(this.token,this.raw.sub(t.raw))}toSignificant(t=this.token.decimals,r,o=0){return super.toSignificant(t,r,o)}toFixed(t=this.token.decimals,r,o=0){return t>this.token.decimals&&this.logger.logWithError("decimals overflow"),super.toFixed(t,r,o)}toExact(t={groupSeparator:""}){return Dt.DP=this.token.decimals,new Dt(this.numerator.toString()).div(this.denominator.toString()).toFormat(t)}};function At(n){return typeof n=="object"&&n!==null&&![$,J,Nt.PublicKey,L,_t.default,Z,oe].some(e=>typeof e=="object"&&n instanceof e)}function Oe(n){return typeof n=="string"?Ue(n):Array.isArray(n)?n.map(e=>Oe(e)):At(n)?Object.fromEntries(Object.entries(n).map(([e,t])=>[e,Oe(t)])):n}var tt=(...n)=>n.map(e=>{try{return typeof e=="object"?JSON.stringify(e):e}catch{return e}}).join(", "),Pe=class{constructor({scope:e,moduleName:t}){this.disabled=!1;this.scope=e,this.logger=v(t)}createTxBuilder(e){return this.scope.checkOwner(),new Ee({connection:this.scope.connection,feePayer:e||this.scope.ownerPubKey,cluster:this.scope.cluster,owner:this.scope.owner,blockhashCommitment:this.scope.blockhashCommitment,loopMultiTxStatus:this.scope.loopMultiTxStatus,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}logDebug(...e){this.logger.debug(tt(e))}logInfo(...e){this.logger.info(tt(e))}logAndCreateError(...e){let t=tt(e);throw new Error(t)}checkDisabled(){(this.disabled||!this.scope)&&this.logAndCreateError("module not working")}};var ue=require("@solana/web3.js"),Ke=require("@solana/spl-token");var gn=require("@solana/web3.js"),Kt=V(require("bn.js"));var d=require("@solana/buffer-layout");var Et=d.Structure;var Ot=d.UInt;var Ft=d.nu64;function rt(n){return new Ot(1,n)}var nt=class extends Et{decode(e,t){return super.decode(e,t)}};function ot(n,e,t){return new nt(n,e,t)}var Fe=ot([rt("instruction"),Ft("amount")]),ae=ot([rt("instruction")]);function yn({programId:n,amount:e,instructionKeys:t}){let r=[{pubkey:dt,isSigner:!1,isWritable:!1},{pubkey:Ke.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:pt,isSigner:!1,isWritable:!1},{pubkey:qe,isSigner:!1,isWritable:!1},...Object.entries(t).map(([a,m])=>({pubkey:m,isSigner:a==="userOwner",isWritable:!["authority","userOwner","userIdoCheck","userStakeInfo"].includes(a)}))],o=Buffer.alloc(Fe.span);return Fe.encode({instruction:1,amount:Number(e)},o),new ue.TransactionInstruction({keys:r,programId:n,data:o})}function we({programId:n},e){let t=[{pubkey:Ke.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:qe,isSigner:!1,isWritable:!1},...Object.entries(e).map(([o,a])=>({pubkey:a,isSigner:o==="userOwner",isWritable:!["authority","userOwner"].includes(o)}))],r=Buffer.alloc(ae.span);return ae.encode({instruction:2},r),new ue.TransactionInstruction({keys:t,programId:n,data:r})}function Ve(n){let{poolConfig:e,userKeys:t,side:r}=n,o=r==="base"?t.baseTokenAccount:t.quoteTokenAccount,a=r==="base"?e.baseVault:e.quoteVault,m=Buffer.alloc(ae.span);ae.encode({instruction:2},m);let i=[{pubkey:Ke.TOKEN_PROGRAM_ID,isWritable:!1,isSigner:!1},{pubkey:ue.SYSVAR_CLOCK_PUBKEY,isWritable:!1,isSigner:!1},{pubkey:e.id,isWritable:!0,isSigner:!1},{pubkey:e.authority,isWritable:!1,isSigner:!1},{pubkey:a,isWritable:!0,isSigner:!1},{pubkey:o,isWritable:!0,isSigner:!1},{pubkey:t.ledgerAccount,isWritable:!0,isSigner:!1},{pubkey:t.owner,isWritable:!1,isSigner:!0}];return new ue.TransactionInstruction({programId:e.programId,keys:i,data:m})}var hn={[me.IDO_PROGRAM_ID_V1.toString()]:1,[me.IDO_PROGRAM_ID_V2.toString()]:2,[me.IDO_PROGRAM_ID_V3.toString()]:3,[me.IDO_PROGRAM_ID_V4.toString()]:4},Ae=class extends Pe{async claim({ownerInfo:e,idoKeys:t,associatedOnly:r=!0,checkCreateATAOwner:o=!1,txVersion:a,feePayer:m}){let i=this.createTxBuilder(m),A=hn[t.programId];A||this.logAndCreateError("invalid version",A);let s=Oe(t),[h,x]=[!new it.default(e.coin).isZero(),!new it.default(e.pc).isZero()],S=s.projectInfo.mint.address.equals(ne),{account:b,instructionParams:f}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:s.projectInfo.mint.programId,mint:s.projectInfo.mint.address,owner:this.scope.ownerPubKey,createInfo:{payer:this.scope.ownerPubKey,amount:0},skipCloseAccount:!S,notUseTokenAccount:S,associatedOnly:S?!1:r,checkCreateATAOwner:o});!b&&h&&this.logAndCreateError("target token accounts not found","mint",t.projectInfo.mint.address),h&&f&&i.addInstruction(f);let T=s.buyInfo.mint.address.equals(ne),{account:u,instructionParams:k}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:s.buyInfo.mint.programId,mint:s.buyInfo.mint.address,owner:this.scope.ownerPubKey,createInfo:{payer:this.scope.ownerPubKey,amount:0},skipCloseAccount:!T,notUseTokenAccount:T,associatedOnly:T?!1:r,checkCreateATAOwner:o});if(!b&&x&&this.logAndCreateError("target token accounts not found","mint",t.projectInfo.mint.address),x&&k&&i.addInstruction(k),(!b||!u)&&this.logAndCreateError("target token accounts not found","mint",t.projectInfo.mint.address,t.buyInfo.mint.address),A===3)return i.addInstruction({instructions:[...h?[we({programId:s.programId},{idoId:s.id,authority:s.authority,poolTokenAccount:s.projectInfo.vault,userTokenAccount:b,userIdoInfo:new ce.PublicKey(e.userIdoInfo),userOwner:this.scope.ownerPubKey})]:[],...x?[we({programId:new ce.PublicKey(t.programId)},{idoId:s.id,authority:s.authority,poolTokenAccount:s.buyInfo.vault,userTokenAccount:u,userIdoInfo:new ce.PublicKey(e.userIdoInfo),userOwner:this.scope.ownerPubKey})]:[]]}).versionBuild({txVersion:a});if(A<3)return!h&&!x&&this.logAndCreateError("no claimable rewards"),i.addInstruction({instructions:[we({programId:s.programId},{idoId:s.id,authority:s.authority,poolQuoteTokenAccount:s.buyInfo.vault,poolBaseTokenAccount:s.projectInfo.vault,userQuoteTokenAccount:u,userBaseTokenAccount:b,userIdoInfo:new ce.PublicKey(e.userIdoInfo),userOwner:this.scope.ownerPubKey})]}).versionBuild({txVersion:a});let y={poolConfig:{id:s.id,programId:s.programId,authority:s.authority,baseVault:s.projectInfo.vault,quoteVault:s.buyInfo.vault,baseToken:t.projectInfo.mint,quoteToken:t.buyInfo.mint},userKeys:{baseTokenAccount:b,quoteTokenAccount:u,ledgerAccount:new ce.PublicKey(e.userIdoInfo),owner:this.scope.ownerPubKey}};return i.addInstruction({instructions:[...h?[Ve(G(F({},y),{side:"base"}))]:[],...x?[Ve(G(F({},y),{side:"quote"}))]:[]]}).versionBuild({txVersion:a})}};0&&(module.exports={claimLayout,makeClaimInstruction,makeClaimInstructionV4,makePurchaseInstruction,purchaseLayout});
//# sourceMappingURL=index.js.map