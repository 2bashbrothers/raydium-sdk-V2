var Ze=Object.defineProperty,$e=Object.defineProperties;var et=Object.getOwnPropertyDescriptors;var Y=Object.getOwnPropertySymbols;var Le=Object.prototype.hasOwnProperty,_e=Object.prototype.propertyIsEnumerable;var Be=(n,e,t)=>e in n?Ze(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,A=(n,e)=>{for(var t in e||(e={}))Le.call(e,t)&&Be(n,t,e[t]);if(Y)for(var t of Y(e))_e.call(e,t)&&Be(n,t,e[t]);return n},R=(n,e)=>$e(n,et(e));var ie=(n,e)=>{var t={};for(var o in n)Le.call(n,o)&&e.indexOf(o)<0&&(t[o]=n[o]);if(n!=null&&Y)for(var o of Y(n))e.indexOf(o)<0&&_e.call(n,o)&&(t[o]=n[o]);return t};import{PublicKey as H}from"@solana/web3.js";import G from"bn.js";import ee from"decimal.js";import{TOKEN_PROGRAM_ID as vt}from"@solana/spl-token";import{ComputeBudgetProgram as Qt,Keypair as Zt,PublicKey as Ne,Transaction as ae,TransactionMessage as tn,VersionedTransaction as nn}from"@solana/web3.js";import{get as Ce,set as tt}from"lodash";var se=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:0,this.name=e.name}set level(e){this.logLevel=e}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let t=e.map(o=>typeof o=="object"?JSON.stringify(o):o).join(", ");throw new Error(t)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},Re={},nt={};function h(n){let e=Ce(Re,n);if(!e){let t=Ce(nt,n);e=new se({name:n,logLevel:t}),tt(Re,n,e)}return e}import{TOKEN_PROGRAM_ID as an}from"@solana/spl-token";var S=h("Raydium_txUtil"),rt=1644;function ot(n,e){n.length<1&&S.logWithError(`no instructions provided: ${n.toString()}`),e.length<1&&S.logWithError(`no signers provided:, ${e.toString()}`);let t=new ae;t.recentBlockhash="11111111111111111111111111111111",t.feePayer=e[0],t.add(...n);try{return Buffer.from(t.serialize({verifySignatures:!1})).toString("base64").length<rt}catch{return!1}}async function Me(n,e,t,o=!0){let i=new Ne("RaydiumSimuLateTransaction11111111111111111"),c=[],d=new ae;d.feePayer=i;for(let l of e)ot([...d.instructions,l],[i])||(c.push(d),d=new ae,d.feePayer=i),d.add(l);d.instructions.length>0&&c.push(d);let p=[];try{if(p=await it(n,c,o),p.find(l=>l.err!==null))throw Error("rpc simulateTransaction error")}catch(l){l instanceof Error&&S.logWithError("failed to simulate for instructions","RPC_ERROR",{message:l.message})}let x=[];for(let l of p)if(S.debug("simulate result:",l),l.logs){let f=l.logs.filter(k=>k&&k.includes(t));S.debug("filteredLog:",x),f.length||S.logWithError("simulate log not match keyword","keyword",t),x.push(...f)}return x}function De(n,e){let t=n.match(/{["\w:,]+}/g);return!t||t.length!==1?S.logWithError(`simulate log fail to match json, keyword: ${e}`):t[0]}function I(n,e){let o=new RegExp(`"${e}":(\\d+)`,"g").exec(n);return!o||o.length!==2?S.logWithError(`simulate log fail to match key", key: ${e}`):o[1]}function O(n,e){let[t,o]=Ne.findProgramAddressSync(n,e);return{publicKey:t,nonce:o}}async function it(n,e,t){let o=[];if(t){let i=await n.getLatestBlockhash(),c=[];for(let l of e){l.recentBlockhash=i.blockhash,l.lastValidBlockHeight=i.lastValidBlockHeight;let k=l._compile().serialize(),N=l._serialize(k).toString("base64");c.push(N)}let d=c.map(l=>{let f=n._buildArgs([l],void 0,"base64");return{methodName:"simulateTransaction",args:f}}),p=[],x=20;for(let l=0;l<Math.ceil(d.length/x);l++)p.push(d.slice(l*x,(l+1)*x));o=await(await Promise.all(p.map(async l=>(await n._rpcBatchRequest(l)).map(f=>f.result.value)))).flat()}else try{o=await Promise.all(e.map(async i=>await(await n.simulateTransaction(i)).value))}catch(i){i instanceof Error&&S.logWithError("failed to get info for multiple accounts","RPC_ERROR",{message:i.message})}return o}import{PublicKey as Bs}from"@solana/web3.js";import{MintLayout as _s,TOKEN_PROGRAM_ID as Rs}from"@solana/spl-token";import Pt from"big.js";import is from"bn.js";import L from"bn.js";import xr from"decimal.js";import{PublicKey as st}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Ee}from"@solana/spl-token";var ce={chainId:101,address:st.default.toBase58(),programId:Ee.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},B={chainId:101,address:"So11111111111111111111111111111111111111112",programId:Ee.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};import{PublicKey as de}from"@solana/web3.js";import{PublicKey as b,SystemProgram as Ke,SYSVAR_RENT_PUBKEY as at}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as ut}from"@solana/spl-token";function P({pubkey:n,isSigner:e=!1,isWritable:t=!0}){return{pubkey:n,isWritable:t,isSigner:e}}var gn=[P({pubkey:ut,isWritable:!1}),P({pubkey:Ke.programId,isWritable:!1}),P({pubkey:at,isWritable:!1})];function me({publicKey:n,transformSol:e}){let t=Oe(n.toString());if(t instanceof b)return e&&t.equals(F)?le:t;if(e&&t.toString()===F.toBase58())return le;if(typeof t=="string"){if(t===b.default.toBase58())return b.default;try{return new b(t)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function Oe(n){try{return new b(n)}catch{return n}}var bn=new b("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),yn=new b("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),ct=new b("SysvarRent111111111111111111111111111111111"),hn=new b("SysvarC1ock11111111111111111111111111111111"),Tn=new b("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),xn=new b("Sysvar1nstructions1111111111111111111111111"),Pn=Ke.programId,wn=new b("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),kn=new b("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),An=new b("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),Sn=new b("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),In=new b("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),Bn=new b("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),Ln=new b("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),_n=new b("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),Cn=new b("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),Rn=new b("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),Nn=new b("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),le=new b("So11111111111111111111111111111111111111112"),F=b.default;function pe(n){return me({publicKey:n,transformSol:!0})}var fe=class{constructor({mint:e,decimals:t,symbol:o,name:i,skipMint:c=!1,isToken2022:d=!1}){if(e===F.toBase58()||e instanceof de&&F.equals(e)){this.decimals=B.decimals,this.symbol=B.symbol,this.name=B.name,this.mint=new de(B.address),this.isToken2022=!1;return}this.decimals=t,this.symbol=o||e.toString().substring(0,6),this.name=i||e.toString().substring(0,6),this.mint=c?de.default:me({publicKey:e}),this.isToken2022=d}equals(e){return this===e?!0:this.mint.equals(e.mint)}},M=fe;M.WSOL=new fe(R(A({},B),{mint:B.address}));var ge=class{constructor({decimals:e,symbol:t="UNKNOWN",name:o="UNKNOWN"}){this.decimals=e,this.symbol=t,this.name=o}equals(e){return this===e}},j=ge;j.SOL=new ge(ce);import J from"big.js";import dt from"bn.js";import ft from"decimal.js-light";import V from"bn.js";var Fe=9007199254740991;function w(n){let e=h("Raydium_parseBigNumberish");if(n instanceof V)return n;if(typeof n=="string"){if(n.match(/^-?[0-9]+$/))return new V(n);e.logWithError(`invalid BigNumberish string: ${n}`)}return typeof n=="number"?(n%1&&e.logWithError(`BigNumberish number underflow: ${n}`),(n>=Fe||n<=-Fe)&&e.logWithError(`BigNumberish number overflow: ${n}`),new V(String(n))):typeof n=="bigint"?new V(n.toString()):(e.error(`invalid BigNumberish value: ${n}`),new V(0))}import lt from"toformat";var mt=lt,v=mt;var Q=h("module/fraction"),be=v(J),W=v(ft),gt={[0]:W.ROUND_DOWN,[1]:W.ROUND_HALF_UP,[2]:W.ROUND_UP},bt={[0]:J.roundDown,[1]:J.roundHalfUp,[2]:J.roundUp},g=class{constructor(e,t=new dt(1)){this.numerator=w(e),this.denominator=w(t)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new g(this.denominator,this.numerator)}add(e){let t=e instanceof g?e:new g(w(e));return this.denominator.eq(t.denominator)?new g(this.numerator.add(t.numerator),this.denominator):new g(this.numerator.mul(t.denominator).add(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}sub(e){let t=e instanceof g?e:new g(w(e));return this.denominator.eq(t.denominator)?new g(this.numerator.sub(t.numerator),this.denominator):new g(this.numerator.mul(t.denominator).sub(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}mul(e){let t=e instanceof g?e:new g(w(e));return new g(this.numerator.mul(t.numerator),this.denominator.mul(t.denominator))}div(e){let t=e instanceof g?e:new g(w(e));return new g(this.numerator.mul(t.denominator),this.denominator.mul(t.numerator))}toSignificant(e,t={groupSeparator:""},o=1){Number.isInteger(e)||Q.logWithError(`${e} is not an integer.`),e<=0&&Q.logWithError(`${e} is not positive.`),W.set({precision:e+1,rounding:gt[o]});let i=new W(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return i.toFormat(i.decimalPlaces(),t)}toFixed(e,t={groupSeparator:""},o=1){return Number.isInteger(e)||Q.logWithError(`${e} is not an integer.`),e<0&&Q.logWithError(`${e} is negative.`),be.DP=e,be.RM=bt[o]||1,new be(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,t)}isZero(){return this.numerator.isZero()}};import yt from"bn.js";var rr=new g(new yt(100));var cr=h("Raydium_price");var We=new L(0),ht=new L(1),_r=new L(2),Cr=new L(3),Rr=new L(5),Tt=new L(10),Nr=new L(100),Mr=new L(1e3),Dr=new L(1e4);import{PublicKey as Wr}from"@solana/web3.js";import{MINT_SIZE as Hr,TOKEN_PROGRAM_ID as zr,getTransferFeeConfig as Yr,unpackMint as jr}from"@solana/spl-token";var Qr=h("Raydium_accountInfo_util");import{PublicKey as no}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as oo}from"@solana/spl-token";import{PublicKey as s}from"@solana/web3.js";var uo=new s("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),co=new s("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),lo=new s("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),mo=new s("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),po=new s("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),fo=new s("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),go=new s("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),bo=new s("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),yo=new s("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),ho=new s("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),To=new s("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),xo=new s("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),Po=new s("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),he=new s("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),wo=new s("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),ko=new s("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),Ao=new s("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),So=new s("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),Io=new s("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),Bo=new s("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),Lo=new s("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),_o=new s("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),Co=new s("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),Ro=new s("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),No=new s("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),Mo=new s("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),Do=new s("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),Eo=new s("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),Ko=new s("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),Oo=new s("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),Fo=new s("6s1xP3hpbAfFoNtUNF8mfHsjr2Bd97JxFJRWLbL6aHuX");var Vo={OPEN_BOOK_PROGRAM:new s("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),SERUM_PROGRAM_ID_V3:new s("Ray1111111111111111111111111111111111111111"),AMM_V4:new s("DRaya7Kj3aMWQSy19kSjvmuwq9docCHofyP9kanQGaav"),AMM_STABLE:new s("DRayDdXc1NZQ9C3hRWmoSf8zK4iapgMnjdNZWrfwsP8m"),CLMM_PROGRAM_ID:new s("DRayAUgENGQBKVaX8owNhgzkEDyoHTGVEGHVJT1E9pfH"),CLMM_LOCK_PROGRAM_ID:new s("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),CLMM_LOCK_AUTH_ID:new s("6Aoh8h2Lw2m5UGxYR8AdAL87jTWYeKoxM52mJRzfYwN"),CREATE_CPMM_POOL_PROGRAM:new s("DRaycpLY18LhpbydsBWbVJtxpNv9oXPgjRSfpF2bWpYb"),CREATE_CPMM_POOL_AUTH:new s("CXniRufdq5xL8t8jZAPxsPZDpuudwuJSPWnbcD5Y5Nxq"),CREATE_CPMM_POOL_FEE_ACC:new s("3oE58BKVt8KuYkGxx8zBojugnymWmBiyafWgMrnb6eYy"),LOCK_CPMM_PROGRAM:new s("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),LOCK_CPMM_AUTH:new s("7qWVV8UY2bRJfDLP4s37YzBPKUkVB46DStYJBpYbQzu3"),UTIL1216:s.default,Router:new s("DRaybByLpbUL57LJARs3j8BitTxVfzBg351EaMr5UTCd"),FARM_PROGRAM_ID_V3:new s("DRayWyrLmEW5KEeqs8kdTMMaBabapqagaBC7KWpGtJeZ"),FARM_PROGRAM_ID_V4:new s("Ray1111111111111111111111111111111111111111"),FARM_PROGRAM_ID_V5:new s("DRayiCGSZgku1GTK6rXD6mVDdingXy6APAH1R6R5L2LC"),FARM_PROGRAM_ID_V6:new s("DRayzbYakXs45ELHkzH6vC3fuhQqTAnv5A68gdFuvZyZ"),LAUNCHPAD_PROGRAM:new s("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),LAUNCHPAD_AUTH:new s("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),LAUNCHPAD_PLATFORM:new s("2Jx4KTDrVSdWNazuGpcA8n3ZLTRGGBDxAWhuKe2Xcj2a"),LAUNCHPAD_CONFIG:new s("7ZR4zD7PYfY2XxoG1Gxcy2EgEeGYrpxrwzPuwdUBssEt"),FEE_DESTINATION_ID:new s("9y8ENuuZ3b19quffx9hQvRVygG5ky6snHfRvGpuSfeJy"),MODEL_DATA_PUBKEY:new s("Ray1111111111111111111111111111111111111111")};import qo from"bn.js";import{PublicKey as Yo,AddressLookupTableAccount as jo}from"@solana/web3.js";import{PublicKey as mi,sendAndConfirmTransaction as pi,SystemProgram as gi,Transaction as bi,TransactionMessage as hi,VersionedTransaction as Ti}from"@solana/web3.js";import Pi from"axios";import{PublicKey as _i}from"@solana/web3.js";import Ri from"bn.js";import xt from"bn.js";var Ki=new xt(1e6);var fs=h("Raydium_amount"),gs=v(Pt);var X=i=>{var c=i,{address:n,programId:e,decimals:t}=c,o=ie(c,["address","programId","decimals"]);return A({chainId:101,address:pe(n).toBase58(),programId:e,logoURI:"",symbol:"",name:"",decimals:t,tags:[],extensions:o.extensions||{}},o)};import{PublicKey as C,SystemProgram as za,SYSVAR_RENT_PUBKEY as Ya,TransactionInstruction as Mt}from"@solana/web3.js";import{ASSOCIATED_TOKEN_PROGRAM_ID as Qa,TOKEN_PROGRAM_ID as Ja}from"@solana/spl-token";import{PublicKey as Bt}from"@solana/web3.js";import Ge,{isBN as He}from"bn.js";import{bits as Fs,BitStructure as Vs,blob as wt,Blob as vs,cstr as Ws,f32 as qs,f32be as Us,f64 as Gs,f64be as Hs,greedy as zs,Layout as kt,ns64 as Ys,ns64be as js,nu64 as Qs,nu64be as Js,offset as Xs,s16 as Zs,s16be as $s,s24 as ea,s24be as ta,s32 as na,s32be as ra,s40 as oa,s40be as ia,s48 as sa,s48be as aa,s8 as ua,seq as At,struct as ca,Structure as St,u16 as la,u16be as ma,u24 as pa,u24be as da,u32 as fa,u32be as ga,u40 as ba,u40be as ya,u48 as ha,u48be as Ta,u8 as xa,UInt as It,union as Pa,Union as wa,unionLayoutDiscriminator as ka,utf8 as Aa}from"@solana/buffer-layout";var Te=kt,qe=St;var xe=It;var Ue=At;var Pe=wt;var Z=class extends Te{constructor(t,o,i){super(t,i);this.blob=Pe(t),this.signed=o}decode(t,o=0){let i=new Ge(this.blob.decode(t,o),10,"le");return this.signed?i.fromTwos(this.span*8).clone():i}encode(t,o,i=0){return typeof t=="number"&&(t=new Ge(t)),this.signed&&(t=t.toTwos(this.span*8)),this.blob.encode(t.toArrayLike(Buffer,"le",this.span),o,i)}};function T(n){return new xe(1,n)}function D(n){return new xe(4,n)}function r(n){return new Z(8,!1,n)}function _(n){return new Z(16,!1,n)}var we=class extends Te{constructor(t,o,i,c){super(t.span,c);this.layout=t,this.decoder=o,this.encoder=i}decode(t,o){return this.decoder(this.layout.decode(t,o))}encode(t,o,i){return this.layout.encode(this.encoder(t),o,i)}getSpan(t,o){return this.layout.getSpan(t,o)}};function m(n){return new we(Pe(32),e=>new Bt(e),e=>e.toBuffer(),n)}var ke=class extends qe{decode(e,t){return super.decode(e,t)}};function y(n,e,t){return new ke(n,e,t)}function q(n,e,t){let o,i=typeof e=="number"?e:He(e)?e.toNumber():new Proxy(e,{get(c,d){if(!o){let p=Reflect.get(c,"count");o=He(p)?p.toNumber():p,Reflect.set(c,"count",o)}return Reflect.get(c,d)},set(c,d,p){return d==="count"&&(o=p),Reflect.set(c,d,p)}});return Ue(n,i,t)}var Lt=y([T("instruction"),r("amountIn"),r("minAmountOut")]),_t=y([T("instruction"),r("maxAmountIn"),r("amountOut")]),va=y([T("instruction"),T("nonce")]),Ct=y([T("instruction"),T("nonce"),r("startTime")]),ze=y([r("status"),r("nonce"),r("maxOrder"),r("depth"),r("baseDecimal"),r("quoteDecimal"),r("state"),r("resetFlag"),r("minSize"),r("volMaxCutRatio"),r("amountWaveRatio"),r("baseLotSize"),r("quoteLotSize"),r("minPriceMultiplier"),r("maxPriceMultiplier"),r("systemDecimalValue"),r("minSeparateNumerator"),r("minSeparateDenominator"),r("tradeFeeNumerator"),r("tradeFeeDenominator"),r("pnlNumerator"),r("pnlDenominator"),r("swapFeeNumerator"),r("swapFeeDenominator"),r("baseNeedTakePnl"),r("quoteNeedTakePnl"),r("quoteTotalPnl"),r("baseTotalPnl"),r("poolOpenTime"),r("punishPcAmount"),r("punishCoinAmount"),r("orderbookToInitTime"),_("swapBaseInAmount"),_("swapQuoteOutAmount"),r("swapBase2QuoteFee"),_("swapQuoteInAmount"),_("swapBaseOutAmount"),r("swapQuote2BaseFee"),m("baseVault"),m("quoteVault"),m("baseMint"),m("quoteMint"),m("lpMint"),m("openOrders"),m("marketId"),m("marketProgramId"),m("targetOrders"),m("withdrawQueue"),m("lpVault"),m("owner"),r("lpReserve"),q(r(),3,"padding")]),Wa=y([r("accountType"),r("status"),r("nonce"),r("maxOrder"),r("depth"),r("baseDecimal"),r("quoteDecimal"),r("state"),r("resetFlag"),r("minSize"),r("volMaxCutRatio"),r("amountWaveRatio"),r("baseLotSize"),r("quoteLotSize"),r("minPriceMultiplier"),r("maxPriceMultiplier"),r("systemDecimalsValue"),r("abortTradeFactor"),r("priceTickMultiplier"),r("priceTick"),r("minSeparateNumerator"),r("minSeparateDenominator"),r("tradeFeeNumerator"),r("tradeFeeDenominator"),r("pnlNumerator"),r("pnlDenominator"),r("swapFeeNumerator"),r("swapFeeDenominator"),r("baseNeedTakePnl"),r("quoteNeedTakePnl"),r("quoteTotalPnl"),r("baseTotalPnl"),r("poolOpenTime"),r("punishPcAmount"),r("punishCoinAmount"),r("orderbookToInitTime"),_("swapBaseInAmount"),_("swapQuoteOutAmount"),_("swapQuoteInAmount"),_("swapBaseOutAmount"),r("swapQuote2BaseFee"),r("swapBase2QuoteFee"),m("baseVault"),m("quoteVault"),m("baseMint"),m("quoteMint"),m("lpMint"),m("modelDataAccount"),m("openOrders"),m("marketId"),m("marketProgramId"),m("targetOrders"),m("owner"),q(r(),64,"padding")]),Rt=y([T("instruction"),r("baseAmountIn"),r("quoteAmountIn"),r("fixedSide"),r("otherAmountMin")]),Nt=y([T("instruction"),r("lpAmount"),r("baseAmountMin"),r("quoteAmountMin")]);var qa=y([r("fee")]);var ou=h("Raydium_liquidity_instruction");function Ye({poolKeys:n}){let e=y([T("instruction"),T("simulateType")]),t=Buffer.alloc(e.span);e.encode({instruction:12,simulateType:0},t);let o=[P({pubkey:new C(n.id),isWritable:!1}),P({pubkey:new C(n.authority),isWritable:!1}),P({pubkey:new C(n.openOrders),isWritable:!1}),P({pubkey:new C(n.vault.A),isWritable:!1}),P({pubkey:new C(n.vault.B),isWritable:!1}),P({pubkey:new C(n.mintLp.address),isWritable:!1}),P({pubkey:new C(n.marketId),isWritable:!1}),P({pubkey:new C(n.marketEventQueue),isWritable:!1})];return{instruction:new Mt({programId:new C(n.programId),keys:o,data:t})}}import{PublicKey as Dt}from"@solana/web3.js";import je from"bn.js";var au=new je(25),uu=new je(1e4);var Et=h("Raydium_liquidity_serum");function Qe({programId:n,marketId:e}){let t=[e.toBuffer()],o=0,i;for(;o<100;){try{let c=t.concat(Buffer.from([o]),Buffer.alloc(7));i=Dt.createProgramAddressSync(c,n)}catch(c){if(c instanceof TypeError)throw c;o++;continue}return{publicKey:i,nonce:o}}throw Et.logWithError("unable to find a viable program address nonce","params",{programId:n,marketId:e}),new Error("unable to find a viable program address nonce")}var Kt=5e4,Ot=y([r("x"),r("y"),r("price")]),Ft=y([r("accountType"),r("status"),r("multiplier"),r("validDataCount"),q(Ot,Kt,"DataElement")]);function Vt(n){let e=Ft.decode(n);return{accountType:e.accountType.toNumber(),status:e.status.toNumber(),multiplier:e.multiplier.toNumber(),validDataCount:e.validDataCount.toNumber(),DataElement:e.DataElement.map(t=>({x:t.x.toNumber(),y:t.y.toNumber(),price:t.price.toNumber()}))}}var $=class{constructor({connection:e,modelDataPubKey:t=he}){this._layoutData={accountType:0,status:0,multiplier:0,validDataCount:0,DataElement:[]};this.connection=e,this.modelDataPubKey=t}get stableModelData(){return this._layoutData}async initStableModelLayout(){if(this._layoutData.validDataCount===0&&this.connection){let e=await this.connection.getAccountInfo(this.modelDataPubKey);e&&(this._layoutData=Vt(e==null?void 0:e.data))}}};var U=y([m("mint"),m("owner"),r("amount"),D("delegateOption"),m("delegate"),T("state"),D("isNativeOption"),r("isNative"),r("delegatedAmount"),D("closeAuthorityOption"),m("closeAuthority")]);import{Keypair as Au,PublicKey as Su}from"@solana/web3.js";import Lu from"bn.js";import{TOKEN_PROGRAM_ID as Ru}from"@solana/spl-token";var Mu=h("Raydium_Util");import{PublicKey as Vu,SystemProgram as Wu}from"@solana/web3.js";import Gu from"bn.js";import{createCloseAccountInstruction as ju,createInitializeAccountInstruction as Qu,createTransferInstruction as Ju,TOKEN_PROGRAM_ID as Xu}from"@solana/spl-token";var Je=y([D("mintAuthorityOption"),m("mintAuthority"),r("supply"),T("decimals"),T("isInitialized"),D("freezeAuthorityOption"),m("freezeAuthority")]);function Xe({programId:n}){let{publicKey:e}=O([Buffer.from("amm_config_account_seed","utf-8")],n);return e}function E({name:n,programId:e,marketId:t}){let{publicKey:o}=O([e.toBuffer(),t.toBuffer(),Buffer.from(n,"utf-8")],e);return o}function Wt({programId:n,marketId:e}){let{publicKey:t}=O([n.toBuffer(),e.toBuffer(),Buffer.from("open_order_associated_seed","utf-8")],n);return t}function qt({programId:n}){return O([Buffer.from([97,109,109,32,97,117,116,104,111,114,105,116,121])],n)}function Lc({version:n,marketVersion:e,marketId:t,baseMint:o,quoteMint:i,baseDecimals:c,quoteDecimals:d,programId:p,marketProgramId:x}){let l=E({name:"amm_associated_seed",programId:p,marketId:t}),f=E({name:"lp_mint_associated_seed",programId:p,marketId:t}),{publicKey:k,nonce:K}=qt({programId:p}),N=E({name:"coin_vault_associated_seed",programId:p,marketId:t}),te=E({name:"pc_vault_associated_seed",programId:p,marketId:t}),ne=E({name:"temp_lp_token_associated_seed",programId:p,marketId:t}),re=Wt({programId:p,marketId:t}),oe=E({name:"target_associated_seed",programId:p,marketId:t}),z=E({name:"withdraw_associated_seed",programId:p,marketId:t}),{publicKey:Ie}=Qe({programId:x,marketId:t});return{id:l,baseMint:o,quoteMint:i,lpMint:f,baseDecimals:c,quoteDecimals:d,lpDecimals:c,version:n,programId:p,authority:k,nonce:K,baseVault:N,quoteVault:te,lpVault:ne,openOrders:re,targetOrders:oe,withdrawQueue:z,marketVersion:e,marketProgramId:x,marketId:t,marketAuthority:Ie,lookupTableAccount:H.default,configId:Xe({programId:p})}}var Ae;async function _c({connection:n,poolKeysList:e,config:t,modelDataPubKey:o}){return e.find(c=>c.modelDataAccount)&&(Ae||(Ae=new $({connection:n,modelDataPubKey:o}),await Ae.initStableModelLayout())),await Promise.all(e.map(async c=>{if(c.modelDataAccount){let d=Ye({poolKeys:c});return(await Me(n,[d.instruction],"GetPoolData")).map(l=>{let f=De(l,"GetPoolData"),k=new G(I(f,"status")),K=Number(I(f,"coin_decimals")),N=Number(I(f,"pc_decimals")),te=Number(I(f,"lp_decimals")),ne=new G(I(f,"pool_coin_amount")),re=new G(I(f,"pool_pc_amount")),oe=new G(I(f,"pool_lp_supply")),z="0";try{z=I(f,"pool_open_time")}catch{}return{status:k,baseDecimals:K,quoteDecimals:N,lpDecimals:te,baseReserve:ne,quoteReserve:re,lpSupply:oe,startTime:new G(z)}})[0]}else{let[d,p,x,l]=await n.getMultipleAccountsInfo([new H(c.id),new H(c.vault.A),new H(c.vault.B),new H(c.mintLp.address)]);if(d===null)throw Error("fetch pool error");if(p===null)throw Error("fetch vaultAccA error");if(x===null)throw Error("fetch vaultAccB error");if(l===null)throw Error("fetch mintAccLp error");let f=ze.decode(d.data),k=U.decode(p.data),K=U.decode(x.data),N=Je.decode(l.data);return{status:f.status,baseDecimals:f.baseDecimal.toNumber(),quoteDecimals:f.quoteDecimal.toNumber(),lpDecimals:N.decimals,baseReserve:k.amount.sub(f.baseNeedTakePnl),quoteReserve:K.amount.sub(f.quoteNeedTakePnl),lpSupply:f.lpReserve,startTime:f.poolOpenTime}}}))}var Se={volume:0,volumeQuote:0,volumeFee:0,apr:0,feeApr:0,priceMin:0,priceMax:0,rewardApr:[]},Cc=n=>{let e={},t=vt.toBase58();return Object.keys(n).map(o=>{let i=n[o],[c,d]=[i.baseMint.toBase58(),i.quoteMint.toBase58()];e[o]={id:o,version:4,status:i.status.toNumber(),programId:i.programId.toBase58(),mintA:X({address:c,programId:t,decimals:i.baseDecimal.toNumber()}),mintB:X({address:d,programId:t,decimals:i.quoteDecimal.toNumber()}),rewardDefaultInfos:[],rewardDefaultPoolInfos:"Ecosystem",price:i.poolPrice.toNumber(),mintAmountA:new ee(i.mintAAmount.toString()).div(10**i.baseDecimal.toNumber()).toNumber(),mintAmountB:new ee(i.mintBAmount.toString()).div(10**i.quoteDecimal.toNumber()).toNumber(),baseReserve:i.baseReserve,quoteReserve:i.quoteReserve,feeRate:new ee(i.tradeFeeNumerator.toString()).div(i.tradeFeeDenominator.toString()).toNumber(),openTime:i.poolOpenTime.toString(),tvl:0,day:Se,week:Se,month:Se,pooltype:[],farmUpcomingCount:0,farmOngoingCount:0,farmFinishedCount:0,type:"Standard",marketId:i.marketId.toBase58(),configId:Xe({programId:i.programId}).toBase58(),lpPrice:0,lpAmount:new ee(i.lpReserve.toString()).div(10**Math.min(i.baseDecimal.toNumber(),i.quoteDecimal.toNumber())).toNumber(),lpMint:X({address:i.lpMint.toBase58(),programId:t,decimals:Math.min(i.baseDecimal.toNumber(),i.quoteDecimal.toNumber())}),burnPercent:0}}),e};export{_c as fetchMultipleInfo,Xe as getAssociatedConfigId,Wt as getAssociatedOpenOrders,Lc as getAssociatedPoolKeys,qt as getLiquidityAssociatedAuthority,E as getLiquidityAssociatedId,Cc as toAmmComputePoolInfo};
//# sourceMappingURL=utils.mjs.map