var Ct=Object.defineProperty,Kt=Object.defineProperties;var Nt=Object.getOwnPropertyDescriptors;var ue=Object.getOwnPropertySymbols;var Ye=Object.prototype.hasOwnProperty,Xe=Object.prototype.propertyIsEnumerable;var Qe=(t,e,n)=>e in t?Ct(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,C=(t,e)=>{for(var n in e||(e={}))Ye.call(e,n)&&Qe(t,n,e[n]);if(ue)for(var n of ue(e))Xe.call(e,n)&&Qe(t,n,e[n]);return t},K=(t,e)=>Kt(t,Nt(e));var ge=(t,e)=>{var n={};for(var r in t)Ye.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&ue)for(var r of ue(t))e.indexOf(r)<0&&Xe.call(t,r)&&(n[r]=t[r]);return n};import Ze from"bn.js";var Dn=new Ze(25),_n=new Ze(1e4),Rt={4:3,5:3};import{PublicKey as Vt}from"@solana/web3.js";import et,{isBN as tt}from"bn.js";import{bits as Vn,BitStructure as Fn,blob as Mt,Blob as vn,cstr as Wn,f32 as qn,f32be as Un,f64 as Gn,f64be as Hn,greedy as jn,Layout as Dt,ns64 as zn,ns64be as Qn,nu64 as Yn,nu64be as Xn,offset as Zn,s16 as Jn,s16be as $n,s24 as er,s24be as tr,s32 as nr,s32be as rr,s40 as or,s40be as ir,s48 as sr,s48be as ar,s8 as ur,seq as _t,struct as cr,Structure as Ot,u16 as mr,u16be as lr,u24 as pr,u24be as dr,u32 as fr,u32be as br,u40 as yr,u40be as gr,u48 as hr,u48be as Tr,u8 as xr,UInt as Et,union as Pr,Union as wr,unionLayoutDiscriminator as Ar,utf8 as kr}from"@solana/buffer-layout";var he=Dt,Je=Ot;var Te=Et;var $e=_t;var xe=Mt;var ce=class extends he{constructor(n,r,i){super(n,i);this.blob=xe(n),this.signed=r}decode(n,r=0){let i=new et(this.blob.decode(n,r),10,"le");return this.signed?i.fromTwos(this.span*8).clone():i}encode(n,r,i=0){return typeof n=="number"&&(n=new et(n)),this.signed&&(n=n.toTwos(this.span*8)),this.blob.encode(n.toArrayLike(Buffer,"le",this.span),r,i)}};function k(t){return new Te(1,t)}function v(t){return new Te(4,t)}function u(t){return new ce(8,!1,t)}function R(t){return new ce(16,!1,t)}var Pe=class extends he{constructor(n,r,i,m){super(n.span,m);this.layout=n,this.decoder=r,this.encoder=i}decode(n,r){return this.decoder(this.layout.decode(n,r))}encode(n,r,i){return this.layout.encode(this.encoder(n),r,i)}getSpan(n,r){return this.layout.getSpan(n,r)}};function g(t){return new Pe(xe(32),e=>new Vt(e),e=>e.toBuffer(),t)}var we=class extends Je{decode(e,n){return super.decode(e,n)}};function S(t,e,n){return new we(t,e,n)}function J(t,e,n){let r,i=typeof e=="number"?e:tt(e)?e.toNumber():new Proxy(e,{get(m,o){if(!r){let a=Reflect.get(m,"count");r=tt(a)?a.toNumber():a,Reflect.set(m,"count",r)}return Reflect.get(m,o)},set(m,o,a){return o==="count"&&(r=a),Reflect.set(m,o,a)}});return $e(t,i,n)}var Ae=S([k("instruction"),u("amountIn"),u("minAmountOut")]),ke=S([k("instruction"),u("maxAmountIn"),u("amountOut")]),vr=S([k("instruction"),k("nonce")]),Se=S([k("instruction"),k("nonce"),u("startTime")]),Ie=S([u("status"),u("nonce"),u("maxOrder"),u("depth"),u("baseDecimal"),u("quoteDecimal"),u("state"),u("resetFlag"),u("minSize"),u("volMaxCutRatio"),u("amountWaveRatio"),u("baseLotSize"),u("quoteLotSize"),u("minPriceMultiplier"),u("maxPriceMultiplier"),u("systemDecimalValue"),u("minSeparateNumerator"),u("minSeparateDenominator"),u("tradeFeeNumerator"),u("tradeFeeDenominator"),u("pnlNumerator"),u("pnlDenominator"),u("swapFeeNumerator"),u("swapFeeDenominator"),u("baseNeedTakePnl"),u("quoteNeedTakePnl"),u("quoteTotalPnl"),u("baseTotalPnl"),u("poolOpenTime"),u("punishPcAmount"),u("punishCoinAmount"),u("orderbookToInitTime"),R("swapBaseInAmount"),R("swapQuoteOutAmount"),u("swapBase2QuoteFee"),R("swapQuoteInAmount"),R("swapBaseOutAmount"),u("swapQuote2BaseFee"),g("baseVault"),g("quoteVault"),g("baseMint"),g("quoteMint"),g("lpMint"),g("openOrders"),g("marketId"),g("marketProgramId"),g("targetOrders"),g("withdrawQueue"),g("lpVault"),g("owner"),u("lpReserve"),J(u(),3,"padding")]),Ft=S([u("accountType"),u("status"),u("nonce"),u("maxOrder"),u("depth"),u("baseDecimal"),u("quoteDecimal"),u("state"),u("resetFlag"),u("minSize"),u("volMaxCutRatio"),u("amountWaveRatio"),u("baseLotSize"),u("quoteLotSize"),u("minPriceMultiplier"),u("maxPriceMultiplier"),u("systemDecimalsValue"),u("abortTradeFactor"),u("priceTickMultiplier"),u("priceTick"),u("minSeparateNumerator"),u("minSeparateDenominator"),u("tradeFeeNumerator"),u("tradeFeeDenominator"),u("pnlNumerator"),u("pnlDenominator"),u("swapFeeNumerator"),u("swapFeeDenominator"),u("baseNeedTakePnl"),u("quoteNeedTakePnl"),u("quoteTotalPnl"),u("baseTotalPnl"),u("poolOpenTime"),u("punishPcAmount"),u("punishCoinAmount"),u("orderbookToInitTime"),R("swapBaseInAmount"),R("swapQuoteOutAmount"),R("swapQuoteInAmount"),R("swapBaseOutAmount"),u("swapQuote2BaseFee"),u("swapBase2QuoteFee"),g("baseVault"),g("quoteVault"),g("baseMint"),g("quoteMint"),g("lpMint"),g("modelDataAccount"),g("openOrders"),g("marketId"),g("marketProgramId"),g("targetOrders"),g("owner"),J(u(),64,"padding")]),Be=S([k("instruction"),u("baseAmountIn"),u("quoteAmountIn"),u("fixedSide"),u("otherAmountMin")]),Le=S([k("instruction"),u("lpAmount"),u("baseAmountMin"),u("quoteAmountMin")]),Wr={4:Ie,5:Ft},qr=S([u("fee")]);import{PublicKey as se}from"@solana/web3.js";import ie from"bn.js";import ye from"decimal.js";import{TOKEN_PROGRAM_ID as Cn}from"@solana/spl-token";import{ComputeBudgetProgram as Yr,Keypair as Jr,PublicKey as ot,Transaction as Ke,TransactionMessage as to,VersionedTransaction as no}from"@solana/web3.js";import{get as nt,set as vt}from"lodash";var Ce=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:0,this.name=e.name}set level(e){this.logLevel=e}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let n=e.map(r=>typeof r=="object"?JSON.stringify(r):r).join(", ");throw new Error(n)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},rt={},Wt={};function I(t){let e=nt(rt,t);if(!e){let n=nt(Wt,t);e=new Ce({name:t,logLevel:n}),vt(rt,t,e)}return e}var $={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",ClmmLockPosition:"ClmmLockPosition",ClmmHarvestLockPosition:"ClmmHarvestLockPosition",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV4Withdraw:"FarmV4Withdraw",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut",CpmmLockLp:"CpmmLockLp",CpmmCollectLockFee:"CpmmCollectLockFee",TransferTip:"TransferTip"};import{TOKEN_PROGRAM_ID as so}from"@solana/spl-token";var M=I("Raydium_txUtil"),qt=1644;function Ut(t,e){t.length<1&&M.logWithError(`no instructions provided: ${t.toString()}`),e.length<1&&M.logWithError(`no signers provided:, ${e.toString()}`);let n=new Ke;n.recentBlockhash="11111111111111111111111111111111",n.feePayer=e[0],n.add(...t);try{return Buffer.from(n.serialize({verifySignatures:!1})).toString("base64").length<qt}catch{return!1}}async function it(t,e,n,r=!0){let i=new ot("RaydiumSimuLateTransaction11111111111111111"),m=[],o=new Ke;o.feePayer=i;for(let l of e)Ut([...o.instructions,l],[i])||(m.push(o),o=new Ke,o.feePayer=i),o.add(l);o.instructions.length>0&&m.push(o);let a=[];try{if(a=await Gt(t,m,r),a.find(l=>l.err!==null))throw Error("rpc simulateTransaction error")}catch(l){l instanceof Error&&M.logWithError("failed to simulate for instructions","RPC_ERROR",{message:l.message})}let c=[];for(let l of a)if(M.debug("simulate result:",l),l.logs){let p=l.logs.filter(y=>y&&y.includes(n));M.debug("filteredLog:",c),p.length||M.logWithError("simulate log not match keyword","keyword",n),c.push(...p)}return c}function st(t,e){let n=t.match(/{["\w:,]+}/g);return!n||n.length!==1?M.logWithError(`simulate log fail to match json, keyword: ${e}`):n[0]}function D(t,e){let r=new RegExp(`"${e}":(\\d+)`,"g").exec(t);return!r||r.length!==2?M.logWithError(`simulate log fail to match key", key: ${e}`):r[1]}function z(t,e){let[n,r]=ot.findProgramAddressSync(t,e);return{publicKey:n,nonce:r}}async function Gt(t,e,n){let r=[];if(n){let i=await t.getLatestBlockhash(),m=[];for(let l of e){l.recentBlockhash=i.blockhash,l.lastValidBlockHeight=i.lastValidBlockHeight;let y=l._compile().serialize(),P=l._serialize(y).toString("base64");m.push(P)}let o=m.map(l=>{let p=t._buildArgs([l],void 0,"base64");return{methodName:"simulateTransaction",args:p}}),a=[],c=20;for(let l=0;l<Math.ceil(o.length/c);l++)a.push(o.slice(l*c,(l+1)*c));r=await(await Promise.all(a.map(async l=>(await t._rpcBatchRequest(l)).map(p=>p.result.value)))).flat()}else try{r=await Promise.all(e.map(async i=>await(await t.simulateTransaction(i)).value))}catch(i){i instanceof Error&&M.logWithError("failed to get info for multiple accounts","RPC_ERROR",{message:i.message})}return r}import{PublicKey as fu}from"@solana/web3.js";import{MintLayout as yu,TOKEN_PROGRAM_ID as hu}from"@solana/spl-token";import cn from"big.js";import de from"bn.js";import E from"bn.js";import wi from"decimal.js";import{PublicKey as Ht}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as at}from"@solana/spl-token";var Ne={chainId:101,address:Ht.default.toBase58(),programId:at.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},_={chainId:101,address:"So11111111111111111111111111111111111111112",programId:at.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};import{PublicKey as Oe}from"@solana/web3.js";import{PublicKey as A,SystemProgram as ut,SYSVAR_RENT_PUBKEY as jt}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as zt}from"@solana/spl-token";function s({pubkey:t,isSigner:e=!1,isWritable:n=!0}){return{pubkey:t,isWritable:n,isSigner:e}}var bo=[s({pubkey:zt,isWritable:!1}),s({pubkey:ut.programId,isWritable:!1}),s({pubkey:jt,isWritable:!1})];function Me({publicKey:t,transformSol:e}){let n=De(t.toString());if(n instanceof A)return e&&n.equals(ee)?Re:n;if(e&&n.toString()===ee.toBase58())return Re;if(typeof n=="string"){if(n===A.default.toBase58())return A.default;try{return new A(n)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function De(t){try{return new A(t)}catch{return t}}var yo=new A("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),go=new A("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),ct=new A("SysvarRent111111111111111111111111111111111"),ho=new A("SysvarC1ock11111111111111111111111111111111"),To=new A("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),xo=new A("Sysvar1nstructions1111111111111111111111111"),Po=ut.programId,wo=new A("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),Ao=new A("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),ko=new A("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),So=new A("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),Io=new A("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),Bo=new A("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),Lo=new A("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),Co=new A("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),Ko=new A("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),No=new A("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),Ro=new A("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),Re=new A("So11111111111111111111111111111111111111112"),ee=A.default;function _e(t){return Me({publicKey:t,transformSol:!0})}var Ee=class{constructor({mint:e,decimals:n,symbol:r,name:i,skipMint:m=!1,isToken2022:o=!1}){if(e===ee.toBase58()||e instanceof Oe&&ee.equals(e)){this.decimals=_.decimals,this.symbol=_.symbol,this.name=_.name,this.mint=new Oe(_.address),this.isToken2022=!1;return}this.decimals=n,this.symbol=r||e.toString().substring(0,6),this.name=i||e.toString().substring(0,6),this.mint=m?Oe.default:Me({publicKey:e}),this.isToken2022=o}equals(e){return this===e?!0:this.mint.equals(e.mint)}},F=Ee;F.WSOL=new Ee(K(C({},_),{mint:_.address}));var Ve=class{constructor({decimals:e,symbol:n="UNKNOWN",name:r="UNKNOWN"}){this.decimals=e,this.symbol=n,this.name=r}equals(e){return this===e}},me=Ve;me.SOL=new Ve(Ne);import pe from"big.js";import Zt from"bn.js";import Jt from"decimal.js-light";import te from"bn.js";var mt=9007199254740991;function x(t){let e=I("Raydium_parseBigNumberish");if(t instanceof te)return t;if(typeof t=="string"){if(t.match(/^-?[0-9]+$/))return new te(t);e.logWithError(`invalid BigNumberish string: ${t}`)}return typeof t=="number"?(t%1&&e.logWithError(`BigNumberish number underflow: ${t}`),(t>=mt||t<=-mt)&&e.logWithError(`BigNumberish number overflow: ${t}`),new te(String(t))):typeof t=="bigint"?new te(t.toString()):(e.error(`invalid BigNumberish value: ${t}`),new te(0))}import Qt from"toformat";var Yt=Qt,ne=Yt;var le=I("module/fraction"),Fe=ne(pe),re=ne(Jt),$t={[0]:re.ROUND_DOWN,[1]:re.ROUND_HALF_UP,[2]:re.ROUND_UP},en={[0]:pe.roundDown,[1]:pe.roundHalfUp,[2]:pe.roundUp},h=class{constructor(e,n=new Zt(1)){this.numerator=x(e),this.denominator=x(n)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new h(this.denominator,this.numerator)}add(e){let n=e instanceof h?e:new h(x(e));return this.denominator.eq(n.denominator)?new h(this.numerator.add(n.numerator),this.denominator):new h(this.numerator.mul(n.denominator).add(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}sub(e){let n=e instanceof h?e:new h(x(e));return this.denominator.eq(n.denominator)?new h(this.numerator.sub(n.numerator),this.denominator):new h(this.numerator.mul(n.denominator).sub(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}mul(e){let n=e instanceof h?e:new h(x(e));return new h(this.numerator.mul(n.numerator),this.denominator.mul(n.denominator))}div(e){let n=e instanceof h?e:new h(x(e));return new h(this.numerator.mul(n.denominator),this.denominator.mul(n.numerator))}toSignificant(e,n={groupSeparator:""},r=1){Number.isInteger(e)||le.logWithError(`${e} is not an integer.`),e<=0&&le.logWithError(`${e} is not positive.`),re.set({precision:e+1,rounding:$t[r]});let i=new re(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return i.toFormat(i.decimalPlaces(),n)}toFixed(e,n={groupSeparator:""},r=1){return Number.isInteger(e)||le.logWithError(`${e} is not an integer.`),e<0&&le.logWithError(`${e} is negative.`),Fe.DP=e,Fe.RM=en[r]||1,new Fe(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,n)}isZero(){return this.numerator.isZero()}};import tn from"bn.js";var lt=new h(new tn(100)),Q=class extends h{toSignificant(e=5,n,r){return this.mul(lt).toSignificant(e,n,r)}toFixed(e=2,n,r){return this.mul(lt).toFixed(e,n,r)}};var nn=I("Raydium_price"),O=class extends h{constructor(n){let{baseToken:r,quoteToken:i,numerator:m,denominator:o}=n;super(m,o);this.baseToken=r,this.quoteToken=i,this.scalar=new h(ve(r.decimals),ve(i.decimals))}get raw(){return new h(this.numerator,this.denominator)}get adjusted(){return super.mul(this.scalar)}invert(){return new O({baseToken:this.quoteToken,quoteToken:this.baseToken,denominator:this.numerator,numerator:this.denominator})}mul(n){this.quoteToken!==n.baseToken&&nn.logWithError("mul token not equals");let r=super.mul(n);return new O({baseToken:this.baseToken,quoteToken:n.quoteToken,denominator:r.denominator,numerator:r.numerator})}toSignificant(n=this.quoteToken.decimals,r,i){return this.adjusted.toSignificant(n,r,i)}toFixed(n=this.quoteToken.decimals,r,i){return this.adjusted.toFixed(n,r,i)}};import{PublicKey as rn}from"@solana/web3.js";import on from"bn.js";function pt(t){return typeof t=="object"&&t!==null&&![F,N,rn,h,on,O,Q].some(e=>typeof e=="object"&&t instanceof e)}function W(t){return typeof t=="string"?De(t):Array.isArray(t)?t.map(e=>W(e)):pt(t)?Object.fromEntries(Object.entries(t).map(([e,n])=>[e,W(n)])):t}var We=new E(0),dt=new E(1),Ri=new E(2),Mi=new E(3),Di=new E(5),qe=new E(10),_i=new E(100),Oi=new E(1e3),Ei=new E(1e4);function ve(t){return qe.pow(x(t))}import{PublicKey as Gi}from"@solana/web3.js";import{MINT_SIZE as Qi,TOKEN_PROGRAM_ID as Yi,getTransferFeeConfig as Xi,unpackMint as Zi}from"@solana/spl-token";var Ji=I("Raydium_accountInfo_util");import{PublicKey as is}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as as}from"@solana/spl-token";import{PublicKey as d}from"@solana/web3.js";var ls=new d("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),ps=new d("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),ds=new d("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),fs=new d("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),bs=new d("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),ys=new d("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),gs=new d("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),hs=new d("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),Ts=new d("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),xs=new d("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Ps=new d("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),ws=new d("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),As=new d("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),q=new d("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),ks=new d("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),Ss=new d("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),Is=new d("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),Bs=new d("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),Ls=new d("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),Cs=new d("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),Ks=new d("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),Ns=new d("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),Rs=new d("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),Ms=new d("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),Ds=new d("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),_s=new d("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),Os=new d("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),Es=new d("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),Vs=new d("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),Fs=new d("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),vs=new d("6s1xP3hpbAfFoNtUNF8mfHsjr2Bd97JxFJRWLbL6aHuX");var Ws={OPEN_BOOK_PROGRAM:new d("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),SERUM_PROGRAM_ID_V3:new d("Ray1111111111111111111111111111111111111111"),AMM_V4:new d("DRaya7Kj3aMWQSy19kSjvmuwq9docCHofyP9kanQGaav"),AMM_STABLE:new d("DRayDdXc1NZQ9C3hRWmoSf8zK4iapgMnjdNZWrfwsP8m"),CLMM_PROGRAM_ID:new d("DRayAUgENGQBKVaX8owNhgzkEDyoHTGVEGHVJT1E9pfH"),CLMM_LOCK_PROGRAM_ID:new d("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),CLMM_LOCK_AUTH_ID:new d("6Aoh8h2Lw2m5UGxYR8AdAL87jTWYeKoxM52mJRzfYwN"),CREATE_CPMM_POOL_PROGRAM:new d("DRaycpLY18LhpbydsBWbVJtxpNv9oXPgjRSfpF2bWpYb"),CREATE_CPMM_POOL_AUTH:new d("CXniRufdq5xL8t8jZAPxsPZDpuudwuJSPWnbcD5Y5Nxq"),CREATE_CPMM_POOL_FEE_ACC:new d("3oE58BKVt8KuYkGxx8zBojugnymWmBiyafWgMrnb6eYy"),LOCK_CPMM_PROGRAM:new d("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),LOCK_CPMM_AUTH:new d("7qWVV8UY2bRJfDLP4s37YzBPKUkVB46DStYJBpYbQzu3"),UTIL1216:d.default,Router:new d("DRaybByLpbUL57LJARs3j8BitTxVfzBg351EaMr5UTCd"),FARM_PROGRAM_ID_V3:new d("DRayWyrLmEW5KEeqs8kdTMMaBabapqagaBC7KWpGtJeZ"),FARM_PROGRAM_ID_V4:new d("Ray1111111111111111111111111111111111111111"),FARM_PROGRAM_ID_V5:new d("DRayiCGSZgku1GTK6rXD6mVDdingXy6APAH1R6R5L2LC"),FARM_PROGRAM_ID_V6:new d("DRayzbYakXs45ELHkzH6vC3fuhQqTAnv5A68gdFuvZyZ"),LAUNCHPAD_PROGRAM:new d("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),LAUNCHPAD_AUTH:new d("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),LAUNCHPAD_PLATFORM:new d("2Jx4KTDrVSdWNazuGpcA8n3ZLTRGGBDxAWhuKe2Xcj2a"),LAUNCHPAD_CONFIG:new d("7ZR4zD7PYfY2XxoG1Gxcy2EgEeGYrpxrwzPuwdUBssEt"),FEE_DESTINATION_ID:new d("9y8ENuuZ3b19quffx9hQvRVygG5ky6snHfRvGpuSfeJy"),MODEL_DATA_PUBKEY:new d("Ray1111111111111111111111111111111111111111")};import Gs from"bn.js";import{PublicKey as sn,AddressLookupTableAccount as ft}from"@solana/web3.js";var an={AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU:new ft({key:new sn("AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU"),state:ft.deserialize(Buffer.from("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","base64"))})};import{PublicKey as ca,sendAndConfirmTransaction as ma,SystemProgram as da,Transaction as fa,TransactionMessage as ya,VersionedTransaction as ga}from"@solana/web3.js";import Ta from"axios";import un from"bn.js";var Ia=new un(1e6);var mn=I("Raydium_amount"),bt=ne(cn);function ln(t,e){let n="0",r="0";if(t.includes(".")){let i=t.split(".");i.length===2?([n,r]=i,r=r.padEnd(e,"0")):mn.logWithError(`invalid number string, num: ${t}`)}else n=t;return[n,r.slice(0,e)||r]}var N=class extends h{constructor(n,r,i=!0,m){let o=new de(0),a=qe.pow(new de(n.decimals));if(i)o=x(r);else{let c=new de(0),l=new de(0);if(typeof r=="string"||typeof r=="number"||typeof r=="bigint"){let[p,y]=ln(r.toString(),n.decimals);c=x(p),l=x(y)}c=c.mul(a),o=c.add(l)}super(o,a);this.logger=I(m||"TokenAmount"),this.token=n}get raw(){return this.numerator}isZero(){return this.raw.isZero()}gt(n){return this.token.equals(n.token)||this.logger.logWithError("gt token not equals"),this.raw.gt(n.raw)}lt(n){return this.token.equals(n.token)||this.logger.logWithError("lt token not equals"),this.raw.lt(n.raw)}add(n){return this.token.equals(n.token)||this.logger.logWithError("add token not equals"),new N(this.token,this.raw.add(n.raw))}subtract(n){return this.token.equals(n.token)||this.logger.logWithError("sub token not equals"),new N(this.token,this.raw.sub(n.raw))}toSignificant(n=this.token.decimals,r,i=0){return super.toSignificant(n,r,i)}toFixed(n=this.token.decimals,r,i=0){return n>this.token.decimals&&this.logger.logWithError("decimals overflow"),super.toFixed(n,r,i)}toExact(n={groupSeparator:""}){return bt.DP=this.token.decimals,new bt(this.numerator.toString()).div(this.denominator.toString()).toFormat(n)}};var fe=i=>{var m=i,{address:t,programId:e,decimals:n}=m,r=ge(m,["address","programId","decimals"]);return C({chainId:101,address:_e(t).toBase58(),programId:e,logoURI:"",symbol:"",name:"",decimals:n,tags:[],extensions:r.extensions||{}},r)};import{PublicKey as T,SystemProgram as gt,SYSVAR_RENT_PUBKEY as pn,TransactionInstruction as V}from"@solana/web3.js";import{ASSOCIATED_TOKEN_PROGRAM_ID as dn,TOKEN_PROGRAM_ID as Y}from"@solana/spl-token";var yt=I("Raydium_liquidity_instruction");function Mu(t){let{poolInfo:e,poolKeys:n,userKeys:r,baseAmountIn:i,quoteAmountIn:m,fixedSide:o,otherAmountMin:a,modelDataPubKey:c=q}=t,l=Buffer.alloc(Be.span);Be.encode({instruction:3,baseAmountIn:x(i),quoteAmountIn:x(m),otherAmountMin:x(a),fixedSide:o==="base"?We:dt},l);let p=[s({pubkey:Y,isWritable:!1}),s({pubkey:new T(e.id)}),s({pubkey:new T(n.authority),isWritable:!1}),s({pubkey:new T(n.openOrders),isWritable:!1}),s({pubkey:new T(n.targetOrders)}),s({pubkey:new T(e.lpMint.address)}),s({pubkey:new T(n.vault.A)}),s({pubkey:new T(n.vault.B)})];return e.pooltype.includes("StablePool")&&p.push(s({pubkey:c})),p.push(s({pubkey:new T(e.marketId),isWritable:!1}),s({pubkey:r.baseTokenAccount}),s({pubkey:r.quoteTokenAccount}),s({pubkey:r.lpTokenAccount}),s({pubkey:r.owner,isWritable:!1,isSigner:!0}),s({pubkey:new T(n.marketEventQueue),isWritable:!1})),new V({programId:new T(e.programId),keys:p,data:l})}function Du(t){let{poolInfo:e,poolKeys:n,userKeys:r,lpAmount:i,baseAmountMin:m,quoteAmountMin:o,modelDataPubKey:a=q}=t,c=W(n),l=4;if(e.pooltype.includes("StablePool")&&(l=5),l===4||l===5){let p=Buffer.alloc(Le.span);Le.encode({instruction:4,lpAmount:x(i),baseAmountMin:x(m),quoteAmountMin:x(o)},p);let y=[s({pubkey:Y,isWritable:!1}),s({pubkey:c.id}),s({pubkey:c.authority,isWritable:!1}),s({pubkey:c.openOrders}),s({pubkey:c.targetOrders}),s({pubkey:c.mintLp.address}),s({pubkey:c.vault.A}),s({pubkey:c.vault.B})];return l===5?y.push(s({pubkey:a})):(y.push(s({pubkey:c.id})),y.push(s({pubkey:c.id}))),y.push(s({pubkey:c.marketProgramId,isWritable:!1}),s({pubkey:c.marketId}),s({pubkey:c.marketBaseVault}),s({pubkey:c.marketQuoteVault}),s({pubkey:c.marketAuthority,isWritable:!1}),s({pubkey:r.lpTokenAccount}),s({pubkey:r.baseTokenAccount}),s({pubkey:r.quoteTokenAccount}),s({pubkey:r.owner,isWritable:!1,isSigner:!0}),s({pubkey:c.marketEventQueue}),s({pubkey:c.marketBids}),s({pubkey:c.marketAsks})),new V({programId:c.programId,keys:y,data:p})}return new V({programId:c.programId,keys:[]})}function _u({programId:t,ammId:e,ammAuthority:n,ammOpenOrders:r,lpMint:i,coinMint:m,pcMint:o,coinVault:a,pcVault:c,withdrawQueue:l,ammTargetOrders:p,poolTempLp:y,marketProgramId:w,marketId:P,userWallet:B,userCoinVault:L,userPcVault:X,userLpVault:Z,nonce:j,openTime:ae,coinAmount:kt,pcAmount:St,ammConfigId:It,feeDestinationId:Bt}){let je=S([k("instruction"),k("nonce"),u("openTime"),u("pcAmount"),u("coinAmount")]),Lt=[{pubkey:Y,isSigner:!1,isWritable:!1},{pubkey:dn,isSigner:!1,isWritable:!1},{pubkey:gt.programId,isSigner:!1,isWritable:!1},{pubkey:ct,isSigner:!1,isWritable:!1},{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:It,isSigner:!1,isWritable:!1},{pubkey:Bt,isSigner:!1,isWritable:!0},{pubkey:w,isSigner:!1,isWritable:!1},{pubkey:P,isSigner:!1,isWritable:!1},{pubkey:B,isSigner:!0,isWritable:!0},{pubkey:L,isSigner:!1,isWritable:!0},{pubkey:X,isSigner:!1,isWritable:!0},{pubkey:Z,isSigner:!1,isWritable:!0}],ze=Buffer.alloc(je.span);return je.encode({instruction:1,nonce:j,openTime:ae,coinAmount:kt,pcAmount:St},ze),{instruction:new V({keys:Lt,programId:t,data:ze}),instructionType:$.AmmV4CreatePool}}function Ou(t){let e=S([k("instruction"),k("simulateType")]),n=Buffer.alloc(e.span);e.encode({instruction:12,simulateType:0},n);let r=[s({pubkey:new T(t.id),isWritable:!1}),s({pubkey:new T(t.authority),isWritable:!1}),s({pubkey:new T(t.openOrders),isWritable:!1}),s({pubkey:new T(t.vault.A),isWritable:!1}),s({pubkey:new T(t.vault.B),isWritable:!1}),s({pubkey:new T(t.mintLp.address),isWritable:!1}),s({pubkey:new T(t.marketId),isWritable:!1}),s({pubkey:new T(t.marketEventQueue),isWritable:!1})];return new V({programId:new T(t.programId),keys:r,data:n})}function fn({poolKeys:t,userKeys:e,amountIn:n,minAmountOut:r,modelDataPubKey:i=q},m){let o=W(t),a=Buffer.alloc(Ae.span);Ae.encode({instruction:9,amountIn:x(n),minAmountOut:x(r)},a);let c=[s({pubkey:Y,isWritable:!1}),s({pubkey:o.id}),s({pubkey:o.authority,isWritable:!1}),s({pubkey:o.openOrders})];return m===4&&c.push(s({pubkey:o.targetOrders})),c.push(s({pubkey:o.vault.A}),s({pubkey:o.vault.B})),m===5&&c.push(s({pubkey:i})),c.push(s({pubkey:o.marketProgramId,isWritable:!1}),s({pubkey:o.marketId}),s({pubkey:o.marketBids}),s({pubkey:o.marketAsks}),s({pubkey:o.marketEventQueue}),s({pubkey:o.marketBaseVault}),s({pubkey:o.marketQuoteVault}),s({pubkey:o.marketAuthority,isWritable:!1}),s({pubkey:e.tokenAccountIn}),s({pubkey:e.tokenAccountOut}),s({pubkey:e.owner,isWritable:!1,isSigner:!0})),new V({programId:o.programId,keys:c,data:a})}function bn({poolKeys:t,userKeys:e,maxAmountIn:n,amountOut:r,modelDataPubKey:i=q},m){let o=W(t),a=Buffer.alloc(ke.span);ke.encode({instruction:11,maxAmountIn:x(n),amountOut:x(r)},a);let c=[s({pubkey:Y,isWritable:!1}),s({pubkey:o.id}),s({pubkey:o.authority,isWritable:!1}),s({pubkey:o.openOrders}),s({pubkey:o.targetOrders}),s({pubkey:o.vault.A}),s({pubkey:o.vault.B})];return m===5&&c.push(s({pubkey:i})),c.push(s({pubkey:o.marketProgramId,isWritable:!1}),s({pubkey:o.marketId}),s({pubkey:o.marketBids}),s({pubkey:o.marketAsks}),s({pubkey:o.marketEventQueue}),s({pubkey:o.marketBaseVault}),s({pubkey:o.marketQuoteVault}),s({pubkey:o.marketAuthority,isWritable:!1}),s({pubkey:e.tokenAccountIn}),s({pubkey:e.tokenAccountOut}),s({pubkey:e.owner,isWritable:!1,isSigner:!0})),new V({programId:o.programId,keys:c,data:a})}function Eu(t){let{poolKeys:e,version:n,userKeys:r,amountIn:i,amountOut:m,fixedSide:o}=t;if(n===4||n===5){let a={poolKeys:e,userKeys:r};if(o==="in")return fn(K(C({},a),{amountIn:i,minAmountOut:m}),n);if(o==="out")return bn(K(C({},a),{maxAmountIn:i,amountOut:m}),n);yt.logWithError("invalid params","params",t)}throw yt.logWithError("invalid version","poolKeys.version",n),new Error("invalid version")}function Vu({poolKeys:t,userKeys:e,startTime:n}){let r=Buffer.alloc(Se.span);Se.encode({instruction:0,nonce:5,startTime:x(n)},r);let i=W(t),m=[s({pubkey:Y,isWritable:!1}),s({pubkey:gt.programId,isWritable:!1}),s({pubkey:pn,isWritable:!1}),s({pubkey:i.id}),s({pubkey:i.authority,isWritable:!1}),s({pubkey:i.openOrders}),s({pubkey:i.mintLp.address}),s({pubkey:i.mintA.address,isWritable:!1}),s({pubkey:i.mintB.address,isWritable:!1}),s({pubkey:i.vault.A,isWritable:!1}),s({pubkey:i.vault.B,isWritable:!1}),s({pubkey:i.id}),s({pubkey:i.targetOrders}),s({pubkey:e.lpTokenAccount}),s({pubkey:i.id,isWritable:!1}),s({pubkey:i.marketProgramId,isWritable:!1}),s({pubkey:i.marketId,isWritable:!1}),s({pubkey:e.payer,isSigner:!0})];return new V({programId:i.programId,keys:m,data:r})}function ht({poolKeys:t}){let e=S([k("instruction"),k("simulateType")]),n=Buffer.alloc(e.span);e.encode({instruction:12,simulateType:0},n);let r=[s({pubkey:new T(t.id),isWritable:!1}),s({pubkey:new T(t.authority),isWritable:!1}),s({pubkey:new T(t.openOrders),isWritable:!1}),s({pubkey:new T(t.vault.A),isWritable:!1}),s({pubkey:new T(t.vault.B),isWritable:!1}),s({pubkey:new T(t.mintLp.address),isWritable:!1}),s({pubkey:new T(t.marketId),isWritable:!1}),s({pubkey:new T(t.marketEventQueue),isWritable:!1})];return{instruction:new V({programId:new T(t.programId),keys:r,data:n})}}import{PublicKey as yn}from"@solana/web3.js";var gn=I("Raydium_liquidity_serum");function Tt({programId:t,marketId:e}){let n=[e.toBuffer()],r=0,i;for(;r<100;){try{let m=n.concat(Buffer.from([r]),Buffer.alloc(7));i=yn.createProgramAddressSync(m,t)}catch(m){if(m instanceof TypeError)throw m;r++;continue}return{publicKey:i,nonce:r}}throw gn.logWithError("unable to find a viable program address nonce","params",{programId:t,marketId:e}),new Error("unable to find a viable program address nonce")}var G=5e4,hn=S([u("x"),u("y"),u("price")]),Tn=S([u("accountType"),u("status"),u("multiplier"),u("validDataCount"),J(hn,G,"DataElement")]);function xn(t,e){return[0,G-2]}function Pn(t){return[0,G-2]}function wn(t){return[0,G-2]}function An(t,e,n){let[r,i]=xn(e,n),m=r,o=i,a=0,c=e*t.multiplier/n;for(;m<=o;){if(a=Math.floor((o+m)/2),a===0||a>=G-2)return[a,a,!1];let l=t.DataElement[a].x*t.multiplier/t.DataElement[a].y,p=t.DataElement[a-1].x*t.multiplier/t.DataElement[a-1].y,y=t.DataElement[a+1].x*t.multiplier/t.DataElement[a+1].y;if(c===l)return[a,a,!0];if(c===p)return[a-1,a-1,!0];if(c===y)return[a+1,a+1,!0];if(c<p)o=a-1;else{if(c>p&&c<l)return[a-1,a,!0];if(c>l&&c<y)return[a,a+1,!0];m=a+1}}return[a,a,!1]}function Ue(t,e,n){let[r,i,m]=An(t,e,n);if(!m)return 0;if(r===i){let o=t.DataElement[r].x;return e*t.multiplier/o}else{let o=t.DataElement[r].x,a=t.DataElement[r].y,c=t.DataElement[i].x,l=t.DataElement[i].y,p=n*(c*a-o*l),y=o*p,w=(c-o)*(e*a-o*n)*l,P=y+w;return e*t.multiplier*p/P}}function U(t,e,n){return e*t.multiplier/n}function xt(t,e,n){return e*n/t.multiplier}function kn(t,e){let[n,r]=Pn(e),i=n,m=r,o=0,a=e;for(;i<m;){if(o=Math.floor((m+i)/2),o<=0||o>G-2)return[o,o,!1];let c=t.DataElement[o].x,l=t.DataElement[o-1].x,p=t.DataElement[o+1].x;if(a===c)return[o,o,!0];if(a===l)return[o-1,o-1,!0];if(a===p)return[o+1,o+1,!0];if(a<l)m=o-1;else{if(a>l&&a<c)return[o-1,o,!0];if(a>c&&a<p)return[o,o+1,!0];i=o+1}}return[o,o,!1]}function Sn(t,e){let[n,r]=wn(e),i=n,m=r,o=0,a=e;for(;i<=m;){if(o=Math.floor((m+i)/2),o<=0||o>=G-2)return[o,o,!1];let c=t.DataElement[o].y,l=t.DataElement[o-1].y,p=t.DataElement[o+1].y;if(a===c)return[o,o,!0];if(a===l)return[o-1,o-1,!0];if(a===p)return[o+1,o+1,!0];if(a<p)i=o+1;else{if(a<l&&a>c)return[o-1,o,!0];if(a<c&&a>p)return[o,o+1,!0];m=o-1}}return[o,o,!1]}function Pt(t,e,n,r){let i=r?e+n:e-n,[m,o,a]=kn(t,i);if(!a)return[0,0,!1,a];if(m===o)return[t.DataElement[o].price,t.DataElement[o].y,!1,a];{let c=t.DataElement[m].x,l=t.DataElement[o].x,p=t.DataElement[m].price,y=t.DataElement[o].price,w=t.DataElement[m].y,P=t.DataElement[o].y;if(e>=c&&e<=l)return r?[y,P,!0,a]:[p,w,!0,a];{let B,L;return r?(B=p+(y-p)*(e-c)/(l-c),L=w-(i-c)*t.multiplier/y):(B=p+(y-p)*(e-c)/(l-c),L=P+(l-i)*t.multiplier/p),[B,L,!1,a]}}}function In(t,e,n,r){let i=r?e-n:e+n,[m,o,a]=Sn(t,i);if(!a)return[0,0,!1,a];if(m===o)return[t.DataElement[o].price,t.DataElement[o].x,!1,a];{let c=t.DataElement[m].x,l=t.DataElement[o].x,p=t.DataElement[m].price,y=t.DataElement[o].price,w=t.DataElement[m].y,P=t.DataElement[o].y;if(e>=P&&e<=w)return r?[y,l,!0,a]:[p,c,!0,a];{let B,L;return r?(B=p+(y-p)*(w-e)/(w-P),L=c+y*(w-i)/t.multiplier):(B=p+(y-p)*(w-e)/(w-P),L=l-p*(i-P)/t.multiplier),[B,L,!1,a]}}}function Bn(t,e){let n=Pt(t,e,0,!1);return n[3]?n[0]:0}function ju(t,e,n,r){let i=Ue(t,e,n),m=U(t,e,i),o=U(t,n,i),a=U(t,r,i),c=!0,[l,p,y,w]=Pt(t,m,a,c);if(!w)return 0;if(y)return r*t.multiplier/l;{let P=o-p;return xt(t,P,i)}}function zu(t,e,n,r){let i=Ue(t,e,n),m=U(t,e,i),o=U(t,n,i),a=U(t,r,i),c=!1,[l,p,y,w]=In(t,o,a,c);if(!w)return 0;if(y)return r*l/t.multiplier;{let P=m-p;return xt(t,P,i)}}function Ln(t){let e=Tn.decode(t);return{accountType:e.accountType.toNumber(),status:e.status.toNumber(),multiplier:e.multiplier.toNumber(),validDataCount:e.validDataCount.toNumber(),DataElement:e.DataElement.map(n=>({x:n.x.toNumber(),y:n.y.toNumber(),price:n.price.toNumber()}))}}function Qu(t,e,n,r){let i=Bn(t,U(t,e,Ue(t,e,n)))/t.multiplier;return r?i:1/i}var be=class{constructor({connection:e,modelDataPubKey:n=q}){this._layoutData={accountType:0,status:0,multiplier:0,validDataCount:0,DataElement:[]};this.connection=e,this.modelDataPubKey=n}get stableModelData(){return this._layoutData}async initStableModelLayout(){if(this._layoutData.validDataCount===0&&this.connection){let e=await this.connection.getAccountInfo(this.modelDataPubKey);e&&(this._layoutData=Ln(e==null?void 0:e.data))}}};var oe=S([g("mint"),g("owner"),u("amount"),v("delegateOption"),g("delegate"),k("state"),v("isNativeOption"),u("isNative"),u("delegatedAmount"),v("closeAuthorityOption"),g("closeAuthority")]);import{Keypair as nc,PublicKey as rc}from"@solana/web3.js";import sc from"bn.js";import{TOKEN_PROGRAM_ID as cc}from"@solana/spl-token";var lc=I("Raydium_Util");import{PublicKey as gc,SystemProgram as Tc}from"@solana/web3.js";import wc from"bn.js";import{createCloseAccountInstruction as Ic,createInitializeAccountInstruction as Bc,createTransferInstruction as Lc,TOKEN_PROGRAM_ID as Cc}from"@solana/spl-token";var wt=S([v("mintAuthorityOption"),g("mintAuthority"),u("supply"),k("decimals"),k("isInitialized"),v("freezeAuthorityOption"),g("freezeAuthority")]);function At({programId:t}){let{publicKey:e}=z([Buffer.from("amm_config_account_seed","utf-8")],t);return e}function H({name:t,programId:e,marketId:n}){let{publicKey:r}=z([e.toBuffer(),n.toBuffer(),Buffer.from(t,"utf-8")],e);return r}function Kn({programId:t,marketId:e}){let{publicKey:n}=z([t.toBuffer(),e.toBuffer(),Buffer.from("open_order_associated_seed","utf-8")],t);return n}function Nn({programId:t}){return z([Buffer.from([97,109,109,32,97,117,116,104,111,114,105,116,121])],t)}function sm({version:t,marketVersion:e,marketId:n,baseMint:r,quoteMint:i,baseDecimals:m,quoteDecimals:o,programId:a,marketProgramId:c}){let l=H({name:"amm_associated_seed",programId:a,marketId:n}),p=H({name:"lp_mint_associated_seed",programId:a,marketId:n}),{publicKey:y,nonce:w}=Nn({programId:a}),P=H({name:"coin_vault_associated_seed",programId:a,marketId:n}),B=H({name:"pc_vault_associated_seed",programId:a,marketId:n}),L=H({name:"temp_lp_token_associated_seed",programId:a,marketId:n}),X=Kn({programId:a,marketId:n}),Z=H({name:"target_associated_seed",programId:a,marketId:n}),j=H({name:"withdraw_associated_seed",programId:a,marketId:n}),{publicKey:ae}=Tt({programId:c,marketId:n});return{id:l,baseMint:r,quoteMint:i,lpMint:p,baseDecimals:m,quoteDecimals:o,lpDecimals:m,version:t,programId:a,authority:y,nonce:w,baseVault:P,quoteVault:B,lpVault:L,openOrders:X,targetOrders:Z,withdrawQueue:j,marketVersion:e,marketProgramId:c,marketId:n,marketAuthority:ae,lookupTableAccount:se.default,configId:At({programId:a})}}var Ge;async function am({connection:t,poolKeysList:e,config:n,modelDataPubKey:r}){return e.find(m=>m.modelDataAccount)&&(Ge||(Ge=new be({connection:t,modelDataPubKey:r}),await Ge.initStableModelLayout())),await Promise.all(e.map(async m=>{if(m.modelDataAccount){let o=ht({poolKeys:m});return(await it(t,[o.instruction],"GetPoolData")).map(l=>{let p=st(l,"GetPoolData"),y=new ie(D(p,"status")),w=Number(D(p,"coin_decimals")),P=Number(D(p,"pc_decimals")),B=Number(D(p,"lp_decimals")),L=new ie(D(p,"pool_coin_amount")),X=new ie(D(p,"pool_pc_amount")),Z=new ie(D(p,"pool_lp_supply")),j="0";try{j=D(p,"pool_open_time")}catch{}return{status:y,baseDecimals:w,quoteDecimals:P,lpDecimals:B,baseReserve:L,quoteReserve:X,lpSupply:Z,startTime:new ie(j)}})[0]}else{let[o,a,c,l]=await t.getMultipleAccountsInfo([new se(m.id),new se(m.vault.A),new se(m.vault.B),new se(m.mintLp.address)]);if(o===null)throw Error("fetch pool error");if(a===null)throw Error("fetch vaultAccA error");if(c===null)throw Error("fetch vaultAccB error");if(l===null)throw Error("fetch mintAccLp error");let p=Ie.decode(o.data),y=oe.decode(a.data),w=oe.decode(c.data),P=wt.decode(l.data);return{status:p.status,baseDecimals:p.baseDecimal.toNumber(),quoteDecimals:p.quoteDecimal.toNumber(),lpDecimals:P.decimals,baseReserve:y.amount.sub(p.baseNeedTakePnl),quoteReserve:w.amount.sub(p.quoteNeedTakePnl),lpSupply:p.lpReserve,startTime:p.poolOpenTime}}}))}var He={volume:0,volumeQuote:0,volumeFee:0,apr:0,feeApr:0,priceMin:0,priceMax:0,rewardApr:[]},um=t=>{let e={},n=Cn.toBase58();return Object.keys(t).map(r=>{let i=t[r],[m,o]=[i.baseMint.toBase58(),i.quoteMint.toBase58()];e[r]={id:r,version:4,status:i.status.toNumber(),programId:i.programId.toBase58(),mintA:fe({address:m,programId:n,decimals:i.baseDecimal.toNumber()}),mintB:fe({address:o,programId:n,decimals:i.quoteDecimal.toNumber()}),rewardDefaultInfos:[],rewardDefaultPoolInfos:"Ecosystem",price:i.poolPrice.toNumber(),mintAmountA:new ye(i.mintAAmount.toString()).div(10**i.baseDecimal.toNumber()).toNumber(),mintAmountB:new ye(i.mintBAmount.toString()).div(10**i.quoteDecimal.toNumber()).toNumber(),baseReserve:i.baseReserve,quoteReserve:i.quoteReserve,feeRate:new ye(i.tradeFeeNumerator.toString()).div(i.tradeFeeDenominator.toString()).toNumber(),openTime:i.poolOpenTime.toString(),tvl:0,day:He,week:He,month:He,pooltype:[],farmUpcomingCount:0,farmOngoingCount:0,farmFinishedCount:0,type:"Standard",marketId:i.marketId.toBase58(),configId:At({programId:i.programId}).toBase58(),lpPrice:0,lpAmount:new ye(i.lpReserve.toString()).div(10**Math.min(i.baseDecimal.toNumber(),i.quoteDecimal.toNumber())).toNumber(),lpMint:fe({address:i.lpMint.toBase58(),programId:n,decimals:Math.min(i.baseDecimal.toNumber(),i.quoteDecimal.toNumber())}),burnPercent:0}}),e};export{hn as DataElement,_n as LIQUIDITY_FEES_DENOMINATOR,Dn as LIQUIDITY_FEES_NUMERATOR,Rt as LIQUIDITY_VERSION_TO_SERUM_VERSION,Wr as LIQUIDITY_VERSION_TO_STATE_LAYOUT,be as StableLayout,Be as addLiquidityLayout,qr as createPoolFeeLayout,_u as createPoolV4InstructionV2,vr as createPoolV4Layout,am as fetchMultipleInfo,Ae as fixedSwapInLayout,ke as fixedSwapOutLayout,Ln as formatLayout,At as getAssociatedConfigId,Kn as getAssociatedOpenOrders,sm as getAssociatedPoolKeys,zu as getDxByDyBaseIn,ju as getDyByDxBaseIn,Nn as getLiquidityAssociatedAuthority,H as getLiquidityAssociatedId,Qu as getStablePrice,Se as initPoolLayout,Ie as liquidityStateV4Layout,Ft as liquidityStateV5Layout,Eu as makeAMMSwapInstruction,Mu as makeAddLiquidityInstruction,Vu as makeInitPoolInstructionV4,ht as makeSimulatePoolInfoInstruction,fn as makeSwapFixedInInstruction,bn as makeSwapFixedOutInstruction,Tn as modelDataInfoLayout,Du as removeLiquidityInstruction,Le as removeLiquidityLayout,Ou as simulatePoolInfoInstruction,um as toAmmComputePoolInfo};
//# sourceMappingURL=index.mjs.map