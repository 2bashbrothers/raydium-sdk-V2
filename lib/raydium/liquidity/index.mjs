var Bt=Object.defineProperty,Lt=Object.defineProperties;var Kt=Object.getOwnPropertyDescriptors;var ue=Object.getOwnPropertySymbols;var Qe=Object.prototype.hasOwnProperty,Je=Object.prototype.propertyIsEnumerable;var je=(t,e,n)=>e in t?Bt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,K=(t,e)=>{for(var n in e||(e={}))Qe.call(e,n)&&je(t,n,e[n]);if(ue)for(var n of ue(e))Je.call(e,n)&&je(t,n,e[n]);return t},C=(t,e)=>Lt(t,Kt(e));var ge=(t,e)=>{var n={};for(var r in t)Qe.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&ue)for(var r of ue(t))e.indexOf(r)<0&&Je.call(t,r)&&(n[r]=t[r]);return n};import Xe from"bn.js";var Nn=new Xe(25),Rn=new Xe(1e4),Ct={4:3,5:3};import{PublicKey as Ot}from"@solana/web3.js";import et,{isBN as tt}from"bn.js";import{bits as Dn,BitStructure as On,blob as Nt,Blob as En,cstr as Vn,f32 as vn,f32be as Fn,f64 as Wn,f64be as qn,greedy as Un,Layout as Rt,ns64 as Gn,ns64be as Hn,nu64 as zn,nu64be as Yn,offset as jn,s16 as Qn,s16be as Jn,s24 as Xn,s24be as Zn,s32 as $n,s32be as er,s40 as tr,s40be as nr,s48 as rr,s48be as or,s8 as ir,seq as _t,struct as sr,Structure as Mt,u16 as ar,u16be as ur,u24 as cr,u24be as lr,u32 as mr,u32be as pr,u40 as dr,u40be as fr,u48 as yr,u48be as br,u8 as gr,UInt as Dt,union as hr,Union as Tr,unionLayoutDiscriminator as xr,utf8 as Pr}from"@solana/buffer-layout";var he=Rt,Ze=Mt;var Te=Dt;var $e=_t;var xe=Nt;var ce=class extends he{constructor(n,r,i){super(n,i);this.blob=xe(n),this.signed=r}decode(n,r=0){let i=new et(this.blob.decode(n,r),10,"le");return this.signed?i.fromTwos(this.span*8).clone():i}encode(n,r,i=0){return typeof n=="number"&&(n=new et(n)),this.signed&&(n=n.toTwos(this.span*8)),this.blob.encode(n.toArrayLike(Buffer,"le",this.span),r,i)}};function k(t){return new Te(1,t)}function F(t){return new Te(4,t)}function u(t){return new ce(8,!1,t)}function R(t){return new ce(16,!1,t)}var Pe=class extends he{constructor(n,r,i,l){super(n.span,l);this.layout=n,this.decoder=r,this.encoder=i}decode(n,r){return this.decoder(this.layout.decode(n,r))}encode(n,r,i){return this.layout.encode(this.encoder(n),r,i)}getSpan(n,r){return this.layout.getSpan(n,r)}};function g(t){return new Pe(xe(32),e=>new Ot(e),e=>e.toBuffer(),t)}var we=class extends Ze{decode(e,n){return super.decode(e,n)}};function S(t,e,n){return new we(t,e,n)}function Z(t,e,n){let r,i=typeof e=="number"?e:tt(e)?e.toNumber():new Proxy(e,{get(l,o){if(!r){let a=Reflect.get(l,"count");r=tt(a)?a.toNumber():a,Reflect.set(l,"count",r)}return Reflect.get(l,o)},set(l,o,a){return o==="count"&&(r=a),Reflect.set(l,o,a)}});return $e(t,i,n)}var Ae=S([k("instruction"),u("amountIn"),u("minAmountOut")]),ke=S([k("instruction"),u("maxAmountIn"),u("amountOut")]),Er=S([k("instruction"),k("nonce")]),Se=S([k("instruction"),k("nonce"),u("startTime")]),Ie=S([u("status"),u("nonce"),u("maxOrder"),u("depth"),u("baseDecimal"),u("quoteDecimal"),u("state"),u("resetFlag"),u("minSize"),u("volMaxCutRatio"),u("amountWaveRatio"),u("baseLotSize"),u("quoteLotSize"),u("minPriceMultiplier"),u("maxPriceMultiplier"),u("systemDecimalValue"),u("minSeparateNumerator"),u("minSeparateDenominator"),u("tradeFeeNumerator"),u("tradeFeeDenominator"),u("pnlNumerator"),u("pnlDenominator"),u("swapFeeNumerator"),u("swapFeeDenominator"),u("baseNeedTakePnl"),u("quoteNeedTakePnl"),u("quoteTotalPnl"),u("baseTotalPnl"),u("poolOpenTime"),u("punishPcAmount"),u("punishCoinAmount"),u("orderbookToInitTime"),R("swapBaseInAmount"),R("swapQuoteOutAmount"),u("swapBase2QuoteFee"),R("swapQuoteInAmount"),R("swapBaseOutAmount"),u("swapQuote2BaseFee"),g("baseVault"),g("quoteVault"),g("baseMint"),g("quoteMint"),g("lpMint"),g("openOrders"),g("marketId"),g("marketProgramId"),g("targetOrders"),g("withdrawQueue"),g("lpVault"),g("owner"),u("lpReserve"),Z(u(),3,"padding")]),Et=S([u("accountType"),u("status"),u("nonce"),u("maxOrder"),u("depth"),u("baseDecimal"),u("quoteDecimal"),u("state"),u("resetFlag"),u("minSize"),u("volMaxCutRatio"),u("amountWaveRatio"),u("baseLotSize"),u("quoteLotSize"),u("minPriceMultiplier"),u("maxPriceMultiplier"),u("systemDecimalsValue"),u("abortTradeFactor"),u("priceTickMultiplier"),u("priceTick"),u("minSeparateNumerator"),u("minSeparateDenominator"),u("tradeFeeNumerator"),u("tradeFeeDenominator"),u("pnlNumerator"),u("pnlDenominator"),u("swapFeeNumerator"),u("swapFeeDenominator"),u("baseNeedTakePnl"),u("quoteNeedTakePnl"),u("quoteTotalPnl"),u("baseTotalPnl"),u("poolOpenTime"),u("punishPcAmount"),u("punishCoinAmount"),u("orderbookToInitTime"),R("swapBaseInAmount"),R("swapQuoteOutAmount"),R("swapQuoteInAmount"),R("swapBaseOutAmount"),u("swapQuote2BaseFee"),u("swapBase2QuoteFee"),g("baseVault"),g("quoteVault"),g("baseMint"),g("quoteMint"),g("lpMint"),g("modelDataAccount"),g("openOrders"),g("marketId"),g("marketProgramId"),g("targetOrders"),g("owner"),Z(u(),64,"padding")]),Be=S([k("instruction"),u("baseAmountIn"),u("quoteAmountIn"),u("fixedSide"),u("otherAmountMin")]),Le=S([k("instruction"),u("lpAmount"),u("baseAmountMin"),u("quoteAmountMin")]),Vr={4:Ie,5:Et},vr=S([u("fee")]);import{PublicKey as se}from"@solana/web3.js";import ie from"bn.js";import be from"decimal.js";import{TOKEN_PROGRAM_ID as In}from"@solana/spl-token";import{ComputeBudgetProgram as zr,Keypair as Qr,PublicKey as ot,Transaction as Ce,TransactionMessage as Zr,VersionedTransaction as $r}from"@solana/web3.js";import{get as nt,set as Vt}from"lodash";var Ke=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:0,this.name=e.name}set level(e){this.logLevel=e}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let n=e.map(r=>typeof r=="object"?JSON.stringify(r):r).join(", ");throw new Error(n)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},rt={},vt={};function I(t){let e=nt(rt,t);if(!e){let n=nt(vt,t);e=new Ke({name:t,logLevel:n}),Vt(rt,t,e)}return e}var $={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",ClmmLockPosition:"ClmmLockPosition",ClmmHarvestLockPosition:"ClmmHarvestLockPosition",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV4Withdraw:"FarmV4Withdraw",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut",CpmmLockLp:"CpmmLockLp",CpmmCollectLockFee:"CpmmCollectLockFee",TransferTip:"TransferTip"};import{TOKEN_PROGRAM_ID as ro}from"@solana/spl-token";var _=I("Raydium_txUtil"),Ft=1644;function Wt(t,e){t.length<1&&_.logWithError(`no instructions provided: ${t.toString()}`),e.length<1&&_.logWithError(`no signers provided:, ${e.toString()}`);let n=new Ce;n.recentBlockhash="11111111111111111111111111111111",n.feePayer=e[0],n.add(...t);try{return Buffer.from(n.serialize({verifySignatures:!1})).toString("base64").length<Ft}catch{return!1}}async function it(t,e,n,r=!0){let i=new ot("RaydiumSimuLateTransaction11111111111111111"),l=[],o=new Ce;o.feePayer=i;for(let m of e)Wt([...o.instructions,m],[i])||(l.push(o),o=new Ce,o.feePayer=i),o.add(m);o.instructions.length>0&&l.push(o);let a=[];try{if(a=await qt(t,l,r),a.find(m=>m.err!==null))throw Error("rpc simulateTransaction error")}catch(m){m instanceof Error&&_.logWithError("failed to simulate for instructions","RPC_ERROR",{message:m.message})}let c=[];for(let m of a)if(_.debug("simulate result:",m),m.logs){let p=m.logs.filter(b=>b&&b.includes(n));_.debug("filteredLog:",c),p.length||_.logWithError("simulate log not match keyword","keyword",n),c.push(...p)}return c}function st(t,e){let n=t.match(/{["\w:,]+}/g);return!n||n.length!==1?_.logWithError(`simulate log fail to match json, keyword: ${e}`):n[0]}function M(t,e){let r=new RegExp(`"${e}":(\\d+)`,"g").exec(t);return!r||r.length!==2?_.logWithError(`simulate log fail to match key", key: ${e}`):r[1]}function Y(t,e){let[n,r]=ot.findProgramAddressSync(t,e);return{publicKey:n,nonce:r}}async function qt(t,e,n){let r=[];if(n){let i=await t.getLatestBlockhash(),l=[];for(let m of e){m.recentBlockhash=i.blockhash,m.lastValidBlockHeight=i.lastValidBlockHeight;let b=m._compile().serialize(),P=m._serialize(b).toString("base64");l.push(P)}let o=l.map(m=>{let p=t._buildArgs([m],void 0,"base64");return{methodName:"simulateTransaction",args:p}}),a=[],c=20;for(let m=0;m<Math.ceil(o.length/c);m++)a.push(o.slice(m*c,(m+1)*c));r=await(await Promise.all(a.map(async m=>(await t._rpcBatchRequest(m)).map(p=>p.result.value)))).flat()}else try{r=await Promise.all(e.map(async i=>await(await t.simulateTransaction(i)).value))}catch(i){i instanceof Error&&_.logWithError("failed to get info for multiple accounts","RPC_ERROR",{message:i.message})}return r}import{PublicKey as yu}from"@solana/web3.js";import{MintLayout as gu,TOKEN_PROGRAM_ID as Tu}from"@solana/spl-token";import sn from"big.js";import de from"bn.js";import E from"bn.js";import fi from"decimal.js";import{PublicKey as Ut}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as at}from"@solana/spl-token";var Ne={chainId:101,address:Ut.default.toBase58(),programId:at.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},D={chainId:101,address:"So11111111111111111111111111111111111111112",programId:at.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};import{PublicKey as Oe}from"@solana/web3.js";import{PublicKey as A,SystemProgram as ut,SYSVAR_RENT_PUBKEY as Gt}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Ht}from"@solana/spl-token";function s({pubkey:t,isSigner:e=!1,isWritable:n=!0}){return{pubkey:t,isWritable:n,isSigner:e}}var mo=[s({pubkey:Ht,isWritable:!1}),s({pubkey:ut.programId,isWritable:!1}),s({pubkey:Gt,isWritable:!1})];function _e({publicKey:t,transformSol:e}){let n=Me(t.toString());if(n instanceof A)return e&&n.equals(ee)?Re:n;if(e&&n.toString()===ee.toBase58())return Re;if(typeof n=="string"){if(n===A.default.toBase58())return A.default;try{return new A(n)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function Me(t){try{return new A(t)}catch{return t}}var po=new A("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),fo=new A("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),ct=new A("SysvarRent111111111111111111111111111111111"),yo=new A("SysvarC1ock11111111111111111111111111111111"),bo=new A("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),go=new A("Sysvar1nstructions1111111111111111111111111"),ho=ut.programId,To=new A("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),xo=new A("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),Po=new A("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),wo=new A("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),Ao=new A("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),ko=new A("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),So=new A("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),Io=new A("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),Bo=new A("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),Lo=new A("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),Ko=new A("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),Re=new A("So11111111111111111111111111111111111111112"),ee=A.default;function De(t){return _e({publicKey:t,transformSol:!0})}var Ee=class{constructor({mint:e,decimals:n,symbol:r,name:i,skipMint:l=!1,isToken2022:o=!1}){if(e===ee.toBase58()||e instanceof Oe&&ee.equals(e)){this.decimals=D.decimals,this.symbol=D.symbol,this.name=D.name,this.mint=new Oe(D.address),this.isToken2022=!1;return}this.decimals=n,this.symbol=r||e.toString().substring(0,6),this.name=i||e.toString().substring(0,6),this.mint=l?Oe.default:_e({publicKey:e}),this.isToken2022=o}equals(e){return this===e?!0:this.mint.equals(e.mint)}},v=Ee;v.WSOL=new Ee(C(K({},D),{mint:D.address}));var Ve=class{constructor({decimals:e,symbol:n="UNKNOWN",name:r="UNKNOWN"}){this.decimals=e,this.symbol=n,this.name=r}equals(e){return this===e}},le=Ve;le.SOL=new Ve(Ne);import pe from"big.js";import Qt from"bn.js";import Jt from"decimal.js-light";import te from"bn.js";var lt=9007199254740991;function x(t){let e=I("Raydium_parseBigNumberish");if(t instanceof te)return t;if(typeof t=="string"){if(t.match(/^-?[0-9]+$/))return new te(t);e.logWithError(`invalid BigNumberish string: ${t}`)}return typeof t=="number"?(t%1&&e.logWithError(`BigNumberish number underflow: ${t}`),(t>=lt||t<=-lt)&&e.logWithError(`BigNumberish number overflow: ${t}`),new te(String(t))):typeof t=="bigint"?new te(t.toString()):(e.error(`invalid BigNumberish value: ${t}`),new te(0))}import zt from"toformat";var Yt=zt,ne=Yt;var me=I("module/fraction"),ve=ne(pe),re=ne(Jt),Xt={[0]:re.ROUND_DOWN,[1]:re.ROUND_HALF_UP,[2]:re.ROUND_UP},Zt={[0]:pe.roundDown,[1]:pe.roundHalfUp,[2]:pe.roundUp},h=class{constructor(e,n=new Qt(1)){this.numerator=x(e),this.denominator=x(n)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new h(this.denominator,this.numerator)}add(e){let n=e instanceof h?e:new h(x(e));return this.denominator.eq(n.denominator)?new h(this.numerator.add(n.numerator),this.denominator):new h(this.numerator.mul(n.denominator).add(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}sub(e){let n=e instanceof h?e:new h(x(e));return this.denominator.eq(n.denominator)?new h(this.numerator.sub(n.numerator),this.denominator):new h(this.numerator.mul(n.denominator).sub(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}mul(e){let n=e instanceof h?e:new h(x(e));return new h(this.numerator.mul(n.numerator),this.denominator.mul(n.denominator))}div(e){let n=e instanceof h?e:new h(x(e));return new h(this.numerator.mul(n.denominator),this.denominator.mul(n.numerator))}toSignificant(e,n={groupSeparator:""},r=1){Number.isInteger(e)||me.logWithError(`${e} is not an integer.`),e<=0&&me.logWithError(`${e} is not positive.`),re.set({precision:e+1,rounding:Xt[r]});let i=new re(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return i.toFormat(i.decimalPlaces(),n)}toFixed(e,n={groupSeparator:""},r=1){return Number.isInteger(e)||me.logWithError(`${e} is not an integer.`),e<0&&me.logWithError(`${e} is negative.`),ve.DP=e,ve.RM=Zt[r]||1,new ve(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,n)}isZero(){return this.numerator.isZero()}};import $t from"bn.js";var mt=new h(new $t(100)),j=class extends h{toSignificant(e=5,n,r){return this.mul(mt).toSignificant(e,n,r)}toFixed(e=2,n,r){return this.mul(mt).toFixed(e,n,r)}};var en=I("Raydium_price"),O=class extends h{constructor(n){let{baseToken:r,quoteToken:i,numerator:l,denominator:o}=n;super(l,o);this.baseToken=r,this.quoteToken=i,this.scalar=new h(Fe(r.decimals),Fe(i.decimals))}get raw(){return new h(this.numerator,this.denominator)}get adjusted(){return super.mul(this.scalar)}invert(){return new O({baseToken:this.quoteToken,quoteToken:this.baseToken,denominator:this.numerator,numerator:this.denominator})}mul(n){this.quoteToken!==n.baseToken&&en.logWithError("mul token not equals");let r=super.mul(n);return new O({baseToken:this.baseToken,quoteToken:n.quoteToken,denominator:r.denominator,numerator:r.numerator})}toSignificant(n=this.quoteToken.decimals,r,i){return this.adjusted.toSignificant(n,r,i)}toFixed(n=this.quoteToken.decimals,r,i){return this.adjusted.toFixed(n,r,i)}};var We=new E(0),pt=new E(1),Ai=new E(2),ki=new E(3),Si=new E(5),qe=new E(10),Ii=new E(100),Bi=new E(1e3),Li=new E(1e4);function Fe(t){return qe.pow(x(t))}import{PublicKey as Di}from"@solana/web3.js";import{MINT_SIZE as vi,TOKEN_PROGRAM_ID as Fi,getTransferFeeConfig as Wi,unpackMint as qi}from"@solana/spl-token";var Ui=I("Raydium_accountInfo_util");import{PublicKey as Ji}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Zi}from"@solana/spl-token";import{PublicKey as d}from"@solana/web3.js";var ns=new d("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),rs=new d("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),os=new d("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),is=new d("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),ss=new d("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),as=new d("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),us=new d("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),cs=new d("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),ls=new d("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),ms=new d("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),ps=new d("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),ds=new d("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),fs=new d("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),W=new d("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),ys=new d("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),bs=new d("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),gs=new d("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),hs=new d("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),Ts=new d("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),xs=new d("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),Ps=new d("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),ws=new d("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),As=new d("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),ks=new d("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),Ss=new d("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),Is=new d("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),Bs=new d("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),Ls=new d("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),Ks=new d("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),Cs=new d("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),Ns=new d("6s1xP3hpbAfFoNtUNF8mfHsjr2Bd97JxFJRWLbL6aHuX");var Rs={OPEN_BOOK_PROGRAM:new d("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),SERUM_PROGRAM_ID_V3:new d("Ray1111111111111111111111111111111111111111"),AMM_V4:new d("DRaya7Kj3aMWQSy19kSjvmuwq9docCHofyP9kanQGaav"),AMM_STABLE:new d("DRayDdXc1NZQ9C3hRWmoSf8zK4iapgMnjdNZWrfwsP8m"),CLMM_PROGRAM_ID:new d("DRayAUgENGQBKVaX8owNhgzkEDyoHTGVEGHVJT1E9pfH"),CLMM_LOCK_PROGRAM_ID:new d("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),CLMM_LOCK_AUTH_ID:new d("6Aoh8h2Lw2m5UGxYR8AdAL87jTWYeKoxM52mJRzfYwN"),CREATE_CPMM_POOL_PROGRAM:new d("DRaycpLY18LhpbydsBWbVJtxpNv9oXPgjRSfpF2bWpYb"),CREATE_CPMM_POOL_AUTH:new d("CXniRufdq5xL8t8jZAPxsPZDpuudwuJSPWnbcD5Y5Nxq"),CREATE_CPMM_POOL_FEE_ACC:new d("3oE58BKVt8KuYkGxx8zBojugnymWmBiyafWgMrnb6eYy"),LOCK_CPMM_PROGRAM:new d("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),LOCK_CPMM_AUTH:new d("7qWVV8UY2bRJfDLP4s37YzBPKUkVB46DStYJBpYbQzu3"),UTIL1216:d.default,Router:new d("DRaybByLpbUL57LJARs3j8BitTxVfzBg351EaMr5UTCd"),FARM_PROGRAM_ID_V3:new d("DRayWyrLmEW5KEeqs8kdTMMaBabapqagaBC7KWpGtJeZ"),FARM_PROGRAM_ID_V4:new d("Ray1111111111111111111111111111111111111111"),FARM_PROGRAM_ID_V5:new d("DRayiCGSZgku1GTK6rXD6mVDdingXy6APAH1R6R5L2LC"),FARM_PROGRAM_ID_V6:new d("DRayzbYakXs45ELHkzH6vC3fuhQqTAnv5A68gdFuvZyZ"),LAUNCHPAD_PROGRAM:new d("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),LAUNCHPAD_AUTH:new d("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),LAUNCHPAD_PLATFORM:new d("2Jx4KTDrVSdWNazuGpcA8n3ZLTRGGBDxAWhuKe2Xcj2a"),LAUNCHPAD_CONFIG:new d("7ZR4zD7PYfY2XxoG1Gxcy2EgEeGYrpxrwzPuwdUBssEt"),FEE_DESTINATION_ID:new d("9y8ENuuZ3b19quffx9hQvRVygG5ky6snHfRvGpuSfeJy"),MODEL_DATA_PUBKEY:new d("Ray1111111111111111111111111111111111111111")};import Ds from"bn.js";import{PublicKey as Fs,AddressLookupTableAccount as Ws}from"@solana/web3.js";import{PublicKey as oa,sendAndConfirmTransaction as ia,SystemProgram as ua,Transaction as ca,TransactionMessage as ma,VersionedTransaction as pa}from"@solana/web3.js";import fa from"axios";import{PublicKey as tn}from"@solana/web3.js";import nn from"bn.js";function rn(t){return typeof t=="object"&&t!==null&&![v,N,tn,h,nn,O,j].some(e=>typeof e=="object"&&t instanceof e)}function q(t){return typeof t=="string"?Me(t):Array.isArray(t)?t.map(e=>q(e)):rn(t)?Object.fromEntries(Object.entries(t).map(([e,n])=>[e,q(n)])):t}import on from"bn.js";var Ba=new on(1e6);var an=I("Raydium_amount"),dt=ne(sn);function un(t,e){let n="0",r="0";if(t.includes(".")){let i=t.split(".");i.length===2?([n,r]=i,r=r.padEnd(e,"0")):an.logWithError(`invalid number string, num: ${t}`)}else n=t;return[n,r.slice(0,e)||r]}var N=class extends h{constructor(n,r,i=!0,l){let o=new de(0),a=qe.pow(new de(n.decimals));if(i)o=x(r);else{let c=new de(0),m=new de(0);if(typeof r=="string"||typeof r=="number"||typeof r=="bigint"){let[p,b]=un(r.toString(),n.decimals);c=x(p),m=x(b)}c=c.mul(a),o=c.add(m)}super(o,a);this.logger=I(l||"TokenAmount"),this.token=n}get raw(){return this.numerator}isZero(){return this.raw.isZero()}gt(n){return this.token.equals(n.token)||this.logger.logWithError("gt token not equals"),this.raw.gt(n.raw)}lt(n){return this.token.equals(n.token)||this.logger.logWithError("lt token not equals"),this.raw.lt(n.raw)}add(n){return this.token.equals(n.token)||this.logger.logWithError("add token not equals"),new N(this.token,this.raw.add(n.raw))}subtract(n){return this.token.equals(n.token)||this.logger.logWithError("sub token not equals"),new N(this.token,this.raw.sub(n.raw))}toSignificant(n=this.token.decimals,r,i=0){return super.toSignificant(n,r,i)}toFixed(n=this.token.decimals,r,i=0){return n>this.token.decimals&&this.logger.logWithError("decimals overflow"),super.toFixed(n,r,i)}toExact(n={groupSeparator:""}){return dt.DP=this.token.decimals,new dt(this.numerator.toString()).div(this.denominator.toString()).toFormat(n)}};var fe=i=>{var l=i,{address:t,programId:e,decimals:n}=l,r=ge(l,["address","programId","decimals"]);return K({chainId:101,address:De(t).toBase58(),programId:e,logoURI:"",symbol:"",name:"",decimals:n,tags:[],extensions:r.extensions||{}},r)};import{PublicKey as T,SystemProgram as yt,SYSVAR_RENT_PUBKEY as cn,TransactionInstruction as V}from"@solana/web3.js";import{ASSOCIATED_TOKEN_PROGRAM_ID as ln,TOKEN_PROGRAM_ID as Q}from"@solana/spl-token";var ft=I("Raydium_liquidity_instruction");function Mu(t){let{poolInfo:e,poolKeys:n,userKeys:r,baseAmountIn:i,quoteAmountIn:l,fixedSide:o,otherAmountMin:a,modelDataPubKey:c=W}=t,m=Buffer.alloc(Be.span);Be.encode({instruction:3,baseAmountIn:x(i),quoteAmountIn:x(l),otherAmountMin:x(a),fixedSide:o==="base"?We:pt},m);let p=[s({pubkey:Q,isWritable:!1}),s({pubkey:new T(e.id)}),s({pubkey:new T(n.authority),isWritable:!1}),s({pubkey:new T(n.openOrders),isWritable:!1}),s({pubkey:new T(n.targetOrders)}),s({pubkey:new T(e.lpMint.address)}),s({pubkey:new T(n.vault.A)}),s({pubkey:new T(n.vault.B)})];return e.pooltype.includes("StablePool")&&p.push(s({pubkey:c})),p.push(s({pubkey:new T(e.marketId),isWritable:!1}),s({pubkey:r.baseTokenAccount}),s({pubkey:r.quoteTokenAccount}),s({pubkey:r.lpTokenAccount}),s({pubkey:r.owner,isWritable:!1,isSigner:!0}),s({pubkey:new T(n.marketEventQueue),isWritable:!1})),new V({programId:new T(e.programId),keys:p,data:m})}function Du(t){let{poolInfo:e,poolKeys:n,userKeys:r,lpAmount:i,baseAmountMin:l,quoteAmountMin:o,modelDataPubKey:a=W}=t,c=q(n),m=4;if(e.pooltype.includes("StablePool")&&(m=5),m===4||m===5){let p=Buffer.alloc(Le.span);Le.encode({instruction:4,lpAmount:x(i),baseAmountMin:x(l),quoteAmountMin:x(o)},p);let b=[s({pubkey:Q,isWritable:!1}),s({pubkey:c.id}),s({pubkey:c.authority,isWritable:!1}),s({pubkey:c.openOrders}),s({pubkey:c.targetOrders}),s({pubkey:c.mintLp.address}),s({pubkey:c.vault.A}),s({pubkey:c.vault.B})];return m===5?b.push(s({pubkey:a})):(b.push(s({pubkey:c.id})),b.push(s({pubkey:c.id}))),b.push(s({pubkey:c.marketProgramId,isWritable:!1}),s({pubkey:c.marketId}),s({pubkey:c.marketBaseVault}),s({pubkey:c.marketQuoteVault}),s({pubkey:c.marketAuthority,isWritable:!1}),s({pubkey:r.lpTokenAccount}),s({pubkey:r.baseTokenAccount}),s({pubkey:r.quoteTokenAccount}),s({pubkey:r.owner,isWritable:!1,isSigner:!0}),s({pubkey:c.marketEventQueue}),s({pubkey:c.marketBids}),s({pubkey:c.marketAsks})),new V({programId:c.programId,keys:b,data:p})}return new V({programId:c.programId,keys:[]})}function Ou({programId:t,ammId:e,ammAuthority:n,ammOpenOrders:r,lpMint:i,coinMint:l,pcMint:o,coinVault:a,pcVault:c,withdrawQueue:m,ammTargetOrders:p,poolTempLp:b,marketProgramId:w,marketId:P,userWallet:B,userCoinVault:L,userPcVault:J,userLpVault:X,nonce:z,openTime:ae,coinAmount:wt,pcAmount:At,ammConfigId:kt,feeDestinationId:St}){let ze=S([k("instruction"),k("nonce"),u("openTime"),u("pcAmount"),u("coinAmount")]),It=[{pubkey:Q,isSigner:!1,isWritable:!1},{pubkey:ln,isSigner:!1,isWritable:!1},{pubkey:yt.programId,isSigner:!1,isWritable:!1},{pubkey:ct,isSigner:!1,isWritable:!1},{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:kt,isSigner:!1,isWritable:!1},{pubkey:St,isSigner:!1,isWritable:!0},{pubkey:w,isSigner:!1,isWritable:!1},{pubkey:P,isSigner:!1,isWritable:!1},{pubkey:B,isSigner:!0,isWritable:!0},{pubkey:L,isSigner:!1,isWritable:!0},{pubkey:J,isSigner:!1,isWritable:!0},{pubkey:X,isSigner:!1,isWritable:!0}],Ye=Buffer.alloc(ze.span);return ze.encode({instruction:1,nonce:z,openTime:ae,coinAmount:wt,pcAmount:At},Ye),{instruction:new V({keys:It,programId:t,data:Ye}),instructionType:$.AmmV4CreatePool}}function Eu(t){let e=S([k("instruction"),k("simulateType")]),n=Buffer.alloc(e.span);e.encode({instruction:12,simulateType:0},n);let r=[s({pubkey:new T(t.id),isWritable:!1}),s({pubkey:new T(t.authority),isWritable:!1}),s({pubkey:new T(t.openOrders),isWritable:!1}),s({pubkey:new T(t.vault.A),isWritable:!1}),s({pubkey:new T(t.vault.B),isWritable:!1}),s({pubkey:new T(t.mintLp.address),isWritable:!1}),s({pubkey:new T(t.marketId),isWritable:!1}),s({pubkey:new T(t.marketEventQueue),isWritable:!1})];return new V({programId:new T(t.programId),keys:r,data:n})}function mn({poolKeys:t,userKeys:e,amountIn:n,minAmountOut:r,modelDataPubKey:i=W},l){let o=q(t),a=Buffer.alloc(Ae.span);Ae.encode({instruction:9,amountIn:x(n),minAmountOut:x(r)},a);let c=[s({pubkey:Q,isWritable:!1}),s({pubkey:o.id}),s({pubkey:o.authority,isWritable:!1}),s({pubkey:o.openOrders})];return l===4&&c.push(s({pubkey:o.targetOrders})),c.push(s({pubkey:o.vault.A}),s({pubkey:o.vault.B})),l===5&&c.push(s({pubkey:i})),c.push(s({pubkey:o.marketProgramId,isWritable:!1}),s({pubkey:o.marketId}),s({pubkey:o.marketBids}),s({pubkey:o.marketAsks}),s({pubkey:o.marketEventQueue}),s({pubkey:o.marketBaseVault}),s({pubkey:o.marketQuoteVault}),s({pubkey:o.marketAuthority,isWritable:!1}),s({pubkey:e.tokenAccountIn}),s({pubkey:e.tokenAccountOut}),s({pubkey:e.owner,isWritable:!1,isSigner:!0})),new V({programId:o.programId,keys:c,data:a})}function pn({poolKeys:t,userKeys:e,maxAmountIn:n,amountOut:r,modelDataPubKey:i=W},l){let o=q(t),a=Buffer.alloc(ke.span);ke.encode({instruction:11,maxAmountIn:x(n),amountOut:x(r)},a);let c=[s({pubkey:Q,isWritable:!1}),s({pubkey:o.id}),s({pubkey:o.authority,isWritable:!1}),s({pubkey:o.openOrders}),s({pubkey:o.targetOrders}),s({pubkey:o.vault.A}),s({pubkey:o.vault.B})];return l===5&&c.push(s({pubkey:i})),c.push(s({pubkey:o.marketProgramId,isWritable:!1}),s({pubkey:o.marketId}),s({pubkey:o.marketBids}),s({pubkey:o.marketAsks}),s({pubkey:o.marketEventQueue}),s({pubkey:o.marketBaseVault}),s({pubkey:o.marketQuoteVault}),s({pubkey:o.marketAuthority,isWritable:!1}),s({pubkey:e.tokenAccountIn}),s({pubkey:e.tokenAccountOut}),s({pubkey:e.owner,isWritable:!1,isSigner:!0})),new V({programId:o.programId,keys:c,data:a})}function Vu(t){let{poolKeys:e,version:n,userKeys:r,amountIn:i,amountOut:l,fixedSide:o}=t;if(n===4||n===5){let a={poolKeys:e,userKeys:r};if(o==="in")return mn(C(K({},a),{amountIn:i,minAmountOut:l}),n);if(o==="out")return pn(C(K({},a),{maxAmountIn:i,amountOut:l}),n);ft.logWithError("invalid params","params",t)}throw ft.logWithError("invalid version","poolKeys.version",n),new Error("invalid version")}function vu({poolKeys:t,userKeys:e,startTime:n}){let r=Buffer.alloc(Se.span);Se.encode({instruction:0,nonce:5,startTime:x(n)},r);let i=q(t),l=[s({pubkey:Q,isWritable:!1}),s({pubkey:yt.programId,isWritable:!1}),s({pubkey:cn,isWritable:!1}),s({pubkey:i.id}),s({pubkey:i.authority,isWritable:!1}),s({pubkey:i.openOrders}),s({pubkey:i.mintLp.address}),s({pubkey:i.mintA.address,isWritable:!1}),s({pubkey:i.mintB.address,isWritable:!1}),s({pubkey:i.vault.A,isWritable:!1}),s({pubkey:i.vault.B,isWritable:!1}),s({pubkey:i.id}),s({pubkey:i.targetOrders}),s({pubkey:e.lpTokenAccount}),s({pubkey:i.id,isWritable:!1}),s({pubkey:i.marketProgramId,isWritable:!1}),s({pubkey:i.marketId,isWritable:!1}),s({pubkey:e.payer,isSigner:!0})];return new V({programId:i.programId,keys:l,data:r})}function bt({poolKeys:t}){let e=S([k("instruction"),k("simulateType")]),n=Buffer.alloc(e.span);e.encode({instruction:12,simulateType:0},n);let r=[s({pubkey:new T(t.id),isWritable:!1}),s({pubkey:new T(t.authority),isWritable:!1}),s({pubkey:new T(t.openOrders),isWritable:!1}),s({pubkey:new T(t.vault.A),isWritable:!1}),s({pubkey:new T(t.vault.B),isWritable:!1}),s({pubkey:new T(t.mintLp.address),isWritable:!1}),s({pubkey:new T(t.marketId),isWritable:!1}),s({pubkey:new T(t.marketEventQueue),isWritable:!1})];return{instruction:new V({programId:new T(t.programId),keys:r,data:n})}}import{PublicKey as dn}from"@solana/web3.js";var fn=I("Raydium_liquidity_serum");function gt({programId:t,marketId:e}){let n=[e.toBuffer()],r=0,i;for(;r<100;){try{let l=n.concat(Buffer.from([r]),Buffer.alloc(7));i=dn.createProgramAddressSync(l,t)}catch(l){if(l instanceof TypeError)throw l;r++;continue}return{publicKey:i,nonce:r}}throw fn.logWithError("unable to find a viable program address nonce","params",{programId:t,marketId:e}),new Error("unable to find a viable program address nonce")}var G=5e4,yn=S([u("x"),u("y"),u("price")]),bn=S([u("accountType"),u("status"),u("multiplier"),u("validDataCount"),Z(yn,G,"DataElement")]);function gn(t,e){return[0,G-2]}function hn(t){return[0,G-2]}function Tn(t){return[0,G-2]}function xn(t,e,n){let[r,i]=gn(e,n),l=r,o=i,a=0,c=e*t.multiplier/n;for(;l<=o;){if(a=Math.floor((o+l)/2),a===0||a>=G-2)return[a,a,!1];let m=t.DataElement[a].x*t.multiplier/t.DataElement[a].y,p=t.DataElement[a-1].x*t.multiplier/t.DataElement[a-1].y,b=t.DataElement[a+1].x*t.multiplier/t.DataElement[a+1].y;if(c===m)return[a,a,!0];if(c===p)return[a-1,a-1,!0];if(c===b)return[a+1,a+1,!0];if(c<p)o=a-1;else{if(c>p&&c<m)return[a-1,a,!0];if(c>m&&c<b)return[a,a+1,!0];l=a+1}}return[a,a,!1]}function Ue(t,e,n){let[r,i,l]=xn(t,e,n);if(!l)return 0;if(r===i){let o=t.DataElement[r].x;return e*t.multiplier/o}else{let o=t.DataElement[r].x,a=t.DataElement[r].y,c=t.DataElement[i].x,m=t.DataElement[i].y,p=n*(c*a-o*m),b=o*p,w=(c-o)*(e*a-o*n)*m,P=b+w;return e*t.multiplier*p/P}}function U(t,e,n){return e*t.multiplier/n}function ht(t,e,n){return e*n/t.multiplier}function Pn(t,e){let[n,r]=hn(e),i=n,l=r,o=0,a=e;for(;i<l;){if(o=Math.floor((l+i)/2),o<=0||o>G-2)return[o,o,!1];let c=t.DataElement[o].x,m=t.DataElement[o-1].x,p=t.DataElement[o+1].x;if(a===c)return[o,o,!0];if(a===m)return[o-1,o-1,!0];if(a===p)return[o+1,o+1,!0];if(a<m)l=o-1;else{if(a>m&&a<c)return[o-1,o,!0];if(a>c&&a<p)return[o,o+1,!0];i=o+1}}return[o,o,!1]}function wn(t,e){let[n,r]=Tn(e),i=n,l=r,o=0,a=e;for(;i<=l;){if(o=Math.floor((l+i)/2),o<=0||o>=G-2)return[o,o,!1];let c=t.DataElement[o].y,m=t.DataElement[o-1].y,p=t.DataElement[o+1].y;if(a===c)return[o,o,!0];if(a===m)return[o-1,o-1,!0];if(a===p)return[o+1,o+1,!0];if(a<p)i=o+1;else{if(a<m&&a>c)return[o-1,o,!0];if(a<c&&a>p)return[o,o+1,!0];l=o-1}}return[o,o,!1]}function Tt(t,e,n,r){let i=r?e+n:e-n,[l,o,a]=Pn(t,i);if(!a)return[0,0,!1,a];if(l===o)return[t.DataElement[o].price,t.DataElement[o].y,!1,a];{let c=t.DataElement[l].x,m=t.DataElement[o].x,p=t.DataElement[l].price,b=t.DataElement[o].price,w=t.DataElement[l].y,P=t.DataElement[o].y;if(e>=c&&e<=m)return r?[b,P,!0,a]:[p,w,!0,a];{let B,L;return r?(B=p+(b-p)*(e-c)/(m-c),L=w-(i-c)*t.multiplier/b):(B=p+(b-p)*(e-c)/(m-c),L=P+(m-i)*t.multiplier/p),[B,L,!1,a]}}}function An(t,e,n,r){let i=r?e-n:e+n,[l,o,a]=wn(t,i);if(!a)return[0,0,!1,a];if(l===o)return[t.DataElement[o].price,t.DataElement[o].x,!1,a];{let c=t.DataElement[l].x,m=t.DataElement[o].x,p=t.DataElement[l].price,b=t.DataElement[o].price,w=t.DataElement[l].y,P=t.DataElement[o].y;if(e>=P&&e<=w)return r?[b,m,!0,a]:[p,c,!0,a];{let B,L;return r?(B=p+(b-p)*(w-e)/(w-P),L=c+b*(w-i)/t.multiplier):(B=p+(b-p)*(w-e)/(w-P),L=m-p*(i-P)/t.multiplier),[B,L,!1,a]}}}function kn(t,e){let n=Tt(t,e,0,!1);return n[3]?n[0]:0}function Yu(t,e,n,r){let i=Ue(t,e,n),l=U(t,e,i),o=U(t,n,i),a=U(t,r,i),c=!0,[m,p,b,w]=Tt(t,l,a,c);if(!w)return 0;if(b)return r*t.multiplier/m;{let P=o-p;return ht(t,P,i)}}function ju(t,e,n,r){let i=Ue(t,e,n),l=U(t,e,i),o=U(t,n,i),a=U(t,r,i),c=!1,[m,p,b,w]=An(t,o,a,c);if(!w)return 0;if(b)return r*m/t.multiplier;{let P=l-p;return ht(t,P,i)}}function Sn(t){let e=bn.decode(t);return{accountType:e.accountType.toNumber(),status:e.status.toNumber(),multiplier:e.multiplier.toNumber(),validDataCount:e.validDataCount.toNumber(),DataElement:e.DataElement.map(n=>({x:n.x.toNumber(),y:n.y.toNumber(),price:n.price.toNumber()}))}}function Qu(t,e,n,r){let i=kn(t,U(t,e,Ue(t,e,n)))/t.multiplier;return r?i:1/i}var ye=class{constructor({connection:e,modelDataPubKey:n=W}){this._layoutData={accountType:0,status:0,multiplier:0,validDataCount:0,DataElement:[]};this.connection=e,this.modelDataPubKey=n}get stableModelData(){return this._layoutData}async initStableModelLayout(){if(this._layoutData.validDataCount===0&&this.connection){let e=await this.connection.getAccountInfo(this.modelDataPubKey);e&&(this._layoutData=Sn(e==null?void 0:e.data))}}};var oe=S([g("mint"),g("owner"),u("amount"),F("delegateOption"),g("delegate"),k("state"),F("isNativeOption"),u("isNative"),u("delegatedAmount"),F("closeAuthorityOption"),g("closeAuthority")]);import{Keypair as rc,PublicKey as oc}from"@solana/web3.js";import ac from"bn.js";import{TOKEN_PROGRAM_ID as lc}from"@solana/spl-token";var pc=I("Raydium_Util");import{PublicKey as hc,SystemProgram as xc}from"@solana/web3.js";import Ac from"bn.js";import{createCloseAccountInstruction as Bc,createInitializeAccountInstruction as Lc,createTransferInstruction as Kc,TOKEN_PROGRAM_ID as Cc}from"@solana/spl-token";var xt=S([F("mintAuthorityOption"),g("mintAuthority"),u("supply"),k("decimals"),k("isInitialized"),F("freezeAuthorityOption"),g("freezeAuthority")]);function Pt({programId:t}){let{publicKey:e}=Y([Buffer.from("amm_config_account_seed","utf-8")],t);return e}function H({name:t,programId:e,marketId:n}){let{publicKey:r}=Y([e.toBuffer(),n.toBuffer(),Buffer.from(t,"utf-8")],e);return r}function Bn({programId:t,marketId:e}){let{publicKey:n}=Y([t.toBuffer(),e.toBuffer(),Buffer.from("open_order_associated_seed","utf-8")],t);return n}function Ln({programId:t}){return Y([Buffer.from([97,109,109,32,97,117,116,104,111,114,105,116,121])],t)}function al({version:t,marketVersion:e,marketId:n,baseMint:r,quoteMint:i,baseDecimals:l,quoteDecimals:o,programId:a,marketProgramId:c}){let m=H({name:"amm_associated_seed",programId:a,marketId:n}),p=H({name:"lp_mint_associated_seed",programId:a,marketId:n}),{publicKey:b,nonce:w}=Ln({programId:a}),P=H({name:"coin_vault_associated_seed",programId:a,marketId:n}),B=H({name:"pc_vault_associated_seed",programId:a,marketId:n}),L=H({name:"temp_lp_token_associated_seed",programId:a,marketId:n}),J=Bn({programId:a,marketId:n}),X=H({name:"target_associated_seed",programId:a,marketId:n}),z=H({name:"withdraw_associated_seed",programId:a,marketId:n}),{publicKey:ae}=gt({programId:c,marketId:n});return{id:m,baseMint:r,quoteMint:i,lpMint:p,baseDecimals:l,quoteDecimals:o,lpDecimals:l,version:t,programId:a,authority:b,nonce:w,baseVault:P,quoteVault:B,lpVault:L,openOrders:J,targetOrders:X,withdrawQueue:z,marketVersion:e,marketProgramId:c,marketId:n,marketAuthority:ae,lookupTableAccount:se.default,configId:Pt({programId:a})}}var Ge;async function ul({connection:t,poolKeysList:e,config:n,modelDataPubKey:r}){return e.find(l=>l.modelDataAccount)&&(Ge||(Ge=new ye({connection:t,modelDataPubKey:r}),await Ge.initStableModelLayout())),await Promise.all(e.map(async l=>{if(l.modelDataAccount){let o=bt({poolKeys:l});return(await it(t,[o.instruction],"GetPoolData")).map(m=>{let p=st(m,"GetPoolData"),b=new ie(M(p,"status")),w=Number(M(p,"coin_decimals")),P=Number(M(p,"pc_decimals")),B=Number(M(p,"lp_decimals")),L=new ie(M(p,"pool_coin_amount")),J=new ie(M(p,"pool_pc_amount")),X=new ie(M(p,"pool_lp_supply")),z="0";try{z=M(p,"pool_open_time")}catch{}return{status:b,baseDecimals:w,quoteDecimals:P,lpDecimals:B,baseReserve:L,quoteReserve:J,lpSupply:X,startTime:new ie(z)}})[0]}else{let[o,a,c,m]=await t.getMultipleAccountsInfo([new se(l.id),new se(l.vault.A),new se(l.vault.B),new se(l.mintLp.address)]);if(o===null)throw Error("fetch pool error");if(a===null)throw Error("fetch vaultAccA error");if(c===null)throw Error("fetch vaultAccB error");if(m===null)throw Error("fetch mintAccLp error");let p=Ie.decode(o.data),b=oe.decode(a.data),w=oe.decode(c.data),P=xt.decode(m.data);return{status:p.status,baseDecimals:p.baseDecimal.toNumber(),quoteDecimals:p.quoteDecimal.toNumber(),lpDecimals:P.decimals,baseReserve:b.amount.sub(p.baseNeedTakePnl),quoteReserve:w.amount.sub(p.quoteNeedTakePnl),lpSupply:p.lpReserve,startTime:p.poolOpenTime}}}))}var He={volume:0,volumeQuote:0,volumeFee:0,apr:0,feeApr:0,priceMin:0,priceMax:0,rewardApr:[]},cl=t=>{let e={},n=In.toBase58();return Object.keys(t).map(r=>{let i=t[r],[l,o]=[i.baseMint.toBase58(),i.quoteMint.toBase58()];e[r]={id:r,version:4,status:i.status.toNumber(),programId:i.programId.toBase58(),mintA:fe({address:l,programId:n,decimals:i.baseDecimal.toNumber()}),mintB:fe({address:o,programId:n,decimals:i.quoteDecimal.toNumber()}),rewardDefaultInfos:[],rewardDefaultPoolInfos:"Ecosystem",price:i.poolPrice.toNumber(),mintAmountA:new be(i.mintAAmount.toString()).div(10**i.baseDecimal.toNumber()).toNumber(),mintAmountB:new be(i.mintBAmount.toString()).div(10**i.quoteDecimal.toNumber()).toNumber(),baseReserve:i.baseReserve,quoteReserve:i.quoteReserve,feeRate:new be(i.tradeFeeNumerator.toString()).div(i.tradeFeeDenominator.toString()).toNumber(),openTime:i.poolOpenTime.toString(),tvl:0,day:He,week:He,month:He,pooltype:[],farmUpcomingCount:0,farmOngoingCount:0,farmFinishedCount:0,type:"Standard",marketId:i.marketId.toBase58(),configId:Pt({programId:i.programId}).toBase58(),lpPrice:0,lpAmount:new be(i.lpReserve.toString()).div(10**Math.min(i.baseDecimal.toNumber(),i.quoteDecimal.toNumber())).toNumber(),lpMint:fe({address:i.lpMint.toBase58(),programId:n,decimals:Math.min(i.baseDecimal.toNumber(),i.quoteDecimal.toNumber())}),burnPercent:0}}),e};export{yn as DataElement,Rn as LIQUIDITY_FEES_DENOMINATOR,Nn as LIQUIDITY_FEES_NUMERATOR,Ct as LIQUIDITY_VERSION_TO_SERUM_VERSION,Vr as LIQUIDITY_VERSION_TO_STATE_LAYOUT,ye as StableLayout,Be as addLiquidityLayout,vr as createPoolFeeLayout,Ou as createPoolV4InstructionV2,Er as createPoolV4Layout,ul as fetchMultipleInfo,Ae as fixedSwapInLayout,ke as fixedSwapOutLayout,Sn as formatLayout,Pt as getAssociatedConfigId,Bn as getAssociatedOpenOrders,al as getAssociatedPoolKeys,ju as getDxByDyBaseIn,Yu as getDyByDxBaseIn,Ln as getLiquidityAssociatedAuthority,H as getLiquidityAssociatedId,Qu as getStablePrice,Se as initPoolLayout,Ie as liquidityStateV4Layout,Et as liquidityStateV5Layout,Vu as makeAMMSwapInstruction,Mu as makeAddLiquidityInstruction,vu as makeInitPoolInstructionV4,bt as makeSimulatePoolInfoInstruction,mn as makeSwapFixedInInstruction,pn as makeSwapFixedOutInstruction,bn as modelDataInfoLayout,Du as removeLiquidityInstruction,Le as removeLiquidityLayout,Eu as simulatePoolInfoInstruction,cl as toAmmComputePoolInfo};
//# sourceMappingURL=index.mjs.map