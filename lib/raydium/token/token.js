var dt=Object.create;var ie=Object.defineProperty,ft=Object.defineProperties,gt=Object.getOwnPropertyDescriptor,ht=Object.getOwnPropertyDescriptors,bt=Object.getOwnPropertyNames,ge=Object.getOwnPropertySymbols,Tt=Object.getPrototypeOf,Ce=Object.prototype.hasOwnProperty,Ue=Object.prototype.propertyIsEnumerable;var We=(n,e,t)=>e in n?ie(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,O=(n,e)=>{for(var t in e||(e={}))Ce.call(e,t)&&We(n,t,e[t]);if(ge)for(var t of ge(e))Ue.call(e,t)&&We(n,t,e[t]);return n},U=(n,e)=>ft(n,ht(e));var he=(n,e)=>{var t={};for(var r in n)Ce.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&ge)for(var r of ge(n))e.indexOf(r)<0&&Ue.call(n,r)&&(t[r]=n[r]);return t};var yt=(n,e)=>{for(var t in e)ie(n,t,{get:e[t],enumerable:!0})},qe=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let h of bt(e))!Ce.call(n,h)&&h!==t&&ie(n,h,{get:()=>e[h],enumerable:!(r=gt(e,h))||r.enumerable});return n};var v=(n,e,t)=>(t=n!=null?dt(Tt(n)):{},qe(e||!n||!n.__esModule?ie(t,"default",{value:n,enumerable:!0}):t,n)),wt=n=>qe(ie({},"__esModule",{value:!0}),n);var _t={};yt(_t,{default:()=>Se});module.exports=wt(_t);var lt=require("@solana/web3.js"),j=require("@solana/spl-token");var oe=require("lodash");var Be=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:0,this.name=e.name}set level(e){this.logLevel=e}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let t=e.map(r=>typeof r=="object"?JSON.stringify(r):r).join(", ");throw new Error(t)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},Ge={},xt={};function K(n){let e=(0,oe.get)(Ge,n);if(!e){let t=(0,oe.get)(xt,n);e=new Be({name:n,logLevel:t}),(0,oe.set)(Ge,n,e)}return e}var S=require("@solana/web3.js"),mt=v(require("axios"));var q=require("@solana/web3.js");var ct=require("@solana/web3.js");var G=v(require("bn.js")),Ft=v(require("decimal.js"));var Ze=v(require("big.js")),St=v(require("bn.js"));var je=v(require("toformat")),At=je.default,se=At;var ae=v(require("big.js")),ze=v(require("bn.js")),Je=v(require("decimal.js-light"));var ee=v(require("bn.js"));var He=9007199254740991;function z(n){let e=K("Raydium_parseBigNumberish");if(n instanceof ee.default)return n;if(typeof n=="string"){if(n.match(/^-?[0-9]+$/))return new ee.default(n);e.logWithError(`invalid BigNumberish string: ${n}`)}return typeof n=="number"?(n%1&&e.logWithError(`BigNumberish number underflow: ${n}`),(n>=He||n<=-He)&&e.logWithError(`BigNumberish number overflow: ${n}`),new ee.default(String(n))):typeof n=="bigint"?new ee.default(n.toString()):(e.error(`invalid BigNumberish value: ${n}`),new ee.default(0))}var be=K("module/fraction"),Re=se(ae.default),ce=se(Je.default),It={[0]:ce.ROUND_DOWN,[1]:ce.ROUND_HALF_UP,[2]:ce.ROUND_UP},kt={[0]:ae.default.roundDown,[1]:ae.default.roundHalfUp,[2]:ae.default.roundUp},D=class{constructor(e,t=new ze.default(1)){this.numerator=z(e),this.denominator=z(t)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new D(this.denominator,this.numerator)}add(e){let t=e instanceof D?e:new D(z(e));return this.denominator.eq(t.denominator)?new D(this.numerator.add(t.numerator),this.denominator):new D(this.numerator.mul(t.denominator).add(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}sub(e){let t=e instanceof D?e:new D(z(e));return this.denominator.eq(t.denominator)?new D(this.numerator.sub(t.numerator),this.denominator):new D(this.numerator.mul(t.denominator).sub(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}mul(e){let t=e instanceof D?e:new D(z(e));return new D(this.numerator.mul(t.numerator),this.denominator.mul(t.denominator))}div(e){let t=e instanceof D?e:new D(z(e));return new D(this.numerator.mul(t.denominator),this.denominator.mul(t.numerator))}toSignificant(e,t={groupSeparator:""},r=1){Number.isInteger(e)||be.logWithError(`${e} is not an integer.`),e<=0&&be.logWithError(`${e} is not positive.`),ce.set({precision:e+1,rounding:It[r]});let h=new ce(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return h.toFormat(h.decimalPlaces(),t)}toFixed(e,t={groupSeparator:""},r=1){return Number.isInteger(e)||be.logWithError(`${e} is not an integer.`),e<0&&be.logWithError(`${e} is negative.`),Re.DP=e,Re.RM=kt[r]||1,new Re(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,t)}isZero(){return this.numerator.isZero()}};var on=K("Raydium_amount"),sn=se(Ze.default);var Qe=require("@solana/web3.js"),Me=require("@solana/spl-token"),Q={chainId:101,address:Qe.PublicKey.default.toBase58(),programId:Me.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},X={chainId:101,address:"So11111111111111111111111111111111111111112",programId:Me.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};var Te=require("@solana/web3.js");var M=require("@solana/web3.js"),Xe=require("@solana/spl-token");function Fe({pubkey:n,isSigner:e=!1,isWritable:t=!0}){return{pubkey:n,isWritable:t,isSigner:e}}var mn=[Fe({pubkey:Xe.TOKEN_PROGRAM_ID,isWritable:!1}),Fe({pubkey:M.SystemProgram.programId,isWritable:!1}),Fe({pubkey:M.SYSVAR_RENT_PUBKEY,isWritable:!1})];function Ye({publicKey:n,transformSol:e}){let t=$e(n.toString());if(t instanceof M.PublicKey)return e&&t.equals(ue)?Le:t;if(e&&t.toString()===ue.toBase58())return Le;if(typeof t=="string"){if(t===M.PublicKey.default.toBase58())return M.PublicKey.default;try{return new M.PublicKey(t)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function $e(n){try{return new M.PublicKey(n)}catch{return n}}var ln=new M.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),pn=new M.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),dn=new M.PublicKey("SysvarRent111111111111111111111111111111111"),fn=new M.PublicKey("SysvarC1ock11111111111111111111111111111111"),gn=new M.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),hn=new M.PublicKey("Sysvar1nstructions1111111111111111111111111"),bn=M.SystemProgram.programId,Tn=new M.PublicKey("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),yn=new M.PublicKey("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),wn=new M.PublicKey("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),xn=new M.PublicKey("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),An=new M.PublicKey("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),Pn=new M.PublicKey("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),In=new M.PublicKey("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),kn=new M.PublicKey("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),Sn=new M.PublicKey("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),Cn=new M.PublicKey("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),Bn=new M.PublicKey("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),Le=new M.PublicKey("So11111111111111111111111111111111111111112"),ue=M.PublicKey.default;var De=class{constructor({mint:e,decimals:t,symbol:r,name:h,skipMint:m=!1,isToken2022:p=!1}){if(e===ue.toBase58()||e instanceof Te.PublicKey&&ue.equals(e)){this.decimals=X.decimals,this.symbol=X.symbol,this.name=X.name,this.mint=new Te.PublicKey(X.address),this.isToken2022=!1;return}this.decimals=t,this.symbol=r||e.toString().substring(0,6),this.name=h||e.toString().substring(0,6),this.mint=m?Te.PublicKey.default:Ye({publicKey:e}),this.isToken2022=p}equals(e){return this===e?!0:this.mint.equals(e.mint)}},te=De;te.WSOL=new De(U(O({},X),{mint:X.address}));var Ve=class{constructor({decimals:e,symbol:t="UNKNOWN",name:r="UNKNOWN"}){this.decimals=e,this.symbol=t,this.name=r}equals(e){return this===e}},ye=Ve;ye.SOL=new Ve(Q);var et=v(require("bn.js"));var _n=new D(new et.default(100));var Gn=K("Raydium_price");var Rt=require("@solana/web3.js"),Mt=v(require("bn.js"));var Bt=new G.default(0),xr=new G.default(1),Ar=new G.default(2),Pr=new G.default(3),Ir=new G.default(5),Ct=new G.default(10),kr=new G.default(100),Sr=new G.default(1e3),Cr=new G.default(1e4);function Ne(n,e=1,t=[]){let r=[...n];if(e<=0)return t;for(;r.length;)t.push(r.splice(0,e));return t}var Nt=require("@solana/web3.js"),Ot=require("@solana/spl-token");var _=require("@solana/web3.js");var me={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",ClmmLockPosition:"ClmmLockPosition",ClmmHarvestLockPosition:"ClmmHarvestLockPosition",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV4Withdraw:"FarmV4Withdraw",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut",CpmmLockLp:"CpmmLockLp",CpmmCollectLockFee:"CpmmCollectLockFee",TransferTip:"TransferTip"};var ot=require("@solana/spl-token"),it=K("Raydium_txUtil"),st=1644;function we(n){let e=[],t=[];return n.microLamports&&(e.push(_.ComputeBudgetProgram.setComputeUnitPrice({microLamports:n.microLamports})),t.push(me.SetComputeUnitPrice)),n.units&&(e.push(_.ComputeBudgetProgram.setComputeUnitLimit({units:n.units})),t.push(me.SetComputeUnitLimit)),{instructions:e,instructionTypes:t}}async function ne(n,e){var r,h;let t=e!=null?e:"confirmed";return(h=await((r=n.getLatestBlockhash)==null?void 0:r.call(n,{commitment:t})))==null?void 0:h.blockhash}async function xe(n,e){return n.getSignatureStatuses([e]),new Promise((t,r)=>{let h=setTimeout(r,6e4);n.onSignature(e,m=>{if(clearTimeout(h),!m.err){t("");return}r(Object.assign(m.err,{txId:e}))},"confirmed")})}function Lt(n,e){n.length<1&&it.logWithError(`no instructions provided: ${n.toString()}`),e.length<1&&it.logWithError(`no signers provided:, ${e.toString()}`);let t=new _.Transaction;t.recentBlockhash="11111111111111111111111111111111",t.feePayer=e[0],t.add(...n);try{return Buffer.from(t.serialize({verifySignatures:!1})).toString("base64").length<st}catch{return!1}}function le({instructions:n,payer:e,signers:t}){return Lt(n,[e,...t])}function pe({instructions:n,payer:e,lookupTableAddressAccount:t,recentBlockhash:r=_.Keypair.generate().publicKey.toString()}){let m=new _.TransactionMessage({payerKey:e,recentBlockhash:r,instructions:n}).compileToV0Message(Object.values(t!=null?t:{}));try{return Buffer.from(new _.VersionedTransaction(m).serialize()).toString("base64").length<st}catch{return!1}}var Dt=n=>Buffer.isBuffer(n)?n:n instanceof Uint8Array?Buffer.from(n.buffer,n.byteOffset,n.byteLength):Buffer.from(n),Vt=n=>{let e=n.serialize({requireAllSignatures:!1,verifySignatures:!1});n instanceof _.VersionedTransaction&&(e=Dt(e));try{return e instanceof Buffer?e.toString("base64"):Buffer.from(e).toString("base64")}catch{return e.toString("base64")}};function Y(n){let e=[];return n.forEach(t=>{t instanceof _.Transaction&&(t.recentBlockhash||(t.recentBlockhash=ot.TOKEN_PROGRAM_ID.toBase58()),t.feePayer||(t.feePayer=_.Keypair.generate().publicKey)),e.push(Vt(t))}),console.log("simulate tx string:",e),e}var a=require("@solana/web3.js"),Gr=new a.PublicKey("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),jr=new a.PublicKey("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),Hr=new a.PublicKey("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),zr=new a.PublicKey("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),Jr=new a.PublicKey("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),Zr=new a.PublicKey("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),Qr=new a.PublicKey("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),Xr=new a.PublicKey("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),Yr=new a.PublicKey("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),$r=new a.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),ei=new a.PublicKey("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),ti=new a.PublicKey("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),ni=new a.PublicKey("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),ri=new a.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),ii=new a.PublicKey("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),oi=new a.PublicKey("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),si=new a.PublicKey("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),ai=new a.PublicKey("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),ci=new a.PublicKey("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),ui=new a.PublicKey("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),mi=new a.PublicKey("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),li=new a.PublicKey("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),pi=new a.PublicKey("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),di=new a.PublicKey("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),fi=new a.PublicKey("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),gi=new a.PublicKey("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),hi=new a.PublicKey("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),bi=new a.PublicKey("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),Ti=new a.PublicKey("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),yi=new a.PublicKey("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),wi=new a.PublicKey("6s1xP3hpbAfFoNtUNF8mfHsjr2Bd97JxFJRWLbL6aHuX");var xi={OPEN_BOOK_PROGRAM:new a.PublicKey("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),SERUM_PROGRAM_ID_V3:new a.PublicKey("Ray1111111111111111111111111111111111111111"),AMM_V4:new a.PublicKey("DRaya7Kj3aMWQSy19kSjvmuwq9docCHofyP9kanQGaav"),AMM_STABLE:new a.PublicKey("DRayDdXc1NZQ9C3hRWmoSf8zK4iapgMnjdNZWrfwsP8m"),CLMM_PROGRAM_ID:new a.PublicKey("DRayAUgENGQBKVaX8owNhgzkEDyoHTGVEGHVJT1E9pfH"),CLMM_LOCK_PROGRAM_ID:new a.PublicKey("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),CLMM_LOCK_AUTH_ID:new a.PublicKey("6Aoh8h2Lw2m5UGxYR8AdAL87jTWYeKoxM52mJRzfYwN"),CREATE_CPMM_POOL_PROGRAM:new a.PublicKey("DRaycpLY18LhpbydsBWbVJtxpNv9oXPgjRSfpF2bWpYb"),CREATE_CPMM_POOL_AUTH:new a.PublicKey("CXniRufdq5xL8t8jZAPxsPZDpuudwuJSPWnbcD5Y5Nxq"),CREATE_CPMM_POOL_FEE_ACC:new a.PublicKey("3oE58BKVt8KuYkGxx8zBojugnymWmBiyafWgMrnb6eYy"),LOCK_CPMM_PROGRAM:new a.PublicKey("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),LOCK_CPMM_AUTH:new a.PublicKey("7qWVV8UY2bRJfDLP4s37YzBPKUkVB46DStYJBpYbQzu3"),UTIL1216:a.PublicKey.default,Router:new a.PublicKey("DRaybByLpbUL57LJARs3j8BitTxVfzBg351EaMr5UTCd"),FARM_PROGRAM_ID_V3:new a.PublicKey("DRayWyrLmEW5KEeqs8kdTMMaBabapqagaBC7KWpGtJeZ"),FARM_PROGRAM_ID_V4:new a.PublicKey("Ray1111111111111111111111111111111111111111"),FARM_PROGRAM_ID_V5:new a.PublicKey("DRayiCGSZgku1GTK6rXD6mVDdingXy6APAH1R6R5L2LC"),FARM_PROGRAM_ID_V6:new a.PublicKey("DRayzbYakXs45ELHkzH6vC3fuhQqTAnv5A68gdFuvZyZ"),LAUNCHPAD_PROGRAM:new a.PublicKey("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),LAUNCHPAD_AUTH:new a.PublicKey("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),LAUNCHPAD_PLATFORM:new a.PublicKey("2Jx4KTDrVSdWNazuGpcA8n3ZLTRGGBDxAWhuKe2Xcj2a"),LAUNCHPAD_CONFIG:new a.PublicKey("7ZR4zD7PYfY2XxoG1Gxcy2EgEeGYrpxrwzPuwdUBssEt"),FEE_DESTINATION_ID:new a.PublicKey("9y8ENuuZ3b19quffx9hQvRVygG5ky6snHfRvGpuSfeJy"),MODEL_DATA_PUBKEY:new a.PublicKey("Ray1111111111111111111111111111111111111111")};var Et=v(require("bn.js"));var at=v(require("bn.js")),Ii=new at.default(1e6);var Ae=require("@solana/spl-token"),Oe=K("Raydium_accountInfo_util");async function ut(n,e,t){let{batchRequest:r,commitment:h="confirmed",chunkCount:m=100}=O({batchRequest:!1},t),p=Ne(e,m),o=new Array(p.length).fill([]);if(r){let P=p.map(x=>{let A=n._buildArgs([x.map(w=>w.toBase58())],h,"base64");return{methodName:"getMultipleAccounts",args:A}}),i=Ne(P,10);o=(await(await Promise.all(i.map(async x=>await n._rpcBatchRequest(x)))).flat()).map(x=>(x.error&&Oe.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${x.error.message}`),x.result.value.map(A=>{if(A){let{data:w,executable:d,lamports:T,owner:c,rentEpoch:I}=A;return w.length!==2&&w[1]!=="base64"&&Oe.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(w[0],"base64"),executable:d,lamports:T,owner:new ct.PublicKey(c),rentEpoch:I}}return null})))}else try{o=await Promise.all(p.map(P=>n.getMultipleAccountsInfo(P,h)))}catch(P){P instanceof Error&&Oe.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${P.message}`)}return o.flat()}async function Ee({connection:n,address:e,cluster:t="mainnet"}){let r=await ut(n,[...new Set(e.map(m=>m.toString()))].map(m=>new q.PublicKey(m))),h={};for(let m=0;m<e.length;m++){let p=r[m],o=e[m];if(!p)continue;let P=new q.AddressLookupTableAccount({key:o,state:q.AddressLookupTableAccount.deserialize(p.data)});h[o.toString()]=P,t==="devnet"?re[o.toString()]=P:Pe[o.toString()]=P}return h}var Pe={AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU:new q.AddressLookupTableAccount({key:new q.PublicKey("AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU"),state:q.AddressLookupTableAccount.deserialize(Buffer.from("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","base64"))})},re={},_e=async n=>{let e="EFhMuDw1PKEuckuFRW9PavNfTH4LKP5uKHgyXDmWpFCq";if(re[e])return re;let t=new q.PublicKey(e),r=await n.getAccountInfo(t);return r&&(re[e]=new q.AddressLookupTableAccount({key:t,state:q.AddressLookupTableAccount.deserialize(r.data)})),re};var Ie=2e3,ke=class{constructor(e){this.instructions=[];this.endInstructions=[];this.lookupTableAddress=[];this.signers=[];this.instructionTypes=[];this.endInstructionTypes=[];this.connection=e.connection,this.feePayer=e.feePayer,this.signAllTransactions=e.signAllTransactions,this.owner=e.owner,this.cluster=e.cluster,this.blockhashCommitment=e.blockhashCommitment,this.loopMultiTxStatus=!!e.loopMultiTxStatus}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers,instructionTypes:this.instructionTypes,endInstructionTypes:this.endInstructionTypes,lookupTableAddress:this.lookupTableAddress}}get allInstructions(){return[...this.instructions,...this.endInstructions]}async getComputeBudgetConfig(){var r;let e=(await mt.default.get(`https://solanacompass.com/api/fees?cacheFreshTime=${3e5}`)).data,{avg:t}=(r=e==null?void 0:e[15])!=null?r:{};if(!!t)return{units:6e5,microLamports:Math.min(Math.ceil(t*1e6/6e5),25e3)}}addCustomComputeBudget(e){if(e){let{instructions:t,instructionTypes:r}=we(e);return this.instructions.unshift(...t),this.instructionTypes.unshift(...r),!0}return!1}addTipInstruction(e){var t;return e?(this.endInstructions.push(S.SystemProgram.transfer({fromPubkey:(t=e.feePayer)!=null?t:this.feePayer,toPubkey:new S.PublicKey(e.address),lamports:BigInt(e.amount.toString())})),this.endInstructionTypes.push(me.TransferTip),!0):!1}async calComputeBudget({config:e,defaultIns:t}){try{let r=e||await this.getComputeBudgetConfig();if(this.addCustomComputeBudget(r))return;t&&this.instructions.unshift(...t)}catch{t&&this.instructions.unshift(...t)}}addInstruction({instructions:e=[],endInstructions:t=[],signers:r=[],instructionTypes:h=[],endInstructionTypes:m=[],lookupTableAddress:p=[]}){return this.instructions.push(...e),this.endInstructions.push(...t),this.signers.push(...r),this.instructionTypes.push(...h),this.endInstructionTypes.push(...m),this.lookupTableAddress.push(...p.filter(o=>o!==S.PublicKey.default.toString())),this}async versionBuild({txVersion:e,extInfo:t}){return e===0?await this.buildV0(O({},t||{})):this.build(t)}build(e){var r;let t=new S.Transaction;return this.allInstructions.length&&t.add(...this.allInstructions),t.feePayer=this.feePayer,((r=this.owner)==null?void 0:r.signer)&&!this.signers.some(h=>h.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer),{builder:this,transaction:t,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async h=>{var f;let{recentBlockHash:m,skipPreflight:p=!0,sendAndConfirm:o,notSendToRpc:P}=h||{},i=m!=null?m:await ne(this.connection,this.blockhashCommitment);if(t.recentBlockhash=i,this.signers.length&&t.sign(...this.signers),Y([t]),(f=this.owner)!=null&&f.isKeyPair)return{txId:o?await(0,S.sendAndConfirmTransaction)(this.connection,t,this.signers.find(A=>A.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:p}):await this.connection.sendRawTransaction(t.serialize(),{skipPreflight:p}),signedTx:t};if(this.signAllTransactions){let x=await this.signAllTransactions([t]);if(this.signers.length)for(let A of x)try{A.sign(...this.signers)}catch{}return{txId:P?"":await this.connection.sendRawTransaction(x[0].serialize(),{skipPreflight:p}),signedTx:x[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:e||{}}}buildMultiTx(e){var i;let{extraPreBuildData:t=[],extInfo:r}=e,{transaction:h}=this.build(r),m=t.filter(f=>f.transaction.instructions.length>0),p=[h,...m.map(f=>f.transaction)],o=[this.signers,...m.map(f=>f.signers)],P=[...this.instructionTypes,...m.map(f=>f.instructionTypes).flat()];return(i=this.owner)!=null&&i.signer&&o.forEach(f=>{f.some(x=>x.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),{builder:this,transactions:p,signers:o,instructionTypes:P,execute:async f=>{var I;let{sequentially:x,onTxUpdate:A,skipTxCount:w=0,recentBlockHash:d,skipPreflight:T=!0}=f||{},c=d!=null?d:await ne(this.connection,this.blockhashCommitment);if((I=this.owner)!=null&&I.isKeyPair){if(x){let g=[],C=0;for(let l of p){if(++C,C<=w)continue;let s=await(0,S.sendAndConfirmTransaction)(this.connection,l,this.signers.find(u=>u.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:T});g.push(s)}return{txIds:g,signedTxs:p}}return{txIds:await await Promise.all(p.map(async g=>(g.recentBlockhash=c,await this.connection.sendRawTransaction(g.serialize(),{skipPreflight:T})))),signedTxs:p}}if(this.signAllTransactions){let g=p.map((l,s)=>(l.recentBlockhash=c,o[s].length&&l.sign(...o[s]),l));Y(g);let C=await this.signAllTransactions(g);if(x){let l=0,s=[],u=async()=>{if(!C[l])return;let y=await this.connection.sendRawTransaction(C[l].serialize(),{skipPreflight:T});s.push({txId:y,status:"sent",signedTx:C[l]}),A==null||A([...s]),l++;let b=!1,k=null,F=null,V=B=>{k!==null&&clearInterval(k),F!==null&&this.connection.removeSignatureListener(F);let L=s.findIndex(N=>N.txId===y);if(L>-1){if(s[L].status==="error"||s[L].status==="success")return;s[L].status=B.err?"error":"success"}A==null||A([...s]),B.err||u()};this.loopMultiTxStatus&&(k=setInterval(async()=>{var B;if(b){clearInterval(k);return}try{let L=await this.connection.getTransaction(y,{commitment:"confirmed",maxSupportedTransactionVersion:0});L&&(b=!0,clearInterval(k),V({err:((B=L.meta)==null?void 0:B.err)||null}),console.log("tx status from getTransaction:",y))}catch(L){b=!0,clearInterval(k),console.error("getTransaction timeout:",L,y)}},Ie)),F=this.connection.onSignature(y,B=>{if(b){this.connection.removeSignatureListener(F);return}b=!0,V(B)},"confirmed"),this.connection.getSignatureStatus(y)};return await u(),{txIds:s.map(y=>y.txId),signedTxs:C}}else{let l=[];for(let s=0;s<C.length;s+=1){let u=await this.connection.sendRawTransaction(C[s].serialize(),{skipPreflight:T});l.push(u)}return{txIds:l,signedTxs:C}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async versionMultiBuild({extraPreBuildData:e,txVersion:t,extInfo:r}){return t===0?await this.buildV0MultiTx({extraPreBuildData:e,buildProps:r||{}}):this.buildMultiTx({extraPreBuildData:e,extInfo:r})}async buildV0(e){var T;let d=e||{},{lookupTableCache:t={},lookupTableAddress:r=[],forerunCreate:h,recentBlockhash:m}=d,p=he(d,["lookupTableCache","lookupTableAddress","forerunCreate","recentBlockhash"]),o=O(O({},this.cluster==="devnet"?await _e(this.connection):Pe),t),P=Array.from(new Set([...r,...this.lookupTableAddress])),i=[];for(let c of P)o[c]===void 0&&i.push(new S.PublicKey(c));let f=await Ee({connection:this.connection,address:i});for(let[c,I]of Object.entries(f))o[c]=I;let x=h?S.PublicKey.default.toBase58():m!=null?m:await ne(this.connection,this.blockhashCommitment),A=new S.TransactionMessage({payerKey:this.feePayer,recentBlockhash:x,instructions:[...this.allInstructions]}).compileToV0Message(Object.values(o));((T=this.owner)==null?void 0:T.signer)&&!this.signers.some(c=>c.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer);let w=new S.VersionedTransaction(A);return w.sign(this.signers),{builder:this,transaction:w,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async c=>{var l;let{skipPreflight:I=!0,sendAndConfirm:g,notSendToRpc:C}=c||{};if(Y([w]),(l=this.owner)!=null&&l.isKeyPair){let s=await this.connection.sendTransaction(w,{skipPreflight:I});return g&&await xe(this.connection,s),{txId:s,signedTx:w}}if(this.signAllTransactions){let s=await this.signAllTransactions([w]);if(this.signers.length)for(let u of s)try{u.sign(this.signers)}catch{}return{txId:C?"":await this.connection.sendTransaction(s[0],{skipPreflight:I}),signedTx:s[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:p||{}}}async buildV0MultiTx(e){var i;let{extraPreBuildData:t=[],buildProps:r}=e,{transaction:h}=await this.buildV0(r),m=t.filter(f=>f.builder.instructions.length>0),p=[h,...m.map(f=>f.transaction)],o=[this.signers,...m.map(f=>f.signers)],P=[...this.instructionTypes,...m.map(f=>f.instructionTypes).flat()];return(i=this.owner)!=null&&i.signer&&o.forEach(f=>{f.some(x=>x.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),p.forEach(async(f,x)=>{f.sign(o[x])}),{builder:this,transactions:p,signers:o,instructionTypes:P,buildProps:r,execute:async f=>{var T;let{sequentially:x,onTxUpdate:A,recentBlockHash:w,skipPreflight:d=!0}=f||{};if(w&&p.forEach(c=>c.message.recentBlockhash=w),Y(p),(T=this.owner)!=null&&T.isKeyPair){if(x){let c=[];for(let I of p){let g=await this.connection.sendTransaction(I,{skipPreflight:d});await xe(this.connection,g),c.push(g)}return{txIds:c,signedTxs:p}}return{txIds:await Promise.all(p.map(async c=>await this.connection.sendTransaction(c,{skipPreflight:d}))),signedTxs:p}}if(this.signAllTransactions){let c=await this.signAllTransactions(p);if(x){let I=0,g=[],C=async()=>{if(!c[I])return;let l=await this.connection.sendTransaction(c[I],{skipPreflight:d});g.push({txId:l,status:"sent",signedTx:c[I]}),A==null||A([...g]),I++;let s=!1,u=null,y=null,b=k=>{u!==null&&clearInterval(u),y!==null&&this.connection.removeSignatureListener(y);let F=g.findIndex(V=>V.txId===l);if(F>-1){if(g[F].status==="error"||g[F].status==="success")return;g[F].status=k.err?"error":"success"}A==null||A([...g]),k.err||C()};this.loopMultiTxStatus&&(u=setInterval(async()=>{var k;if(s){clearInterval(u);return}try{let F=await this.connection.getTransaction(l,{commitment:"confirmed",maxSupportedTransactionVersion:0});F&&(s=!0,clearInterval(u),b({err:((k=F.meta)==null?void 0:k.err)||null}),console.log("tx status from getTransaction:",l))}catch(F){s=!0,clearInterval(u),console.error("getTransaction timeout:",F,l)}},Ie)),y=this.connection.onSignature(l,k=>{if(s){this.connection.removeSignatureListener(y);return}s=!0,b(k)},"confirmed"),this.connection.getSignatureStatus(l)};return C(),{txIds:[],signedTxs:c}}else{let I=[];for(let g=0;g<c.length;g+=1){let C=await this.connection.sendTransaction(c[g],{skipPreflight:d});I.push(C)}return{txIds:I,signedTxs:c}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async sizeCheckBuild(e){var A;let x=e||{},{splitIns:t=[],computeBudgetConfig:r}=x,h=he(x,["splitIns","computeBudgetConfig"]),m=r?we(r):{instructions:[],instructionTypes:[]},p=this.signers.reduce((w,d)=>U(O({},w),{[d.publicKey.toBase58()]:d}),{}),o=[],P=[],i=[],f=0;if(this.allInstructions.forEach(w=>{let d=[...i,w],T=r?[...m.instructions,...d]:d,I=[...new Set(d.map(g=>g.keys.filter(C=>C.isSigner).map(C=>C.pubkey.toString())).flat()).values()].map(g=>new S.PublicKey(g));if(w!==t[f]&&i.length<12&&(le({instructions:T,payer:this.feePayer,signers:I})||le({instructions:d,payer:this.feePayer,signers:I})))i.push(w);else{if(i.length===0)throw Error("item ins too big");f+=w===t[f]?1:0,le({instructions:r?[...m.instructions,...i]:[...i],payer:this.feePayer,signers:I})?o.push(new S.Transaction().add(...m.instructions,...i)):o.push(new S.Transaction().add(...i)),P.push(Array.from(new Set(i.map(g=>g.keys.filter(C=>C.isSigner).map(C=>C.pubkey.toString())).flat())).map(g=>p[g]).filter(g=>g!==void 0)),i=[w]}}),i.length>0){let d=[...new Set(i.map(T=>T.keys.filter(c=>c.isSigner).map(c=>c.pubkey.toString())).flat()).values()].map(T=>p[T]).filter(T=>T!==void 0);le({instructions:r?[...m.instructions,...i]:[...i],payer:this.feePayer,signers:d.map(T=>T.publicKey)})?o.push(new S.Transaction().add(...m.instructions,...i)):o.push(new S.Transaction().add(...i)),P.push(d)}return o.forEach(w=>w.feePayer=this.feePayer),(A=this.owner)!=null&&A.signer&&P.forEach(w=>{w.some(d=>d.publicKey.equals(this.owner.publicKey))||w.push(this.owner.signer)}),{builder:this,transactions:o,signers:P,instructionTypes:this.instructionTypes,execute:async w=>{var l;let{sequentially:d,onTxUpdate:T,skipTxCount:c=0,recentBlockHash:I,skipPreflight:g=!0}=w||{},C=I!=null?I:await ne(this.connection,this.blockhashCommitment);if(o.forEach(async(s,u)=>{s.recentBlockhash=C,P[u].length&&s.sign(...P[u])}),Y(o),(l=this.owner)!=null&&l.isKeyPair){if(d){let s=0,u=[];for(let y of o){if(++s,s<=c){u.push("tx skipped");continue}let b=await(0,S.sendAndConfirmTransaction)(this.connection,y,this.signers.find(k=>k.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:g});u.push(b)}return{txIds:u,signedTxs:o}}return{txIds:await Promise.all(o.map(async s=>await this.connection.sendRawTransaction(s.serialize(),{skipPreflight:g}))),signedTxs:o}}if(this.signAllTransactions){let s=await this.signAllTransactions(o.slice(c,o.length)),u=[...o.slice(0,c),...s];if(d){let y=0,b=[],k=async()=>{if(!u[y])return;y<c&&(b.push({txId:"",status:"success",signedTx:u[y]}),T==null||T([...b]),y++,k());let F=await this.connection.sendRawTransaction(u[y].serialize(),{skipPreflight:g});b.push({txId:F,status:"sent",signedTx:u[y]}),T==null||T([...b]),y++;let V=!1,B=null,L=null,N=W=>{B!==null&&clearInterval(B),L!==null&&this.connection.removeSignatureListener(L);let E=b.findIndex(J=>J.txId===F);if(E>-1){if(b[E].status==="error"||b[E].status==="success")return;b[E].status=W.err?"error":"success"}T==null||T([...b]),W.err||k()};this.loopMultiTxStatus&&(B=setInterval(async()=>{var W;if(V){clearInterval(B);return}try{let E=await this.connection.getTransaction(F,{commitment:"confirmed",maxSupportedTransactionVersion:0});E&&(V=!0,clearInterval(B),N({err:((W=E.meta)==null?void 0:W.err)||null}),console.log("tx status from getTransaction:",F))}catch(E){V=!0,clearInterval(B),console.error("getTransaction timeout:",E,F)}},Ie)),L=this.connection.onSignature(F,W=>{if(V){this.connection.removeSignatureListener(L);return}V=!0,N(W)},"confirmed"),this.connection.getSignatureStatus(F)};return await k(),{txIds:b.map(F=>F.txId),signedTxs:u}}else{let y=[];for(let b=0;b<u.length;b+=1){let k=await this.connection.sendRawTransaction(u[b].serialize(),{skipPreflight:g});y.push(k)}return{txIds:y,signedTxs:u}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:h||{}}}async sizeCheckBuildV0(e){var C;let g=e||{},{computeBudgetConfig:t,splitIns:r=[],lookupTableCache:h={},lookupTableAddress:m=[]}=g,p=he(g,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),o=O(O({},this.cluster==="devnet"?await _e(this.connection):Pe),h),P=Array.from(new Set([...this.lookupTableAddress,...m])),i=[];for(let l of P)o[l]===void 0&&i.push(new S.PublicKey(l));let f=await Ee({connection:this.connection,address:i});for(let[l,s]of Object.entries(f))o[l]=s;let x=t?we(t):{instructions:[],instructionTypes:[]},A=await ne(this.connection,this.blockhashCommitment),w=this.signers.reduce((l,s)=>U(O({},l),{[s.publicKey.toBase58()]:s}),{}),d=[],T=[],c=[],I=0;if(this.allInstructions.forEach(l=>{let s=[...c,l],u=t?[...x.instructions,...s]:s;if(l!==r[I]&&c.length<12&&(pe({instructions:u,payer:this.feePayer,lookupTableAddressAccount:o})||pe({instructions:s,payer:this.feePayer,lookupTableAddressAccount:o})))c.push(l);else{if(c.length===0)throw Error("item ins too big");I+=l===r[I]?1:0;let y={};for(let b of[...new Set(P)])o[b]!==void 0&&(y[b]=o[b]);if(t&&pe({instructions:[...x.instructions,...c],payer:this.feePayer,lookupTableAddressAccount:o,recentBlockhash:A})){let b=new S.TransactionMessage({payerKey:this.feePayer,recentBlockhash:A,instructions:[...x.instructions,...c]}).compileToV0Message(Object.values(o));d.push(new S.VersionedTransaction(b))}else{let b=new S.TransactionMessage({payerKey:this.feePayer,recentBlockhash:A,instructions:[...c]}).compileToV0Message(Object.values(o));d.push(new S.VersionedTransaction(b))}T.push(Array.from(new Set(c.map(b=>b.keys.filter(k=>k.isSigner).map(k=>k.pubkey.toString())).flat())).map(b=>w[b]).filter(b=>b!==void 0)),c=[l]}}),c.length>0){let s=[...new Set(c.map(u=>u.keys.filter(y=>y.isSigner).map(y=>y.pubkey.toString())).flat()).values()].map(u=>w[u]).filter(u=>u!==void 0);if(t&&pe({instructions:[...x.instructions,...c],payer:this.feePayer,lookupTableAddressAccount:o,recentBlockhash:A})){let u=new S.TransactionMessage({payerKey:this.feePayer,recentBlockhash:A,instructions:[...x.instructions,...c]}).compileToV0Message(Object.values(o));d.push(new S.VersionedTransaction(u))}else{let u=new S.TransactionMessage({payerKey:this.feePayer,recentBlockhash:A,instructions:[...c]}).compileToV0Message(Object.values(o));d.push(new S.VersionedTransaction(u))}T.push(s)}return(C=this.owner)!=null&&C.signer&&T.forEach(l=>{l.some(s=>s.publicKey.equals(this.owner.publicKey))||l.push(this.owner.signer)}),d.forEach((l,s)=>{l.sign(T[s])}),{builder:this,transactions:d,buildProps:e,signers:T,instructionTypes:this.instructionTypes,execute:async l=>{var F;let{sequentially:s,onTxUpdate:u,skipTxCount:y=0,recentBlockHash:b,skipPreflight:k=!0}=l||{};if(d.map(async(V,B)=>{T[B].length&&V.sign(T[B]),b&&(V.message.recentBlockhash=b)}),Y(d),(F=this.owner)!=null&&F.isKeyPair){if(s){let V=0,B=[];for(let L of d){if(++V,V<=y){console.log("skip tx: ",V),B.push("tx skipped");continue}let N=await this.connection.sendTransaction(L,{skipPreflight:k});await xe(this.connection,N),B.push(N)}return{txIds:B,signedTxs:d}}return{txIds:await Promise.all(d.map(async V=>await this.connection.sendTransaction(V,{skipPreflight:k}))),signedTxs:d}}if(this.signAllTransactions){let V=await this.signAllTransactions(d.slice(y,d.length)),B=[...d.slice(0,y),...V];if(s){let L=0,N=[],W=async()=>{if(!B[L])return;if(L<y){N.push({txId:"",status:"success",signedTx:B[L]}),u==null||u([...N]),L++,W();return}let E=await this.connection.sendTransaction(B[L],{skipPreflight:k});N.push({txId:E,status:"sent",signedTx:B[L]}),u==null||u([...N]),L++;let J=!1,$=null,fe=null,Ke=Z=>{$!==null&&clearInterval($),fe!==null&&this.connection.removeSignatureListener(fe);let H=N.findIndex(pt=>pt.txId===E);if(H>-1){if(N[H].status==="error"||N[H].status==="success")return;N[H].status=Z.err?"error":"success"}u==null||u([...N]),Z.err||W()};this.loopMultiTxStatus&&($=setInterval(async()=>{var Z;if(J){clearInterval($);return}try{let H=await this.connection.getTransaction(E,{commitment:"confirmed",maxSupportedTransactionVersion:0});H&&(J=!0,clearInterval($),Ke({err:((Z=H.meta)==null?void 0:Z.err)||null}),console.log("tx status from getTransaction:",E))}catch(H){J=!0,clearInterval($),console.error("getTransaction timeout:",H,E)}},Ie)),fe=this.connection.onSignature(E,Z=>{if(J){this.connection.removeSignatureListener(fe);return}J=!0,Ke(Z)},"confirmed"),this.connection.getSignatureStatus(E)};return W(),{txIds:[],signedTxs:B}}else{let L=[];for(let N=0;N<B.length;N+=1){let W=await this.connection.sendTransaction(B[N],{skipPreflight:k});L.push(W)}return{txIds:L,signedTxs:B}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:p||{}}}};var ve=(...n)=>n.map(e=>{try{return typeof e=="object"?JSON.stringify(e):e}catch{return e}}).join(", "),de=class{constructor({scope:e,moduleName:t}){this.disabled=!1;this.scope=e,this.logger=K(t)}createTxBuilder(e){return this.scope.checkOwner(),new ke({connection:this.scope.connection,feePayer:e||this.scope.ownerPubKey,cluster:this.scope.cluster,owner:this.scope.owner,blockhashCommitment:this.scope.blockhashCommitment,loopMultiTxStatus:this.scope.loopMultiTxStatus,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}logDebug(...e){this.logger.debug(ve(e))}logInfo(...e){this.logger.info(ve(e))}logAndCreateError(...e){let t=ve(e);throw new Error(t)}checkDisabled(){(this.disabled||!this.scope)&&this.logAndCreateError("module not working")}};var Se=class extends de{constructor(t){super(t);this._tokenList=[];this._tokenMap=new Map;this._blackTokenMap=new Set;this._mintGroup={official:new Set,jup:new Set,extra:new Set};this._whiteMap=new Set;this._extraTokenList=[]}async load(t){this.checkDisabled();let{forceUpdate:r=!1,type:h="strict"}=t||{},{mintList:m,blacklist:p,whiteList:o}=await this.scope.fetchV3TokenList(r),P=await this.scope.fetchJupTokenList(r);this._tokenList=[],this._tokenMap=new Map,this._blackTokenMap=new Set(p),this._mintGroup={official:new Set,jup:new Set,extra:new Set},this._whiteMap=new Set(o),this._tokenMap.set(Q.address,Q),this._mintGroup.official.add(Q.address),m.forEach(i=>{var f;this._blackTokenMap.has(i.address)||(this._tokenMap.set(i.address,U(O({},i),{type:"raydium",priority:2,programId:(f=i.programId)!=null?f:i.tags.includes("token-2022")?j.TOKEN_2022_PROGRAM_ID.toBase58():j.TOKEN_PROGRAM_ID.toBase58()})),this._mintGroup.official.add(i.address))}),P.forEach(i=>{var f;this._blackTokenMap.has(i.address)||this._tokenMap.has(i.address)||(this._tokenMap.set(i.address,U(O({},i),{type:"jupiter",priority:1,programId:(f=i.programId)!=null?f:i.tags.includes("token-2022")?j.TOKEN_2022_PROGRAM_ID.toBase58():j.TOKEN_PROGRAM_ID.toBase58(),tags:i.freezeAuthority?[...i.tags||[],"hasFreeze"]:i.tags})),this._mintGroup.jup.add(i.address))}),this._extraTokenList.forEach(i=>{this._blackTokenMap.has(i.address)||this._tokenMap.has(i.address)||(this._tokenMap.set(i.address,U(O({},i),{type:"extra",priority:1,programId:i.programId||i.tags.includes("token-2022")?j.TOKEN_2022_PROGRAM_ID.toBase58():j.TOKEN_PROGRAM_ID.toBase58()})),this._mintGroup.extra.add(i.address))}),this._tokenList=Array.from(this._tokenMap).map(i=>i[1])}get tokenList(){return this._tokenList}get tokenMap(){return this._tokenMap}get blackTokenMap(){return this._blackTokenMap}get mintGroup(){return this._mintGroup}get whiteListMap(){return this._whiteMap}async getTokenInfo(t){if(!t)throw new Error("please input mint");let r=t.toString(),h=this._tokenMap.get(r);if(h)return h;if(r.toLocaleUpperCase()==="SOL")return Q;let m=(await this.scope.api.getTokenInfo([r]))[0];if(m)return this._mintGroup.extra.add(r),this._tokenMap.set(r,U(O({},m),{priority:2})),m;let p=await this.scope.connection.getAccountInfo(new lt.PublicKey(r));if(!p)throw new Error(`mint address not found: ${r}`);let o=j.MintLayout.decode(p.data),P=r.toString().substring(0,6),i={chainId:101,address:r,programId:p.owner.toBase58(),logoURI:"",symbol:P,name:P,decimals:o.decimals,tags:[],extensions:{},priority:0,type:"unknown"};return this._mintGroup.extra.add(r),this._tokenMap.set(r,i),i}};0&&(module.exports={});
//# sourceMappingURL=token.js.map