var ft=Object.create;var ce=Object.defineProperty,gt=Object.defineProperties,ht=Object.getOwnPropertyDescriptor,bt=Object.getOwnPropertyDescriptors,Tt=Object.getOwnPropertyNames,Pe=Object.getOwnPropertySymbols,yt=Object.getPrototypeOf,Le=Object.prototype.hasOwnProperty,Ge=Object.prototype.propertyIsEnumerable;var Ue=(n,e,t)=>e in n?ce(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,E=(n,e)=>{for(var t in e||(e={}))Le.call(e,t)&&Ue(n,t,e[t]);if(Pe)for(var t of Pe(e))Ge.call(e,t)&&Ue(n,t,e[t]);return n},q=(n,e)=>gt(n,bt(e));var ue=(n,e)=>{var t={};for(var r in n)Le.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&Pe)for(var r of Pe(n))e.indexOf(r)<0&&Ge.call(n,r)&&(t[r]=n[r]);return t};var wt=(n,e)=>{for(var t in e)ce(n,t,{get:e[t],enumerable:!0})},je=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let w of Tt(e))!Le.call(n,w)&&w!==t&&ce(n,w,{get:()=>e[w],enumerable:!(r=ht(e,w))||r.enumerable});return n};var U=(n,e,t)=>(t=n!=null?ft(yt(n)):{},je(e||!n||!n.__esModule?ce(t,"default",{value:n,enumerable:!0}):t,n)),xt=n=>je(ce({},"__esModule",{value:!0}),n);var vt={};wt(vt,{default:()=>Me});module.exports=xt(vt);var dt=require("@solana/web3.js"),Z=require("@solana/spl-token");var me=require("lodash");var Ve=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:0,this.name=e.name}set level(e){this.logLevel=e}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let t=e.map(r=>typeof r=="object"?JSON.stringify(r):r).join(", ");throw new Error(t)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},He={},At={};function G(n){let e=(0,me.get)(He,n);if(!e){let t=(0,me.get)(At,n);e=new Ve({name:n,logLevel:t}),(0,me.set)(He,n,e)}return e}var S=require("@solana/web3.js"),pt=U(require("axios"));var z=require("@solana/web3.js");var mt=require("@solana/web3.js");var J=U(require("bn.js")),Lt=U(require("decimal.js"));var Xe=U(require("big.js")),Ct=U(require("bn.js"));var ze=U(require("toformat")),Pt=ze.default,le=Pt;var pe=U(require("big.js")),Qe=U(require("bn.js")),Ze=U(require("decimal.js-light"));var ie=U(require("bn.js"));var Je=9007199254740991;function Y(n){let e=G("Raydium_parseBigNumberish");if(n instanceof ie.default)return n;if(typeof n=="string"){if(n.match(/^-?[0-9]+$/))return new ie.default(n);e.logWithError(`invalid BigNumberish string: ${n}`)}return typeof n=="number"?(n%1&&e.logWithError(`BigNumberish number underflow: ${n}`),(n>=Je||n<=-Je)&&e.logWithError(`BigNumberish number overflow: ${n}`),new ie.default(String(n))):typeof n=="bigint"?new ie.default(n.toString()):(e.error(`invalid BigNumberish value: ${n}`),new ie.default(0))}var Ie=G("module/fraction"),De=le(pe.default),de=le(Ze.default),kt={[0]:de.ROUND_DOWN,[1]:de.ROUND_HALF_UP,[2]:de.ROUND_UP},St={[0]:pe.default.roundDown,[1]:pe.default.roundHalfUp,[2]:pe.default.roundUp},O=class{constructor(e,t=new Qe.default(1)){this.numerator=Y(e),this.denominator=Y(t)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new O(this.denominator,this.numerator)}add(e){let t=e instanceof O?e:new O(Y(e));return this.denominator.eq(t.denominator)?new O(this.numerator.add(t.numerator),this.denominator):new O(this.numerator.mul(t.denominator).add(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}sub(e){let t=e instanceof O?e:new O(Y(e));return this.denominator.eq(t.denominator)?new O(this.numerator.sub(t.numerator),this.denominator):new O(this.numerator.mul(t.denominator).sub(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}mul(e){let t=e instanceof O?e:new O(Y(e));return new O(this.numerator.mul(t.numerator),this.denominator.mul(t.denominator))}div(e){let t=e instanceof O?e:new O(Y(e));return new O(this.numerator.mul(t.denominator),this.denominator.mul(t.numerator))}toSignificant(e,t={groupSeparator:""},r=1){Number.isInteger(e)||Ie.logWithError(`${e} is not an integer.`),e<=0&&Ie.logWithError(`${e} is not positive.`),de.set({precision:e+1,rounding:kt[r]});let w=new de(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return w.toFormat(w.decimalPlaces(),t)}toFixed(e,t={groupSeparator:""},r=1){return Number.isInteger(e)||Ie.logWithError(`${e} is not an integer.`),e<0&&Ie.logWithError(`${e} is negative.`),De.DP=e,De.RM=St[r]||1,new De(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,t)}isZero(){return this.numerator.isZero()}};var sn=G("Raydium_amount"),an=le(Xe.default);var Ye=require("@solana/web3.js"),Ne=require("@solana/spl-token"),te={chainId:101,address:Ye.PublicKey.default.toBase58(),programId:Ne.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},ne={chainId:101,address:"So11111111111111111111111111111111111111112",programId:Ne.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};var ke=require("@solana/web3.js");var D=require("@solana/web3.js"),$e=require("@solana/spl-token");function Oe({pubkey:n,isSigner:e=!1,isWritable:t=!0}){return{pubkey:n,isWritable:t,isSigner:e}}var ln=[Oe({pubkey:$e.TOKEN_PROGRAM_ID,isWritable:!1}),Oe({pubkey:D.SystemProgram.programId,isWritable:!1}),Oe({pubkey:D.SYSVAR_RENT_PUBKEY,isWritable:!1})];function et({publicKey:n,transformSol:e}){let t=tt(n.toString());if(t instanceof D.PublicKey)return e&&t.equals(fe)?Ee:t;if(e&&t.toString()===fe.toBase58())return Ee;if(typeof t=="string"){if(t===D.PublicKey.default.toBase58())return D.PublicKey.default;try{return new D.PublicKey(t)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function tt(n){try{return new D.PublicKey(n)}catch{return n}}var pn=new D.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),dn=new D.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),fn=new D.PublicKey("SysvarRent111111111111111111111111111111111"),gn=new D.PublicKey("SysvarC1ock11111111111111111111111111111111"),hn=new D.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),bn=new D.PublicKey("Sysvar1nstructions1111111111111111111111111"),Tn=D.SystemProgram.programId,yn=new D.PublicKey("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),wn=new D.PublicKey("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),xn=new D.PublicKey("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),An=new D.PublicKey("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),Pn=new D.PublicKey("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),In=new D.PublicKey("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),kn=new D.PublicKey("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),Sn=new D.PublicKey("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),Cn=new D.PublicKey("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),Bn=new D.PublicKey("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),Rn=new D.PublicKey("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),Ee=new D.PublicKey("So11111111111111111111111111111111111111112"),fe=D.PublicKey.default;var _e=class{constructor({mint:e,decimals:t,symbol:r,name:w,skipMint:d=!1,isToken2022:g=!1}){if(e===fe.toBase58()||e instanceof ke.PublicKey&&fe.equals(e)){this.decimals=ne.decimals,this.symbol=ne.symbol,this.name=ne.name,this.mint=new ke.PublicKey(ne.address),this.isToken2022=!1;return}this.decimals=t,this.symbol=r||e.toString().substring(0,6),this.name=w||e.toString().substring(0,6),this.mint=d?ke.PublicKey.default:et({publicKey:e}),this.isToken2022=g}equals(e){return this===e?!0:this.mint.equals(e.mint)}},oe=_e;oe.WSOL=new _e(q(E({},ne),{mint:ne.address}));var ve=class{constructor({decimals:e,symbol:t="UNKNOWN",name:r="UNKNOWN"}){this.decimals=e,this.symbol=t,this.name=r}equals(e){return this===e}},Se=ve;Se.SOL=new ve(te);var nt=U(require("bn.js"));var vn=new O(new nt.default(100));var jn=G("Raydium_price");var Mt=require("@solana/web3.js"),Ft=U(require("bn.js"));var Rt=new J.default(0),Ar=new J.default(1),Pr=new J.default(2),Ir=new J.default(3),kr=new J.default(5),Bt=new J.default(10),Sr=new J.default(100),Cr=new J.default(1e3),Br=new J.default(1e4);function Ke(n,e=1,t=[]){let r=[...n];if(e<=0)return t;for(;r.length;)t.push(r.splice(0,e));return t}var Q=class{constructor(e){this._owner=e}get publicKey(){return Q.isKeyPair(this._owner)?this._owner.publicKey:this._owner}get signer(){return Q.isKeyPair(this._owner)?this._owner:void 0}get isKeyPair(){return Q.isKeyPair(this._owner)}get isPublicKey(){return Q.isPublicKey(this._owner)}static isKeyPair(e){return e.secretKey!==void 0}static isPublicKey(e){return!Q.isKeyPair(e)}};var Ot=require("@solana/web3.js"),Et=require("@solana/spl-token");var W=require("@solana/web3.js");var ge={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",ClmmLockPosition:"ClmmLockPosition",ClmmHarvestLockPosition:"ClmmHarvestLockPosition",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV4Withdraw:"FarmV4Withdraw",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut",CpmmLockLp:"CpmmLockLp",CpmmCollectLockFee:"CpmmCollectLockFee",TransferTip:"TransferTip"};var at=require("@solana/spl-token"),st=G("Raydium_txUtil"),ct=1644;function he(n){let e=[],t=[];return n.microLamports&&(e.push(W.ComputeBudgetProgram.setComputeUnitPrice({microLamports:n.microLamports})),t.push(ge.SetComputeUnitPrice)),n.units&&(e.push(W.ComputeBudgetProgram.setComputeUnitLimit({units:n.units})),t.push(ge.SetComputeUnitLimit)),{instructions:e,instructionTypes:t}}async function re(n,e){var r,w;let t=e!=null?e:"confirmed";return(w=await((r=n.getLatestBlockhash)==null?void 0:r.call(n,{commitment:t})))==null?void 0:w.blockhash}async function be(n,e){return n.getSignatureStatuses([e]),new Promise((t,r)=>{let w=setTimeout(r,6e4);n.onSignature(e,d=>{if(clearTimeout(w),!d.err){t("");return}r(Object.assign(d.err,{txId:e}))},"confirmed")})}function Vt(n,e){n.length<1&&st.logWithError(`no instructions provided: ${n.toString()}`),e.length<1&&st.logWithError(`no signers provided:, ${e.toString()}`);let t=new W.Transaction;t.recentBlockhash="11111111111111111111111111111111",t.feePayer=e[0],t.add(...n);try{return Buffer.from(t.serialize({verifySignatures:!1})).toString("base64").length<ct}catch{return!1}}function Te({instructions:n,payer:e,signers:t}){return Vt(n,[e,...t])}function $({instructions:n,payer:e,lookupTableAddressAccount:t,recentBlockhash:r=W.Keypair.generate().publicKey.toString()}){let d=new W.TransactionMessage({payerKey:e,recentBlockhash:r,instructions:n}).compileToV0Message(Object.values(t!=null?t:{}));try{return Buffer.from(new W.VersionedTransaction(d).serialize()).toString("base64").length<ct}catch{return!1}}var Dt=n=>Buffer.isBuffer(n)?n:n instanceof Uint8Array?Buffer.from(n.buffer,n.byteOffset,n.byteLength):Buffer.from(n),Nt=n=>{let e=n.serialize({requireAllSignatures:!1,verifySignatures:!1});n instanceof W.VersionedTransaction&&(e=Dt(e));try{return e instanceof Buffer?e.toString("base64"):Buffer.from(e).toString("base64")}catch{return e.toString("base64")}};function ee(n){let e=[];return n.forEach(t=>{t instanceof W.Transaction&&(t.recentBlockhash||(t.recentBlockhash=at.TOKEN_PROGRAM_ID.toBase58()),t.feePayer||(t.feePayer=W.Keypair.generate().publicKey)),e.push(Nt(t))}),console.log("simulate tx string:",e),e}var p=require("@solana/web3.js"),jr=new p.PublicKey("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),Hr=new p.PublicKey("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),zr=new p.PublicKey("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),Jr=new p.PublicKey("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),Qr=new p.PublicKey("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),Zr=new p.PublicKey("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),Xr=new p.PublicKey("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),Yr=new p.PublicKey("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),$r=new p.PublicKey("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),ei=new p.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),ti=new p.PublicKey("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),ni=new p.PublicKey("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),ri=new p.PublicKey("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),ii=new p.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),oi=new p.PublicKey("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),si=new p.PublicKey("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),ai=new p.PublicKey("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),ci=new p.PublicKey("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),ui=new p.PublicKey("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),mi=new p.PublicKey("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),li=new p.PublicKey("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),pi=new p.PublicKey("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),di=new p.PublicKey("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),fi=new p.PublicKey("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),gi=new p.PublicKey("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),hi=new p.PublicKey("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),bi=new p.PublicKey("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),Ti=new p.PublicKey("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),yi=new p.PublicKey("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),wi=new p.PublicKey("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),xi=new p.PublicKey("6s1xP3hpbAfFoNtUNF8mfHsjr2Bd97JxFJRWLbL6aHuX");var Ai={OPEN_BOOK_PROGRAM:new p.PublicKey("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),SERUM_PROGRAM_ID_V3:new p.PublicKey("Ray1111111111111111111111111111111111111111"),AMM_V4:new p.PublicKey("DRaya7Kj3aMWQSy19kSjvmuwq9docCHofyP9kanQGaav"),AMM_STABLE:new p.PublicKey("DRayDdXc1NZQ9C3hRWmoSf8zK4iapgMnjdNZWrfwsP8m"),CLMM_PROGRAM_ID:new p.PublicKey("DRayAUgENGQBKVaX8owNhgzkEDyoHTGVEGHVJT1E9pfH"),CLMM_LOCK_PROGRAM_ID:new p.PublicKey("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),CLMM_LOCK_AUTH_ID:new p.PublicKey("6Aoh8h2Lw2m5UGxYR8AdAL87jTWYeKoxM52mJRzfYwN"),CREATE_CPMM_POOL_PROGRAM:new p.PublicKey("DRaycpLY18LhpbydsBWbVJtxpNv9oXPgjRSfpF2bWpYb"),CREATE_CPMM_POOL_AUTH:new p.PublicKey("CXniRufdq5xL8t8jZAPxsPZDpuudwuJSPWnbcD5Y5Nxq"),CREATE_CPMM_POOL_FEE_ACC:new p.PublicKey("3oE58BKVt8KuYkGxx8zBojugnymWmBiyafWgMrnb6eYy"),LOCK_CPMM_PROGRAM:new p.PublicKey("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),LOCK_CPMM_AUTH:new p.PublicKey("7qWVV8UY2bRJfDLP4s37YzBPKUkVB46DStYJBpYbQzu3"),UTIL1216:p.PublicKey.default,Router:new p.PublicKey("DRaybByLpbUL57LJARs3j8BitTxVfzBg351EaMr5UTCd"),FARM_PROGRAM_ID_V3:new p.PublicKey("DRayWyrLmEW5KEeqs8kdTMMaBabapqagaBC7KWpGtJeZ"),FARM_PROGRAM_ID_V4:new p.PublicKey("Ray1111111111111111111111111111111111111111"),FARM_PROGRAM_ID_V5:new p.PublicKey("DRayiCGSZgku1GTK6rXD6mVDdingXy6APAH1R6R5L2LC"),FARM_PROGRAM_ID_V6:new p.PublicKey("DRayzbYakXs45ELHkzH6vC3fuhQqTAnv5A68gdFuvZyZ"),LAUNCHPAD_PROGRAM:new p.PublicKey("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),LAUNCHPAD_AUTH:new p.PublicKey("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),LAUNCHPAD_PLATFORM:new p.PublicKey("2Jx4KTDrVSdWNazuGpcA8n3ZLTRGGBDxAWhuKe2Xcj2a"),LAUNCHPAD_CONFIG:new p.PublicKey("7ZR4zD7PYfY2XxoG1Gxcy2EgEeGYrpxrwzPuwdUBssEt"),FEE_DESTINATION_ID:new p.PublicKey("9y8ENuuZ3b19quffx9hQvRVygG5ky6snHfRvGpuSfeJy"),MODEL_DATA_PUBKEY:new p.PublicKey("Ray1111111111111111111111111111111111111111")};var _t=U(require("bn.js"));var ut=U(require("bn.js")),ki=new ut.default(1e6);var Ce=require("@solana/spl-token"),We=G("Raydium_accountInfo_util");async function lt(n,e,t){let{batchRequest:r,commitment:w="confirmed",chunkCount:d=100}=E({batchRequest:!1},t),g=Ke(e,d),s=new Array(g.length).fill([]);if(r){let B=g.map(x=>{let A=n._buildArgs([x.map(P=>P.toBase58())],w,"base64");return{methodName:"getMultipleAccounts",args:A}}),u=Ke(B,10);s=(await(await Promise.all(u.map(async x=>await n._rpcBatchRequest(x)))).flat()).map(x=>(x.error&&We.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${x.error.message}`),x.result.value.map(A=>{if(A){let{data:P,executable:m,lamports:h,owner:c,rentEpoch:R}=A;return P.length!==2&&P[1]!=="base64"&&We.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(P[0],"base64"),executable:m,lamports:h,owner:new mt.PublicKey(c),rentEpoch:R}}return null})))}else try{s=await Promise.all(g.map(B=>n.getMultipleAccountsInfo(B,w)))}catch(B){B instanceof Error&&We.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${B.message}`)}return s.flat()}async function Be({connection:n,address:e,cluster:t="mainnet"}){let r=await lt(n,[...new Set(e.map(d=>d.toString()))].map(d=>new z.PublicKey(d))),w={};for(let d=0;d<e.length;d++){let g=r[d],s=e[d];if(!g)continue;let B=new z.AddressLookupTableAccount({key:s,state:z.AddressLookupTableAccount.deserialize(g.data)});w[s.toString()]=B,t==="devnet"?se[s.toString()]=B:ye[s.toString()]=B}return w}var ye={AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU:new z.AddressLookupTableAccount({key:new z.PublicKey("AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU"),state:z.AddressLookupTableAccount.deserialize(Buffer.from("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","base64"))})},se={},Re=async n=>{let e="EFhMuDw1PKEuckuFRW9PavNfTH4LKP5uKHgyXDmWpFCq";if(se[e])return se;let t=new z.PublicKey(e),r=await n.getAccountInfo(t);return r&&(se[e]=new z.AddressLookupTableAccount({key:t,state:z.AddressLookupTableAccount.deserialize(r.data)})),se};var we=2e3,xe=class{constructor(e){this.instructions=[];this.endInstructions=[];this.lookupTableAddress=[];this.signers=[];this.instructionTypes=[];this.endInstructionTypes=[];this.connection=e.connection,this.feePayer=e.feePayer,this.signAllTransactions=e.signAllTransactions,this.owner=e.owner,this.cluster=e.cluster,this.blockhashCommitment=e.blockhashCommitment,this.loopMultiTxStatus=!!e.loopMultiTxStatus}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers,instructionTypes:this.instructionTypes,endInstructionTypes:this.endInstructionTypes,lookupTableAddress:this.lookupTableAddress}}get allInstructions(){return[...this.instructions,...this.endInstructions]}async getComputeBudgetConfig(){var r;let e=(await pt.default.get(`https://solanacompass.com/api/fees?cacheFreshTime=${3e5}`)).data,{avg:t}=(r=e==null?void 0:e[15])!=null?r:{};if(!!t)return{units:6e5,microLamports:Math.min(Math.ceil(t*1e6/6e5),25e3)}}addCustomComputeBudget(e){if(e){let{instructions:t,instructionTypes:r}=he(e);return this.instructions.unshift(...t),this.instructionTypes.unshift(...r),!0}return!1}addTipInstruction(e){var t;return e?(this.endInstructions.push(S.SystemProgram.transfer({fromPubkey:(t=e.feePayer)!=null?t:this.feePayer,toPubkey:new S.PublicKey(e.address),lamports:BigInt(e.amount.toString())})),this.endInstructionTypes.push(ge.TransferTip),!0):!1}async calComputeBudget({config:e,defaultIns:t}){try{let r=e||await this.getComputeBudgetConfig();if(this.addCustomComputeBudget(r))return;t&&this.instructions.unshift(...t)}catch{t&&this.instructions.unshift(...t)}}addInstruction({instructions:e=[],endInstructions:t=[],signers:r=[],instructionTypes:w=[],endInstructionTypes:d=[],lookupTableAddress:g=[]}){return this.instructions.push(...e),this.endInstructions.push(...t),this.signers.push(...r),this.instructionTypes.push(...w),this.endInstructionTypes.push(...d),this.lookupTableAddress.push(...g.filter(s=>s!==S.PublicKey.default.toString())),this}async versionBuild({txVersion:e,extInfo:t}){return e===0?await this.buildV0(E({},t||{})):this.build(t)}build(e){var r;let t=new S.Transaction;return this.allInstructions.length&&t.add(...this.allInstructions),t.feePayer=this.feePayer,((r=this.owner)==null?void 0:r.signer)&&!this.signers.some(w=>w.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer),{builder:this,transaction:t,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async w=>{var y;let{recentBlockHash:d,skipPreflight:g=!0,sendAndConfirm:s,notSendToRpc:B}=w||{},u=d!=null?d:await re(this.connection,this.blockhashCommitment);if(t.recentBlockhash=u,this.signers.length&&t.sign(...this.signers),ee([t]),(y=this.owner)!=null&&y.isKeyPair)return{txId:s?await(0,S.sendAndConfirmTransaction)(this.connection,t,this.signers.find(A=>A.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:g}):await this.connection.sendRawTransaction(t.serialize(),{skipPreflight:g}),signedTx:t};if(this.signAllTransactions){let x=await this.signAllTransactions([t]);if(this.signers.length)for(let A of x)try{A.sign(...this.signers)}catch{}return{txId:B?"":await this.connection.sendRawTransaction(x[0].serialize(),{skipPreflight:g}),signedTx:x[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:e||{}}}buildMultiTx(e){var u;let{extraPreBuildData:t=[],extInfo:r}=e,{transaction:w}=this.build(r),d=t.filter(y=>y.transaction.instructions.length>0),g=[w,...d.map(y=>y.transaction)],s=[this.signers,...d.map(y=>y.signers)],B=[...this.instructionTypes,...d.map(y=>y.instructionTypes).flat()];return(u=this.owner)!=null&&u.signer&&s.forEach(y=>{y.some(x=>x.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),{builder:this,transactions:g,signers:s,instructionTypes:B,execute:async y=>{var R;let{sequentially:x,onTxUpdate:A,skipTxCount:P=0,recentBlockHash:m,skipPreflight:h=!0}=y||{},c=m!=null?m:await re(this.connection,this.blockhashCommitment);if((R=this.owner)!=null&&R.isKeyPair){if(x){let b=[],M=0;for(let a of g){if(++M,M<=P)continue;let i=await(0,S.sendAndConfirmTransaction)(this.connection,a,this.signers.find(o=>o.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:h});b.push(i)}return{txIds:b,signedTxs:g}}return{txIds:await await Promise.all(g.map(async b=>(b.recentBlockhash=c,await this.connection.sendRawTransaction(b.serialize(),{skipPreflight:h})))),signedTxs:g}}if(this.signAllTransactions){let b=g.map((a,i)=>(a.recentBlockhash=c,s[i].length&&a.sign(...s[i]),a));ee(b);let M=await this.signAllTransactions(b);if(x){let a=0,i=[],o=async()=>{if(!M[a])return;let f=await this.connection.sendRawTransaction(M[a].serialize(),{skipPreflight:h});i.push({txId:f,status:"sent",signedTx:M[a]}),A==null||A([...i]),a++;let l=!1,I=null,L=null,F=T=>{I!==null&&clearInterval(I),L!==null&&this.connection.removeSignatureListener(L);let k=i.findIndex(C=>C.txId===f);if(k>-1){if(i[k].status==="error"||i[k].status==="success")return;i[k].status=T.err?"error":"success"}A==null||A([...i]),T.err||o()};this.loopMultiTxStatus&&(I=setInterval(async()=>{var T;if(l){clearInterval(I);return}try{let k=await this.connection.getTransaction(f,{commitment:"confirmed",maxSupportedTransactionVersion:0});k&&(l=!0,clearInterval(I),F({err:((T=k.meta)==null?void 0:T.err)||null}),console.log("tx status from getTransaction:",f))}catch(k){l=!0,clearInterval(I),console.error("getTransaction timeout:",k,f)}},we)),L=this.connection.onSignature(f,T=>{if(l){this.connection.removeSignatureListener(L);return}l=!0,F(T)},"confirmed"),this.connection.getSignatureStatus(f)};return await o(),{txIds:i.map(f=>f.txId),signedTxs:M}}else{let a=[];for(let i=0;i<M.length;i+=1){let o=await this.connection.sendRawTransaction(M[i].serialize(),{skipPreflight:h});a.push(o)}return{txIds:a,signedTxs:M}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async versionMultiBuild({extraPreBuildData:e,txVersion:t,extInfo:r}){return t===0?await this.buildV0MultiTx({extraPreBuildData:e,buildProps:r||{}}):this.buildMultiTx({extraPreBuildData:e,extInfo:r})}async buildV0(e){var h;let m=e||{},{lookupTableCache:t={},lookupTableAddress:r=[],forerunCreate:w,recentBlockhash:d}=m,g=ue(m,["lookupTableCache","lookupTableAddress","forerunCreate","recentBlockhash"]),s=E(E({},this.cluster==="devnet"?await Re(this.connection):ye),t),B=Array.from(new Set([...r,...this.lookupTableAddress])),u=[];for(let c of B)s[c]===void 0&&u.push(new S.PublicKey(c));let y=await Be({connection:this.connection,address:u});for(let[c,R]of Object.entries(y))s[c]=R;let x=w?S.PublicKey.default.toBase58():d!=null?d:await re(this.connection,this.blockhashCommitment),A=new S.TransactionMessage({payerKey:this.feePayer,recentBlockhash:x,instructions:[...this.allInstructions]}).compileToV0Message(Object.values(s));((h=this.owner)==null?void 0:h.signer)&&!this.signers.some(c=>c.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer);let P=new S.VersionedTransaction(A);return P.sign(this.signers),{builder:this,transaction:P,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async c=>{var a;let{skipPreflight:R=!0,sendAndConfirm:b,notSendToRpc:M}=c||{};if(ee([P]),(a=this.owner)!=null&&a.isKeyPair){let i=await this.connection.sendTransaction(P,{skipPreflight:R});return b&&await be(this.connection,i),{txId:i,signedTx:P}}if(this.signAllTransactions){let i=await this.signAllTransactions([P]);if(this.signers.length)for(let o of i)try{o.sign(this.signers)}catch{}return{txId:M?"":await this.connection.sendTransaction(i[0],{skipPreflight:R}),signedTx:i[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:g||{}}}async buildV0MultiTx(e){var u;let{extraPreBuildData:t=[],buildProps:r}=e,{transaction:w}=await this.buildV0(r),d=t.filter(y=>y.builder.instructions.length>0),g=[w,...d.map(y=>y.transaction)],s=[this.signers,...d.map(y=>y.signers)],B=[...this.instructionTypes,...d.map(y=>y.instructionTypes).flat()];return(u=this.owner)!=null&&u.signer&&s.forEach(y=>{y.some(x=>x.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),g.forEach(async(y,x)=>{y.sign(s[x])}),{builder:this,transactions:g,signers:s,instructionTypes:B,buildProps:r,execute:async y=>{var h;let{sequentially:x,onTxUpdate:A,recentBlockHash:P,skipPreflight:m=!0}=y||{};if(P&&g.forEach(c=>c.message.recentBlockhash=P),ee(g),(h=this.owner)!=null&&h.isKeyPair){if(x){let c=[];for(let R of g){let b=await this.connection.sendTransaction(R,{skipPreflight:m});await be(this.connection,b),c.push(b)}return{txIds:c,signedTxs:g}}return{txIds:await Promise.all(g.map(async c=>await this.connection.sendTransaction(c,{skipPreflight:m}))),signedTxs:g}}if(this.signAllTransactions){let c=await this.signAllTransactions(g);if(x){let R=0,b=[],M=async()=>{if(!c[R])return;let a=await this.connection.sendTransaction(c[R],{skipPreflight:m});b.push({txId:a,status:"sent",signedTx:c[R]}),A==null||A([...b]),R++;let i=!1,o=null,f=null,l=I=>{o!==null&&clearInterval(o),f!==null&&this.connection.removeSignatureListener(f);let L=b.findIndex(F=>F.txId===a);if(L>-1){if(b[L].status==="error"||b[L].status==="success")return;b[L].status=I.err?"error":"success"}A==null||A([...b]),I.err||M()};this.loopMultiTxStatus&&(o=setInterval(async()=>{var I;if(i){clearInterval(o);return}try{let L=await this.connection.getTransaction(a,{commitment:"confirmed",maxSupportedTransactionVersion:0});L&&(i=!0,clearInterval(o),l({err:((I=L.meta)==null?void 0:I.err)||null}),console.log("tx status from getTransaction:",a))}catch(L){i=!0,clearInterval(o),console.error("getTransaction timeout:",L,a)}},we)),f=this.connection.onSignature(a,I=>{if(i){this.connection.removeSignatureListener(f);return}i=!0,l(I)},"confirmed"),this.connection.getSignatureStatus(a)};return M(),{txIds:[],signedTxs:c}}else{let R=[];for(let b=0;b<c.length;b+=1){let M=await this.connection.sendTransaction(c[b],{skipPreflight:m});R.push(M)}return{txIds:R,signedTxs:c}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async sizeCheckBuild(e){var A;let x=e||{},{splitIns:t=[],computeBudgetConfig:r}=x,w=ue(x,["splitIns","computeBudgetConfig"]),d=r?he(r):{instructions:[],instructionTypes:[]},g=this.signers.reduce((P,m)=>q(E({},P),{[m.publicKey.toBase58()]:m}),{}),s=[],B=[],u=[],y=0;if(this.allInstructions.forEach(P=>{let m=[...u,P],h=r?[...d.instructions,...m]:m,R=[...new Set(m.map(b=>b.keys.filter(M=>M.isSigner).map(M=>M.pubkey.toString())).flat()).values()].map(b=>new S.PublicKey(b));if(P!==t[y]&&u.length<12&&(Te({instructions:h,payer:this.feePayer,signers:R})||Te({instructions:m,payer:this.feePayer,signers:R})))u.push(P);else{if(u.length===0)throw Error("item ins too big");y+=P===t[y]?1:0,Te({instructions:r?[...d.instructions,...u]:[...u],payer:this.feePayer,signers:R})?s.push(new S.Transaction().add(...d.instructions,...u)):s.push(new S.Transaction().add(...u)),B.push(Array.from(new Set(u.map(b=>b.keys.filter(M=>M.isSigner).map(M=>M.pubkey.toString())).flat())).map(b=>g[b]).filter(b=>b!==void 0)),u=[P]}}),u.length>0){let m=[...new Set(u.map(h=>h.keys.filter(c=>c.isSigner).map(c=>c.pubkey.toString())).flat()).values()].map(h=>g[h]).filter(h=>h!==void 0);Te({instructions:r?[...d.instructions,...u]:[...u],payer:this.feePayer,signers:m.map(h=>h.publicKey)})?s.push(new S.Transaction().add(...d.instructions,...u)):s.push(new S.Transaction().add(...u)),B.push(m)}return s.forEach(P=>P.feePayer=this.feePayer),(A=this.owner)!=null&&A.signer&&B.forEach(P=>{P.some(m=>m.publicKey.equals(this.owner.publicKey))||P.push(this.owner.signer)}),{builder:this,transactions:s,signers:B,instructionTypes:this.instructionTypes,execute:async P=>{var a;let{sequentially:m,onTxUpdate:h,skipTxCount:c=0,recentBlockHash:R,skipPreflight:b=!0}=P||{},M=R!=null?R:await re(this.connection,this.blockhashCommitment);if(s.forEach(async(i,o)=>{i.recentBlockhash=M,B[o].length&&i.sign(...B[o])}),ee(s),(a=this.owner)!=null&&a.isKeyPair){if(m){let i=0,o=[];for(let f of s){if(++i,i<=c){o.push("tx skipped");continue}let l=await(0,S.sendAndConfirmTransaction)(this.connection,f,this.signers.find(I=>I.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:b});o.push(l)}return{txIds:o,signedTxs:s}}return{txIds:await Promise.all(s.map(async i=>await this.connection.sendRawTransaction(i.serialize(),{skipPreflight:b}))),signedTxs:s}}if(this.signAllTransactions){let i=await this.signAllTransactions(s.slice(c,s.length)),o=[...s.slice(0,c),...i];if(m){let f=0,l=[],I=async()=>{if(!o[f])return;f<c&&(l.push({txId:"",status:"success",signedTx:o[f]}),h==null||h([...l]),f++,I());let L=await this.connection.sendRawTransaction(o[f].serialize(),{skipPreflight:b});l.push({txId:L,status:"sent",signedTx:o[f]}),h==null||h([...l]),f++;let F=!1,T=null,k=null,C=_=>{T!==null&&clearInterval(T),k!==null&&this.connection.removeSignatureListener(k);let N=l.findIndex(j=>j.txId===L);if(N>-1){if(l[N].status==="error"||l[N].status==="success")return;l[N].status=_.err?"error":"success"}h==null||h([...l]),_.err||I()};this.loopMultiTxStatus&&(T=setInterval(async()=>{var _;if(F){clearInterval(T);return}try{let N=await this.connection.getTransaction(L,{commitment:"confirmed",maxSupportedTransactionVersion:0});N&&(F=!0,clearInterval(T),C({err:((_=N.meta)==null?void 0:_.err)||null}),console.log("tx status from getTransaction:",L))}catch(N){F=!0,clearInterval(T),console.error("getTransaction timeout:",N,L)}},we)),k=this.connection.onSignature(L,_=>{if(F){this.connection.removeSignatureListener(k);return}F=!0,C(_)},"confirmed"),this.connection.getSignatureStatus(L)};return await I(),{txIds:l.map(L=>L.txId),signedTxs:o}}else{let f=[];for(let l=0;l<o.length;l+=1){let I=await this.connection.sendRawTransaction(o[l].serialize(),{skipPreflight:b});f.push(I)}return{txIds:f,signedTxs:o}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:w||{}}}async sizeCheckBuildV0(e){var M;let b=e||{},{computeBudgetConfig:t,splitIns:r=[],lookupTableCache:w={},lookupTableAddress:d=[]}=b,g=ue(b,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),s=E(E({},this.cluster==="devnet"?await Re(this.connection):ye),w),B=Array.from(new Set([...this.lookupTableAddress,...d])),u=[];for(let a of B)s[a]===void 0&&u.push(new S.PublicKey(a));let y=await Be({connection:this.connection,address:u});for(let[a,i]of Object.entries(y))s[a]=i;let x=t?he(t):{instructions:[],instructionTypes:[]},A=await re(this.connection,this.blockhashCommitment),P=this.signers.reduce((a,i)=>q(E({},a),{[i.publicKey.toBase58()]:i}),{}),m=[],h=[],c=[],R=0;if(this.allInstructions.forEach(a=>{let i=[...c,a],o=t?[...x.instructions,...i]:i;if(a!==r[R]&&c.length<12&&($({instructions:o,payer:this.feePayer,lookupTableAddressAccount:s})||$({instructions:i,payer:this.feePayer,lookupTableAddressAccount:s})))c.push(a);else{if(c.length===0)throw Error("item ins too big");R+=a===r[R]?1:0;let f={};for(let l of[...new Set(B)])s[l]!==void 0&&(f[l]=s[l]);if(t&&$({instructions:[...x.instructions,...c],payer:this.feePayer,lookupTableAddressAccount:s,recentBlockhash:A})){let l=new S.TransactionMessage({payerKey:this.feePayer,recentBlockhash:A,instructions:[...x.instructions,...c]}).compileToV0Message(Object.values(s));m.push(new S.VersionedTransaction(l))}else{let l=new S.TransactionMessage({payerKey:this.feePayer,recentBlockhash:A,instructions:[...c]}).compileToV0Message(Object.values(s));m.push(new S.VersionedTransaction(l))}h.push(Array.from(new Set(c.map(l=>l.keys.filter(I=>I.isSigner).map(I=>I.pubkey.toString())).flat())).map(l=>P[l]).filter(l=>l!==void 0)),c=[a]}}),c.length>0){let i=[...new Set(c.map(o=>o.keys.filter(f=>f.isSigner).map(f=>f.pubkey.toString())).flat()).values()].map(o=>P[o]).filter(o=>o!==void 0);if(t&&$({instructions:[...x.instructions,...c],payer:this.feePayer,lookupTableAddressAccount:s,recentBlockhash:A})){let o=new S.TransactionMessage({payerKey:this.feePayer,recentBlockhash:A,instructions:[...x.instructions,...c]}).compileToV0Message(Object.values(s));m.push(new S.VersionedTransaction(o))}else{let o=new S.TransactionMessage({payerKey:this.feePayer,recentBlockhash:A,instructions:[...c]}).compileToV0Message(Object.values(s));m.push(new S.VersionedTransaction(o))}h.push(i)}return(M=this.owner)!=null&&M.signer&&h.forEach(a=>{a.some(i=>i.publicKey.equals(this.owner.publicKey))||a.push(this.owner.signer)}),m.forEach((a,i)=>{a.sign(h[i])}),{builder:this,transactions:m,buildProps:e,signers:h,instructionTypes:this.instructionTypes,execute:async a=>{var L;let{sequentially:i,onTxUpdate:o,skipTxCount:f=0,recentBlockHash:l,skipPreflight:I=!0}=a||{};if(m.map(async(F,T)=>{h[T].length&&F.sign(h[T]),l&&(F.message.recentBlockhash=l)}),ee(m),(L=this.owner)!=null&&L.isKeyPair){if(i){let F=0,T=[];for(let k of m){if(++F,F<=f){console.log("skip tx: ",F),T.push("tx skipped");continue}let C=await this.connection.sendTransaction(k,{skipPreflight:I});await be(this.connection,C),T.push(C)}return{txIds:T,signedTxs:m}}return{txIds:await Promise.all(m.map(async F=>await this.connection.sendTransaction(F,{skipPreflight:I}))),signedTxs:m}}if(this.signAllTransactions){let F=await this.signAllTransactions(m.slice(f,m.length)),T=[...m.slice(0,f),...F];if(i){let k=0,C=[],_=async()=>{if(!T[k])return;if(k<f){C.push({txId:"",status:"success",signedTx:T[k]}),o==null||o([...C]),k++,_();return}let N=await this.connection.sendTransaction(T[k],{skipPreflight:I});C.push({txId:N,status:"sent",signedTx:T[k]}),o==null||o([...C]),k++;let j=!1,H=null,X=null,ae=K=>{H!==null&&clearInterval(H),X!==null&&this.connection.removeSignatureListener(X);let v=C.findIndex(Fe=>Fe.txId===N);if(v>-1){if(C[v].status==="error"||C[v].status==="success")return;C[v].status=K.err?"error":"success"}o==null||o([...C]),K.err||_()};this.loopMultiTxStatus&&(H=setInterval(async()=>{var K;if(j){clearInterval(H);return}try{let v=await this.connection.getTransaction(N,{commitment:"confirmed",maxSupportedTransactionVersion:0});v&&(j=!0,clearInterval(H),ae({err:((K=v.meta)==null?void 0:K.err)||null}),console.log("tx status from getTransaction:",N))}catch(v){j=!0,clearInterval(H),console.error("getTransaction timeout:",v,N)}},we)),X=this.connection.onSignature(N,K=>{if(j){this.connection.removeSignatureListener(X);return}j=!0,ae(K)},"confirmed"),this.connection.getSignatureStatus(N)};return _(),{txIds:[],signedTxs:T}}else{let k=[];for(let C=0;C<T.length;C+=1){let _=await this.connection.sendTransaction(T[C],{skipPreflight:I});k.push(_)}return{txIds:k,signedTxs:T}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:g||{}}}async buildSniperTransaction(e){var M;let b=e||{},{computeBudgetConfig:t,splitIns:r=[],lookupTableCache:w={},lookupTableAddress:d=[]}=b,g=ue(b,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),s=E(E({},this.cluster==="devnet"?await Re(this.connection):ye),w),B=Array.from(new Set([...this.lookupTableAddress,...d])),u=[];for(let a of B)s[a]===void 0&&u.push(new S.PublicKey(a));let y=await Be({connection:this.connection,address:u});for(let[a,i]of Object.entries(y))s[a]=i;let x=t?he(t):{instructions:[],instructionTypes:[]},A=await re(this.connection,this.blockhashCommitment),P=this.signers.reduce((a,i)=>q(E({},a),{[i.publicKey.toBase58()]:i}),{}),m=[],h=[],c=[],R=0;if(this.allInstructions.forEach(a=>{let i=[...c,a],o=t?[...x.instructions,...i]:i;if(a!==r[R]&&c.length<12&&($({instructions:o,payer:this.feePayer,lookupTableAddressAccount:s})||$({instructions:i,payer:this.feePayer,lookupTableAddressAccount:s})))c.push(a);else{if(c.length===0)throw Error("item ins too big");R+=a===r[R]?1:0;let f={};for(let l of[...new Set(B)])s[l]!==void 0&&(f[l]=s[l]);if(t&&$({instructions:[...x.instructions,...c],payer:this.feePayer,lookupTableAddressAccount:s,recentBlockhash:A})){let l=new S.TransactionMessage({payerKey:this.feePayer,recentBlockhash:A,instructions:[...x.instructions,...c]}).compileToV0Message(Object.values(s));m.push(new S.VersionedTransaction(l))}else{let l=new S.TransactionMessage({payerKey:this.feePayer,recentBlockhash:A,instructions:[...c]}).compileToV0Message(Object.values(s));m.push(new S.VersionedTransaction(l))}h.push(Array.from(new Set(c.map(l=>l.keys.filter(I=>I.isSigner).map(I=>I.pubkey.toString())).flat())).map(l=>P[l]).filter(l=>l!==void 0)),c=[a]}}),c.length>0){let i=[...new Set(c.map(o=>o.keys.filter(f=>f.isSigner).map(f=>f.pubkey.toString())).flat()).values()].map(o=>P[o]).filter(o=>o!==void 0);if(t&&$({instructions:[...x.instructions,...c],payer:this.feePayer,lookupTableAddressAccount:s,recentBlockhash:A})){let o=new S.TransactionMessage({payerKey:this.feePayer,recentBlockhash:A,instructions:[...x.instructions,...c]}).compileToV0Message(Object.values(s));m.push(new S.VersionedTransaction(o))}else{let o=new S.TransactionMessage({payerKey:this.feePayer,recentBlockhash:A,instructions:[...c]}).compileToV0Message(Object.values(s));m.push(new S.VersionedTransaction(o))}h.push(i)}return(M=this.owner)!=null&&M.signer&&h.forEach(a=>{a.some(i=>i.publicKey.equals(this.owner.publicKey))||a.push(this.owner.signer)}),m.forEach((a,i)=>{a.sign(h[i])}),{builder:this,transactions:m,buildProps:e,signers:h,instructionTypes:this.instructionTypes,execute:async a=>{var L;let{sequentially:i,onTxUpdate:o,skipTxCount:f=0,recentBlockHash:l,skipPreflight:I=!0}=a||{};if(m.map(async(F,T)=>{h[T].length&&F.sign(h[T]),l&&(F.message.recentBlockhash=l)}),ee(m),(L=this.owner)!=null&&L.isKeyPair){if(i){let F=0,T=[];for(let k of m){if(++F,F<=f){console.log("skip tx: ",F),T.push("tx skipped");continue}let C=await this.connection.sendTransaction(k,{skipPreflight:I});await be(this.connection,C),T.push(C)}return{txIds:T,signedTxs:m}}return{txIds:await Promise.all(m.map(async F=>await this.connection.sendTransaction(F,{skipPreflight:I}))),signedTxs:m}}if(this.signAllTransactions){let F=await this.signAllTransactions(m.slice(f,m.length)),T=[...m.slice(0,f),...F];if(i){let k=0,C=[],_=async()=>{if(!T[k])return;if(k<f){C.push({txId:"",status:"success",signedTx:T[k]}),o==null||o([...C]),k++,_();return}let N=await this.connection.sendTransaction(T[k],{skipPreflight:I});C.push({txId:N,status:"sent",signedTx:T[k]}),o==null||o([...C]),k++;let j=!1,H=null,X=null,ae=K=>{H!==null&&clearInterval(H),X!==null&&this.connection.removeSignatureListener(X);let v=C.findIndex(Fe=>Fe.txId===N);if(v>-1){if(C[v].status==="error"||C[v].status==="success")return;C[v].status=K.err?"error":"success"}o==null||o([...C]),K.err||_()};this.loopMultiTxStatus&&(H=setInterval(async()=>{var K;if(j){clearInterval(H);return}try{let v=await this.connection.getTransaction(N,{commitment:"confirmed",maxSupportedTransactionVersion:0});v&&(j=!0,clearInterval(H),ae({err:((K=v.meta)==null?void 0:K.err)||null}),console.log("tx status from getTransaction:",N))}catch(v){j=!0,clearInterval(H),console.error("getTransaction timeout:",v,N)}},we)),X=this.connection.onSignature(N,K=>{if(j){this.connection.removeSignatureListener(X);return}j=!0,ae(K)},"confirmed"),this.connection.getSignatureStatus(N)};return _(),{txIds:[],signedTxs:T}}else{let k=[];for(let C=0;C<T.length;C+=1){let _=await this.connection.sendTransaction(T[C],{skipPreflight:I});k.push(_)}return{txIds:k,signedTxs:T}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:g||{}}}};var qe=(...n)=>n.map(e=>{try{return typeof e=="object"?JSON.stringify(e):e}catch{return e}}).join(", "),Ae=class{constructor({scope:e,moduleName:t}){this.disabled=!1;this.scope=e,this.logger=G(t)}createTxBuilder(e){return this.scope.checkOwner(),new xe({connection:this.scope.connection,feePayer:e||this.scope.ownerPubKey,cluster:this.scope.cluster,owner:this.scope.owner,blockhashCommitment:this.scope.blockhashCommitment,loopMultiTxStatus:this.scope.loopMultiTxStatus,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}createSniperTxBuilder(e,t){let r=new Q(e);return new xe({connection:this.scope.connection,feePayer:t,cluster:this.scope.cluster,owner:r,blockhashCommitment:this.scope.blockhashCommitment,loopMultiTxStatus:this.scope.loopMultiTxStatus,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}logDebug(...e){this.logger.debug(qe(e))}logInfo(...e){this.logger.info(qe(e))}logAndCreateError(...e){let t=qe(e);throw new Error(t)}checkDisabled(){(this.disabled||!this.scope)&&this.logAndCreateError("module not working")}};var Me=class extends Ae{constructor(t){super(t);this._tokenList=[];this._tokenMap=new Map;this._blackTokenMap=new Set;this._mintGroup={official:new Set,jup:new Set,extra:new Set};this._whiteMap=new Set;this._extraTokenList=[]}async load(t){this.checkDisabled();let{forceUpdate:r=!1,type:w="strict"}=t||{},{mintList:d,blacklist:g,whiteList:s}=await this.scope.fetchV3TokenList(r),B=await this.scope.fetchJupTokenList(r);this._tokenList=[],this._tokenMap=new Map,this._blackTokenMap=new Set(g),this._mintGroup={official:new Set,jup:new Set,extra:new Set},this._whiteMap=new Set(s),this._tokenMap.set(te.address,te),this._mintGroup.official.add(te.address),d.forEach(u=>{var y;this._blackTokenMap.has(u.address)||(this._tokenMap.set(u.address,q(E({},u),{type:"raydium",priority:2,programId:(y=u.programId)!=null?y:u.tags.includes("token-2022")?Z.TOKEN_2022_PROGRAM_ID.toBase58():Z.TOKEN_PROGRAM_ID.toBase58()})),this._mintGroup.official.add(u.address))}),B.forEach(u=>{var y;this._blackTokenMap.has(u.address)||this._tokenMap.has(u.address)||(this._tokenMap.set(u.address,q(E({},u),{type:"jupiter",priority:1,programId:(y=u.programId)!=null?y:u.tags.includes("token-2022")?Z.TOKEN_2022_PROGRAM_ID.toBase58():Z.TOKEN_PROGRAM_ID.toBase58(),tags:u.freezeAuthority?[...u.tags||[],"hasFreeze"]:u.tags})),this._mintGroup.jup.add(u.address))}),this._extraTokenList.forEach(u=>{this._blackTokenMap.has(u.address)||this._tokenMap.has(u.address)||(this._tokenMap.set(u.address,q(E({},u),{type:"extra",priority:1,programId:u.programId||u.tags.includes("token-2022")?Z.TOKEN_2022_PROGRAM_ID.toBase58():Z.TOKEN_PROGRAM_ID.toBase58()})),this._mintGroup.extra.add(u.address))}),this._tokenList=Array.from(this._tokenMap).map(u=>u[1])}get tokenList(){return this._tokenList}get tokenMap(){return this._tokenMap}get blackTokenMap(){return this._blackTokenMap}get mintGroup(){return this._mintGroup}get whiteListMap(){return this._whiteMap}async getTokenInfo(t){if(!t)throw new Error("please input mint");let r=t.toString(),w=this._tokenMap.get(r);if(w)return w;if(r.toLocaleUpperCase()==="SOL")return te;let d=(await this.scope.api.getTokenInfo([r]))[0];if(d)return this._mintGroup.extra.add(r),this._tokenMap.set(r,q(E({},d),{priority:2})),d;let g=await this.scope.connection.getAccountInfo(new dt.PublicKey(r));if(!g)throw new Error(`mint address not found: ${r}`);let s=Z.MintLayout.decode(g.data),B=r.toString().substring(0,6),u={chainId:101,address:r,programId:g.owner.toBase58(),logoURI:"",symbol:B,name:B,decimals:s.decimals,tags:[],extensions:{},priority:0,type:"unknown"};return this._mintGroup.extra.add(r),this._tokenMap.set(r,u),u}};0&&(module.exports={});
//# sourceMappingURL=token.js.map