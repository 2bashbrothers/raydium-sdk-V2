var nn=Object.create;var ye=Object.defineProperty,rn=Object.defineProperties,on=Object.getOwnPropertyDescriptor,sn=Object.getOwnPropertyDescriptors,an=Object.getOwnPropertyNames,ke=Object.getOwnPropertySymbols,un=Object.getPrototypeOf,Qe=Object.prototype.hasOwnProperty,wt=Object.prototype.propertyIsEnumerable;var Tt=(n,e,t)=>e in n?ye(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,v=(n,e)=>{for(var t in e||(e={}))Qe.call(e,t)&&Tt(n,t,e[t]);if(ke)for(var t of ke(e))wt.call(e,t)&&Tt(n,t,e[t]);return n},ee=(n,e)=>rn(n,sn(e));var Ce=(n,e)=>{var t={};for(var r in n)Qe.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&ke)for(var r of ke(n))e.indexOf(r)<0&&wt.call(n,r)&&(t[r]=n[r]);return t};var cn=(n,e)=>{for(var t in e)ye(n,t,{get:e[t],enumerable:!0})},Pt=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of an(e))!Qe.call(n,o)&&o!==t&&ye(n,o,{get:()=>e[o],enumerable:!(r=on(e,o))||r.enumerable});return n};var W=(n,e,t)=>(t=n!=null?nn(un(n)):{},Pt(e||!n||!n.__esModule?ye(t,"default",{value:n,enumerable:!0}):t,n)),ln=n=>Pt(ye({},"__esModule",{value:!0}),n);var Fn={};cn(Fn,{default:()=>je});module.exports=ln(Fn);var ge=require("@solana/web3.js"),be=W(require("bn.js")),ht=require("@solana/spl-token");var J=W(require("bn.js")),kn=W(require("decimal.js"));var Gt=W(require("big.js")),Bn=W(require("bn.js"));var he=require("lodash");var Ze=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:0,this.name=e.name}set level(e){this.logLevel=e}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let t=e.map(r=>typeof r=="object"?JSON.stringify(r):r).join(", ");throw new Error(t)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},At={},pn={};function q(n){let e=(0,he.get)(At,n);if(!e){let t=(0,he.get)(pn,n);e=new Ze({name:n,logLevel:t}),(0,he.set)(At,n,e)}return e}var St=require("@solana/web3.js");var Me=require("@solana/spl-token"),Je=q("Raydium_accountInfo_util");async function Bt(n,e,t){let{batchRequest:r,commitment:o="confirmed",chunkCount:s=100}=v({batchRequest:!1},t),u=Xe(e,s),i=new Array(u.length).fill([]);if(r){let y=u.map(c=>{let P=n._buildArgs([c.map(T=>T.toBase58())],o,"base64");return{methodName:"getMultipleAccounts",args:P}}),x=Xe(y,10);i=(await(await Promise.all(x.map(async c=>await n._rpcBatchRequest(c)))).flat()).map(c=>(c.error&&Je.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${c.error.message}`),c.result.value.map(P=>{if(P){let{data:T,executable:h,lamports:g,owner:a,rentEpoch:L}=P;return T.length!==2&&T[1]!=="base64"&&Je.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(T[0],"base64"),executable:h,lamports:g,owner:new St.PublicKey(a),rentEpoch:L}}return null})))}else try{i=await Promise.all(u.map(y=>n.getMultipleAccountsInfo(y,o)))}catch(y){y instanceof Error&&Je.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${y.message}`)}return i.flat()}var ae=W(require("bn.js"));var Lt=9007199254740991;function Y(n){let e=q("Raydium_parseBigNumberish");if(n instanceof ae.default)return n;if(typeof n=="string"){if(n.match(/^-?[0-9]+$/))return new ae.default(n);e.logWithError(`invalid BigNumberish string: ${n}`)}return typeof n=="number"?(n%1&&e.logWithError(`BigNumberish number underflow: ${n}`),(n>=Lt||n<=-Lt)&&e.logWithError(`BigNumberish number overflow: ${n}`),new ae.default(String(n))):typeof n=="bigint"?new ae.default(n.toString()):(e.error(`invalid BigNumberish value: ${n}`),new ae.default(0))}var kt=require("@solana/web3.js"),$e=require("@solana/spl-token"),Ct={chainId:101,address:kt.PublicKey.default.toBase58(),programId:$e.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},ie={chainId:101,address:"So11111111111111111111111111111111111111112",programId:$e.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};var Re=require("@solana/web3.js");var N=require("@solana/web3.js"),Mt=require("@solana/spl-token");function et({pubkey:n,isSigner:e=!1,isWritable:t=!0}){return{pubkey:n,isWritable:t,isSigner:e}}var Yn=[et({pubkey:Mt.TOKEN_PROGRAM_ID,isWritable:!1}),et({pubkey:N.SystemProgram.programId,isWritable:!1}),et({pubkey:N.SYSVAR_RENT_PUBKEY,isWritable:!1})];function Rt({publicKey:n,transformSol:e}){let t=Dt(n.toString());if(t instanceof N.PublicKey)return e&&t.equals(xe)?Ye:t;if(e&&t.toString()===xe.toBase58())return Ye;if(typeof t=="string"){if(t===N.PublicKey.default.toBase58())return N.PublicKey.default;try{return new N.PublicKey(t)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function Dt(n){try{return new N.PublicKey(n)}catch{return n}}var $n=new N.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),er=new N.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),tr=new N.PublicKey("SysvarRent111111111111111111111111111111111"),nr=new N.PublicKey("SysvarC1ock11111111111111111111111111111111"),rr=new N.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),or=new N.PublicKey("Sysvar1nstructions1111111111111111111111111"),ir=N.SystemProgram.programId,sr=new N.PublicKey("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),ar=new N.PublicKey("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),ur=new N.PublicKey("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),cr=new N.PublicKey("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),lr=new N.PublicKey("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),pr=new N.PublicKey("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),mr=new N.PublicKey("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),dr=new N.PublicKey("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),fr=new N.PublicKey("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),gr=new N.PublicKey("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),br=new N.PublicKey("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),Ye=new N.PublicKey("So11111111111111111111111111111111111111112"),xe=N.PublicKey.default;var tt=class{constructor({mint:e,decimals:t,symbol:r,name:o,skipMint:s=!1,isToken2022:u=!1}){if(e===xe.toBase58()||e instanceof Re.PublicKey&&xe.equals(e)){this.decimals=ie.decimals,this.symbol=ie.symbol,this.name=ie.name,this.mint=new Re.PublicKey(ie.address),this.isToken2022=!1;return}this.decimals=t,this.symbol=r||e.toString().substring(0,6),this.name=o||e.toString().substring(0,6),this.mint=s?Re.PublicKey.default:Rt({publicKey:e}),this.isToken2022=u}equals(e){return this===e?!0:this.mint.equals(e.mint)}},ue=tt;ue.WSOL=new tt(ee(v({},ie),{mint:ie.address}));var nt=class{constructor({decimals:e,symbol:t="UNKNOWN",name:r="UNKNOWN"}){this.decimals=e,this.symbol=t,this.name=r}equals(e){return this===e}},De=nt;De.SOL=new nt(Ct);var Nt=W(require("toformat")),mn=Nt.default,Te=mn;var we=W(require("big.js")),Kt=W(require("bn.js")),It=W(require("decimal.js-light"));var Ne=q("module/fraction"),rt=Te(we.default),Pe=Te(It.default),fn={[0]:Pe.ROUND_DOWN,[1]:Pe.ROUND_HALF_UP,[2]:Pe.ROUND_UP},gn={[0]:we.default.roundDown,[1]:we.default.roundHalfUp,[2]:we.default.roundUp},I=class{constructor(e,t=new Kt.default(1)){this.numerator=Y(e),this.denominator=Y(t)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new I(this.denominator,this.numerator)}add(e){let t=e instanceof I?e:new I(Y(e));return this.denominator.eq(t.denominator)?new I(this.numerator.add(t.numerator),this.denominator):new I(this.numerator.mul(t.denominator).add(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}sub(e){let t=e instanceof I?e:new I(Y(e));return this.denominator.eq(t.denominator)?new I(this.numerator.sub(t.numerator),this.denominator):new I(this.numerator.mul(t.denominator).sub(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}mul(e){let t=e instanceof I?e:new I(Y(e));return new I(this.numerator.mul(t.numerator),this.denominator.mul(t.denominator))}div(e){let t=e instanceof I?e:new I(Y(e));return new I(this.numerator.mul(t.denominator),this.denominator.mul(t.numerator))}toSignificant(e,t={groupSeparator:""},r=1){Number.isInteger(e)||Ne.logWithError(`${e} is not an integer.`),e<=0&&Ne.logWithError(`${e} is not positive.`),Pe.set({precision:e+1,rounding:fn[r]});let o=new Pe(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return o.toFormat(o.decimalPlaces(),t)}toFixed(e,t={groupSeparator:""},r=1){return Number.isInteger(e)||Ne.logWithError(`${e} is not an integer.`),e<0&&Ne.logWithError(`${e} is negative.`),rt.DP=e,rt.RM=gn[r]||1,new rt(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,t)}isZero(){return this.numerator.isZero()}};var Et=W(require("bn.js"));var Nr=new I(new Et.default(100));var Or=q("Raydium_price");function Xe(n,e=1,t=[]){let r=[...n];if(e<=0)return t;for(;r.length;)t.push(r.splice(0,e));return t}var xn=require("@solana/web3.js"),Tn=require("@solana/spl-token");var H=require("@solana/web3.js");var G={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",ClmmLockPosition:"ClmmLockPosition",ClmmHarvestLockPosition:"ClmmHarvestLockPosition",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV4Withdraw:"FarmV4Withdraw",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut",CpmmLockLp:"CpmmLockLp",CpmmCollectLockFee:"CpmmCollectLockFee",TransferTip:"TransferTip"};var vt=require("@solana/spl-token"),Vt=q("Raydium_txUtil"),Wt=1644;function Ie(n){let e=[],t=[];return n.microLamports&&(e.push(H.ComputeBudgetProgram.setComputeUnitPrice({microLamports:n.microLamports})),t.push(G.SetComputeUnitPrice)),n.units&&(e.push(H.ComputeBudgetProgram.setComputeUnitLimit({units:n.units})),t.push(G.SetComputeUnitLimit)),{instructions:e,instructionTypes:t}}async function ce(n,e){var r,o;let t=e!=null?e:"confirmed";return(o=await((r=n.getLatestBlockhash)==null?void 0:r.call(n,{commitment:t})))==null?void 0:o.blockhash}async function Ee(n,e){return n.getSignatureStatuses([e]),new Promise((t,r)=>{let o=setTimeout(r,6e4);n.onSignature(e,s=>{if(clearTimeout(o),!s.err){t("");return}r(Object.assign(s.err,{txId:e}))},"confirmed")})}function bn(n,e){n.length<1&&Vt.logWithError(`no instructions provided: ${n.toString()}`),e.length<1&&Vt.logWithError(`no signers provided:, ${e.toString()}`);let t=new H.Transaction;t.recentBlockhash="11111111111111111111111111111111",t.feePayer=e[0],t.add(...n);try{return Buffer.from(t.serialize({verifySignatures:!1})).toString("base64").length<Wt}catch{return!1}}function Ae({instructions:n,payer:e,signers:t}){return bn(n,[e,...t])}function Se({instructions:n,payer:e,lookupTableAddressAccount:t,recentBlockhash:r=H.Keypair.generate().publicKey.toString()}){let s=new H.TransactionMessage({payerKey:e,recentBlockhash:r,instructions:n}).compileToV0Message(Object.values(t!=null?t:{}));try{return Buffer.from(new H.VersionedTransaction(s).serialize()).toString("base64").length<Wt}catch{return!1}}var yn=n=>Buffer.isBuffer(n)?n:n instanceof Uint8Array?Buffer.from(n.buffer,n.byteOffset,n.byteLength):Buffer.from(n),hn=n=>{let e=n.serialize({requireAllSignatures:!1,verifySignatures:!1});n instanceof H.VersionedTransaction&&(e=yn(e));try{return e instanceof Buffer?e.toString("base64"):Buffer.from(e).toString("base64")}catch{return e.toString("base64")}};function se(n){let e=[];return n.forEach(t=>{t instanceof H.Transaction&&(t.recentBlockhash||(t.recentBlockhash=vt.TOKEN_PROGRAM_ID.toBase58()),t.feePayer||(t.feePayer=H.Keypair.generate().publicKey)),e.push(hn(t))}),console.log("simulate tx string:",e),e}var m=require("@solana/web3.js"),go=new m.PublicKey("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),bo=new m.PublicKey("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),yo=new m.PublicKey("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),ho=new m.PublicKey("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),xo=new m.PublicKey("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),To=new m.PublicKey("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),wo=new m.PublicKey("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),Po=new m.PublicKey("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),Ao=new m.PublicKey("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),So=new m.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Bo=new m.PublicKey("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),Lo=new m.PublicKey("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),ko=new m.PublicKey("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),Co=new m.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Mo=new m.PublicKey("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),Ro=new m.PublicKey("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),Do=new m.PublicKey("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),No=new m.PublicKey("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),Ko=new m.PublicKey("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),Io=new m.PublicKey("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),Eo=new m.PublicKey("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),_o=new m.PublicKey("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),Fo=new m.PublicKey("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),Oo=new m.PublicKey("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),Vo=new m.PublicKey("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),vo=new m.PublicKey("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),Wo=new m.PublicKey("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),Uo=new m.PublicKey("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),qo=new m.PublicKey("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),Go=new m.PublicKey("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),Ho=new m.PublicKey("6s1xP3hpbAfFoNtUNF8mfHsjr2Bd97JxFJRWLbL6aHuX");var zo={OPEN_BOOK_PROGRAM:new m.PublicKey("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),SERUM_PROGRAM_ID_V3:new m.PublicKey("Ray1111111111111111111111111111111111111111"),AMM_V4:new m.PublicKey("DRaya7Kj3aMWQSy19kSjvmuwq9docCHofyP9kanQGaav"),AMM_STABLE:new m.PublicKey("DRayDdXc1NZQ9C3hRWmoSf8zK4iapgMnjdNZWrfwsP8m"),CLMM_PROGRAM_ID:new m.PublicKey("DRayAUgENGQBKVaX8owNhgzkEDyoHTGVEGHVJT1E9pfH"),CLMM_LOCK_PROGRAM_ID:new m.PublicKey("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),CLMM_LOCK_AUTH_ID:new m.PublicKey("6Aoh8h2Lw2m5UGxYR8AdAL87jTWYeKoxM52mJRzfYwN"),CREATE_CPMM_POOL_PROGRAM:new m.PublicKey("DRaycpLY18LhpbydsBWbVJtxpNv9oXPgjRSfpF2bWpYb"),CREATE_CPMM_POOL_AUTH:new m.PublicKey("CXniRufdq5xL8t8jZAPxsPZDpuudwuJSPWnbcD5Y5Nxq"),CREATE_CPMM_POOL_FEE_ACC:new m.PublicKey("3oE58BKVt8KuYkGxx8zBojugnymWmBiyafWgMrnb6eYy"),LOCK_CPMM_PROGRAM:new m.PublicKey("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),LOCK_CPMM_AUTH:new m.PublicKey("7qWVV8UY2bRJfDLP4s37YzBPKUkVB46DStYJBpYbQzu3"),UTIL1216:m.PublicKey.default,Router:new m.PublicKey("DRaybByLpbUL57LJARs3j8BitTxVfzBg351EaMr5UTCd"),FARM_PROGRAM_ID_V3:new m.PublicKey("DRayWyrLmEW5KEeqs8kdTMMaBabapqagaBC7KWpGtJeZ"),FARM_PROGRAM_ID_V4:new m.PublicKey("Ray1111111111111111111111111111111111111111"),FARM_PROGRAM_ID_V5:new m.PublicKey("DRayiCGSZgku1GTK6rXD6mVDdingXy6APAH1R6R5L2LC"),FARM_PROGRAM_ID_V6:new m.PublicKey("DRayzbYakXs45ELHkzH6vC3fuhQqTAnv5A68gdFuvZyZ"),LAUNCHPAD_PROGRAM:new m.PublicKey("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),LAUNCHPAD_AUTH:new m.PublicKey("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),LAUNCHPAD_PLATFORM:new m.PublicKey("2Jx4KTDrVSdWNazuGpcA8n3ZLTRGGBDxAWhuKe2Xcj2a"),LAUNCHPAD_CONFIG:new m.PublicKey("7ZR4zD7PYfY2XxoG1Gxcy2EgEeGYrpxrwzPuwdUBssEt"),FEE_DESTINATION_ID:new m.PublicKey("9y8ENuuZ3b19quffx9hQvRVygG5ky6snHfRvGpuSfeJy"),MODEL_DATA_PUBKEY:new m.PublicKey("Ray1111111111111111111111111111111111111111")};var wn=W(require("bn.js"));var Q=require("@solana/web3.js");async function ot({connection:n,address:e,cluster:t="mainnet"}){let r=await Bt(n,[...new Set(e.map(s=>s.toString()))].map(s=>new Q.PublicKey(s))),o={};for(let s=0;s<e.length;s++){let u=r[s],i=e[s];if(!u)continue;let y=new Q.AddressLookupTableAccount({key:i,state:Q.AddressLookupTableAccount.deserialize(u.data)});o[i.toString()]=y,t==="devnet"?le[i.toString()]=y:_e[i.toString()]=y}return o}var _e={AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU:new Q.AddressLookupTableAccount({key:new Q.PublicKey("AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU"),state:Q.AddressLookupTableAccount.deserialize(Buffer.from("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","base64"))})},le={},it=async n=>{let e="EFhMuDw1PKEuckuFRW9PavNfTH4LKP5uKHgyXDmWpFCq";if(le[e])return le;let t=new Q.PublicKey(e),r=await n.getAccountInfo(t);return r&&(le[e]=new Q.AddressLookupTableAccount({key:t,state:Q.AddressLookupTableAccount.deserialize(r.data)})),le};var R=require("@solana/web3.js"),Ut=W(require("axios"));var Fe=2e3,Oe=class{constructor(e){this.instructions=[];this.endInstructions=[];this.lookupTableAddress=[];this.signers=[];this.instructionTypes=[];this.endInstructionTypes=[];this.connection=e.connection,this.feePayer=e.feePayer,this.signAllTransactions=e.signAllTransactions,this.owner=e.owner,this.cluster=e.cluster,this.blockhashCommitment=e.blockhashCommitment,this.loopMultiTxStatus=!!e.loopMultiTxStatus}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers,instructionTypes:this.instructionTypes,endInstructionTypes:this.endInstructionTypes,lookupTableAddress:this.lookupTableAddress}}get allInstructions(){return[...this.instructions,...this.endInstructions]}async getComputeBudgetConfig(){var r;let e=(await Ut.default.get(`https://solanacompass.com/api/fees?cacheFreshTime=${3e5}`)).data,{avg:t}=(r=e==null?void 0:e[15])!=null?r:{};if(!!t)return{units:6e5,microLamports:Math.min(Math.ceil(t*1e6/6e5),25e3)}}addCustomComputeBudget(e){if(e){let{instructions:t,instructionTypes:r}=Ie(e);return this.instructions.unshift(...t),this.instructionTypes.unshift(...r),!0}return!1}addTipInstruction(e){var t;return e?(this.endInstructions.push(R.SystemProgram.transfer({fromPubkey:(t=e.feePayer)!=null?t:this.feePayer,toPubkey:new R.PublicKey(e.address),lamports:BigInt(e.amount.toString())})),this.endInstructionTypes.push(G.TransferTip),!0):!1}async calComputeBudget({config:e,defaultIns:t}){try{let r=e||await this.getComputeBudgetConfig();if(this.addCustomComputeBudget(r))return;t&&this.instructions.unshift(...t)}catch{t&&this.instructions.unshift(...t)}}addInstruction({instructions:e=[],endInstructions:t=[],signers:r=[],instructionTypes:o=[],endInstructionTypes:s=[],lookupTableAddress:u=[]}){return this.instructions.push(...e),this.endInstructions.push(...t),this.signers.push(...r),this.instructionTypes.push(...o),this.endInstructionTypes.push(...s),this.lookupTableAddress.push(...u.filter(i=>i!==R.PublicKey.default.toString())),this}async versionBuild({txVersion:e,extInfo:t}){return e===0?await this.buildV0(v({},t||{})):this.build(t)}build(e){var r;let t=new R.Transaction;return this.allInstructions.length&&t.add(...this.allInstructions),t.feePayer=this.feePayer,((r=this.owner)==null?void 0:r.signer)&&!this.signers.some(o=>o.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer),{builder:this,transaction:t,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async o=>{var f;let{recentBlockHash:s,skipPreflight:u=!0,sendAndConfirm:i,notSendToRpc:y}=o||{},x=s!=null?s:await ce(this.connection,this.blockhashCommitment);if(t.recentBlockhash=x,this.signers.length&&t.sign(...this.signers),se([t]),(f=this.owner)!=null&&f.isKeyPair)return{txId:i?await(0,R.sendAndConfirmTransaction)(this.connection,t,this.signers.find(P=>P.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:u}):await this.connection.sendRawTransaction(t.serialize(),{skipPreflight:u}),signedTx:t};if(this.signAllTransactions){let c=await this.signAllTransactions([t]);if(this.signers.length)for(let P of c)try{P.sign(...this.signers)}catch{}return{txId:y?"":await this.connection.sendRawTransaction(c[0].serialize(),{skipPreflight:u}),signedTx:c[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:e||{}}}buildMultiTx(e){var x;let{extraPreBuildData:t=[],extInfo:r}=e,{transaction:o}=this.build(r),s=t.filter(f=>f.transaction.instructions.length>0),u=[o,...s.map(f=>f.transaction)],i=[this.signers,...s.map(f=>f.signers)],y=[...this.instructionTypes,...s.map(f=>f.instructionTypes).flat()];return(x=this.owner)!=null&&x.signer&&i.forEach(f=>{f.some(c=>c.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),{builder:this,transactions:u,signers:i,instructionTypes:y,execute:async f=>{var L;let{sequentially:c,onTxUpdate:P,skipTxCount:T=0,recentBlockHash:h,skipPreflight:g=!0}=f||{},a=h!=null?h:await ce(this.connection,this.blockhashCommitment);if((L=this.owner)!=null&&L.isKeyPair){if(c){let w=[],k=0;for(let b of u){if(++k,k<=T)continue;let l=await(0,R.sendAndConfirmTransaction)(this.connection,b,this.signers.find(p=>p.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:g});w.push(l)}return{txIds:w,signedTxs:u}}return{txIds:await await Promise.all(u.map(async w=>(w.recentBlockhash=a,await this.connection.sendRawTransaction(w.serialize(),{skipPreflight:g})))),signedTxs:u}}if(this.signAllTransactions){let w=u.map((b,l)=>(b.recentBlockhash=a,i[l].length&&b.sign(...i[l]),b));se(w);let k=await this.signAllTransactions(w);if(c){let b=0,l=[],p=async()=>{if(!k[b])return;let S=await this.connection.sendRawTransaction(k[b].serialize(),{skipPreflight:g});l.push({txId:S,status:"sent",signedTx:k[b]}),P==null||P([...l]),b++;let A=!1,C=null,K=null,_=M=>{C!==null&&clearInterval(C),K!==null&&this.connection.removeSignatureListener(K);let D=l.findIndex(E=>E.txId===S);if(D>-1){if(l[D].status==="error"||l[D].status==="success")return;l[D].status=M.err?"error":"success"}P==null||P([...l]),M.err||p()};this.loopMultiTxStatus&&(C=setInterval(async()=>{var M;if(A){clearInterval(C);return}try{let D=await this.connection.getTransaction(S,{commitment:"confirmed",maxSupportedTransactionVersion:0});D&&(A=!0,clearInterval(C),_({err:((M=D.meta)==null?void 0:M.err)||null}),console.log("tx status from getTransaction:",S))}catch(D){A=!0,clearInterval(C),console.error("getTransaction timeout:",D,S)}},Fe)),K=this.connection.onSignature(S,M=>{if(A){this.connection.removeSignatureListener(K);return}A=!0,_(M)},"confirmed"),this.connection.getSignatureStatus(S)};return await p(),{txIds:l.map(S=>S.txId),signedTxs:k}}else{let b=[];for(let l=0;l<k.length;l+=1){let p=await this.connection.sendRawTransaction(k[l].serialize(),{skipPreflight:g});b.push(p)}return{txIds:b,signedTxs:k}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async versionMultiBuild({extraPreBuildData:e,txVersion:t,extInfo:r}){return t===0?await this.buildV0MultiTx({extraPreBuildData:e,buildProps:r||{}}):this.buildMultiTx({extraPreBuildData:e,extInfo:r})}async buildV0(e){var g;let h=e||{},{lookupTableCache:t={},lookupTableAddress:r=[],forerunCreate:o,recentBlockhash:s}=h,u=Ce(h,["lookupTableCache","lookupTableAddress","forerunCreate","recentBlockhash"]),i=v(v({},this.cluster==="devnet"?await it(this.connection):_e),t),y=Array.from(new Set([...r,...this.lookupTableAddress])),x=[];for(let a of y)i[a]===void 0&&x.push(new R.PublicKey(a));let f=await ot({connection:this.connection,address:x});for(let[a,L]of Object.entries(f))i[a]=L;let c=o?R.PublicKey.default.toBase58():s!=null?s:await ce(this.connection,this.blockhashCommitment),P=new R.TransactionMessage({payerKey:this.feePayer,recentBlockhash:c,instructions:[...this.allInstructions]}).compileToV0Message(Object.values(i));((g=this.owner)==null?void 0:g.signer)&&!this.signers.some(a=>a.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer);let T=new R.VersionedTransaction(P);return T.sign(this.signers),{builder:this,transaction:T,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async a=>{var b;let{skipPreflight:L=!0,sendAndConfirm:w,notSendToRpc:k}=a||{};if(se([T]),(b=this.owner)!=null&&b.isKeyPair){let l=await this.connection.sendTransaction(T,{skipPreflight:L});return w&&await Ee(this.connection,l),{txId:l,signedTx:T}}if(this.signAllTransactions){let l=await this.signAllTransactions([T]);if(this.signers.length)for(let p of l)try{p.sign(this.signers)}catch{}return{txId:k?"":await this.connection.sendTransaction(l[0],{skipPreflight:L}),signedTx:l[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:u||{}}}async buildV0MultiTx(e){var x;let{extraPreBuildData:t=[],buildProps:r}=e,{transaction:o}=await this.buildV0(r),s=t.filter(f=>f.builder.instructions.length>0),u=[o,...s.map(f=>f.transaction)],i=[this.signers,...s.map(f=>f.signers)],y=[...this.instructionTypes,...s.map(f=>f.instructionTypes).flat()];return(x=this.owner)!=null&&x.signer&&i.forEach(f=>{f.some(c=>c.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),u.forEach(async(f,c)=>{f.sign(i[c])}),{builder:this,transactions:u,signers:i,instructionTypes:y,buildProps:r,execute:async f=>{var g;let{sequentially:c,onTxUpdate:P,recentBlockHash:T,skipPreflight:h=!0}=f||{};if(T&&u.forEach(a=>a.message.recentBlockhash=T),se(u),(g=this.owner)!=null&&g.isKeyPair){if(c){let a=[];for(let L of u){let w=await this.connection.sendTransaction(L,{skipPreflight:h});await Ee(this.connection,w),a.push(w)}return{txIds:a,signedTxs:u}}return{txIds:await Promise.all(u.map(async a=>await this.connection.sendTransaction(a,{skipPreflight:h}))),signedTxs:u}}if(this.signAllTransactions){let a=await this.signAllTransactions(u);if(c){let L=0,w=[],k=async()=>{if(!a[L])return;let b=await this.connection.sendTransaction(a[L],{skipPreflight:h});w.push({txId:b,status:"sent",signedTx:a[L]}),P==null||P([...w]),L++;let l=!1,p=null,S=null,A=C=>{p!==null&&clearInterval(p),S!==null&&this.connection.removeSignatureListener(S);let K=w.findIndex(_=>_.txId===b);if(K>-1){if(w[K].status==="error"||w[K].status==="success")return;w[K].status=C.err?"error":"success"}P==null||P([...w]),C.err||k()};this.loopMultiTxStatus&&(p=setInterval(async()=>{var C;if(l){clearInterval(p);return}try{let K=await this.connection.getTransaction(b,{commitment:"confirmed",maxSupportedTransactionVersion:0});K&&(l=!0,clearInterval(p),A({err:((C=K.meta)==null?void 0:C.err)||null}),console.log("tx status from getTransaction:",b))}catch(K){l=!0,clearInterval(p),console.error("getTransaction timeout:",K,b)}},Fe)),S=this.connection.onSignature(b,C=>{if(l){this.connection.removeSignatureListener(S);return}l=!0,A(C)},"confirmed"),this.connection.getSignatureStatus(b)};return k(),{txIds:[],signedTxs:a}}else{let L=[];for(let w=0;w<a.length;w+=1){let k=await this.connection.sendTransaction(a[w],{skipPreflight:h});L.push(k)}return{txIds:L,signedTxs:a}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async sizeCheckBuild(e){var P;let c=e||{},{splitIns:t=[],computeBudgetConfig:r}=c,o=Ce(c,["splitIns","computeBudgetConfig"]),s=r?Ie(r):{instructions:[],instructionTypes:[]},u=this.signers.reduce((T,h)=>ee(v({},T),{[h.publicKey.toBase58()]:h}),{}),i=[],y=[],x=[],f=0;if(this.allInstructions.forEach(T=>{let h=[...x,T],g=r?[...s.instructions,...h]:h,L=[...new Set(h.map(w=>w.keys.filter(k=>k.isSigner).map(k=>k.pubkey.toString())).flat()).values()].map(w=>new R.PublicKey(w));if(T!==t[f]&&x.length<12&&(Ae({instructions:g,payer:this.feePayer,signers:L})||Ae({instructions:h,payer:this.feePayer,signers:L})))x.push(T);else{if(x.length===0)throw Error("item ins too big");f+=T===t[f]?1:0,Ae({instructions:r?[...s.instructions,...x]:[...x],payer:this.feePayer,signers:L})?i.push(new R.Transaction().add(...s.instructions,...x)):i.push(new R.Transaction().add(...x)),y.push(Array.from(new Set(x.map(w=>w.keys.filter(k=>k.isSigner).map(k=>k.pubkey.toString())).flat())).map(w=>u[w]).filter(w=>w!==void 0)),x=[T]}}),x.length>0){let h=[...new Set(x.map(g=>g.keys.filter(a=>a.isSigner).map(a=>a.pubkey.toString())).flat()).values()].map(g=>u[g]).filter(g=>g!==void 0);Ae({instructions:r?[...s.instructions,...x]:[...x],payer:this.feePayer,signers:h.map(g=>g.publicKey)})?i.push(new R.Transaction().add(...s.instructions,...x)):i.push(new R.Transaction().add(...x)),y.push(h)}return i.forEach(T=>T.feePayer=this.feePayer),(P=this.owner)!=null&&P.signer&&y.forEach(T=>{T.some(h=>h.publicKey.equals(this.owner.publicKey))||T.push(this.owner.signer)}),{builder:this,transactions:i,signers:y,instructionTypes:this.instructionTypes,execute:async T=>{var b;let{sequentially:h,onTxUpdate:g,skipTxCount:a=0,recentBlockHash:L,skipPreflight:w=!0}=T||{},k=L!=null?L:await ce(this.connection,this.blockhashCommitment);if(i.forEach(async(l,p)=>{l.recentBlockhash=k,y[p].length&&l.sign(...y[p])}),se(i),(b=this.owner)!=null&&b.isKeyPair){if(h){let l=0,p=[];for(let S of i){if(++l,l<=a){p.push("tx skipped");continue}let A=await(0,R.sendAndConfirmTransaction)(this.connection,S,this.signers.find(C=>C.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:w});p.push(A)}return{txIds:p,signedTxs:i}}return{txIds:await Promise.all(i.map(async l=>await this.connection.sendRawTransaction(l.serialize(),{skipPreflight:w}))),signedTxs:i}}if(this.signAllTransactions){let l=await this.signAllTransactions(i.slice(a,i.length)),p=[...i.slice(0,a),...l];if(h){let S=0,A=[],C=async()=>{if(!p[S])return;S<a&&(A.push({txId:"",status:"success",signedTx:p[S]}),g==null||g([...A]),S++,C());let K=await this.connection.sendRawTransaction(p[S].serialize(),{skipPreflight:w});A.push({txId:K,status:"sent",signedTx:p[S]}),g==null||g([...A]),S++;let _=!1,M=null,D=null,E=V=>{M!==null&&clearInterval(M),D!==null&&this.connection.removeSignatureListener(D);let F=A.findIndex(U=>U.txId===K);if(F>-1){if(A[F].status==="error"||A[F].status==="success")return;A[F].status=V.err?"error":"success"}g==null||g([...A]),V.err||C()};this.loopMultiTxStatus&&(M=setInterval(async()=>{var V;if(_){clearInterval(M);return}try{let F=await this.connection.getTransaction(K,{commitment:"confirmed",maxSupportedTransactionVersion:0});F&&(_=!0,clearInterval(M),E({err:((V=F.meta)==null?void 0:V.err)||null}),console.log("tx status from getTransaction:",K))}catch(F){_=!0,clearInterval(M),console.error("getTransaction timeout:",F,K)}},Fe)),D=this.connection.onSignature(K,V=>{if(_){this.connection.removeSignatureListener(D);return}_=!0,E(V)},"confirmed"),this.connection.getSignatureStatus(K)};return await C(),{txIds:A.map(K=>K.txId),signedTxs:p}}else{let S=[];for(let A=0;A<p.length;A+=1){let C=await this.connection.sendRawTransaction(p[A].serialize(),{skipPreflight:w});S.push(C)}return{txIds:S,signedTxs:p}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:o||{}}}async sizeCheckBuildV0(e){var k;let w=e||{},{computeBudgetConfig:t,splitIns:r=[],lookupTableCache:o={},lookupTableAddress:s=[]}=w,u=Ce(w,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),i=v(v({},this.cluster==="devnet"?await it(this.connection):_e),o),y=Array.from(new Set([...this.lookupTableAddress,...s])),x=[];for(let b of y)i[b]===void 0&&x.push(new R.PublicKey(b));let f=await ot({connection:this.connection,address:x});for(let[b,l]of Object.entries(f))i[b]=l;let c=t?Ie(t):{instructions:[],instructionTypes:[]},P=await ce(this.connection,this.blockhashCommitment),T=this.signers.reduce((b,l)=>ee(v({},b),{[l.publicKey.toBase58()]:l}),{}),h=[],g=[],a=[],L=0;if(this.allInstructions.forEach(b=>{let l=[...a,b],p=t?[...c.instructions,...l]:l;if(b!==r[L]&&a.length<12&&(Se({instructions:p,payer:this.feePayer,lookupTableAddressAccount:i})||Se({instructions:l,payer:this.feePayer,lookupTableAddressAccount:i})))a.push(b);else{if(a.length===0)throw Error("item ins too big");L+=b===r[L]?1:0;let S={};for(let A of[...new Set(y)])i[A]!==void 0&&(S[A]=i[A]);if(t&&Se({instructions:[...c.instructions,...a],payer:this.feePayer,lookupTableAddressAccount:i,recentBlockhash:P})){let A=new R.TransactionMessage({payerKey:this.feePayer,recentBlockhash:P,instructions:[...c.instructions,...a]}).compileToV0Message(Object.values(i));h.push(new R.VersionedTransaction(A))}else{let A=new R.TransactionMessage({payerKey:this.feePayer,recentBlockhash:P,instructions:[...a]}).compileToV0Message(Object.values(i));h.push(new R.VersionedTransaction(A))}g.push(Array.from(new Set(a.map(A=>A.keys.filter(C=>C.isSigner).map(C=>C.pubkey.toString())).flat())).map(A=>T[A]).filter(A=>A!==void 0)),a=[b]}}),a.length>0){let l=[...new Set(a.map(p=>p.keys.filter(S=>S.isSigner).map(S=>S.pubkey.toString())).flat()).values()].map(p=>T[p]).filter(p=>p!==void 0);if(t&&Se({instructions:[...c.instructions,...a],payer:this.feePayer,lookupTableAddressAccount:i,recentBlockhash:P})){let p=new R.TransactionMessage({payerKey:this.feePayer,recentBlockhash:P,instructions:[...c.instructions,...a]}).compileToV0Message(Object.values(i));h.push(new R.VersionedTransaction(p))}else{let p=new R.TransactionMessage({payerKey:this.feePayer,recentBlockhash:P,instructions:[...a]}).compileToV0Message(Object.values(i));h.push(new R.VersionedTransaction(p))}g.push(l)}return(k=this.owner)!=null&&k.signer&&g.forEach(b=>{b.some(l=>l.publicKey.equals(this.owner.publicKey))||b.push(this.owner.signer)}),h.forEach((b,l)=>{b.sign(g[l])}),{builder:this,transactions:h,buildProps:e,signers:g,instructionTypes:this.instructionTypes,execute:async b=>{var K;let{sequentially:l,onTxUpdate:p,skipTxCount:S=0,recentBlockHash:A,skipPreflight:C=!0}=b||{};if(h.map(async(_,M)=>{g[M].length&&_.sign(g[M]),A&&(_.message.recentBlockhash=A)}),se(h),(K=this.owner)!=null&&K.isKeyPair){if(l){let _=0,M=[];for(let D of h){if(++_,_<=S){console.log("skip tx: ",_),M.push("tx skipped");continue}let E=await this.connection.sendTransaction(D,{skipPreflight:C});await Ee(this.connection,E),M.push(E)}return{txIds:M,signedTxs:h}}return{txIds:await Promise.all(h.map(async _=>await this.connection.sendTransaction(_,{skipPreflight:C}))),signedTxs:h}}if(this.signAllTransactions){let _=await this.signAllTransactions(h.slice(S,h.length)),M=[...h.slice(0,S),..._];if(l){let D=0,E=[],V=async()=>{if(!M[D])return;if(D<S){E.push({txId:"",status:"success",signedTx:M[D]}),p==null||p([...E]),D++,V();return}let F=await this.connection.sendTransaction(M[D],{skipPreflight:C});E.push({txId:F,status:"sent",signedTx:M[D]}),p==null||p([...E]),D++;let U=!1,$=null,Le=null,xt=oe=>{$!==null&&clearInterval($),Le!==null&&this.connection.removeSignatureListener(Le);let X=E.findIndex(tn=>tn.txId===F);if(X>-1){if(E[X].status==="error"||E[X].status==="success")return;E[X].status=oe.err?"error":"success"}p==null||p([...E]),oe.err||V()};this.loopMultiTxStatus&&($=setInterval(async()=>{var oe;if(U){clearInterval($);return}try{let X=await this.connection.getTransaction(F,{commitment:"confirmed",maxSupportedTransactionVersion:0});X&&(U=!0,clearInterval($),xt({err:((oe=X.meta)==null?void 0:oe.err)||null}),console.log("tx status from getTransaction:",F))}catch(X){U=!0,clearInterval($),console.error("getTransaction timeout:",X,F)}},Fe)),Le=this.connection.onSignature(F,oe=>{if(U){this.connection.removeSignatureListener(Le);return}U=!0,xt(oe)},"confirmed"),this.connection.getSignatureStatus(F)};return V(),{txIds:[],signedTxs:M}}else{let D=[];for(let E=0;E<M.length;E+=1){let V=await this.connection.sendTransaction(M[E],{skipPreflight:C});D.push(V)}return{txIds:D,signedTxs:M}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:u||{}}}};var An=require("@solana/web3.js"),Sn=W(require("bn.js"));var qt=W(require("bn.js")),pi=new qt.default(1e6);var vi=q("Raydium_amount"),Wi=Te(Gt.default);var Ke=new J.default(0),ts=new J.default(1),ns=new J.default(2),rs=new J.default(3),os=new J.default(5),Ln=new J.default(10),is=new J.default(100),ss=new J.default(1e3),as=new J.default(1e4);var ze=require("@solana/web3.js"),Kn=W(require("bn.js"));var $t=require("@solana/spl-token");function Cn(n){return n instanceof Uint8Array||n!=null&&typeof n=="object"&&n.constructor.name==="Uint8Array"}function st(n,...e){if(!Cn(n))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(n.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${n.length}`)}function at(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")}function Ht(n,e){st(n);let t=e.outputLen;if(n.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}var ve=n=>new DataView(n.buffer,n.byteOffset,n.byteLength),Z=(n,e)=>n<<32-e|n>>>e;var ps=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Mn(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function ut(n){return typeof n=="string"&&(n=Mn(n)),st(n),n}var Ve=class{clone(){return this._cloneInto()}},ms={}.toString;function zt(n){let e=r=>n().update(ut(r)).digest(),t=n();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>n(),e}function Rn(n,e,t,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,t,r);let o=BigInt(32),s=BigInt(4294967295),u=Number(t>>o&s),i=Number(t&s),y=r?4:0,x=r?0:4;n.setUint32(e+y,u,r),n.setUint32(e+x,i,r)}var jt=(n,e,t)=>n&e^~n&t,Qt=(n,e,t)=>n&e^n&t^e&t,We=class extends Ve{constructor(e,t,r,o){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ve(this.buffer)}update(e){at(this);let{view:t,buffer:r,blockLen:o}=this;e=ut(e);let s=e.length;for(let u=0;u<s;){let i=Math.min(o-this.pos,s-u);if(i===o){let y=ve(e);for(;o<=s-u;u+=o)this.process(y,u);continue}r.set(e.subarray(u,u+i),this.pos),this.pos+=i,u+=i,this.pos===o&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){at(this),Ht(e,this),this.finished=!0;let{buffer:t,view:r,blockLen:o,isLE:s}=this,{pos:u}=this;t[u++]=128,this.buffer.subarray(u).fill(0),this.padOffset>o-u&&(this.process(r,0),u=0);for(let c=u;c<o;c++)t[c]=0;Rn(r,o-8,BigInt(this.length*8),s),this.process(r,0);let i=ve(e),y=this.outputLen;if(y%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let x=y/4,f=this.get();if(x>f.length)throw new Error("_sha2: outputLen bigger than state");for(let c=0;c<x;c++)i.setUint32(4*c,f[c],s)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:r,length:o,finished:s,destroyed:u,pos:i}=this;return e.length=o,e.pos=i,e.finished=s,e.destroyed=u,o%t&&e.buffer.set(r),e}};var Dn=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),te=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ne=new Uint32Array(64),ct=class extends We{constructor(){super(64,32,8,!1),this.A=te[0]|0,this.B=te[1]|0,this.C=te[2]|0,this.D=te[3]|0,this.E=te[4]|0,this.F=te[5]|0,this.G=te[6]|0,this.H=te[7]|0}get(){let{A:e,B:t,C:r,D:o,E:s,F:u,G:i,H:y}=this;return[e,t,r,o,s,u,i,y]}set(e,t,r,o,s,u,i,y){this.A=e|0,this.B=t|0,this.C=r|0,this.D=o|0,this.E=s|0,this.F=u|0,this.G=i|0,this.H=y|0}process(e,t){for(let c=0;c<16;c++,t+=4)ne[c]=e.getUint32(t,!1);for(let c=16;c<64;c++){let P=ne[c-15],T=ne[c-2],h=Z(P,7)^Z(P,18)^P>>>3,g=Z(T,17)^Z(T,19)^T>>>10;ne[c]=g+ne[c-7]+h+ne[c-16]|0}let{A:r,B:o,C:s,D:u,E:i,F:y,G:x,H:f}=this;for(let c=0;c<64;c++){let P=Z(i,6)^Z(i,11)^Z(i,25),T=f+P+jt(i,y,x)+Dn[c]+ne[c]|0,g=(Z(r,2)^Z(r,13)^Z(r,22))+Qt(r,o,s)|0;f=x,x=y,y=i,i=u+T|0,u=s,s=o,o=r,r=T+g|0}r=r+this.A|0,o=o+this.B|0,s=s+this.C|0,u=u+this.D|0,i=i+this.E|0,y=y+this.F|0,x=x+this.G|0,f=f+this.H|0,this.set(r,o,s,u,i,y,x,f)}roundClean(){ne.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var Zt=zt(()=>new ct);var Yt=require("@solana/web3.js"),qe=W(require("bn.js"));var d=require("@solana/buffer-layout"),Ue=d.Layout,Jt=d.Structure;var lt=d.UInt;var Xt=d.u16;var pt=d.u32;var pe=d.blob;var mt=d.bits;var dt=class extends Ue{constructor(t,r,o){super(t,o);this.blob=pe(t),this.signed=r}decode(t,r=0){let o=new qe.default(this.blob.decode(t,r),10,"le");return this.signed?o.fromTwos(this.span*8).clone():o}encode(t,r,o=0){return typeof t=="number"&&(t=new qe.default(t)),this.signed&&(t=t.toTwos(this.span*8)),this.blob.encode(t.toArrayLike(Buffer,"le",this.span),r,o)}},Ge=class extends Ue{constructor(t){super(8,t);this._lower=mt(pt(),!1),this._upper=mt(pt(),!1)}addBoolean(t){this._lower.fields.length<32?this._lower.addBoolean(t):this._upper.addBoolean(t)}decode(t,r=0){let o=this._lower.decode(t,r),s=this._upper.decode(t,r+this._lower.span);return v(v({},o),s)}encode(t,r,o=0){return this._lower.encode(t,r,o)+this._upper.encode(t,r,o+this._lower.span)}};function He(n){return new lt(1,n)}function me(n){return new lt(4,n)}function O(n){return new dt(8,!1,n)}var ft=class extends Ue{constructor(t,r,o,s){super(t.span,s);this.layout=t,this.decoder=r,this.encoder=o}decode(t,r){return this.decoder(this.layout.decode(t,r))}encode(t,r,o){return this.layout.encode(this.encoder(t),r,o)}getSpan(t,r){return this.layout.getSpan(t,r)}};function z(n){return new ft(pe(32),e=>new Yt.PublicKey(e),e=>e.toBuffer(),n)}var gt=class extends Jt{decode(e,t){return super.decode(e,t)}};function de(n,e,t){return new gt(n,e,t)}var Nn=de([z("mint"),z("owner"),O("amount"),me("delegateOption"),z("delegate"),He("state"),me("isNativeOption"),O("isNative"),O("delegatedAmount"),me("closeAuthorityOption"),z("closeAuthority")]);var Vs=q("Raydium_Util");function re({fromPublicKey:n,programId:e=$t.TOKEN_PROGRAM_ID,assignSeed:t}){let r=t?btoa(t).slice(0,32):ze.Keypair.generate().publicKey.toBase58().slice(0,32);return{publicKey:In(n,r,e),seed:r}}function In(n,e,t){let r=Buffer.concat([n.toBuffer(),Buffer.from(e),t.toBuffer()]),o=Zt(r);return new ze.PublicKey(o)}var bt=(...n)=>n.map(e=>{try{return typeof e=="object"?JSON.stringify(e):e}catch{return e}}).join(", "),Be=class{constructor({scope:e,moduleName:t}){this.disabled=!1;this.scope=e,this.logger=q(t)}createTxBuilder(e){return this.scope.checkOwner(),new Oe({connection:this.scope.connection,feePayer:e||this.scope.ownerPubKey,cluster:this.scope.cluster,owner:this.scope.owner,blockhashCommitment:this.scope.blockhashCommitment,loopMultiTxStatus:this.scope.loopMultiTxStatus,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}logDebug(...e){this.logger.debug(bt(e))}logInfo(...e){this.logger.info(bt(e))}logAndCreateError(...e){let t=bt(e);throw new Error(t)}checkDisabled(){(this.disabled||!this.scope)&&this.logAndCreateError("module not working")}};var j=require("@solana/web3.js"),fe=require("@solana/spl-token");function En(n="accountFlags"){let e=new Ge(n);return e.addBoolean("initialized"),e.addBoolean("market"),e.addBoolean("openOrders"),e.addBoolean("requestQueue"),e.addBoolean("eventQueue"),e.addBoolean("bids"),e.addBoolean("asks"),e}var yt=de([pe(5),En("accountFlags"),z("ownAddress"),O("vaultSignerNonce"),z("baseMint"),z("quoteMint"),z("baseVault"),O("baseDepositsTotal"),O("baseFeesAccrued"),z("quoteVault"),O("quoteDepositsTotal"),O("quoteFeesAccrued"),O("quoteDustThreshold"),z("requestQueue"),z("eventQueue"),z("bids"),z("asks"),O("baseLotSize"),O("quoteLotSize"),O("feeRateBps"),O("referrerRebatesAccrued"),pe(7)]);function _n({programId:n,marketInfo:e}){let t=de([He("version"),me("instruction"),O("baseLotSize"),O("quoteLotSize"),Xt("feeRateBps"),O("vaultSignerNonce"),O("quoteDustThreshold")]),r=[{pubkey:e.id,isSigner:!1,isWritable:!0},{pubkey:e.requestQueue,isSigner:!1,isWritable:!0},{pubkey:e.eventQueue,isSigner:!1,isWritable:!0},{pubkey:e.bids,isSigner:!1,isWritable:!0},{pubkey:e.asks,isSigner:!1,isWritable:!0},{pubkey:e.baseVault,isSigner:!1,isWritable:!0},{pubkey:e.quoteVault,isSigner:!1,isWritable:!0},{pubkey:e.baseMint,isSigner:!1,isWritable:!1},{pubkey:e.quoteMint,isSigner:!1,isWritable:!1},{pubkey:e.authority?e.quoteMint:j.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}].concat(e.authority?{pubkey:e.authority,isSigner:!1,isWritable:!1}:[]).concat(e.authority&&e.pruneAuthority?{pubkey:e.pruneAuthority,isSigner:!1,isWritable:!1}:[]),o=Buffer.alloc(t.span);return t.encode({version:0,instruction:0,baseLotSize:e.baseLotSize,quoteLotSize:e.quoteLotSize,feeRateBps:e.feeRateBps,vaultSignerNonce:e.vaultSignerNonce,quoteDustThreshold:e.quoteDustThreshold},o),new j.TransactionInstruction({keys:r,programId:n,data:o})}async function en({connection:n,wallet:e,marketInfo:t}){var u,i,y,x,f,c,P,T;let r=new j.Transaction,o=await n.getMinimumBalanceForRentExemption(165);r.add(j.SystemProgram.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.baseVault.seed,newAccountPubkey:t.baseVault.publicKey,lamports:o,space:165,programId:fe.TOKEN_PROGRAM_ID}),j.SystemProgram.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.quoteVault.seed,newAccountPubkey:t.quoteVault.publicKey,lamports:o,space:165,programId:fe.TOKEN_PROGRAM_ID}),(0,fe.createInitializeAccountInstruction)(t.baseVault.publicKey,t.baseMint,t.vaultOwner),(0,fe.createInitializeAccountInstruction)(t.quoteVault.publicKey,t.quoteMint,t.vaultOwner),j.SystemProgram.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.id.seed,newAccountPubkey:t.id.publicKey,lamports:await n.getMinimumBalanceForRentExemption(yt.span),space:yt.span,programId:t.programId}));let s=new j.Transaction;return s.add(j.SystemProgram.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.requestQueue.seed,newAccountPubkey:t.requestQueue.publicKey,lamports:t.lowestFeeMarket?6208320:await n.getMinimumBalanceForRentExemption((u=t.requestQueueSpace)!=null?u:5120+12),space:t.lowestFeeMarket?764:(i=t.requestQueueSpace)!=null?i:5120+12,programId:t.programId}),j.SystemProgram.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.eventQueue.seed,newAccountPubkey:t.eventQueue.publicKey,lamports:t.lowestFeeMarket?79594560:await n.getMinimumBalanceForRentExemption((y=t.eventQueueSpace)!=null?y:262144+12),space:t.lowestFeeMarket?11308:(x=t.eventQueueSpace)!=null?x:262144+12,programId:t.programId}),j.SystemProgram.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.bids.seed,newAccountPubkey:t.bids.publicKey,lamports:t.lowestFeeMarket?101977920:await n.getMinimumBalanceForRentExemption((f=t.orderbookQueueSpace)!=null?f:65536+12),space:t.lowestFeeMarket?14524:(c=t.orderbookQueueSpace)!=null?c:65536+12,programId:t.programId}),j.SystemProgram.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.asks.seed,newAccountPubkey:t.asks.publicKey,lamports:t.lowestFeeMarket?101977920:await n.getMinimumBalanceForRentExemption((P=t.orderbookQueueSpace)!=null?P:65536+12),space:t.lowestFeeMarket?14524:(T=t.orderbookQueueSpace)!=null?T:65536+12,programId:t.programId}),_n({programId:t.programId,marketInfo:{id:t.id.publicKey,requestQueue:t.requestQueue.publicKey,eventQueue:t.eventQueue.publicKey,bids:t.bids.publicKey,asks:t.asks.publicKey,baseVault:t.baseVault.publicKey,quoteVault:t.quoteVault.publicKey,baseMint:t.baseMint,quoteMint:t.quoteMint,baseLotSize:t.baseLotSize,quoteLotSize:t.quoteLotSize,feeRateBps:t.feeRateBps,vaultSignerNonce:t.vaultSignerNonce,quoteDustThreshold:t.quoteDustThreshold}})),[{transaction:r,signer:[],instructionTypes:[G.CreateAccount,G.CreateAccount,G.InitAccount,G.InitAccount]},{transaction:s,signer:[],instructionTypes:[G.CreateAccount,G.CreateAccount,G.CreateAccount,G.CreateAccount,G.CreateAccount,G.InitMarket]}]}var je=class extends Be{async create({baseInfo:e,quoteInfo:t,lotSize:r,tickSize:o,dexProgramId:s,requestQueueSpace:u,eventQueueSpace:i,orderbookQueueSpace:y,lowestFeeMarket:x,assignSeed:f,txVersion:c,computeBudgetConfig:P,txTipConfig:T,feePayer:h}){let g=this.scope.ownerPubKey,a=f?`${e.mint.toBase58().slice(0,10)}-${t.mint.toBase58().slice(0,10)}-${f}`:void 0,L=re({fromPublicKey:g,programId:s,assignSeed:a&&`${a}-market`}),w=re({fromPublicKey:g,programId:s,assignSeed:a&&`${a}-request`}),k=re({fromPublicKey:g,programId:s,assignSeed:a&&`${a}-event`}),b=re({fromPublicKey:g,programId:s,assignSeed:a&&`${a}-bids`}),l=re({fromPublicKey:g,programId:s,assignSeed:a&&`${a}-asks`}),p=re({fromPublicKey:g,programId:ht.TOKEN_PROGRAM_ID,assignSeed:a&&`${a}-baseVault`}),S=re({fromPublicKey:g,programId:ht.TOKEN_PROGRAM_ID,assignSeed:a&&`${a}-quoteVault`}),A=0,C=new be.default(100);function K(){let U=new be.default(0);for(;;)try{return{vaultOwner:ge.PublicKey.createProgramAddressSync([L.publicKey.toBuffer(),U.toArrayLike(Buffer,"le",8)],s),vaultSignerNonce:U}}catch{if(U.iaddn(1),U.gt(new be.default(25555)))throw Error("find vault owner error")}}let{vaultOwner:_,vaultSignerNonce:M}=K(),D=new be.default(Math.round(10**e.decimals*r)),E=new be.default(Math.round(r*10**t.decimals*o));if(D.eq(Ke))throw Error("lot size is too small");if(E.eq(Ke))throw Error("tick size or lot size is too small");let V=await en({connection:this.scope.connection,wallet:this.scope.ownerPubKey,marketInfo:{programId:s,id:L,baseMint:e.mint,quoteMint:t.mint,baseVault:p,quoteVault:S,vaultOwner:_,requestQueue:w,eventQueue:k,bids:b,asks:l,feeRateBps:A,quoteDustThreshold:C,vaultSignerNonce:M,baseLotSize:D,quoteLotSize:E,requestQueueSpace:u,eventQueueSpace:i,orderbookQueueSpace:y,lowestFeeMarket:x}}),F=this.createTxBuilder(h);F.addInstruction({instructions:V[0].transaction.instructions,signers:V[0].signer});for await(let U of V.slice(1,V.length))F.addInstruction({instructions:U.transaction.instructions,signers:U.signer,instructionTypes:U.instructionTypes});return c===0?F.sizeCheckBuildV0({computeBudgetConfig:P,address:{marketId:L.publicKey,requestQueue:w.publicKey,eventQueue:k.publicKey,bids:b.publicKey,asks:l.publicKey,baseVault:p.publicKey,quoteVault:S.publicKey,baseMint:new ge.PublicKey(e.mint),quoteMint:new ge.PublicKey(t.mint)}}):F.sizeCheckBuild({computeBudgetConfig:P,address:{marketId:L.publicKey,requestQueue:w.publicKey,eventQueue:k.publicKey,bids:b.publicKey,asks:l.publicKey,baseVault:p.publicKey,quoteVault:S.publicKey,baseMint:new ge.PublicKey(e.mint),quoteMint:new ge.PublicKey(t.mint)}})}};0&&(module.exports={});
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */
//# sourceMappingURL=createMarket.js.map