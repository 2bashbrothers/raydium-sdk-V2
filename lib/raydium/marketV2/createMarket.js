var on=Object.create;var Pe=Object.defineProperty,sn=Object.defineProperties,an=Object.getOwnPropertyDescriptor,un=Object.getOwnPropertyDescriptors,cn=Object.getOwnPropertyNames,Ke=Object.getOwnPropertySymbols,ln=Object.getPrototypeOf,$e=Object.prototype.hasOwnProperty,At=Object.prototype.propertyIsEnumerable;var St=(n,e,t)=>e in n?Pe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,v=(n,e)=>{for(var t in e||(e={}))$e.call(e,t)&&St(n,t,e[t]);if(Ke)for(var t of Ke(e))At.call(e,t)&&St(n,t,e[t]);return n},ne=(n,e)=>sn(n,un(e));var Se=(n,e)=>{var t={};for(var r in n)$e.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&Ke)for(var r of Ke(n))e.indexOf(r)<0&&At.call(n,r)&&(t[r]=n[r]);return t};var pn=(n,e)=>{for(var t in e)Pe(n,t,{get:e[t],enumerable:!0})},Bt=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of cn(e))!$e.call(n,i)&&i!==t&&Pe(n,i,{get:()=>e[i],enumerable:!(r=an(e,i))||r.enumerable});return n};var U=(n,e,t)=>(t=n!=null?on(ln(n)):{},Bt(e||!n||!n.__esModule?Pe(t,"default",{value:n,enumerable:!0}):t,n)),mn=n=>Bt(Pe({},"__esModule",{value:!0}),n);var Vn={};pn(Vn,{default:()=>Ze});module.exports=mn(Vn);var xe=require("@solana/web3.js"),Te=U(require("bn.js")),Pt=require("@solana/spl-token");var ee=U(require("bn.js")),Rn=U(require("decimal.js"));var jt=U(require("big.js")),kn=U(require("bn.js"));var Ae=require("lodash");var et=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:0,this.name=e.name}set level(e){this.logLevel=e}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let t=e.map(r=>typeof r=="object"?JSON.stringify(r):r).join(", ");throw new Error(t)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},Lt={},dn={};function G(n){let e=(0,Ae.get)(Lt,n);if(!e){let t=(0,Ae.get)(dn,n);e=new et({name:n,logLevel:t}),(0,Ae.set)(Lt,n,e)}return e}var kt=require("@solana/web3.js");var Ee=require("@solana/spl-token"),tt=G("Raydium_accountInfo_util");async function Ct(n,e,t){let{batchRequest:r,commitment:i="confirmed",chunkCount:a=100}=v({batchRequest:!1},t),l=nt(e,a),o=new Array(l.length).fill([]);if(r){let b=l.map(m=>{let x=n._buildArgs([m.map(S=>S.toBase58())],i,"base64");return{methodName:"getMultipleAccounts",args:x}}),P=nt(b,10);o=(await(await Promise.all(P.map(async m=>await n._rpcBatchRequest(m)))).flat()).map(m=>(m.error&&tt.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${m.error.message}`),m.result.value.map(x=>{if(x){let{data:S,executable:d,lamports:g,owner:s,rentEpoch:R}=x;return S.length!==2&&S[1]!=="base64"&&tt.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(S[0],"base64"),executable:d,lamports:g,owner:new kt.PublicKey(s),rentEpoch:R}}return null})))}else try{o=await Promise.all(l.map(b=>n.getMultipleAccountsInfo(b,i)))}catch(b){b instanceof Error&&tt.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${b.message}`)}return o.flat()}var me=U(require("bn.js"));var Rt=9007199254740991;function re(n){let e=G("Raydium_parseBigNumberish");if(n instanceof me.default)return n;if(typeof n=="string"){if(n.match(/^-?[0-9]+$/))return new me.default(n);e.logWithError(`invalid BigNumberish string: ${n}`)}return typeof n=="number"?(n%1&&e.logWithError(`BigNumberish number underflow: ${n}`),(n>=Rt||n<=-Rt)&&e.logWithError(`BigNumberish number overflow: ${n}`),new me.default(String(n))):typeof n=="bigint"?new me.default(n.toString()):(e.error(`invalid BigNumberish value: ${n}`),new me.default(0))}var Mt=require("@solana/web3.js"),ot=require("@solana/spl-token"),_t={chainId:101,address:Mt.PublicKey.default.toBase58(),programId:ot.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},le={chainId:101,address:"So11111111111111111111111111111111111111112",programId:ot.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};var Fe=require("@solana/web3.js");var E=require("@solana/web3.js"),It=require("@solana/spl-token");function it({pubkey:n,isSigner:e=!1,isWritable:t=!0}){return{pubkey:n,isWritable:t,isSigner:e}}var er=[it({pubkey:It.TOKEN_PROGRAM_ID,isWritable:!1}),it({pubkey:E.SystemProgram.programId,isWritable:!1}),it({pubkey:E.SYSVAR_RENT_PUBKEY,isWritable:!1})];function Dt({publicKey:n,transformSol:e}){let t=Nt(n.toString());if(t instanceof E.PublicKey)return e&&t.equals(Be)?rt:t;if(e&&t.toString()===Be.toBase58())return rt;if(typeof t=="string"){if(t===E.PublicKey.default.toBase58())return E.PublicKey.default;try{return new E.PublicKey(t)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function Nt(n){try{return new E.PublicKey(n)}catch{return n}}var tr=new E.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),nr=new E.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),rr=new E.PublicKey("SysvarRent111111111111111111111111111111111"),or=new E.PublicKey("SysvarC1ock11111111111111111111111111111111"),ir=new E.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),sr=new E.PublicKey("Sysvar1nstructions1111111111111111111111111"),ar=E.SystemProgram.programId,ur=new E.PublicKey("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),cr=new E.PublicKey("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),lr=new E.PublicKey("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),pr=new E.PublicKey("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),mr=new E.PublicKey("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),dr=new E.PublicKey("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),fr=new E.PublicKey("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),gr=new E.PublicKey("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),hr=new E.PublicKey("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),br=new E.PublicKey("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),yr=new E.PublicKey("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),rt=new E.PublicKey("So11111111111111111111111111111111111111112"),Be=E.PublicKey.default;var st=class{constructor({mint:e,decimals:t,symbol:r,name:i,skipMint:a=!1,isToken2022:l=!1}){if(e===Be.toBase58()||e instanceof Fe.PublicKey&&Be.equals(e)){this.decimals=le.decimals,this.symbol=le.symbol,this.name=le.name,this.mint=new Fe.PublicKey(le.address),this.isToken2022=!1;return}this.decimals=t,this.symbol=r||e.toString().substring(0,6),this.name=i||e.toString().substring(0,6),this.mint=a?Fe.PublicKey.default:Dt({publicKey:e}),this.isToken2022=l}equals(e){return this===e?!0:this.mint.equals(e.mint)}},de=st;de.WSOL=new st(ne(v({},le),{mint:le.address}));var at=class{constructor({decimals:e,symbol:t="UNKNOWN",name:r="UNKNOWN"}){this.decimals=e,this.symbol=t,this.name=r}equals(e){return this===e}},Oe=at;Oe.SOL=new at(_t);var Kt=U(require("toformat")),fn=Kt.default,Le=fn;var ke=U(require("big.js")),Et=U(require("bn.js")),Ft=U(require("decimal.js-light"));var Ve=G("module/fraction"),ut=Le(ke.default),Ce=Le(Ft.default),hn={[0]:Ce.ROUND_DOWN,[1]:Ce.ROUND_HALF_UP,[2]:Ce.ROUND_UP},bn={[0]:ke.default.roundDown,[1]:ke.default.roundHalfUp,[2]:ke.default.roundUp},F=class{constructor(e,t=new Et.default(1)){this.numerator=re(e),this.denominator=re(t)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new F(this.denominator,this.numerator)}add(e){let t=e instanceof F?e:new F(re(e));return this.denominator.eq(t.denominator)?new F(this.numerator.add(t.numerator),this.denominator):new F(this.numerator.mul(t.denominator).add(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}sub(e){let t=e instanceof F?e:new F(re(e));return this.denominator.eq(t.denominator)?new F(this.numerator.sub(t.numerator),this.denominator):new F(this.numerator.mul(t.denominator).sub(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}mul(e){let t=e instanceof F?e:new F(re(e));return new F(this.numerator.mul(t.numerator),this.denominator.mul(t.denominator))}div(e){let t=e instanceof F?e:new F(re(e));return new F(this.numerator.mul(t.denominator),this.denominator.mul(t.numerator))}toSignificant(e,t={groupSeparator:""},r=1){Number.isInteger(e)||Ve.logWithError(`${e} is not an integer.`),e<=0&&Ve.logWithError(`${e} is not positive.`),Ce.set({precision:e+1,rounding:hn[r]});let i=new Ce(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return i.toFormat(i.decimalPlaces(),t)}toFixed(e,t={groupSeparator:""},r=1){return Number.isInteger(e)||Ve.logWithError(`${e} is not an integer.`),e<0&&Ve.logWithError(`${e} is negative.`),ut.DP=e,ut.RM=bn[r]||1,new ut(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,t)}isZero(){return this.numerator.isZero()}};var Ot=U(require("bn.js"));var Nr=new F(new Ot.default(100));var vr=G("Raydium_price");function nt(n,e=1,t=[]){let r=[...n];if(e<=0)return t;for(;r.length;)t.push(r.splice(0,e));return t}var $=class{constructor(e){this._owner=e}get publicKey(){return $.isKeyPair(this._owner)?this._owner.publicKey:this._owner}get signer(){return $.isKeyPair(this._owner)?this._owner:void 0}get isKeyPair(){return $.isKeyPair(this._owner)}get isPublicKey(){return $.isPublicKey(this._owner)}static isKeyPair(e){return e.secretKey!==void 0}static isPublicKey(e){return!$.isKeyPair(e)}};var wn=require("@solana/web3.js"),Pn=require("@solana/spl-token");var Q=require("@solana/web3.js");var H={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",ClmmLockPosition:"ClmmLockPosition",ClmmHarvestLockPosition:"ClmmHarvestLockPosition",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV4Withdraw:"FarmV4Withdraw",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut",CpmmLockLp:"CpmmLockLp",CpmmCollectLockFee:"CpmmCollectLockFee",TransferTip:"TransferTip"};var Ut=require("@solana/spl-token"),qt=G("Raydium_txUtil"),Gt=1644;function Re(n){let e=[],t=[];return n.microLamports&&(e.push(Q.ComputeBudgetProgram.setComputeUnitPrice({microLamports:n.microLamports})),t.push(H.SetComputeUnitPrice)),n.units&&(e.push(Q.ComputeBudgetProgram.setComputeUnitLimit({units:n.units})),t.push(H.SetComputeUnitLimit)),{instructions:e,instructionTypes:t}}async function pe(n,e){var r,i;let t=e!=null?e:"confirmed";return(i=await((r=n.getLatestBlockhash)==null?void 0:r.call(n,{commitment:t})))==null?void 0:i.blockhash}async function Me(n,e){return n.getSignatureStatuses([e]),new Promise((t,r)=>{let i=setTimeout(r,6e4);n.onSignature(e,a=>{if(clearTimeout(i),!a.err){t("");return}r(Object.assign(a.err,{txId:e}))},"confirmed")})}function yn(n,e){n.length<1&&qt.logWithError(`no instructions provided: ${n.toString()}`),e.length<1&&qt.logWithError(`no signers provided:, ${e.toString()}`);let t=new Q.Transaction;t.recentBlockhash="11111111111111111111111111111111",t.feePayer=e[0],t.add(...n);try{return Buffer.from(t.serialize({verifySignatures:!1})).toString("base64").length<Gt}catch{return!1}}function _e({instructions:n,payer:e,signers:t}){return yn(n,[e,...t])}function oe({instructions:n,payer:e,lookupTableAddressAccount:t,recentBlockhash:r=Q.Keypair.generate().publicKey.toString()}){let a=new Q.TransactionMessage({payerKey:e,recentBlockhash:r,instructions:n}).compileToV0Message(Object.values(t!=null?t:{}));try{return Buffer.from(new Q.VersionedTransaction(a).serialize()).toString("base64").length<Gt}catch{return!1}}var xn=n=>Buffer.isBuffer(n)?n:n instanceof Uint8Array?Buffer.from(n.buffer,n.byteOffset,n.byteLength):Buffer.from(n),Tn=n=>{let e=n.serialize({requireAllSignatures:!1,verifySignatures:!1});n instanceof Q.VersionedTransaction&&(e=xn(e));try{return e instanceof Buffer?e.toString("base64"):Buffer.from(e).toString("base64")}catch{return e.toString("base64")}};function ie(n){let e=[];return n.forEach(t=>{t instanceof Q.Transaction&&(t.recentBlockhash||(t.recentBlockhash=Ut.TOKEN_PROGRAM_ID.toBase58()),t.feePayer||(t.feePayer=Q.Keypair.generate().publicKey)),e.push(Tn(t))}),console.log("simulate tx string:",e),e}var h=require("@solana/web3.js"),bo=new h.PublicKey("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),yo=new h.PublicKey("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),xo=new h.PublicKey("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),To=new h.PublicKey("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),wo=new h.PublicKey("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),Po=new h.PublicKey("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),So=new h.PublicKey("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),Ao=new h.PublicKey("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),Bo=new h.PublicKey("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),Lo=new h.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),ko=new h.PublicKey("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),Co=new h.PublicKey("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),Ro=new h.PublicKey("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),Mo=new h.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),_o=new h.PublicKey("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),Io=new h.PublicKey("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),Do=new h.PublicKey("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),No=new h.PublicKey("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),Ko=new h.PublicKey("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),Eo=new h.PublicKey("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),Fo=new h.PublicKey("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),Oo=new h.PublicKey("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),Vo=new h.PublicKey("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),vo=new h.PublicKey("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),Wo=new h.PublicKey("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),qo=new h.PublicKey("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),Uo=new h.PublicKey("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),Go=new h.PublicKey("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),Ho=new h.PublicKey("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),zo=new h.PublicKey("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),jo=new h.PublicKey("6s1xP3hpbAfFoNtUNF8mfHsjr2Bd97JxFJRWLbL6aHuX");var Qo={OPEN_BOOK_PROGRAM:new h.PublicKey("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),SERUM_PROGRAM_ID_V3:new h.PublicKey("Ray1111111111111111111111111111111111111111"),AMM_V4:new h.PublicKey("DRaya7Kj3aMWQSy19kSjvmuwq9docCHofyP9kanQGaav"),AMM_STABLE:new h.PublicKey("DRayDdXc1NZQ9C3hRWmoSf8zK4iapgMnjdNZWrfwsP8m"),CLMM_PROGRAM_ID:new h.PublicKey("DRayAUgENGQBKVaX8owNhgzkEDyoHTGVEGHVJT1E9pfH"),CLMM_LOCK_PROGRAM_ID:new h.PublicKey("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),CLMM_LOCK_AUTH_ID:new h.PublicKey("6Aoh8h2Lw2m5UGxYR8AdAL87jTWYeKoxM52mJRzfYwN"),CREATE_CPMM_POOL_PROGRAM:new h.PublicKey("DRaycpLY18LhpbydsBWbVJtxpNv9oXPgjRSfpF2bWpYb"),CREATE_CPMM_POOL_AUTH:new h.PublicKey("CXniRufdq5xL8t8jZAPxsPZDpuudwuJSPWnbcD5Y5Nxq"),CREATE_CPMM_POOL_FEE_ACC:new h.PublicKey("3oE58BKVt8KuYkGxx8zBojugnymWmBiyafWgMrnb6eYy"),LOCK_CPMM_PROGRAM:new h.PublicKey("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),LOCK_CPMM_AUTH:new h.PublicKey("7qWVV8UY2bRJfDLP4s37YzBPKUkVB46DStYJBpYbQzu3"),UTIL1216:h.PublicKey.default,Router:new h.PublicKey("DRaybByLpbUL57LJARs3j8BitTxVfzBg351EaMr5UTCd"),FARM_PROGRAM_ID_V3:new h.PublicKey("DRayWyrLmEW5KEeqs8kdTMMaBabapqagaBC7KWpGtJeZ"),FARM_PROGRAM_ID_V4:new h.PublicKey("Ray1111111111111111111111111111111111111111"),FARM_PROGRAM_ID_V5:new h.PublicKey("DRayiCGSZgku1GTK6rXD6mVDdingXy6APAH1R6R5L2LC"),FARM_PROGRAM_ID_V6:new h.PublicKey("DRayzbYakXs45ELHkzH6vC3fuhQqTAnv5A68gdFuvZyZ"),LAUNCHPAD_PROGRAM:new h.PublicKey("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),LAUNCHPAD_AUTH:new h.PublicKey("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),LAUNCHPAD_PLATFORM:new h.PublicKey("2Jx4KTDrVSdWNazuGpcA8n3ZLTRGGBDxAWhuKe2Xcj2a"),LAUNCHPAD_CONFIG:new h.PublicKey("7ZR4zD7PYfY2XxoG1Gxcy2EgEeGYrpxrwzPuwdUBssEt"),FEE_DESTINATION_ID:new h.PublicKey("9y8ENuuZ3b19quffx9hQvRVygG5ky6snHfRvGpuSfeJy"),MODEL_DATA_PUBKEY:new h.PublicKey("Ray1111111111111111111111111111111111111111")};var Sn=U(require("bn.js"));var Z=require("@solana/web3.js");async function We({connection:n,address:e,cluster:t="mainnet"}){let r=await Ct(n,[...new Set(e.map(a=>a.toString()))].map(a=>new Z.PublicKey(a))),i={};for(let a=0;a<e.length;a++){let l=r[a],o=e[a];if(!l)continue;let b=new Z.AddressLookupTableAccount({key:o,state:Z.AddressLookupTableAccount.deserialize(l.data)});i[o.toString()]=b,t==="devnet"?fe[o.toString()]=b:se[o.toString()]=b}return i}var se={},ct=async n=>{let e="AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU";if(se[e])return se;let t=new Z.PublicKey(e),r=await n.getAccountInfo(t);return r&&(se[e]=new Z.AddressLookupTableAccount({key:t,state:Z.AddressLookupTableAccount.deserialize(r.data)})),se},fe={},qe=async n=>{let e="EFhMuDw1PKEuckuFRW9PavNfTH4LKP5uKHgyXDmWpFCq";if(fe[e])return fe;let t=new Z.PublicKey(e),r=await n.getAccountInfo(t);return r&&(fe[e]=new Z.AddressLookupTableAccount({key:t,state:Z.AddressLookupTableAccount.deserialize(r.data)})),fe};var M=require("@solana/web3.js"),Ht=U(require("axios"));var Ie=2e3,De=class{constructor(e){this.instructions=[];this.endInstructions=[];this.lookupTableAddress=[];this.signers=[];this.instructionTypes=[];this.endInstructionTypes=[];this.connection=e.connection,this.feePayer=e.feePayer,this.signAllTransactions=e.signAllTransactions,this.owner=e.owner,this.cluster=e.cluster,this.blockhashCommitment=e.blockhashCommitment,this.loopMultiTxStatus=!!e.loopMultiTxStatus}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers,instructionTypes:this.instructionTypes,endInstructionTypes:this.endInstructionTypes,lookupTableAddress:this.lookupTableAddress}}get allInstructions(){return[...this.instructions,...this.endInstructions]}async getComputeBudgetConfig(){var r;let e=(await Ht.default.get(`https://solanacompass.com/api/fees?cacheFreshTime=${3e5}`)).data,{avg:t}=(r=e==null?void 0:e[15])!=null?r:{};if(!!t)return{units:6e5,microLamports:Math.min(Math.ceil(t*1e6/6e5),25e3)}}addCustomComputeBudget(e){if(e){let{instructions:t,instructionTypes:r}=Re(e);return this.instructions.unshift(...t),this.instructionTypes.unshift(...r),!0}return!1}addTipInstruction(e){var t;return e?(this.endInstructions.push(M.SystemProgram.transfer({fromPubkey:(t=e.feePayer)!=null?t:this.feePayer,toPubkey:new M.PublicKey(e.address),lamports:BigInt(e.amount.toString())})),this.endInstructionTypes.push(H.TransferTip),!0):!1}async calComputeBudget({config:e,defaultIns:t}){try{let r=e||await this.getComputeBudgetConfig();if(this.addCustomComputeBudget(r))return;t&&this.instructions.unshift(...t)}catch{t&&this.instructions.unshift(...t)}}addInstruction({instructions:e=[],endInstructions:t=[],signers:r=[],instructionTypes:i=[],endInstructionTypes:a=[],lookupTableAddress:l=[]}){return this.instructions.push(...e),this.endInstructions.push(...t),this.signers.push(...r),this.instructionTypes.push(...i),this.endInstructionTypes.push(...a),this.lookupTableAddress.push(...l.filter(o=>o!==M.PublicKey.default.toString())),this}async versionBuild({txVersion:e,extInfo:t}){return e===0?await this.buildV0(v({},t||{})):this.build(t)}build(e){var r;let t=new M.Transaction;return this.allInstructions.length&&t.add(...this.allInstructions),t.feePayer=this.feePayer,((r=this.owner)==null?void 0:r.signer)&&!this.signers.some(i=>i.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer),{builder:this,transaction:t,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async i=>{var y;let{recentBlockHash:a,skipPreflight:l=!0,sendAndConfirm:o,notSendToRpc:b}=i||{},P=a!=null?a:await pe(this.connection,this.blockhashCommitment);if(t.recentBlockhash=P,this.signers.length&&t.sign(...this.signers),ie([t]),(y=this.owner)!=null&&y.isKeyPair)return{txId:o?await(0,M.sendAndConfirmTransaction)(this.connection,t,this.signers.find(x=>x.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:l}):await this.connection.sendRawTransaction(t.serialize(),{skipPreflight:l}),signedTx:t};if(this.signAllTransactions){let m=await this.signAllTransactions([t]);if(this.signers.length)for(let x of m)try{x.sign(...this.signers)}catch{}return{txId:b?"":await this.connection.sendRawTransaction(m[0].serialize(),{skipPreflight:l}),signedTx:m[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:e||{}}}buildMultiTx(e){var P;let{extraPreBuildData:t=[],extInfo:r}=e,{transaction:i}=this.build(r),a=t.filter(y=>y.transaction.instructions.length>0),l=[i,...a.map(y=>y.transaction)],o=[this.signers,...a.map(y=>y.signers)],b=[...this.instructionTypes,...a.map(y=>y.instructionTypes).flat()];return(P=this.owner)!=null&&P.signer&&o.forEach(y=>{y.some(m=>m.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),{builder:this,transactions:l,signers:o,instructionTypes:b,execute:async y=>{var R;let{sequentially:m,onTxUpdate:x,skipTxCount:S=0,recentBlockHash:d,skipPreflight:g=!0}=y||{},s=d!=null?d:await pe(this.connection,this.blockhashCommitment);if((R=this.owner)!=null&&R.isKeyPair){if(m){let A=[],I=0;for(let p of l){if(++I,I<=S)continue;let u=await(0,M.sendAndConfirmTransaction)(this.connection,p,this.signers.find(c=>c.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:g});A.push(u)}return{txIds:A,signedTxs:l}}return{txIds:await await Promise.all(l.map(async A=>(A.recentBlockhash=s,await this.connection.sendRawTransaction(A.serialize(),{skipPreflight:g})))),signedTxs:l}}if(this.signAllTransactions){let A=l.map((p,u)=>(p.recentBlockhash=s,o[u].length&&p.sign(...o[u]),p));ie(A);let I=await this.signAllTransactions(A);if(m){let p=0,u=[],c=async()=>{if(!I[p])return;let T=await this.connection.sendRawTransaction(I[p].serialize(),{skipPreflight:g});u.push({txId:T,status:"sent",signedTx:I[p]}),x==null||x([...u]),p++;let f=!1,k=null,N=null,D=B=>{k!==null&&clearInterval(k),N!==null&&this.connection.removeSignatureListener(N);let L=u.findIndex(C=>C.txId===T);if(L>-1){if(u[L].status==="error"||u[L].status==="success")return;u[L].status=B.err?"error":"success"}x==null||x([...u]),B.err||c()};this.loopMultiTxStatus&&(k=setInterval(async()=>{var B;if(f){clearInterval(k);return}try{let L=await this.connection.getTransaction(T,{commitment:"confirmed",maxSupportedTransactionVersion:0});L&&(f=!0,clearInterval(k),D({err:((B=L.meta)==null?void 0:B.err)||null}),console.log("tx status from getTransaction:",T))}catch(L){f=!0,clearInterval(k),console.error("getTransaction timeout:",L,T)}},Ie)),N=this.connection.onSignature(T,B=>{if(f){this.connection.removeSignatureListener(N);return}f=!0,D(B)},"confirmed"),this.connection.getSignatureStatus(T)};return await c(),{txIds:u.map(T=>T.txId),signedTxs:I}}else{let p=[];for(let u=0;u<I.length;u+=1){let c=await this.connection.sendRawTransaction(I[u].serialize(),{skipPreflight:g});p.push(c)}return{txIds:p,signedTxs:I}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async versionMultiBuild({extraPreBuildData:e,txVersion:t,extInfo:r}){return t===0?await this.buildV0MultiTx({extraPreBuildData:e,buildProps:r||{}}):this.buildMultiTx({extraPreBuildData:e,extInfo:r})}async buildV0(e){var g;let d=e||{},{lookupTableCache:t={},lookupTableAddress:r=[],forerunCreate:i,recentBlockhash:a}=d,l=Se(d,["lookupTableCache","lookupTableAddress","forerunCreate","recentBlockhash"]),o=v(v({},this.cluster==="devnet"?await qe(this.connection):await ct(this.connection)),t),b=Array.from(new Set([...r,...this.lookupTableAddress])),P=[];for(let s of b)o[s]===void 0&&P.push(new M.PublicKey(s));let y=await We({connection:this.connection,address:P});for(let[s,R]of Object.entries(y))o[s]=R;let m=i?M.PublicKey.default.toBase58():a!=null?a:await pe(this.connection,this.blockhashCommitment),x=new M.TransactionMessage({payerKey:this.feePayer,recentBlockhash:m,instructions:[...this.allInstructions]}).compileToV0Message(Object.values(o));((g=this.owner)==null?void 0:g.signer)&&!this.signers.some(s=>s.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer);let S=new M.VersionedTransaction(x);return S.sign(this.signers),{builder:this,transaction:S,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async s=>{var p;let{skipPreflight:R=!0,sendAndConfirm:A,notSendToRpc:I}=s||{};if(ie([S]),(p=this.owner)!=null&&p.isKeyPair){let u=await this.connection.sendTransaction(S,{skipPreflight:R});return A&&await Me(this.connection,u),{txId:u,signedTx:S}}if(this.signAllTransactions){let u=await this.signAllTransactions([S]);if(this.signers.length)for(let c of u)try{c.sign(this.signers)}catch{}return{txId:I?"":await this.connection.sendTransaction(u[0],{skipPreflight:R}),signedTx:u[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:l||{}}}async buildV0MultiTx(e){var P;let{extraPreBuildData:t=[],buildProps:r}=e,{transaction:i}=await this.buildV0(r),a=t.filter(y=>y.builder.instructions.length>0),l=[i,...a.map(y=>y.transaction)],o=[this.signers,...a.map(y=>y.signers)],b=[...this.instructionTypes,...a.map(y=>y.instructionTypes).flat()];return(P=this.owner)!=null&&P.signer&&o.forEach(y=>{y.some(m=>m.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),l.forEach(async(y,m)=>{y.sign(o[m])}),{builder:this,transactions:l,signers:o,instructionTypes:b,buildProps:r,execute:async y=>{var g;let{sequentially:m,onTxUpdate:x,recentBlockHash:S,skipPreflight:d=!0}=y||{};if(S&&l.forEach(s=>s.message.recentBlockhash=S),ie(l),(g=this.owner)!=null&&g.isKeyPair){if(m){let s=[];for(let R of l){let A=await this.connection.sendTransaction(R,{skipPreflight:d});await Me(this.connection,A),s.push(A)}return{txIds:s,signedTxs:l}}return{txIds:await Promise.all(l.map(async s=>await this.connection.sendTransaction(s,{skipPreflight:d}))),signedTxs:l}}if(this.signAllTransactions){let s=await this.signAllTransactions(l);if(m){let R=0,A=[],I=async()=>{if(!s[R])return;let p=await this.connection.sendTransaction(s[R],{skipPreflight:d});A.push({txId:p,status:"sent",signedTx:s[R]}),x==null||x([...A]),R++;let u=!1,c=null,T=null,f=k=>{c!==null&&clearInterval(c),T!==null&&this.connection.removeSignatureListener(T);let N=A.findIndex(D=>D.txId===p);if(N>-1){if(A[N].status==="error"||A[N].status==="success")return;A[N].status=k.err?"error":"success"}x==null||x([...A]),k.err||I()};this.loopMultiTxStatus&&(c=setInterval(async()=>{var k;if(u){clearInterval(c);return}try{let N=await this.connection.getTransaction(p,{commitment:"confirmed",maxSupportedTransactionVersion:0});N&&(u=!0,clearInterval(c),f({err:((k=N.meta)==null?void 0:k.err)||null}),console.log("tx status from getTransaction:",p))}catch(N){u=!0,clearInterval(c),console.error("getTransaction timeout:",N,p)}},Ie)),T=this.connection.onSignature(p,k=>{if(u){this.connection.removeSignatureListener(T);return}u=!0,f(k)},"confirmed"),this.connection.getSignatureStatus(p)};return I(),{txIds:[],signedTxs:s}}else{let R=[];for(let A=0;A<s.length;A+=1){let I=await this.connection.sendTransaction(s[A],{skipPreflight:d});R.push(I)}return{txIds:R,signedTxs:s}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async sizeCheckBuild(e){var x;let m=e||{},{splitIns:t=[],computeBudgetConfig:r}=m,i=Se(m,["splitIns","computeBudgetConfig"]),a=r?Re(r):{instructions:[],instructionTypes:[]},l=this.signers.reduce((S,d)=>ne(v({},S),{[d.publicKey.toBase58()]:d}),{}),o=[],b=[],P=[],y=0;if(this.allInstructions.forEach(S=>{let d=[...P,S],g=r?[...a.instructions,...d]:d,R=[...new Set(d.map(A=>A.keys.filter(I=>I.isSigner).map(I=>I.pubkey.toString())).flat()).values()].map(A=>new M.PublicKey(A));if(S!==t[y]&&P.length<12&&(_e({instructions:g,payer:this.feePayer,signers:R})||_e({instructions:d,payer:this.feePayer,signers:R})))P.push(S);else{if(P.length===0)throw Error("item ins too big");y+=S===t[y]?1:0,_e({instructions:r?[...a.instructions,...P]:[...P],payer:this.feePayer,signers:R})?o.push(new M.Transaction().add(...a.instructions,...P)):o.push(new M.Transaction().add(...P)),b.push(Array.from(new Set(P.map(A=>A.keys.filter(I=>I.isSigner).map(I=>I.pubkey.toString())).flat())).map(A=>l[A]).filter(A=>A!==void 0)),P=[S]}}),P.length>0){let d=[...new Set(P.map(g=>g.keys.filter(s=>s.isSigner).map(s=>s.pubkey.toString())).flat()).values()].map(g=>l[g]).filter(g=>g!==void 0);_e({instructions:r?[...a.instructions,...P]:[...P],payer:this.feePayer,signers:d.map(g=>g.publicKey)})?o.push(new M.Transaction().add(...a.instructions,...P)):o.push(new M.Transaction().add(...P)),b.push(d)}return o.forEach(S=>S.feePayer=this.feePayer),(x=this.owner)!=null&&x.signer&&b.forEach(S=>{S.some(d=>d.publicKey.equals(this.owner.publicKey))||S.push(this.owner.signer)}),{builder:this,transactions:o,signers:b,instructionTypes:this.instructionTypes,execute:async S=>{var p;let{sequentially:d,onTxUpdate:g,skipTxCount:s=0,recentBlockHash:R,skipPreflight:A=!0}=S||{},I=R!=null?R:await pe(this.connection,this.blockhashCommitment);if(o.forEach(async(u,c)=>{u.recentBlockhash=I,b[c].length&&u.sign(...b[c])}),ie(o),(p=this.owner)!=null&&p.isKeyPair){if(d){let u=0,c=[];for(let T of o){if(++u,u<=s){c.push("tx skipped");continue}let f=await(0,M.sendAndConfirmTransaction)(this.connection,T,this.signers.find(k=>k.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:A});c.push(f)}return{txIds:c,signedTxs:o}}return{txIds:await Promise.all(o.map(async u=>await this.connection.sendRawTransaction(u.serialize(),{skipPreflight:A}))),signedTxs:o}}if(this.signAllTransactions){let u=await this.signAllTransactions(o.slice(s,o.length)),c=[...o.slice(0,s),...u];if(d){let T=0,f=[],k=async()=>{if(!c[T])return;T<s&&(f.push({txId:"",status:"success",signedTx:c[T]}),g==null||g([...f]),T++,k());let N=await this.connection.sendRawTransaction(c[T].serialize(),{skipPreflight:A});f.push({txId:N,status:"sent",signedTx:c[T]}),g==null||g([...f]),T++;let D=!1,B=null,L=null,C=O=>{B!==null&&clearInterval(B),L!==null&&this.connection.removeSignatureListener(L);let K=f.findIndex(V=>V.txId===N);if(K>-1){if(f[K].status==="error"||f[K].status==="success")return;f[K].status=O.err?"error":"success"}g==null||g([...f]),O.err||k()};this.loopMultiTxStatus&&(B=setInterval(async()=>{var O;if(D){clearInterval(B);return}try{let K=await this.connection.getTransaction(N,{commitment:"confirmed",maxSupportedTransactionVersion:0});K&&(D=!0,clearInterval(B),C({err:((O=K.meta)==null?void 0:O.err)||null}),console.log("tx status from getTransaction:",N))}catch(K){D=!0,clearInterval(B),console.error("getTransaction timeout:",K,N)}},Ie)),L=this.connection.onSignature(N,O=>{if(D){this.connection.removeSignatureListener(L);return}D=!0,C(O)},"confirmed"),this.connection.getSignatureStatus(N)};return await k(),{txIds:f.map(N=>N.txId),signedTxs:c}}else{let T=[];for(let f=0;f<c.length;f+=1){let k=await this.connection.sendRawTransaction(c[f].serialize(),{skipPreflight:A});T.push(k)}return{txIds:T,signedTxs:c}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:i||{}}}async sizeCheckBuildV0(e){var I;let A=e||{},{computeBudgetConfig:t,splitIns:r=[],lookupTableCache:i={},lookupTableAddress:a=[]}=A,l=Se(A,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),o=v(v({},this.cluster==="devnet"?await qe(this.connection):se),i),b=Array.from(new Set([...this.lookupTableAddress,...a])),P=[];for(let p of b)o[p]===void 0&&P.push(new M.PublicKey(p));let y=await We({connection:this.connection,address:P});for(let[p,u]of Object.entries(y))o[p]=u;let m=t?Re(t):{instructions:[],instructionTypes:[]},x=await pe(this.connection,this.blockhashCommitment),S=this.signers.reduce((p,u)=>ne(v({},p),{[u.publicKey.toBase58()]:u}),{}),d=[],g=[],s=[],R=0;if(this.allInstructions.forEach(p=>{let u=[...s,p],c=t?[...m.instructions,...u]:u;if(p!==r[R]&&s.length<12&&(oe({instructions:c,payer:this.feePayer,lookupTableAddressAccount:o})||oe({instructions:u,payer:this.feePayer,lookupTableAddressAccount:o})))s.push(p);else{if(s.length===0)throw Error("item ins too big");R+=p===r[R]?1:0;let T={};for(let f of[...new Set(b)])o[f]!==void 0&&(T[f]=o[f]);if(t&&oe({instructions:[...m.instructions,...s],payer:this.feePayer,lookupTableAddressAccount:o,recentBlockhash:x})){let f=new M.TransactionMessage({payerKey:this.feePayer,recentBlockhash:x,instructions:[...m.instructions,...s]}).compileToV0Message(Object.values(o));d.push(new M.VersionedTransaction(f))}else{let f=new M.TransactionMessage({payerKey:this.feePayer,recentBlockhash:x,instructions:[...s]}).compileToV0Message(Object.values(o));d.push(new M.VersionedTransaction(f))}g.push(Array.from(new Set(s.map(f=>f.keys.filter(k=>k.isSigner).map(k=>k.pubkey.toString())).flat())).map(f=>S[f]).filter(f=>f!==void 0)),s=[p]}}),s.length>0){let u=[...new Set(s.map(c=>c.keys.filter(T=>T.isSigner).map(T=>T.pubkey.toString())).flat()).values()].map(c=>S[c]).filter(c=>c!==void 0);if(t&&oe({instructions:[...m.instructions,...s],payer:this.feePayer,lookupTableAddressAccount:o,recentBlockhash:x})){let c=new M.TransactionMessage({payerKey:this.feePayer,recentBlockhash:x,instructions:[...m.instructions,...s]}).compileToV0Message(Object.values(o));d.push(new M.VersionedTransaction(c))}else{let c=new M.TransactionMessage({payerKey:this.feePayer,recentBlockhash:x,instructions:[...s]}).compileToV0Message(Object.values(o));d.push(new M.VersionedTransaction(c))}g.push(u)}return(I=this.owner)!=null&&I.signer&&g.forEach(p=>{p.some(u=>u.publicKey.equals(this.owner.publicKey))||p.push(this.owner.signer)}),d.forEach((p,u)=>{p.sign(g[u])}),{builder:this,transactions:d,buildProps:e,signers:g,blockHash:x,instructionTypes:this.instructionTypes,execute:async p=>{var N;let{sequentially:u,onTxUpdate:c,skipTxCount:T=0,recentBlockHash:f,skipPreflight:k=!0}=p||{};if(d.map(async(D,B)=>{g[B].length&&D.sign(g[B]),f&&(D.message.recentBlockhash=f)}),ie(d),(N=this.owner)!=null&&N.isKeyPair){if(u){let D=0,B=[];for(let L of d){if(++D,D<=T){console.log("skip tx: ",D),B.push("tx skipped");continue}let C=await this.connection.sendTransaction(L,{skipPreflight:k});await Me(this.connection,C),B.push(C)}return{txIds:B,signedTxs:d}}return{txIds:await Promise.all(d.map(async D=>await this.connection.sendTransaction(D,{skipPreflight:k}))),signedTxs:d}}if(this.signAllTransactions){let D=await this.signAllTransactions(d.slice(T,d.length)),B=[...d.slice(0,T),...D];if(u){let L=0,C=[],O=async()=>{if(!B[L])return;if(L<T){C.push({txId:"",status:"success",signedTx:B[L]}),c==null||c([...C]),L++,O();return}let K=await this.connection.sendTransaction(B[L],{skipPreflight:k});C.push({txId:K,status:"sent",signedTx:B[L]}),c==null||c([...C]),L++;let V=!1,z=null,te=null,we=j=>{z!==null&&clearInterval(z),te!==null&&this.connection.removeSignatureListener(te);let q=C.findIndex(Xe=>Xe.txId===K);if(q>-1){if(C[q].status==="error"||C[q].status==="success")return;C[q].status=j.err?"error":"success"}c==null||c([...C]),j.err||O()};this.loopMultiTxStatus&&(z=setInterval(async()=>{var j;if(V){clearInterval(z);return}try{let q=await this.connection.getTransaction(K,{commitment:"confirmed",maxSupportedTransactionVersion:0});q&&(V=!0,clearInterval(z),we({err:((j=q.meta)==null?void 0:j.err)||null}),console.log("tx status from getTransaction:",K))}catch(q){V=!0,clearInterval(z),console.error("getTransaction timeout:",q,K)}},Ie)),te=this.connection.onSignature(K,j=>{if(V){this.connection.removeSignatureListener(te);return}V=!0,we(j)},"confirmed"),this.connection.getSignatureStatus(K)};return O(),{txIds:[],signedTxs:B}}else{let L=[];for(let C=0;C<B.length;C+=1){let O=await this.connection.sendTransaction(B[C],{skipPreflight:k});L.push(O)}return{txIds:L,signedTxs:B}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:l||{}}}async buildSniperTransaction(e){var I;let A=e||{},{computeBudgetConfig:t,splitIns:r=[],lookupTableCache:i={},lookupTableAddress:a=[]}=A,l=Se(A,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),o=v(v({},this.cluster==="devnet"?await qe(this.connection):await ct(this.connection)),i),b=Array.from(new Set([...this.lookupTableAddress,...a])),P=[];for(let p of b)o[p]===void 0&&P.push(new M.PublicKey(p));let y=await We({connection:this.connection,address:P});for(let[p,u]of Object.entries(y))o[p]=u;let m=t?Re(t):{instructions:[],instructionTypes:[]},x=await pe(this.connection,this.blockhashCommitment),S=this.signers.reduce((p,u)=>ne(v({},p),{[u.publicKey.toBase58()]:u}),{}),d=[],g=[],s=[],R=0;if(this.allInstructions.forEach(p=>{let u=[...s,p],c=t?[...m.instructions,...u]:u;if(p!==r[R]&&s.length<12&&(oe({instructions:c,payer:this.feePayer,lookupTableAddressAccount:o})||oe({instructions:u,payer:this.feePayer,lookupTableAddressAccount:o})))s.push(p);else{if(s.length===0)throw Error("item ins too big");R+=p===r[R]?1:0;let T={};for(let f of[...new Set(b)])o[f]!==void 0&&(T[f]=o[f]);if(t&&oe({instructions:[...m.instructions,...s],payer:this.feePayer,lookupTableAddressAccount:o,recentBlockhash:x})){let f=new M.TransactionMessage({payerKey:this.feePayer,recentBlockhash:x,instructions:[...m.instructions,...s]}).compileToV0Message(Object.values(o));d.push(new M.VersionedTransaction(f))}else{let f=new M.TransactionMessage({payerKey:this.feePayer,recentBlockhash:x,instructions:[...s]}).compileToV0Message(Object.values(o));d.push(new M.VersionedTransaction(f))}g.push(Array.from(new Set(s.map(f=>f.keys.filter(k=>k.isSigner).map(k=>k.pubkey.toString())).flat())).map(f=>S[f]).filter(f=>f!==void 0)),s=[p]}}),s.length>0){let u=[...new Set(s.map(c=>c.keys.filter(T=>T.isSigner).map(T=>T.pubkey.toString())).flat()).values()].map(c=>S[c]).filter(c=>c!==void 0);if(t&&oe({instructions:[...m.instructions,...s],payer:this.feePayer,lookupTableAddressAccount:o,recentBlockhash:x})){let c=new M.TransactionMessage({payerKey:this.feePayer,recentBlockhash:x,instructions:[...m.instructions,...s]}).compileToV0Message(Object.values(o));d.push(new M.VersionedTransaction(c))}else{let c=new M.TransactionMessage({payerKey:this.feePayer,recentBlockhash:x,instructions:[...s]}).compileToV0Message(Object.values(o));d.push(new M.VersionedTransaction(c))}g.push(u)}return(I=this.owner)!=null&&I.signer&&g.forEach(p=>{p.some(u=>u.publicKey.equals(this.owner.publicKey))||p.push(this.owner.signer)}),d.forEach((p,u)=>{p.sign(g[u])}),{builder:this,transactions:d,buildProps:e,signers:g,instructionTypes:this.instructionTypes,execute:async p=>{var N;let{sequentially:u,onTxUpdate:c,skipTxCount:T=0,recentBlockHash:f,skipPreflight:k=!0}=p||{};if(d.map(async(D,B)=>{g[B].length&&D.sign(g[B]),f&&(D.message.recentBlockhash=f)}),ie(d),(N=this.owner)!=null&&N.isKeyPair){if(u){let D=0,B=[];for(let L of d){if(++D,D<=T){console.log("skip tx: ",D),B.push("tx skipped");continue}let C=await this.connection.sendTransaction(L,{skipPreflight:k});await Me(this.connection,C),B.push(C)}return{txIds:B,signedTxs:d}}return{txIds:await Promise.all(d.map(async D=>await this.connection.sendTransaction(D,{skipPreflight:k}))),signedTxs:d}}if(this.signAllTransactions){let D=await this.signAllTransactions(d.slice(T,d.length)),B=[...d.slice(0,T),...D];if(u){let L=0,C=[],O=async()=>{if(!B[L])return;if(L<T){C.push({txId:"",status:"success",signedTx:B[L]}),c==null||c([...C]),L++,O();return}let K=await this.connection.sendTransaction(B[L],{skipPreflight:k});C.push({txId:K,status:"sent",signedTx:B[L]}),c==null||c([...C]),L++;let V=!1,z=null,te=null,we=j=>{z!==null&&clearInterval(z),te!==null&&this.connection.removeSignatureListener(te);let q=C.findIndex(Xe=>Xe.txId===K);if(q>-1){if(C[q].status==="error"||C[q].status==="success")return;C[q].status=j.err?"error":"success"}c==null||c([...C]),j.err||O()};this.loopMultiTxStatus&&(z=setInterval(async()=>{var j;if(V){clearInterval(z);return}try{let q=await this.connection.getTransaction(K,{commitment:"confirmed",maxSupportedTransactionVersion:0});q&&(V=!0,clearInterval(z),we({err:((j=q.meta)==null?void 0:j.err)||null}),console.log("tx status from getTransaction:",K))}catch(q){V=!0,clearInterval(z),console.error("getTransaction timeout:",q,K)}},Ie)),te=this.connection.onSignature(K,j=>{if(V){this.connection.removeSignatureListener(te);return}V=!0,we(j)},"confirmed"),this.connection.getSignatureStatus(K)};return O(),{txIds:[],signedTxs:B}}else{let L=[];for(let C=0;C<B.length;C+=1){let O=await this.connection.sendTransaction(B[C],{skipPreflight:k});L.push(O)}return{txIds:L,signedTxs:B}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:l||{}}}};var Bn=require("@solana/web3.js"),Ln=U(require("bn.js"));var zt=U(require("bn.js")),fi=new zt.default(1e6);var Ui=G("Raydium_amount"),Gi=Le(jt.default);var ve=new ee.default(0),ns=new ee.default(1),rs=new ee.default(2),os=new ee.default(3),is=new ee.default(5),Cn=new ee.default(10),ss=new ee.default(100),as=new ee.default(1e3),us=new ee.default(1e4);var Je=require("@solana/web3.js"),Kn=U(require("bn.js"));var nn=require("@solana/spl-token");function Mn(n){return n instanceof Uint8Array||n!=null&&typeof n=="object"&&n.constructor.name==="Uint8Array"}function lt(n,...e){if(!Mn(n))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(n.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${n.length}`)}function pt(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")}function Qt(n,e){lt(n);let t=e.outputLen;if(n.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}var Ge=n=>new DataView(n.buffer,n.byteOffset,n.byteLength),X=(n,e)=>n<<32-e|n>>>e;var ms=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function _n(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function mt(n){return typeof n=="string"&&(n=_n(n)),lt(n),n}var Ue=class{clone(){return this._cloneInto()}},ds={}.toString;function Yt(n){let e=r=>n().update(mt(r)).digest(),t=n();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>n(),e}function In(n,e,t,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,t,r);let i=BigInt(32),a=BigInt(4294967295),l=Number(t>>i&a),o=Number(t&a),b=r?4:0,P=r?0:4;n.setUint32(e+b,l,r),n.setUint32(e+P,o,r)}var Jt=(n,e,t)=>n&e^~n&t,Zt=(n,e,t)=>n&e^n&t^e&t,He=class extends Ue{constructor(e,t,r,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Ge(this.buffer)}update(e){pt(this);let{view:t,buffer:r,blockLen:i}=this;e=mt(e);let a=e.length;for(let l=0;l<a;){let o=Math.min(i-this.pos,a-l);if(o===i){let b=Ge(e);for(;i<=a-l;l+=i)this.process(b,l);continue}r.set(e.subarray(l,l+o),this.pos),this.pos+=o,l+=o,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){pt(this),Qt(e,this),this.finished=!0;let{buffer:t,view:r,blockLen:i,isLE:a}=this,{pos:l}=this;t[l++]=128,this.buffer.subarray(l).fill(0),this.padOffset>i-l&&(this.process(r,0),l=0);for(let m=l;m<i;m++)t[m]=0;In(r,i-8,BigInt(this.length*8),a),this.process(r,0);let o=Ge(e),b=this.outputLen;if(b%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let P=b/4,y=this.get();if(P>y.length)throw new Error("_sha2: outputLen bigger than state");for(let m=0;m<P;m++)o.setUint32(4*m,y[m],a)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:r,length:i,finished:a,destroyed:l,pos:o}=this;return e.length=i,e.pos=o,e.finished=a,e.destroyed=l,i%t&&e.buffer.set(r),e}};var Dn=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ae=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ue=new Uint32Array(64),dt=class extends He{constructor(){super(64,32,8,!1),this.A=ae[0]|0,this.B=ae[1]|0,this.C=ae[2]|0,this.D=ae[3]|0,this.E=ae[4]|0,this.F=ae[5]|0,this.G=ae[6]|0,this.H=ae[7]|0}get(){let{A:e,B:t,C:r,D:i,E:a,F:l,G:o,H:b}=this;return[e,t,r,i,a,l,o,b]}set(e,t,r,i,a,l,o,b){this.A=e|0,this.B=t|0,this.C=r|0,this.D=i|0,this.E=a|0,this.F=l|0,this.G=o|0,this.H=b|0}process(e,t){for(let m=0;m<16;m++,t+=4)ue[m]=e.getUint32(t,!1);for(let m=16;m<64;m++){let x=ue[m-15],S=ue[m-2],d=X(x,7)^X(x,18)^x>>>3,g=X(S,17)^X(S,19)^S>>>10;ue[m]=g+ue[m-7]+d+ue[m-16]|0}let{A:r,B:i,C:a,D:l,E:o,F:b,G:P,H:y}=this;for(let m=0;m<64;m++){let x=X(o,6)^X(o,11)^X(o,25),S=y+x+Jt(o,b,P)+Dn[m]+ue[m]|0,g=(X(r,2)^X(r,13)^X(r,22))+Zt(r,i,a)|0;y=P,P=b,b=o,o=l+S|0,l=a,a=i,i=r,r=S+g|0}r=r+this.A|0,i=i+this.B|0,a=a+this.C|0,l=l+this.D|0,o=o+this.E|0,b=b+this.F|0,P=P+this.G|0,y=y+this.H|0,this.set(r,i,a,l,o,b,P,y)}roundClean(){ue.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var Xt=Yt(()=>new dt);var tn=require("@solana/web3.js"),je=U(require("bn.js"));var w=require("@solana/buffer-layout"),ze=w.Layout,$t=w.Structure;var ft=w.UInt;var en=w.u16;var gt=w.u32;var ge=w.blob;var ht=w.bits;var bt=class extends ze{constructor(t,r,i){super(t,i);this.blob=ge(t),this.signed=r}decode(t,r=0){let i=new je.default(this.blob.decode(t,r),10,"le");return this.signed?i.fromTwos(this.span*8).clone():i}encode(t,r,i=0){return typeof t=="number"&&(t=new je.default(t)),this.signed&&(t=t.toTwos(this.span*8)),this.blob.encode(t.toArrayLike(Buffer,"le",this.span),r,i)}},Qe=class extends ze{constructor(t){super(8,t);this._lower=ht(gt(),!1),this._upper=ht(gt(),!1)}addBoolean(t){this._lower.fields.length<32?this._lower.addBoolean(t):this._upper.addBoolean(t)}decode(t,r=0){let i=this._lower.decode(t,r),a=this._upper.decode(t,r+this._lower.span);return v(v({},i),a)}encode(t,r,i=0){return this._lower.encode(t,r,i)+this._upper.encode(t,r,i+this._lower.span)}};function Ye(n){return new ft(1,n)}function he(n){return new ft(4,n)}function W(n){return new bt(8,!1,n)}var yt=class extends ze{constructor(t,r,i,a){super(t.span,a);this.layout=t,this.decoder=r,this.encoder=i}decode(t,r){return this.decoder(this.layout.decode(t,r))}encode(t,r,i){return this.layout.encode(this.encoder(t),r,i)}getSpan(t,r){return this.layout.getSpan(t,r)}};function Y(n){return new yt(ge(32),e=>new tn.PublicKey(e),e=>e.toBuffer(),n)}var xt=class extends $t{decode(e,t){return super.decode(e,t)}};function be(n,e,t){return new xt(n,e,t)}var Nn=be([Y("mint"),Y("owner"),W("amount"),he("delegateOption"),Y("delegate"),Ye("state"),he("isNativeOption"),W("isNative"),W("delegatedAmount"),he("closeAuthorityOption"),Y("closeAuthority")]);var vs=G("Raydium_Util");function ce({fromPublicKey:n,programId:e=nn.TOKEN_PROGRAM_ID,assignSeed:t}){let r=t?btoa(t).slice(0,32):Je.Keypair.generate().publicKey.toBase58().slice(0,32);return{publicKey:En(n,r,e),seed:r}}function En(n,e,t){let r=Buffer.concat([n.toBuffer(),Buffer.from(e),t.toBuffer()]),i=Xt(r);return new Je.PublicKey(i)}var Tt=(...n)=>n.map(e=>{try{return typeof e=="object"?JSON.stringify(e):e}catch{return e}}).join(", "),Ne=class{constructor({scope:e,moduleName:t}){this.disabled=!1;this.scope=e,this.logger=G(t)}createTxBuilder(e){return this.scope.checkOwner(),new De({connection:this.scope.connection,feePayer:e||this.scope.ownerPubKey,cluster:this.scope.cluster,owner:this.scope.owner,blockhashCommitment:this.scope.blockhashCommitment,loopMultiTxStatus:this.scope.loopMultiTxStatus,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}createSniperTxBuilder(e,t){let r=new $(e);return new De({connection:this.scope.connection,feePayer:t,cluster:this.scope.cluster,owner:r,blockhashCommitment:this.scope.blockhashCommitment,loopMultiTxStatus:this.scope.loopMultiTxStatus,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}logDebug(...e){this.logger.debug(Tt(e))}logInfo(...e){this.logger.info(Tt(e))}logAndCreateError(...e){let t=Tt(e);throw new Error(t)}checkDisabled(){(this.disabled||!this.scope)&&this.logAndCreateError("module not working")}};var J=require("@solana/web3.js"),ye=require("@solana/spl-token");function Fn(n="accountFlags"){let e=new Qe(n);return e.addBoolean("initialized"),e.addBoolean("market"),e.addBoolean("openOrders"),e.addBoolean("requestQueue"),e.addBoolean("eventQueue"),e.addBoolean("bids"),e.addBoolean("asks"),e}var wt=be([ge(5),Fn("accountFlags"),Y("ownAddress"),W("vaultSignerNonce"),Y("baseMint"),Y("quoteMint"),Y("baseVault"),W("baseDepositsTotal"),W("baseFeesAccrued"),Y("quoteVault"),W("quoteDepositsTotal"),W("quoteFeesAccrued"),W("quoteDustThreshold"),Y("requestQueue"),Y("eventQueue"),Y("bids"),Y("asks"),W("baseLotSize"),W("quoteLotSize"),W("feeRateBps"),W("referrerRebatesAccrued"),ge(7)]);function On({programId:n,marketInfo:e}){let t=be([Ye("version"),he("instruction"),W("baseLotSize"),W("quoteLotSize"),en("feeRateBps"),W("vaultSignerNonce"),W("quoteDustThreshold")]),r=[{pubkey:e.id,isSigner:!1,isWritable:!0},{pubkey:e.requestQueue,isSigner:!1,isWritable:!0},{pubkey:e.eventQueue,isSigner:!1,isWritable:!0},{pubkey:e.bids,isSigner:!1,isWritable:!0},{pubkey:e.asks,isSigner:!1,isWritable:!0},{pubkey:e.baseVault,isSigner:!1,isWritable:!0},{pubkey:e.quoteVault,isSigner:!1,isWritable:!0},{pubkey:e.baseMint,isSigner:!1,isWritable:!1},{pubkey:e.quoteMint,isSigner:!1,isWritable:!1},{pubkey:e.authority?e.quoteMint:J.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}].concat(e.authority?{pubkey:e.authority,isSigner:!1,isWritable:!1}:[]).concat(e.authority&&e.pruneAuthority?{pubkey:e.pruneAuthority,isSigner:!1,isWritable:!1}:[]),i=Buffer.alloc(t.span);return t.encode({version:0,instruction:0,baseLotSize:e.baseLotSize,quoteLotSize:e.quoteLotSize,feeRateBps:e.feeRateBps,vaultSignerNonce:e.vaultSignerNonce,quoteDustThreshold:e.quoteDustThreshold},i),new J.TransactionInstruction({keys:r,programId:n,data:i})}async function rn({connection:n,wallet:e,marketInfo:t}){var l,o,b,P,y,m,x,S;let r=new J.Transaction,i=await n.getMinimumBalanceForRentExemption(165);r.add(J.SystemProgram.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.baseVault.seed,newAccountPubkey:t.baseVault.publicKey,lamports:i,space:165,programId:ye.TOKEN_PROGRAM_ID}),J.SystemProgram.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.quoteVault.seed,newAccountPubkey:t.quoteVault.publicKey,lamports:i,space:165,programId:ye.TOKEN_PROGRAM_ID}),(0,ye.createInitializeAccountInstruction)(t.baseVault.publicKey,t.baseMint,t.vaultOwner),(0,ye.createInitializeAccountInstruction)(t.quoteVault.publicKey,t.quoteMint,t.vaultOwner),J.SystemProgram.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.id.seed,newAccountPubkey:t.id.publicKey,lamports:await n.getMinimumBalanceForRentExemption(wt.span),space:wt.span,programId:t.programId}));let a=new J.Transaction;return a.add(J.SystemProgram.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.requestQueue.seed,newAccountPubkey:t.requestQueue.publicKey,lamports:t.lowestFeeMarket?6208320:await n.getMinimumBalanceForRentExemption((l=t.requestQueueSpace)!=null?l:5120+12),space:t.lowestFeeMarket?764:(o=t.requestQueueSpace)!=null?o:5120+12,programId:t.programId}),J.SystemProgram.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.eventQueue.seed,newAccountPubkey:t.eventQueue.publicKey,lamports:t.lowestFeeMarket?79594560:await n.getMinimumBalanceForRentExemption((b=t.eventQueueSpace)!=null?b:262144+12),space:t.lowestFeeMarket?11308:(P=t.eventQueueSpace)!=null?P:262144+12,programId:t.programId}),J.SystemProgram.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.bids.seed,newAccountPubkey:t.bids.publicKey,lamports:t.lowestFeeMarket?101977920:await n.getMinimumBalanceForRentExemption((y=t.orderbookQueueSpace)!=null?y:65536+12),space:t.lowestFeeMarket?14524:(m=t.orderbookQueueSpace)!=null?m:65536+12,programId:t.programId}),J.SystemProgram.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.asks.seed,newAccountPubkey:t.asks.publicKey,lamports:t.lowestFeeMarket?101977920:await n.getMinimumBalanceForRentExemption((x=t.orderbookQueueSpace)!=null?x:65536+12),space:t.lowestFeeMarket?14524:(S=t.orderbookQueueSpace)!=null?S:65536+12,programId:t.programId}),On({programId:t.programId,marketInfo:{id:t.id.publicKey,requestQueue:t.requestQueue.publicKey,eventQueue:t.eventQueue.publicKey,bids:t.bids.publicKey,asks:t.asks.publicKey,baseVault:t.baseVault.publicKey,quoteVault:t.quoteVault.publicKey,baseMint:t.baseMint,quoteMint:t.quoteMint,baseLotSize:t.baseLotSize,quoteLotSize:t.quoteLotSize,feeRateBps:t.feeRateBps,vaultSignerNonce:t.vaultSignerNonce,quoteDustThreshold:t.quoteDustThreshold}})),[{transaction:r,signer:[],instructionTypes:[H.CreateAccount,H.CreateAccount,H.InitAccount,H.InitAccount]},{transaction:a,signer:[],instructionTypes:[H.CreateAccount,H.CreateAccount,H.CreateAccount,H.CreateAccount,H.CreateAccount,H.InitMarket]}]}var Ze=class extends Ne{async create({baseInfo:e,quoteInfo:t,lotSize:r,tickSize:i,dexProgramId:a,requestQueueSpace:l,eventQueueSpace:o,orderbookQueueSpace:b,lowestFeeMarket:P,assignSeed:y,txVersion:m,computeBudgetConfig:x,txTipConfig:S,feePayer:d}){let g=this.scope.ownerPubKey,s=y?`${e.mint.toBase58().slice(0,10)}-${t.mint.toBase58().slice(0,10)}-${y}`:void 0,R=ce({fromPublicKey:g,programId:a,assignSeed:s&&`${s}-market`}),A=ce({fromPublicKey:g,programId:a,assignSeed:s&&`${s}-request`}),I=ce({fromPublicKey:g,programId:a,assignSeed:s&&`${s}-event`}),p=ce({fromPublicKey:g,programId:a,assignSeed:s&&`${s}-bids`}),u=ce({fromPublicKey:g,programId:a,assignSeed:s&&`${s}-asks`}),c=ce({fromPublicKey:g,programId:Pt.TOKEN_PROGRAM_ID,assignSeed:s&&`${s}-baseVault`}),T=ce({fromPublicKey:g,programId:Pt.TOKEN_PROGRAM_ID,assignSeed:s&&`${s}-quoteVault`}),f=0,k=new Te.default(100);function N(){let V=new Te.default(0);for(;;)try{return{vaultOwner:xe.PublicKey.createProgramAddressSync([R.publicKey.toBuffer(),V.toArrayLike(Buffer,"le",8)],a),vaultSignerNonce:V}}catch{if(V.iaddn(1),V.gt(new Te.default(25555)))throw Error("find vault owner error")}}let{vaultOwner:D,vaultSignerNonce:B}=N(),L=new Te.default(Math.round(10**e.decimals*r)),C=new Te.default(Math.round(r*10**t.decimals*i));if(L.eq(ve))throw Error("lot size is too small");if(C.eq(ve))throw Error("tick size or lot size is too small");let O=await rn({connection:this.scope.connection,wallet:this.scope.ownerPubKey,marketInfo:{programId:a,id:R,baseMint:e.mint,quoteMint:t.mint,baseVault:c,quoteVault:T,vaultOwner:D,requestQueue:A,eventQueue:I,bids:p,asks:u,feeRateBps:f,quoteDustThreshold:k,vaultSignerNonce:B,baseLotSize:L,quoteLotSize:C,requestQueueSpace:l,eventQueueSpace:o,orderbookQueueSpace:b,lowestFeeMarket:P}}),K=this.createTxBuilder(d);K.addInstruction({instructions:O[0].transaction.instructions,signers:O[0].signer});for await(let V of O.slice(1,O.length))K.addInstruction({instructions:V.transaction.instructions,signers:V.signer,instructionTypes:V.instructionTypes});return m===0?K.sizeCheckBuildV0({computeBudgetConfig:x,address:{marketId:R.publicKey,requestQueue:A.publicKey,eventQueue:I.publicKey,bids:p.publicKey,asks:u.publicKey,baseVault:c.publicKey,quoteVault:T.publicKey,baseMint:new xe.PublicKey(e.mint),quoteMint:new xe.PublicKey(t.mint)}}):K.sizeCheckBuild({computeBudgetConfig:x,address:{marketId:R.publicKey,requestQueue:A.publicKey,eventQueue:I.publicKey,bids:p.publicKey,asks:u.publicKey,baseVault:c.publicKey,quoteVault:T.publicKey,baseMint:new xe.PublicKey(e.mint),quoteMint:new xe.PublicKey(t.mint)}})}};0&&(module.exports={});
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */
//# sourceMappingURL=createMarket.js.map