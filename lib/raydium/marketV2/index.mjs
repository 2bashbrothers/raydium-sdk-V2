var Zt=Object.defineProperty,Xt=Object.defineProperties;var $t=Object.getOwnPropertyDescriptors;var Ie=Object.getOwnPropertySymbols;var yt=Object.prototype.hasOwnProperty,xt=Object.prototype.propertyIsEnumerable;var bt=(n,e,t)=>e in n?Zt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,V=(n,e)=>{for(var t in e||(e={}))yt.call(e,t)&&bt(n,t,e[t]);if(Ie)for(var t of Ie(e))xt.call(e,t)&&bt(n,t,e[t]);return n},J=(n,e)=>Xt(n,$t(e));var ye=(n,e)=>{var t={};for(var r in n)yt.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&Ie)for(var r of Ie(n))e.indexOf(r)<0&&xt.call(n,r)&&(t[r]=n[r]);return t};import{PublicKey as Me}from"@solana/web3.js";import _e from"bn.js";import{TOKEN_PROGRAM_ID as Jt}from"@solana/spl-token";import te from"bn.js";import qs from"decimal.js";import An from"big.js";import Ls from"bn.js";import{get as Tt,set as en}from"lodash";var je=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:0,this.name=e.name}set level(e){this.logLevel=e}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let t=e.map(r=>typeof r=="object"?JSON.stringify(r):r).join(", ");throw new Error(t)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},wt={},tn={};function q(n){let e=Tt(wt,n);if(!e){let t=Tt(tn,n);e=new je({name:n,logLevel:t}),en(wt,n,e)}return e}import{PublicKey as nn}from"@solana/web3.js";import{MINT_SIZE as rr,TOKEN_PROGRAM_ID as or,getTransferFeeConfig as ir,unpackMint as sr}from"@solana/spl-token";var Qe=q("Raydium_accountInfo_util");async function Pt(n,e,t){let{batchRequest:r,commitment:s="confirmed",chunkCount:a=100}=V({batchRequest:!1},t),l=Ye(e,a),o=new Array(l.length).fill([]);if(r){let b=l.map(m=>{let x=n._buildArgs([m.map(P=>P.toBase58())],s,"base64");return{methodName:"getMultipleAccounts",args:x}}),w=Ye(b,10);o=(await(await Promise.all(w.map(async m=>await n._rpcBatchRequest(m)))).flat()).map(m=>(m.error&&Qe.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${m.error.message}`),m.result.value.map(x=>{if(x){let{data:P,executable:d,lamports:g,owner:i,rentEpoch:C}=x;return P.length!==2&&P[1]!=="base64"&&Qe.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(P[0],"base64"),executable:d,lamports:g,owner:new nn(i),rentEpoch:C}}return null})))}else try{o=await Promise.all(l.map(b=>n.getMultipleAccountsInfo(b,s)))}catch(b){b instanceof Error&&Qe.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${b.message}`)}return o.flat()}import xe from"bn.js";var St=9007199254740991;function Z(n){let e=q("Raydium_parseBigNumberish");if(n instanceof xe)return n;if(typeof n=="string"){if(n.match(/^-?[0-9]+$/))return new xe(n);e.logWithError(`invalid BigNumberish string: ${n}`)}return typeof n=="number"?(n%1&&e.logWithError(`BigNumberish number underflow: ${n}`),(n>=St||n<=-St)&&e.logWithError(`BigNumberish number overflow: ${n}`),new xe(String(n))):typeof n=="bigint"?new xe(n.toString()):(e.error(`invalid BigNumberish value: ${n}`),new xe(0))}import{PublicKey as rn}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as At}from"@solana/spl-token";var Bt={chainId:101,address:rn.default.toBase58(),programId:At.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},ae={chainId:101,address:"So11111111111111111111111111111111111111112",programId:At.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};import{PublicKey as Xe}from"@solana/web3.js";import{PublicKey as F,SystemProgram as Lt,SYSVAR_RENT_PUBKEY as on}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as sn}from"@solana/spl-token";function Ze({pubkey:n,isSigner:e=!1,isWritable:t=!0}){return{pubkey:n,isWritable:t,isSigner:e}}var xr=[Ze({pubkey:sn,isWritable:!1}),Ze({pubkey:Lt.programId,isWritable:!1}),Ze({pubkey:on,isWritable:!1})];function kt({publicKey:n,transformSol:e}){let t=Ct(n.toString());if(t instanceof F)return e&&t.equals(Te)?Je:t;if(e&&t.toString()===Te.toBase58())return Je;if(typeof t=="string"){if(t===F.default.toBase58())return F.default;try{return new F(t)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function Ct(n){try{return new F(n)}catch{return n}}var Tr=new F("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),wr=new F("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),Pr=new F("SysvarRent111111111111111111111111111111111"),Sr=new F("SysvarC1ock11111111111111111111111111111111"),Ar=new F("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),Br=new F("Sysvar1nstructions1111111111111111111111111"),Lr=Lt.programId,kr=new F("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),Cr=new F("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),Rr=new F("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),Mr=new F("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),_r=new F("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),Ir=new F("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),Dr=new F("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),Nr=new F("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),Kr=new F("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),Er=new F("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),Fr=new F("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),Je=new F("So11111111111111111111111111111111111111112"),Te=F.default;var $e=class{constructor({mint:e,decimals:t,symbol:r,name:s,skipMint:a=!1,isToken2022:l=!1}){if(e===Te.toBase58()||e instanceof Xe&&Te.equals(e)){this.decimals=ae.decimals,this.symbol=ae.symbol,this.name=ae.name,this.mint=new Xe(ae.address),this.isToken2022=!1;return}this.decimals=t,this.symbol=r||e.toString().substring(0,6),this.name=s||e.toString().substring(0,6),this.mint=a?Xe.default:kt({publicKey:e}),this.isToken2022=l}equals(e){return this===e?!0:this.mint.equals(e.mint)}},pe=$e;pe.WSOL=new $e(J(V({},ae),{mint:ae.address}));var et=class{constructor({decimals:e,symbol:t="UNKNOWN",name:r="UNKNOWN"}){this.decimals=e,this.symbol=t,this.name=r}equals(e){return this===e}},De=et;De.SOL=new et(Bt);import an from"toformat";var un=an,we=un;import Ke from"big.js";import ln from"bn.js";import pn from"decimal.js-light";var Ne=q("module/fraction"),tt=we(Ke),Pe=we(pn),mn={[0]:Pe.ROUND_DOWN,[1]:Pe.ROUND_HALF_UP,[2]:Pe.ROUND_UP},dn={[0]:Ke.roundDown,[1]:Ke.roundHalfUp,[2]:Ke.roundUp},K=class{constructor(e,t=new ln(1)){this.numerator=Z(e),this.denominator=Z(t)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new K(this.denominator,this.numerator)}add(e){let t=e instanceof K?e:new K(Z(e));return this.denominator.eq(t.denominator)?new K(this.numerator.add(t.numerator),this.denominator):new K(this.numerator.mul(t.denominator).add(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}sub(e){let t=e instanceof K?e:new K(Z(e));return this.denominator.eq(t.denominator)?new K(this.numerator.sub(t.numerator),this.denominator):new K(this.numerator.mul(t.denominator).sub(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}mul(e){let t=e instanceof K?e:new K(Z(e));return new K(this.numerator.mul(t.numerator),this.denominator.mul(t.denominator))}div(e){let t=e instanceof K?e:new K(Z(e));return new K(this.numerator.mul(t.denominator),this.denominator.mul(t.numerator))}toSignificant(e,t={groupSeparator:""},r=1){Number.isInteger(e)||Ne.logWithError(`${e} is not an integer.`),e<=0&&Ne.logWithError(`${e} is not positive.`),Pe.set({precision:e+1,rounding:mn[r]});let s=new Pe(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return s.toFormat(s.decimalPlaces(),t)}toFixed(e,t={groupSeparator:""},r=1){return Number.isInteger(e)||Ne.logWithError(`${e} is not an integer.`),e<0&&Ne.logWithError(`${e} is negative.`),tt.DP=e,tt.RM=dn[r]||1,new tt(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,t)}isZero(){return this.numerator.isZero()}};import fn from"bn.js";var io=new K(new fn(100));var po=q("Raydium_price");function Ye(n,e=1,t=[]){let r=[...n];if(e<=0)return t;for(;r.length;)t.push(r.splice(0,e));return t}var Q=class{constructor(e){this._owner=e}get publicKey(){return Q.isKeyPair(this._owner)?this._owner.publicKey:this._owner}get signer(){return Q.isKeyPair(this._owner)?this._owner:void 0}get isKeyPair(){return Q.isKeyPair(this._owner)}get isPublicKey(){return Q.isPublicKey(this._owner)}static isKeyPair(e){return e.secretKey!==void 0}static isPublicKey(e){return!Q.isKeyPair(e)}};import{PublicKey as Go}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as zo}from"@solana/spl-token";import{ComputeBudgetProgram as It,Keypair as Nt,PublicKey as Ko,Transaction as Kt,TransactionMessage as gn,VersionedTransaction as Et}from"@solana/web3.js";var U={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",ClmmLockPosition:"ClmmLockPosition",ClmmHarvestLockPosition:"ClmmHarvestLockPosition",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV4Withdraw:"FarmV4Withdraw",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut",CpmmLockLp:"CpmmLockLp",CpmmCollectLockFee:"CpmmCollectLockFee",TransferTip:"TransferTip"};import{TOKEN_PROGRAM_ID as hn}from"@solana/spl-token";var Dt=q("Raydium_txUtil"),Ft=1644;function Se(n){let e=[],t=[];return n.microLamports&&(e.push(It.setComputeUnitPrice({microLamports:n.microLamports})),t.push(U.SetComputeUnitPrice)),n.units&&(e.push(It.setComputeUnitLimit({units:n.units})),t.push(U.SetComputeUnitLimit)),{instructions:e,instructionTypes:t}}async function ue(n,e){var r,s;let t=e!=null?e:"confirmed";return(s=await((r=n.getLatestBlockhash)==null?void 0:r.call(n,{commitment:t})))==null?void 0:s.blockhash}async function Ae(n,e){return n.getSignatureStatuses([e]),new Promise((t,r)=>{let s=setTimeout(r,6e4);n.onSignature(e,a=>{if(clearTimeout(s),!a.err){t("");return}r(Object.assign(a.err,{txId:e}))},"confirmed")})}function bn(n,e){n.length<1&&Dt.logWithError(`no instructions provided: ${n.toString()}`),e.length<1&&Dt.logWithError(`no signers provided:, ${e.toString()}`);let t=new Kt;t.recentBlockhash="11111111111111111111111111111111",t.feePayer=e[0],t.add(...n);try{return Buffer.from(t.serialize({verifySignatures:!1})).toString("base64").length<Ft}catch{return!1}}function Be({instructions:n,payer:e,signers:t}){return bn(n,[e,...t])}function X({instructions:n,payer:e,lookupTableAddressAccount:t,recentBlockhash:r=Nt.generate().publicKey.toString()}){let a=new gn({payerKey:e,recentBlockhash:r,instructions:n}).compileToV0Message(Object.values(t!=null?t:{}));try{return Buffer.from(new Et(a).serialize()).toString("base64").length<Ft}catch{return!1}}var yn=n=>Buffer.isBuffer(n)?n:n instanceof Uint8Array?Buffer.from(n.buffer,n.byteOffset,n.byteLength):Buffer.from(n),xn=n=>{let e=n.serialize({requireAllSignatures:!1,verifySignatures:!1});n instanceof Et&&(e=yn(e));try{return e instanceof Buffer?e.toString("base64"):Buffer.from(e).toString("base64")}catch{return e.toString("base64")}};function ne(n){let e=[];return n.forEach(t=>{t instanceof Kt&&(t.recentBlockhash||(t.recentBlockhash=hn.toBase58()),t.feePayer||(t.feePayer=Nt.generate().publicKey)),e.push(xn(t))}),console.log("simulate tx string:",e),e}import{PublicKey as h}from"@solana/web3.js";var Jo=new h("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),Zo=new h("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),Xo=new h("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),$o=new h("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),ei=new h("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),ti=new h("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),ni=new h("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),ri=new h("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),oi=new h("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),ii=new h("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),si=new h("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),ai=new h("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),ui=new h("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),ci=new h("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),li=new h("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),pi=new h("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),mi=new h("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),di=new h("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),fi=new h("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),gi=new h("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),hi=new h("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),bi=new h("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),yi=new h("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),xi=new h("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),Ti=new h("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),wi=new h("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),Pi=new h("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),Si=new h("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),Ai=new h("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),Bi=new h("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),Li=new h("6s1xP3hpbAfFoNtUNF8mfHsjr2Bd97JxFJRWLbL6aHuX");var ki={OPEN_BOOK_PROGRAM:new h("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),SERUM_PROGRAM_ID_V3:new h("Ray1111111111111111111111111111111111111111"),AMM_V4:new h("DRaya7Kj3aMWQSy19kSjvmuwq9docCHofyP9kanQGaav"),AMM_STABLE:new h("DRayDdXc1NZQ9C3hRWmoSf8zK4iapgMnjdNZWrfwsP8m"),CLMM_PROGRAM_ID:new h("DRayAUgENGQBKVaX8owNhgzkEDyoHTGVEGHVJT1E9pfH"),CLMM_LOCK_PROGRAM_ID:new h("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),CLMM_LOCK_AUTH_ID:new h("6Aoh8h2Lw2m5UGxYR8AdAL87jTWYeKoxM52mJRzfYwN"),CREATE_CPMM_POOL_PROGRAM:new h("DRaycpLY18LhpbydsBWbVJtxpNv9oXPgjRSfpF2bWpYb"),CREATE_CPMM_POOL_AUTH:new h("CXniRufdq5xL8t8jZAPxsPZDpuudwuJSPWnbcD5Y5Nxq"),CREATE_CPMM_POOL_FEE_ACC:new h("3oE58BKVt8KuYkGxx8zBojugnymWmBiyafWgMrnb6eYy"),LOCK_CPMM_PROGRAM:new h("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),LOCK_CPMM_AUTH:new h("7qWVV8UY2bRJfDLP4s37YzBPKUkVB46DStYJBpYbQzu3"),UTIL1216:h.default,Router:new h("DRaybByLpbUL57LJARs3j8BitTxVfzBg351EaMr5UTCd"),FARM_PROGRAM_ID_V3:new h("DRayWyrLmEW5KEeqs8kdTMMaBabapqagaBC7KWpGtJeZ"),FARM_PROGRAM_ID_V4:new h("Ray1111111111111111111111111111111111111111"),FARM_PROGRAM_ID_V5:new h("DRayiCGSZgku1GTK6rXD6mVDdingXy6APAH1R6R5L2LC"),FARM_PROGRAM_ID_V6:new h("DRayzbYakXs45ELHkzH6vC3fuhQqTAnv5A68gdFuvZyZ"),LAUNCHPAD_PROGRAM:new h("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),LAUNCHPAD_AUTH:new h("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),LAUNCHPAD_PLATFORM:new h("2Jx4KTDrVSdWNazuGpcA8n3ZLTRGGBDxAWhuKe2Xcj2a"),LAUNCHPAD_CONFIG:new h("7ZR4zD7PYfY2XxoG1Gxcy2EgEeGYrpxrwzPuwdUBssEt"),FEE_DESTINATION_ID:new h("9y8ENuuZ3b19quffx9hQvRVygG5ky6snHfRvGpuSfeJy"),MODEL_DATA_PUBKEY:new h("Ray1111111111111111111111111111111111111111")};import Mi from"bn.js";import{PublicKey as nt,AddressLookupTableAccount as de}from"@solana/web3.js";async function Fe({connection:n,address:e,cluster:t="mainnet"}){let r=await Pt(n,[...new Set(e.map(a=>a.toString()))].map(a=>new nt(a))),s={};for(let a=0;a<e.length;a++){let l=r[a],o=e[a];if(!l)continue;let b=new de({key:o,state:de.deserialize(l.data)});s[o.toString()]=b,t==="devnet"?me[o.toString()]=b:re[o.toString()]=b}return s}var re={},rt=async n=>{let e="AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU";if(re[e])return re;let t=new nt(e),r=await n.getAccountInfo(t);return r&&(re[e]=new de({key:t,state:de.deserialize(r.data)})),re},me={},Oe=async n=>{let e="EFhMuDw1PKEuckuFRW9PavNfTH4LKP5uKHgyXDmWpFCq";if(me[e])return me;let t=new nt(e),r=await n.getAccountInfo(t);return r&&(me[e]=new de({key:t,state:de.deserialize(r.data)})),me};import{PublicKey as ce,sendAndConfirmTransaction as ot,SystemProgram as wn,Transaction as Le,TransactionMessage as $,VersionedTransaction as ee}from"@solana/web3.js";import Pn from"axios";var ke=2e3,Ce=class{constructor(e){this.instructions=[];this.endInstructions=[];this.lookupTableAddress=[];this.signers=[];this.instructionTypes=[];this.endInstructionTypes=[];this.connection=e.connection,this.feePayer=e.feePayer,this.signAllTransactions=e.signAllTransactions,this.owner=e.owner,this.cluster=e.cluster,this.blockhashCommitment=e.blockhashCommitment,this.loopMultiTxStatus=!!e.loopMultiTxStatus}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers,instructionTypes:this.instructionTypes,endInstructionTypes:this.endInstructionTypes,lookupTableAddress:this.lookupTableAddress}}get allInstructions(){return[...this.instructions,...this.endInstructions]}async getComputeBudgetConfig(){var r;let e=(await Pn.get(`https://solanacompass.com/api/fees?cacheFreshTime=${3e5}`)).data,{avg:t}=(r=e==null?void 0:e[15])!=null?r:{};if(!!t)return{units:6e5,microLamports:Math.min(Math.ceil(t*1e6/6e5),25e3)}}addCustomComputeBudget(e){if(e){let{instructions:t,instructionTypes:r}=Se(e);return this.instructions.unshift(...t),this.instructionTypes.unshift(...r),!0}return!1}addTipInstruction(e){var t;return e?(this.endInstructions.push(wn.transfer({fromPubkey:(t=e.feePayer)!=null?t:this.feePayer,toPubkey:new ce(e.address),lamports:BigInt(e.amount.toString())})),this.endInstructionTypes.push(U.TransferTip),!0):!1}async calComputeBudget({config:e,defaultIns:t}){try{let r=e||await this.getComputeBudgetConfig();if(this.addCustomComputeBudget(r))return;t&&this.instructions.unshift(...t)}catch{t&&this.instructions.unshift(...t)}}addInstruction({instructions:e=[],endInstructions:t=[],signers:r=[],instructionTypes:s=[],endInstructionTypes:a=[],lookupTableAddress:l=[]}){return this.instructions.push(...e),this.endInstructions.push(...t),this.signers.push(...r),this.instructionTypes.push(...s),this.endInstructionTypes.push(...a),this.lookupTableAddress.push(...l.filter(o=>o!==ce.default.toString())),this}async versionBuild({txVersion:e,extInfo:t}){return e===0?await this.buildV0(V({},t||{})):this.build(t)}build(e){var r;let t=new Le;return this.allInstructions.length&&t.add(...this.allInstructions),t.feePayer=this.feePayer,((r=this.owner)==null?void 0:r.signer)&&!this.signers.some(s=>s.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer),{builder:this,transaction:t,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async s=>{var y;let{recentBlockHash:a,skipPreflight:l=!0,sendAndConfirm:o,notSendToRpc:b}=s||{},w=a!=null?a:await ue(this.connection,this.blockhashCommitment);if(t.recentBlockhash=w,this.signers.length&&t.sign(...this.signers),ne([t]),(y=this.owner)!=null&&y.isKeyPair)return{txId:o?await ot(this.connection,t,this.signers.find(x=>x.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:l}):await this.connection.sendRawTransaction(t.serialize(),{skipPreflight:l}),signedTx:t};if(this.signAllTransactions){let m=await this.signAllTransactions([t]);if(this.signers.length)for(let x of m)try{x.sign(...this.signers)}catch{}return{txId:b?"":await this.connection.sendRawTransaction(m[0].serialize(),{skipPreflight:l}),signedTx:m[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:e||{}}}buildMultiTx(e){var w;let{extraPreBuildData:t=[],extInfo:r}=e,{transaction:s}=this.build(r),a=t.filter(y=>y.transaction.instructions.length>0),l=[s,...a.map(y=>y.transaction)],o=[this.signers,...a.map(y=>y.signers)],b=[...this.instructionTypes,...a.map(y=>y.instructionTypes).flat()];return(w=this.owner)!=null&&w.signer&&o.forEach(y=>{y.some(m=>m.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),{builder:this,transactions:l,signers:o,instructionTypes:b,execute:async y=>{var C;let{sequentially:m,onTxUpdate:x,skipTxCount:P=0,recentBlockHash:d,skipPreflight:g=!0}=y||{},i=d!=null?d:await ue(this.connection,this.blockhashCommitment);if((C=this.owner)!=null&&C.isKeyPair){if(m){let S=[],_=0;for(let p of l){if(++_,_<=P)continue;let u=await ot(this.connection,p,this.signers.find(c=>c.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:g});S.push(u)}return{txIds:S,signedTxs:l}}return{txIds:await await Promise.all(l.map(async S=>(S.recentBlockhash=i,await this.connection.sendRawTransaction(S.serialize(),{skipPreflight:g})))),signedTxs:l}}if(this.signAllTransactions){let S=l.map((p,u)=>(p.recentBlockhash=i,o[u].length&&p.sign(...o[u]),p));ne(S);let _=await this.signAllTransactions(S);if(m){let p=0,u=[],c=async()=>{if(!_[p])return;let T=await this.connection.sendRawTransaction(_[p].serialize(),{skipPreflight:g});u.push({txId:T,status:"sent",signedTx:_[p]}),x==null||x([...u]),p++;let f=!1,L=null,D=null,I=A=>{L!==null&&clearInterval(L),D!==null&&this.connection.removeSignatureListener(D);let B=u.findIndex(k=>k.txId===T);if(B>-1){if(u[B].status==="error"||u[B].status==="success")return;u[B].status=A.err?"error":"success"}x==null||x([...u]),A.err||c()};this.loopMultiTxStatus&&(L=setInterval(async()=>{var A;if(f){clearInterval(L);return}try{let B=await this.connection.getTransaction(T,{commitment:"confirmed",maxSupportedTransactionVersion:0});B&&(f=!0,clearInterval(L),I({err:((A=B.meta)==null?void 0:A.err)||null}),console.log("tx status from getTransaction:",T))}catch(B){f=!0,clearInterval(L),console.error("getTransaction timeout:",B,T)}},ke)),D=this.connection.onSignature(T,A=>{if(f){this.connection.removeSignatureListener(D);return}f=!0,I(A)},"confirmed"),this.connection.getSignatureStatus(T)};return await c(),{txIds:u.map(T=>T.txId),signedTxs:_}}else{let p=[];for(let u=0;u<_.length;u+=1){let c=await this.connection.sendRawTransaction(_[u].serialize(),{skipPreflight:g});p.push(c)}return{txIds:p,signedTxs:_}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async versionMultiBuild({extraPreBuildData:e,txVersion:t,extInfo:r}){return t===0?await this.buildV0MultiTx({extraPreBuildData:e,buildProps:r||{}}):this.buildMultiTx({extraPreBuildData:e,extInfo:r})}async buildV0(e){var g;let d=e||{},{lookupTableCache:t={},lookupTableAddress:r=[],forerunCreate:s,recentBlockhash:a}=d,l=ye(d,["lookupTableCache","lookupTableAddress","forerunCreate","recentBlockhash"]),o=V(V({},this.cluster==="devnet"?await Oe(this.connection):await rt(this.connection)),t),b=Array.from(new Set([...r,...this.lookupTableAddress])),w=[];for(let i of b)o[i]===void 0&&w.push(new ce(i));let y=await Fe({connection:this.connection,address:w});for(let[i,C]of Object.entries(y))o[i]=C;let m=s?ce.default.toBase58():a!=null?a:await ue(this.connection,this.blockhashCommitment),x=new $({payerKey:this.feePayer,recentBlockhash:m,instructions:[...this.allInstructions]}).compileToV0Message(Object.values(o));((g=this.owner)==null?void 0:g.signer)&&!this.signers.some(i=>i.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer);let P=new ee(x);return P.sign(this.signers),{builder:this,transaction:P,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async i=>{var p;let{skipPreflight:C=!0,sendAndConfirm:S,notSendToRpc:_}=i||{};if(ne([P]),(p=this.owner)!=null&&p.isKeyPair){let u=await this.connection.sendTransaction(P,{skipPreflight:C});return S&&await Ae(this.connection,u),{txId:u,signedTx:P}}if(this.signAllTransactions){let u=await this.signAllTransactions([P]);if(this.signers.length)for(let c of u)try{c.sign(this.signers)}catch{}return{txId:_?"":await this.connection.sendTransaction(u[0],{skipPreflight:C}),signedTx:u[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:l||{}}}async buildV0MultiTx(e){var w;let{extraPreBuildData:t=[],buildProps:r}=e,{transaction:s}=await this.buildV0(r),a=t.filter(y=>y.builder.instructions.length>0),l=[s,...a.map(y=>y.transaction)],o=[this.signers,...a.map(y=>y.signers)],b=[...this.instructionTypes,...a.map(y=>y.instructionTypes).flat()];return(w=this.owner)!=null&&w.signer&&o.forEach(y=>{y.some(m=>m.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),l.forEach(async(y,m)=>{y.sign(o[m])}),{builder:this,transactions:l,signers:o,instructionTypes:b,buildProps:r,execute:async y=>{var g;let{sequentially:m,onTxUpdate:x,recentBlockHash:P,skipPreflight:d=!0}=y||{};if(P&&l.forEach(i=>i.message.recentBlockhash=P),ne(l),(g=this.owner)!=null&&g.isKeyPair){if(m){let i=[];for(let C of l){let S=await this.connection.sendTransaction(C,{skipPreflight:d});await Ae(this.connection,S),i.push(S)}return{txIds:i,signedTxs:l}}return{txIds:await Promise.all(l.map(async i=>await this.connection.sendTransaction(i,{skipPreflight:d}))),signedTxs:l}}if(this.signAllTransactions){let i=await this.signAllTransactions(l);if(m){let C=0,S=[],_=async()=>{if(!i[C])return;let p=await this.connection.sendTransaction(i[C],{skipPreflight:d});S.push({txId:p,status:"sent",signedTx:i[C]}),x==null||x([...S]),C++;let u=!1,c=null,T=null,f=L=>{c!==null&&clearInterval(c),T!==null&&this.connection.removeSignatureListener(T);let D=S.findIndex(I=>I.txId===p);if(D>-1){if(S[D].status==="error"||S[D].status==="success")return;S[D].status=L.err?"error":"success"}x==null||x([...S]),L.err||_()};this.loopMultiTxStatus&&(c=setInterval(async()=>{var L;if(u){clearInterval(c);return}try{let D=await this.connection.getTransaction(p,{commitment:"confirmed",maxSupportedTransactionVersion:0});D&&(u=!0,clearInterval(c),f({err:((L=D.meta)==null?void 0:L.err)||null}),console.log("tx status from getTransaction:",p))}catch(D){u=!0,clearInterval(c),console.error("getTransaction timeout:",D,p)}},ke)),T=this.connection.onSignature(p,L=>{if(u){this.connection.removeSignatureListener(T);return}u=!0,f(L)},"confirmed"),this.connection.getSignatureStatus(p)};return _(),{txIds:[],signedTxs:i}}else{let C=[];for(let S=0;S<i.length;S+=1){let _=await this.connection.sendTransaction(i[S],{skipPreflight:d});C.push(_)}return{txIds:C,signedTxs:i}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async sizeCheckBuild(e){var x;let m=e||{},{splitIns:t=[],computeBudgetConfig:r}=m,s=ye(m,["splitIns","computeBudgetConfig"]),a=r?Se(r):{instructions:[],instructionTypes:[]},l=this.signers.reduce((P,d)=>J(V({},P),{[d.publicKey.toBase58()]:d}),{}),o=[],b=[],w=[],y=0;if(this.allInstructions.forEach(P=>{let d=[...w,P],g=r?[...a.instructions,...d]:d,C=[...new Set(d.map(S=>S.keys.filter(_=>_.isSigner).map(_=>_.pubkey.toString())).flat()).values()].map(S=>new ce(S));if(P!==t[y]&&w.length<12&&(Be({instructions:g,payer:this.feePayer,signers:C})||Be({instructions:d,payer:this.feePayer,signers:C})))w.push(P);else{if(w.length===0)throw Error("item ins too big");y+=P===t[y]?1:0,Be({instructions:r?[...a.instructions,...w]:[...w],payer:this.feePayer,signers:C})?o.push(new Le().add(...a.instructions,...w)):o.push(new Le().add(...w)),b.push(Array.from(new Set(w.map(S=>S.keys.filter(_=>_.isSigner).map(_=>_.pubkey.toString())).flat())).map(S=>l[S]).filter(S=>S!==void 0)),w=[P]}}),w.length>0){let d=[...new Set(w.map(g=>g.keys.filter(i=>i.isSigner).map(i=>i.pubkey.toString())).flat()).values()].map(g=>l[g]).filter(g=>g!==void 0);Be({instructions:r?[...a.instructions,...w]:[...w],payer:this.feePayer,signers:d.map(g=>g.publicKey)})?o.push(new Le().add(...a.instructions,...w)):o.push(new Le().add(...w)),b.push(d)}return o.forEach(P=>P.feePayer=this.feePayer),(x=this.owner)!=null&&x.signer&&b.forEach(P=>{P.some(d=>d.publicKey.equals(this.owner.publicKey))||P.push(this.owner.signer)}),{builder:this,transactions:o,signers:b,instructionTypes:this.instructionTypes,execute:async P=>{var p;let{sequentially:d,onTxUpdate:g,skipTxCount:i=0,recentBlockHash:C,skipPreflight:S=!0}=P||{},_=C!=null?C:await ue(this.connection,this.blockhashCommitment);if(o.forEach(async(u,c)=>{u.recentBlockhash=_,b[c].length&&u.sign(...b[c])}),ne(o),(p=this.owner)!=null&&p.isKeyPair){if(d){let u=0,c=[];for(let T of o){if(++u,u<=i){c.push("tx skipped");continue}let f=await ot(this.connection,T,this.signers.find(L=>L.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:S});c.push(f)}return{txIds:c,signedTxs:o}}return{txIds:await Promise.all(o.map(async u=>await this.connection.sendRawTransaction(u.serialize(),{skipPreflight:S}))),signedTxs:o}}if(this.signAllTransactions){let u=await this.signAllTransactions(o.slice(i,o.length)),c=[...o.slice(0,i),...u];if(d){let T=0,f=[],L=async()=>{if(!c[T])return;T<i&&(f.push({txId:"",status:"success",signedTx:c[T]}),g==null||g([...f]),T++,L());let D=await this.connection.sendRawTransaction(c[T].serialize(),{skipPreflight:S});f.push({txId:D,status:"sent",signedTx:c[T]}),g==null||g([...f]),T++;let I=!1,A=null,B=null,k=E=>{A!==null&&clearInterval(A),B!==null&&this.connection.removeSignatureListener(B);let N=f.findIndex(O=>O.txId===D);if(N>-1){if(f[N].status==="error"||f[N].status==="success")return;f[N].status=E.err?"error":"success"}g==null||g([...f]),E.err||L()};this.loopMultiTxStatus&&(A=setInterval(async()=>{var E;if(I){clearInterval(A);return}try{let N=await this.connection.getTransaction(D,{commitment:"confirmed",maxSupportedTransactionVersion:0});N&&(I=!0,clearInterval(A),k({err:((E=N.meta)==null?void 0:E.err)||null}),console.log("tx status from getTransaction:",D))}catch(N){I=!0,clearInterval(A),console.error("getTransaction timeout:",N,D)}},ke)),B=this.connection.onSignature(D,E=>{if(I){this.connection.removeSignatureListener(B);return}I=!0,k(E)},"confirmed"),this.connection.getSignatureStatus(D)};return await L(),{txIds:f.map(D=>D.txId),signedTxs:c}}else{let T=[];for(let f=0;f<c.length;f+=1){let L=await this.connection.sendRawTransaction(c[f].serialize(),{skipPreflight:S});T.push(L)}return{txIds:T,signedTxs:c}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:s||{}}}async sizeCheckBuildV0(e){var _;let S=e||{},{computeBudgetConfig:t,splitIns:r=[],lookupTableCache:s={},lookupTableAddress:a=[]}=S,l=ye(S,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),o=V(V({},this.cluster==="devnet"?await Oe(this.connection):re),s),b=Array.from(new Set([...this.lookupTableAddress,...a])),w=[];for(let p of b)o[p]===void 0&&w.push(new ce(p));let y=await Fe({connection:this.connection,address:w});for(let[p,u]of Object.entries(y))o[p]=u;let m=t?Se(t):{instructions:[],instructionTypes:[]},x=await ue(this.connection,this.blockhashCommitment),P=this.signers.reduce((p,u)=>J(V({},p),{[u.publicKey.toBase58()]:u}),{}),d=[],g=[],i=[],C=0;if(this.allInstructions.forEach(p=>{let u=[...i,p],c=t?[...m.instructions,...u]:u;if(p!==r[C]&&i.length<12&&(X({instructions:c,payer:this.feePayer,lookupTableAddressAccount:o})||X({instructions:u,payer:this.feePayer,lookupTableAddressAccount:o})))i.push(p);else{if(i.length===0)throw Error("item ins too big");C+=p===r[C]?1:0;let T={};for(let f of[...new Set(b)])o[f]!==void 0&&(T[f]=o[f]);if(t&&X({instructions:[...m.instructions,...i],payer:this.feePayer,lookupTableAddressAccount:o,recentBlockhash:x})){let f=new $({payerKey:this.feePayer,recentBlockhash:x,instructions:[...m.instructions,...i]}).compileToV0Message(Object.values(o));d.push(new ee(f))}else{let f=new $({payerKey:this.feePayer,recentBlockhash:x,instructions:[...i]}).compileToV0Message(Object.values(o));d.push(new ee(f))}g.push(Array.from(new Set(i.map(f=>f.keys.filter(L=>L.isSigner).map(L=>L.pubkey.toString())).flat())).map(f=>P[f]).filter(f=>f!==void 0)),i=[p]}}),i.length>0){let u=[...new Set(i.map(c=>c.keys.filter(T=>T.isSigner).map(T=>T.pubkey.toString())).flat()).values()].map(c=>P[c]).filter(c=>c!==void 0);if(t&&X({instructions:[...m.instructions,...i],payer:this.feePayer,lookupTableAddressAccount:o,recentBlockhash:x})){let c=new $({payerKey:this.feePayer,recentBlockhash:x,instructions:[...m.instructions,...i]}).compileToV0Message(Object.values(o));d.push(new ee(c))}else{let c=new $({payerKey:this.feePayer,recentBlockhash:x,instructions:[...i]}).compileToV0Message(Object.values(o));d.push(new ee(c))}g.push(u)}return(_=this.owner)!=null&&_.signer&&g.forEach(p=>{p.some(u=>u.publicKey.equals(this.owner.publicKey))||p.push(this.owner.signer)}),d.forEach((p,u)=>{p.sign(g[u])}),{builder:this,transactions:d,buildProps:e,signers:g,blockHash:x,instructionTypes:this.instructionTypes,execute:async p=>{var D;let{sequentially:u,onTxUpdate:c,skipTxCount:T=0,recentBlockHash:f,skipPreflight:L=!0}=p||{};if(d.map(async(I,A)=>{g[A].length&&I.sign(g[A]),f&&(I.message.recentBlockhash=f)}),ne(d),(D=this.owner)!=null&&D.isKeyPair){if(u){let I=0,A=[];for(let B of d){if(++I,I<=T){console.log("skip tx: ",I),A.push("tx skipped");continue}let k=await this.connection.sendTransaction(B,{skipPreflight:L});await Ae(this.connection,k),A.push(k)}return{txIds:A,signedTxs:d}}return{txIds:await Promise.all(d.map(async I=>await this.connection.sendTransaction(I,{skipPreflight:L}))),signedTxs:d}}if(this.signAllTransactions){let I=await this.signAllTransactions(d.slice(T,d.length)),A=[...d.slice(0,T),...I];if(u){let B=0,k=[],E=async()=>{if(!A[B])return;if(B<T){k.push({txId:"",status:"success",signedTx:A[B]}),c==null||c([...k]),B++,E();return}let N=await this.connection.sendTransaction(A[B],{skipPreflight:L});k.push({txId:N,status:"sent",signedTx:A[B]}),c==null||c([...k]),B++;let O=!1,G=null,Y=null,be=H=>{G!==null&&clearInterval(G),Y!==null&&this.connection.removeSignatureListener(Y);let W=k.findIndex(ze=>ze.txId===N);if(W>-1){if(k[W].status==="error"||k[W].status==="success")return;k[W].status=H.err?"error":"success"}c==null||c([...k]),H.err||E()};this.loopMultiTxStatus&&(G=setInterval(async()=>{var H;if(O){clearInterval(G);return}try{let W=await this.connection.getTransaction(N,{commitment:"confirmed",maxSupportedTransactionVersion:0});W&&(O=!0,clearInterval(G),be({err:((H=W.meta)==null?void 0:H.err)||null}),console.log("tx status from getTransaction:",N))}catch(W){O=!0,clearInterval(G),console.error("getTransaction timeout:",W,N)}},ke)),Y=this.connection.onSignature(N,H=>{if(O){this.connection.removeSignatureListener(Y);return}O=!0,be(H)},"confirmed"),this.connection.getSignatureStatus(N)};return E(),{txIds:[],signedTxs:A}}else{let B=[];for(let k=0;k<A.length;k+=1){let E=await this.connection.sendTransaction(A[k],{skipPreflight:L});B.push(E)}return{txIds:B,signedTxs:A}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:l||{}}}async buildSniperTransaction(e){var _;let S=e||{},{computeBudgetConfig:t,splitIns:r=[],lookupTableCache:s={},lookupTableAddress:a=[]}=S,l=ye(S,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),o=V(V({},this.cluster==="devnet"?await Oe(this.connection):await rt(this.connection)),s),b=Array.from(new Set([...this.lookupTableAddress,...a])),w=[];for(let p of b)o[p]===void 0&&w.push(new ce(p));let y=await Fe({connection:this.connection,address:w});for(let[p,u]of Object.entries(y))o[p]=u;let m=t?Se(t):{instructions:[],instructionTypes:[]},x=await ue(this.connection,this.blockhashCommitment),P=this.signers.reduce((p,u)=>J(V({},p),{[u.publicKey.toBase58()]:u}),{}),d=[],g=[],i=[],C=0;if(this.allInstructions.forEach(p=>{let u=[...i,p],c=t?[...m.instructions,...u]:u;if(p!==r[C]&&i.length<12&&(X({instructions:c,payer:this.feePayer,lookupTableAddressAccount:o})||X({instructions:u,payer:this.feePayer,lookupTableAddressAccount:o})))i.push(p);else{if(i.length===0)throw Error("item ins too big");C+=p===r[C]?1:0;let T={};for(let f of[...new Set(b)])o[f]!==void 0&&(T[f]=o[f]);if(t&&X({instructions:[...m.instructions,...i],payer:this.feePayer,lookupTableAddressAccount:o,recentBlockhash:x})){let f=new $({payerKey:this.feePayer,recentBlockhash:x,instructions:[...m.instructions,...i]}).compileToV0Message(Object.values(o));d.push(new ee(f))}else{let f=new $({payerKey:this.feePayer,recentBlockhash:x,instructions:[...i]}).compileToV0Message(Object.values(o));d.push(new ee(f))}g.push(Array.from(new Set(i.map(f=>f.keys.filter(L=>L.isSigner).map(L=>L.pubkey.toString())).flat())).map(f=>P[f]).filter(f=>f!==void 0)),i=[p]}}),i.length>0){let u=[...new Set(i.map(c=>c.keys.filter(T=>T.isSigner).map(T=>T.pubkey.toString())).flat()).values()].map(c=>P[c]).filter(c=>c!==void 0);if(t&&X({instructions:[...m.instructions,...i],payer:this.feePayer,lookupTableAddressAccount:o,recentBlockhash:x})){let c=new $({payerKey:this.feePayer,recentBlockhash:x,instructions:[...m.instructions,...i]}).compileToV0Message(Object.values(o));d.push(new ee(c))}else{let c=new $({payerKey:this.feePayer,recentBlockhash:x,instructions:[...i]}).compileToV0Message(Object.values(o));d.push(new ee(c))}g.push(u)}return(_=this.owner)!=null&&_.signer&&g.forEach(p=>{p.some(u=>u.publicKey.equals(this.owner.publicKey))||p.push(this.owner.signer)}),d.forEach((p,u)=>{p.sign(g[u])}),{builder:this,transactions:d,buildProps:e,signers:g,instructionTypes:this.instructionTypes,execute:async p=>{var D;let{sequentially:u,onTxUpdate:c,skipTxCount:T=0,recentBlockHash:f,skipPreflight:L=!0}=p||{};if(d.map(async(I,A)=>{g[A].length&&I.sign(g[A]),f&&(I.message.recentBlockhash=f)}),ne(d),(D=this.owner)!=null&&D.isKeyPair){if(u){let I=0,A=[];for(let B of d){if(++I,I<=T){console.log("skip tx: ",I),A.push("tx skipped");continue}let k=await this.connection.sendTransaction(B,{skipPreflight:L});await Ae(this.connection,k),A.push(k)}return{txIds:A,signedTxs:d}}return{txIds:await Promise.all(d.map(async I=>await this.connection.sendTransaction(I,{skipPreflight:L}))),signedTxs:d}}if(this.signAllTransactions){let I=await this.signAllTransactions(d.slice(T,d.length)),A=[...d.slice(0,T),...I];if(u){let B=0,k=[],E=async()=>{if(!A[B])return;if(B<T){k.push({txId:"",status:"success",signedTx:A[B]}),c==null||c([...k]),B++,E();return}let N=await this.connection.sendTransaction(A[B],{skipPreflight:L});k.push({txId:N,status:"sent",signedTx:A[B]}),c==null||c([...k]),B++;let O=!1,G=null,Y=null,be=H=>{G!==null&&clearInterval(G),Y!==null&&this.connection.removeSignatureListener(Y);let W=k.findIndex(ze=>ze.txId===N);if(W>-1){if(k[W].status==="error"||k[W].status==="success")return;k[W].status=H.err?"error":"success"}c==null||c([...k]),H.err||E()};this.loopMultiTxStatus&&(G=setInterval(async()=>{var H;if(O){clearInterval(G);return}try{let W=await this.connection.getTransaction(N,{commitment:"confirmed",maxSupportedTransactionVersion:0});W&&(O=!0,clearInterval(G),be({err:((H=W.meta)==null?void 0:H.err)||null}),console.log("tx status from getTransaction:",N))}catch(W){O=!0,clearInterval(G),console.error("getTransaction timeout:",W,N)}},ke)),Y=this.connection.onSignature(N,H=>{if(O){this.connection.removeSignatureListener(Y);return}O=!0,be(H)},"confirmed"),this.connection.getSignatureStatus(N)};return E(),{txIds:[],signedTxs:A}}else{let B=[];for(let k=0;k<A.length;k+=1){let E=await this.connection.sendTransaction(A[k],{skipPreflight:L});B.push(E)}return{txIds:B,signedTxs:A}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:l||{}}}};import{PublicKey as Ji}from"@solana/web3.js";import Xi from"bn.js";import Sn from"bn.js";var rs=new Sn(1e6);var Ks=q("Raydium_amount"),Es=we(An);var Ee=new te(0),Zs=new te(1),Xs=new te(2),$s=new te(3),ea=new te(5),Bn=new te(10),ta=new te(100),na=new te(1e3),ra=new te(1e4);import{Keypair as Vn,PublicKey as vn}from"@solana/web3.js";import Su from"bn.js";import{TOKEN_PROGRAM_ID as Wn}from"@solana/spl-token";function Ln(n){return n instanceof Uint8Array||n!=null&&typeof n=="object"&&n.constructor.name==="Uint8Array"}function it(n,...e){if(!Ln(n))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(n.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${n.length}`)}function st(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")}function Ot(n,e){it(n);let t=e.outputLen;if(n.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}var ve=n=>new DataView(n.buffer,n.byteOffset,n.byteLength),j=(n,e)=>n<<32-e|n>>>e;var aa=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function kn(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function at(n){return typeof n=="string"&&(n=kn(n)),it(n),n}var Ve=class{clone(){return this._cloneInto()}},ua={}.toString;function Vt(n){let e=r=>n().update(at(r)).digest(),t=n();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>n(),e}function Cn(n,e,t,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,t,r);let s=BigInt(32),a=BigInt(4294967295),l=Number(t>>s&a),o=Number(t&a),b=r?4:0,w=r?0:4;n.setUint32(e+b,l,r),n.setUint32(e+w,o,r)}var vt=(n,e,t)=>n&e^~n&t,Wt=(n,e,t)=>n&e^n&t^e&t,We=class extends Ve{constructor(e,t,r,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ve(this.buffer)}update(e){st(this);let{view:t,buffer:r,blockLen:s}=this;e=at(e);let a=e.length;for(let l=0;l<a;){let o=Math.min(s-this.pos,a-l);if(o===s){let b=ve(e);for(;s<=a-l;l+=s)this.process(b,l);continue}r.set(e.subarray(l,l+o),this.pos),this.pos+=o,l+=o,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){st(this),Ot(e,this),this.finished=!0;let{buffer:t,view:r,blockLen:s,isLE:a}=this,{pos:l}=this;t[l++]=128,this.buffer.subarray(l).fill(0),this.padOffset>s-l&&(this.process(r,0),l=0);for(let m=l;m<s;m++)t[m]=0;Cn(r,s-8,BigInt(this.length*8),a),this.process(r,0);let o=ve(e),b=this.outputLen;if(b%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let w=b/4,y=this.get();if(w>y.length)throw new Error("_sha2: outputLen bigger than state");for(let m=0;m<w;m++)o.setUint32(4*m,y[m],a)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:r,length:s,finished:a,destroyed:l,pos:o}=this;return e.length=s,e.pos=o,e.finished=a,e.destroyed=l,s%t&&e.buffer.set(r),e}};var Rn=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),oe=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ie=new Uint32Array(64),ut=class extends We{constructor(){super(64,32,8,!1),this.A=oe[0]|0,this.B=oe[1]|0,this.C=oe[2]|0,this.D=oe[3]|0,this.E=oe[4]|0,this.F=oe[5]|0,this.G=oe[6]|0,this.H=oe[7]|0}get(){let{A:e,B:t,C:r,D:s,E:a,F:l,G:o,H:b}=this;return[e,t,r,s,a,l,o,b]}set(e,t,r,s,a,l,o,b){this.A=e|0,this.B=t|0,this.C=r|0,this.D=s|0,this.E=a|0,this.F=l|0,this.G=o|0,this.H=b|0}process(e,t){for(let m=0;m<16;m++,t+=4)ie[m]=e.getUint32(t,!1);for(let m=16;m<64;m++){let x=ie[m-15],P=ie[m-2],d=j(x,7)^j(x,18)^x>>>3,g=j(P,17)^j(P,19)^P>>>10;ie[m]=g+ie[m-7]+d+ie[m-16]|0}let{A:r,B:s,C:a,D:l,E:o,F:b,G:w,H:y}=this;for(let m=0;m<64;m++){let x=j(o,6)^j(o,11)^j(o,25),P=y+x+vt(o,b,w)+Rn[m]+ie[m]|0,g=(j(r,2)^j(r,13)^j(r,22))+Wt(r,s,a)|0;y=w,w=b,b=o,o=l+P|0,l=a,a=s,s=r,r=P+g|0}r=r+this.A|0,s=s+this.B|0,a=a+this.C|0,l=l+this.D|0,o=o+this.E|0,b=b+this.F|0,w=w+this.G|0,y=y+this.H|0,this.set(r,s,a,l,o,b,w,y)}roundClean(){ie.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var qt=Vt(()=>new ut);import{PublicKey as Fn}from"@solana/web3.js";import Ht,{isBN as pu}from"bn.js";import{bits as Mn,BitStructure as ba,blob as _n,Blob as ya,cstr as xa,f32 as Ta,f32be as wa,f64 as Pa,f64be as Sa,greedy as Aa,Layout as In,ns64 as Ba,ns64be as La,nu64 as ka,nu64be as Ca,offset as Ra,s16 as Ma,s16be as _a,s24 as Ia,s24be as Da,s32 as Na,s32be as Ka,s40 as Ea,s40be as Fa,s48 as Oa,s48be as Va,s8 as va,seq as Wa,struct as qa,Structure as Dn,u16 as Nn,u16be as Ua,u24 as Ga,u24be as Ha,u32 as Kn,u32be as za,u40 as ja,u40be as Qa,u48 as Ya,u48be as Ja,u8 as Za,UInt as En,union as Xa,Union as $a,unionLayoutDiscriminator as eu,utf8 as tu}from"@solana/buffer-layout";var qe=In,Ut=Dn;var ct=En;var Gt=Nn;var lt=Kn;var fe=_n;var pt=Mn;var mt=class extends qe{constructor(t,r,s){super(t,s);this.blob=fe(t),this.signed=r}decode(t,r=0){let s=new Ht(this.blob.decode(t,r),10,"le");return this.signed?s.fromTwos(this.span*8).clone():s}encode(t,r,s=0){return typeof t=="number"&&(t=new Ht(t)),this.signed&&(t=t.toTwos(this.span*8)),this.blob.encode(t.toArrayLike(Buffer,"le",this.span),r,s)}},Ue=class extends qe{constructor(t){super(8,t);this._lower=pt(lt(),!1),this._upper=pt(lt(),!1)}addBoolean(t){this._lower.fields.length<32?this._lower.addBoolean(t):this._upper.addBoolean(t)}decode(t,r=0){let s=this._lower.decode(t,r),a=this._upper.decode(t,r+this._lower.span);return V(V({},s),a)}encode(t,r,s=0){return this._lower.encode(t,r,s)+this._upper.encode(t,r,s+this._lower.span)}};function Ge(n){return new ct(1,n)}function ge(n){return new ct(4,n)}function v(n){return new mt(8,!1,n)}var dt=class extends qe{constructor(t,r,s,a){super(t.span,a);this.layout=t,this.decoder=r,this.encoder=s}decode(t,r){return this.decoder(this.layout.decode(t,r))}encode(t,r,s){return this.layout.encode(this.encoder(t),r,s)}getSpan(t,r){return this.layout.getSpan(t,r)}};function z(n){return new dt(fe(32),e=>new Fn(e),e=>e.toBuffer(),n)}var ft=class extends Ut{decode(e,t){return super.decode(e,t)}};function he(n,e,t){return new ft(n,e,t)}var On=he([z("mint"),z("owner"),v("amount"),ge("delegateOption"),z("delegate"),Ge("state"),ge("isNativeOption"),v("isNative"),v("delegatedAmount"),ge("closeAuthorityOption"),z("closeAuthority")]);var Cu=q("Raydium_Util");function se({fromPublicKey:n,programId:e=Wn,assignSeed:t}){let r=t?btoa(t).slice(0,32):Vn.generate().publicKey.toBase58().slice(0,32);return{publicKey:qn(n,r,e),seed:r}}function qn(n,e,t){let r=Buffer.concat([n.toBuffer(),Buffer.from(e),t.toBuffer()]),s=qt(r);return new vn(s)}var gt=(...n)=>n.map(e=>{try{return typeof e=="object"?JSON.stringify(e):e}catch{return e}}).join(", "),Re=class{constructor({scope:e,moduleName:t}){this.disabled=!1;this.scope=e,this.logger=q(t)}createTxBuilder(e){return this.scope.checkOwner(),new Ce({connection:this.scope.connection,feePayer:e||this.scope.ownerPubKey,cluster:this.scope.cluster,owner:this.scope.owner,blockhashCommitment:this.scope.blockhashCommitment,loopMultiTxStatus:this.scope.loopMultiTxStatus,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}createSniperTxBuilder(e,t){let r=new Q(e);return new Ce({connection:this.scope.connection,feePayer:t,cluster:this.scope.cluster,owner:r,blockhashCommitment:this.scope.blockhashCommitment,loopMultiTxStatus:this.scope.loopMultiTxStatus,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}logDebug(...e){this.logger.debug(gt(e))}logInfo(...e){this.logger.info(gt(e))}logAndCreateError(...e){let t=gt(e);throw new Error(t)}checkDisabled(){(this.disabled||!this.scope)&&this.logAndCreateError("module not working")}};import{SystemProgram as le,SYSVAR_RENT_PUBKEY as Gn,Transaction as zt,TransactionInstruction as Hn}from"@solana/web3.js";import{createInitializeAccountInstruction as jt,TOKEN_PROGRAM_ID as Qt}from"@solana/spl-token";function Un(n="accountFlags"){let e=new Ue(n);return e.addBoolean("initialized"),e.addBoolean("market"),e.addBoolean("openOrders"),e.addBoolean("requestQueue"),e.addBoolean("eventQueue"),e.addBoolean("bids"),e.addBoolean("asks"),e}var ht=he([fe(5),Un("accountFlags"),z("ownAddress"),v("vaultSignerNonce"),z("baseMint"),z("quoteMint"),z("baseVault"),v("baseDepositsTotal"),v("baseFeesAccrued"),z("quoteVault"),v("quoteDepositsTotal"),v("quoteFeesAccrued"),v("quoteDustThreshold"),z("requestQueue"),z("eventQueue"),z("bids"),z("asks"),v("baseLotSize"),v("quoteLotSize"),v("feeRateBps"),v("referrerRebatesAccrued"),fe(7)]);function zn({programId:n,marketInfo:e}){let t=he([Ge("version"),ge("instruction"),v("baseLotSize"),v("quoteLotSize"),Gt("feeRateBps"),v("vaultSignerNonce"),v("quoteDustThreshold")]),r=[{pubkey:e.id,isSigner:!1,isWritable:!0},{pubkey:e.requestQueue,isSigner:!1,isWritable:!0},{pubkey:e.eventQueue,isSigner:!1,isWritable:!0},{pubkey:e.bids,isSigner:!1,isWritable:!0},{pubkey:e.asks,isSigner:!1,isWritable:!0},{pubkey:e.baseVault,isSigner:!1,isWritable:!0},{pubkey:e.quoteVault,isSigner:!1,isWritable:!0},{pubkey:e.baseMint,isSigner:!1,isWritable:!1},{pubkey:e.quoteMint,isSigner:!1,isWritable:!1},{pubkey:e.authority?e.quoteMint:Gn,isSigner:!1,isWritable:!1}].concat(e.authority?{pubkey:e.authority,isSigner:!1,isWritable:!1}:[]).concat(e.authority&&e.pruneAuthority?{pubkey:e.pruneAuthority,isSigner:!1,isWritable:!1}:[]),s=Buffer.alloc(t.span);return t.encode({version:0,instruction:0,baseLotSize:e.baseLotSize,quoteLotSize:e.quoteLotSize,feeRateBps:e.feeRateBps,vaultSignerNonce:e.vaultSignerNonce,quoteDustThreshold:e.quoteDustThreshold},s),new Hn({keys:r,programId:n,data:s})}async function Yt({connection:n,wallet:e,marketInfo:t}){var l,o,b,w,y,m,x,P;let r=new zt,s=await n.getMinimumBalanceForRentExemption(165);r.add(le.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.baseVault.seed,newAccountPubkey:t.baseVault.publicKey,lamports:s,space:165,programId:Qt}),le.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.quoteVault.seed,newAccountPubkey:t.quoteVault.publicKey,lamports:s,space:165,programId:Qt}),jt(t.baseVault.publicKey,t.baseMint,t.vaultOwner),jt(t.quoteVault.publicKey,t.quoteMint,t.vaultOwner),le.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.id.seed,newAccountPubkey:t.id.publicKey,lamports:await n.getMinimumBalanceForRentExemption(ht.span),space:ht.span,programId:t.programId}));let a=new zt;return a.add(le.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.requestQueue.seed,newAccountPubkey:t.requestQueue.publicKey,lamports:t.lowestFeeMarket?6208320:await n.getMinimumBalanceForRentExemption((l=t.requestQueueSpace)!=null?l:5120+12),space:t.lowestFeeMarket?764:(o=t.requestQueueSpace)!=null?o:5120+12,programId:t.programId}),le.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.eventQueue.seed,newAccountPubkey:t.eventQueue.publicKey,lamports:t.lowestFeeMarket?79594560:await n.getMinimumBalanceForRentExemption((b=t.eventQueueSpace)!=null?b:262144+12),space:t.lowestFeeMarket?11308:(w=t.eventQueueSpace)!=null?w:262144+12,programId:t.programId}),le.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.bids.seed,newAccountPubkey:t.bids.publicKey,lamports:t.lowestFeeMarket?101977920:await n.getMinimumBalanceForRentExemption((y=t.orderbookQueueSpace)!=null?y:65536+12),space:t.lowestFeeMarket?14524:(m=t.orderbookQueueSpace)!=null?m:65536+12,programId:t.programId}),le.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.asks.seed,newAccountPubkey:t.asks.publicKey,lamports:t.lowestFeeMarket?101977920:await n.getMinimumBalanceForRentExemption((x=t.orderbookQueueSpace)!=null?x:65536+12),space:t.lowestFeeMarket?14524:(P=t.orderbookQueueSpace)!=null?P:65536+12,programId:t.programId}),zn({programId:t.programId,marketInfo:{id:t.id.publicKey,requestQueue:t.requestQueue.publicKey,eventQueue:t.eventQueue.publicKey,bids:t.bids.publicKey,asks:t.asks.publicKey,baseVault:t.baseVault.publicKey,quoteVault:t.quoteVault.publicKey,baseMint:t.baseMint,quoteMint:t.quoteMint,baseLotSize:t.baseLotSize,quoteLotSize:t.quoteLotSize,feeRateBps:t.feeRateBps,vaultSignerNonce:t.vaultSignerNonce,quoteDustThreshold:t.quoteDustThreshold}})),[{transaction:r,signer:[],instructionTypes:[U.CreateAccount,U.CreateAccount,U.InitAccount,U.InitAccount]},{transaction:a,signer:[],instructionTypes:[U.CreateAccount,U.CreateAccount,U.CreateAccount,U.CreateAccount,U.CreateAccount,U.InitMarket]}]}var He=class extends Re{async create({baseInfo:e,quoteInfo:t,lotSize:r,tickSize:s,dexProgramId:a,requestQueueSpace:l,eventQueueSpace:o,orderbookQueueSpace:b,lowestFeeMarket:w,assignSeed:y,txVersion:m,computeBudgetConfig:x,txTipConfig:P,feePayer:d}){let g=this.scope.ownerPubKey,i=y?`${e.mint.toBase58().slice(0,10)}-${t.mint.toBase58().slice(0,10)}-${y}`:void 0,C=se({fromPublicKey:g,programId:a,assignSeed:i&&`${i}-market`}),S=se({fromPublicKey:g,programId:a,assignSeed:i&&`${i}-request`}),_=se({fromPublicKey:g,programId:a,assignSeed:i&&`${i}-event`}),p=se({fromPublicKey:g,programId:a,assignSeed:i&&`${i}-bids`}),u=se({fromPublicKey:g,programId:a,assignSeed:i&&`${i}-asks`}),c=se({fromPublicKey:g,programId:Jt,assignSeed:i&&`${i}-baseVault`}),T=se({fromPublicKey:g,programId:Jt,assignSeed:i&&`${i}-quoteVault`}),f=0,L=new _e(100);function D(){let O=new _e(0);for(;;)try{return{vaultOwner:Me.createProgramAddressSync([C.publicKey.toBuffer(),O.toArrayLike(Buffer,"le",8)],a),vaultSignerNonce:O}}catch{if(O.iaddn(1),O.gt(new _e(25555)))throw Error("find vault owner error")}}let{vaultOwner:I,vaultSignerNonce:A}=D(),B=new _e(Math.round(10**e.decimals*r)),k=new _e(Math.round(r*10**t.decimals*s));if(B.eq(Ee))throw Error("lot size is too small");if(k.eq(Ee))throw Error("tick size or lot size is too small");let E=await Yt({connection:this.scope.connection,wallet:this.scope.ownerPubKey,marketInfo:{programId:a,id:C,baseMint:e.mint,quoteMint:t.mint,baseVault:c,quoteVault:T,vaultOwner:I,requestQueue:S,eventQueue:_,bids:p,asks:u,feeRateBps:f,quoteDustThreshold:L,vaultSignerNonce:A,baseLotSize:B,quoteLotSize:k,requestQueueSpace:l,eventQueueSpace:o,orderbookQueueSpace:b,lowestFeeMarket:w}}),N=this.createTxBuilder(d);N.addInstruction({instructions:E[0].transaction.instructions,signers:E[0].signer});for await(let O of E.slice(1,E.length))N.addInstruction({instructions:O.transaction.instructions,signers:O.signer,instructionTypes:O.instructionTypes});return m===0?N.sizeCheckBuildV0({computeBudgetConfig:x,address:{marketId:C.publicKey,requestQueue:S.publicKey,eventQueue:_.publicKey,bids:p.publicKey,asks:u.publicKey,baseVault:c.publicKey,quoteVault:T.publicKey,baseMint:new Me(e.mint),quoteMint:new Me(t.mint)}}):N.sizeCheckBuild({computeBudgetConfig:x,address:{marketId:C.publicKey,requestQueue:S.publicKey,eventQueue:_.publicKey,bids:p.publicKey,asks:u.publicKey,baseVault:c.publicKey,quoteVault:T.publicKey,baseMint:new Me(e.mint),quoteMint:new Me(t.mint)}})}};export{ht as MARKET_STATE_LAYOUT_V2,He as default,zn as initializeMarket,Yt as makeCreateMarketInstruction};
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */
//# sourceMappingURL=index.mjs.map