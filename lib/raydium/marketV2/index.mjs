var Jt=Object.defineProperty,Xt=Object.defineProperties;var Yt=Object.getOwnPropertyDescriptors;var De=Object.getOwnPropertySymbols;var bt=Object.prototype.hasOwnProperty,yt=Object.prototype.propertyIsEnumerable;var ht=(n,e,t)=>e in n?Jt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,O=(n,e)=>{for(var t in e||(e={}))bt.call(e,t)&&ht(n,t,e[t]);if(De)for(var t of De(e))yt.call(e,t)&&ht(n,t,e[t]);return n},J=(n,e)=>Xt(n,Yt(e));var be=(n,e)=>{var t={};for(var r in n)bt.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&De)for(var r of De(n))e.indexOf(r)<0&&yt.call(n,r)&&(t[r]=n[r]);return t};import{PublicKey as Re}from"@solana/web3.js";import Ie from"bn.js";import{TOKEN_PROGRAM_ID as Zt}from"@solana/spl-token";import te from"bn.js";import Ws from"decimal.js";import An from"big.js";import Ss from"bn.js";import{get as xt,set as $t}from"lodash";var ze=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:0,this.name=e.name}set level(e){this.logLevel=e}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let t=e.map(r=>typeof r=="object"?JSON.stringify(r):r).join(", ");throw new Error(t)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},Tt={},en={};function q(n){let e=xt(Tt,n);if(!e){let t=xt(en,n);e=new ze({name:n,logLevel:t}),$t(Tt,n,e)}return e}import{PublicKey as tn}from"@solana/web3.js";import{MINT_SIZE as nr,TOKEN_PROGRAM_ID as rr,getTransferFeeConfig as or,unpackMint as ir}from"@solana/spl-token";var Qe=q("Raydium_accountInfo_util");async function wt(n,e,t){let{batchRequest:r,commitment:s="confirmed",chunkCount:a=100}=O({batchRequest:!1},t),l=Ze(e,a),o=new Array(l.length).fill([]);if(r){let b=l.map(m=>{let T=n._buildArgs([m.map(P=>P.toBase58())],s,"base64");return{methodName:"getMultipleAccounts",args:T}}),w=Ze(b,10);o=(await(await Promise.all(w.map(async m=>await n._rpcBatchRequest(m)))).flat()).map(m=>(m.error&&Qe.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${m.error.message}`),m.result.value.map(T=>{if(T){let{data:P,executable:d,lamports:g,owner:i,rentEpoch:C}=T;return P.length!==2&&P[1]!=="base64"&&Qe.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(P[0],"base64"),executable:d,lamports:g,owner:new tn(i),rentEpoch:C}}return null})))}else try{o=await Promise.all(l.map(b=>n.getMultipleAccountsInfo(b,s)))}catch(b){b instanceof Error&&Qe.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${b.message}`)}return o.flat()}import ye from"bn.js";var Pt=9007199254740991;function X(n){let e=q("Raydium_parseBigNumberish");if(n instanceof ye)return n;if(typeof n=="string"){if(n.match(/^-?[0-9]+$/))return new ye(n);e.logWithError(`invalid BigNumberish string: ${n}`)}return typeof n=="number"?(n%1&&e.logWithError(`BigNumberish number underflow: ${n}`),(n>=Pt||n<=-Pt)&&e.logWithError(`BigNumberish number overflow: ${n}`),new ye(String(n))):typeof n=="bigint"?new ye(n.toString()):(e.error(`invalid BigNumberish value: ${n}`),new ye(0))}import{PublicKey as nn}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as At}from"@solana/spl-token";var St={chainId:101,address:nn.default.toBase58(),programId:At.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},se={chainId:101,address:"So11111111111111111111111111111111111111112",programId:At.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};import{PublicKey as Ye}from"@solana/web3.js";import{PublicKey as F,SystemProgram as Bt,SYSVAR_RENT_PUBKEY as rn}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as on}from"@solana/spl-token";function Xe({pubkey:n,isSigner:e=!1,isWritable:t=!0}){return{pubkey:n,isWritable:t,isSigner:e}}var yr=[Xe({pubkey:on,isWritable:!1}),Xe({pubkey:Bt.programId,isWritable:!1}),Xe({pubkey:rn,isWritable:!1})];function Lt({publicKey:n,transformSol:e}){let t=kt(n.toString());if(t instanceof F)return e&&t.equals(xe)?Je:t;if(e&&t.toString()===xe.toBase58())return Je;if(typeof t=="string"){if(t===F.default.toBase58())return F.default;try{return new F(t)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function kt(n){try{return new F(n)}catch{return n}}var xr=new F("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),Tr=new F("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),wr=new F("SysvarRent111111111111111111111111111111111"),Pr=new F("SysvarC1ock11111111111111111111111111111111"),Ar=new F("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),Sr=new F("Sysvar1nstructions1111111111111111111111111"),Br=Bt.programId,Lr=new F("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),kr=new F("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),Cr=new F("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),Mr=new F("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),Rr=new F("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),Ir=new F("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),Dr=new F("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),Kr=new F("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),Nr=new F("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),Er=new F("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),_r=new F("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),Je=new F("So11111111111111111111111111111111111111112"),xe=F.default;var $e=class{constructor({mint:e,decimals:t,symbol:r,name:s,skipMint:a=!1,isToken2022:l=!1}){if(e===xe.toBase58()||e instanceof Ye&&xe.equals(e)){this.decimals=se.decimals,this.symbol=se.symbol,this.name=se.name,this.mint=new Ye(se.address),this.isToken2022=!1;return}this.decimals=t,this.symbol=r||e.toString().substring(0,6),this.name=s||e.toString().substring(0,6),this.mint=a?Ye.default:Lt({publicKey:e}),this.isToken2022=l}equals(e){return this===e?!0:this.mint.equals(e.mint)}},le=$e;le.WSOL=new $e(J(O({},se),{mint:se.address}));var et=class{constructor({decimals:e,symbol:t="UNKNOWN",name:r="UNKNOWN"}){this.decimals=e,this.symbol=t,this.name=r}equals(e){return this===e}},Ke=et;Ke.SOL=new et(St);import sn from"toformat";var an=sn,Te=an;import Ee from"big.js";import cn from"bn.js";import ln from"decimal.js-light";var Ne=q("module/fraction"),tt=Te(Ee),we=Te(ln),pn={[0]:we.ROUND_DOWN,[1]:we.ROUND_HALF_UP,[2]:we.ROUND_UP},mn={[0]:Ee.roundDown,[1]:Ee.roundHalfUp,[2]:Ee.roundUp},E=class{constructor(e,t=new cn(1)){this.numerator=X(e),this.denominator=X(t)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new E(this.denominator,this.numerator)}add(e){let t=e instanceof E?e:new E(X(e));return this.denominator.eq(t.denominator)?new E(this.numerator.add(t.numerator),this.denominator):new E(this.numerator.mul(t.denominator).add(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}sub(e){let t=e instanceof E?e:new E(X(e));return this.denominator.eq(t.denominator)?new E(this.numerator.sub(t.numerator),this.denominator):new E(this.numerator.mul(t.denominator).sub(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}mul(e){let t=e instanceof E?e:new E(X(e));return new E(this.numerator.mul(t.numerator),this.denominator.mul(t.denominator))}div(e){let t=e instanceof E?e:new E(X(e));return new E(this.numerator.mul(t.denominator),this.denominator.mul(t.numerator))}toSignificant(e,t={groupSeparator:""},r=1){Number.isInteger(e)||Ne.logWithError(`${e} is not an integer.`),e<=0&&Ne.logWithError(`${e} is not positive.`),we.set({precision:e+1,rounding:pn[r]});let s=new we(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return s.toFormat(s.decimalPlaces(),t)}toFixed(e,t={groupSeparator:""},r=1){return Number.isInteger(e)||Ne.logWithError(`${e} is not an integer.`),e<0&&Ne.logWithError(`${e} is negative.`),tt.DP=e,tt.RM=mn[r]||1,new tt(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,t)}isZero(){return this.numerator.isZero()}};import dn from"bn.js";var oo=new E(new dn(100));var lo=q("Raydium_price");function Ze(n,e=1,t=[]){let r=[...n];if(e<=0)return t;for(;r.length;)t.push(r.splice(0,e));return t}var Q=class{constructor(e){this._owner=e}get publicKey(){return Q.isKeyPair(this._owner)?this._owner.publicKey:this._owner}get signer(){return Q.isKeyPair(this._owner)?this._owner:void 0}get isKeyPair(){return Q.isKeyPair(this._owner)}get isPublicKey(){return Q.isPublicKey(this._owner)}static isKeyPair(e){return e.secretKey!==void 0}static isPublicKey(e){return!Q.isKeyPair(e)}};import{PublicKey as Uo}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Ho}from"@solana/spl-token";import{ComputeBudgetProgram as It,Keypair as Kt,PublicKey as No,Transaction as Nt,TransactionMessage as fn,VersionedTransaction as Et}from"@solana/web3.js";var U={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",ClmmLockPosition:"ClmmLockPosition",ClmmHarvestLockPosition:"ClmmHarvestLockPosition",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV4Withdraw:"FarmV4Withdraw",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut",CpmmLockLp:"CpmmLockLp",CpmmCollectLockFee:"CpmmCollectLockFee",TransferTip:"TransferTip"};import{TOKEN_PROGRAM_ID as gn}from"@solana/spl-token";var Dt=q("Raydium_txUtil"),_t=1644;function Pe(n){let e=[],t=[];return n.microLamports&&(e.push(It.setComputeUnitPrice({microLamports:n.microLamports})),t.push(U.SetComputeUnitPrice)),n.units&&(e.push(It.setComputeUnitLimit({units:n.units})),t.push(U.SetComputeUnitLimit)),{instructions:e,instructionTypes:t}}async function ae(n,e){var r,s;let t=e!=null?e:"confirmed";return(s=await((r=n.getLatestBlockhash)==null?void 0:r.call(n,{commitment:t})))==null?void 0:s.blockhash}async function Ae(n,e){return n.getSignatureStatuses([e]),new Promise((t,r)=>{let s=setTimeout(r,6e4);n.onSignature(e,a=>{if(clearTimeout(s),!a.err){t("");return}r(Object.assign(a.err,{txId:e}))},"confirmed")})}function hn(n,e){n.length<1&&Dt.logWithError(`no instructions provided: ${n.toString()}`),e.length<1&&Dt.logWithError(`no signers provided:, ${e.toString()}`);let t=new Nt;t.recentBlockhash="11111111111111111111111111111111",t.feePayer=e[0],t.add(...n);try{return Buffer.from(t.serialize({verifySignatures:!1})).toString("base64").length<_t}catch{return!1}}function Se({instructions:n,payer:e,signers:t}){return hn(n,[e,...t])}function Y({instructions:n,payer:e,lookupTableAddressAccount:t,recentBlockhash:r=Kt.generate().publicKey.toString()}){let a=new fn({payerKey:e,recentBlockhash:r,instructions:n}).compileToV0Message(Object.values(t!=null?t:{}));try{return Buffer.from(new Et(a).serialize()).toString("base64").length<_t}catch{return!1}}var bn=n=>Buffer.isBuffer(n)?n:n instanceof Uint8Array?Buffer.from(n.buffer,n.byteOffset,n.byteLength):Buffer.from(n),yn=n=>{let e=n.serialize({requireAllSignatures:!1,verifySignatures:!1});n instanceof Et&&(e=bn(e));try{return e instanceof Buffer?e.toString("base64"):Buffer.from(e).toString("base64")}catch{return e.toString("base64")}};function ne(n){let e=[];return n.forEach(t=>{t instanceof Nt&&(t.recentBlockhash||(t.recentBlockhash=gn.toBase58()),t.feePayer||(t.feePayer=Kt.generate().publicKey)),e.push(yn(t))}),console.log("simulate tx string:",e),e}import{PublicKey as h}from"@solana/web3.js";var Zo=new h("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),Jo=new h("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),Xo=new h("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),Yo=new h("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),$o=new h("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),ei=new h("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),ti=new h("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),ni=new h("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),ri=new h("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),oi=new h("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),ii=new h("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),si=new h("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),ai=new h("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),ui=new h("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),ci=new h("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),li=new h("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),pi=new h("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),mi=new h("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),di=new h("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),fi=new h("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),gi=new h("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),hi=new h("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),bi=new h("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),yi=new h("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),xi=new h("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),Ti=new h("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),wi=new h("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),Pi=new h("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),Ai=new h("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),Si=new h("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),Bi=new h("6s1xP3hpbAfFoNtUNF8mfHsjr2Bd97JxFJRWLbL6aHuX");var Li={OPEN_BOOK_PROGRAM:new h("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),SERUM_PROGRAM_ID_V3:new h("Ray1111111111111111111111111111111111111111"),AMM_V4:new h("DRaya7Kj3aMWQSy19kSjvmuwq9docCHofyP9kanQGaav"),AMM_STABLE:new h("DRayDdXc1NZQ9C3hRWmoSf8zK4iapgMnjdNZWrfwsP8m"),CLMM_PROGRAM_ID:new h("DRayAUgENGQBKVaX8owNhgzkEDyoHTGVEGHVJT1E9pfH"),CLMM_LOCK_PROGRAM_ID:new h("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),CLMM_LOCK_AUTH_ID:new h("6Aoh8h2Lw2m5UGxYR8AdAL87jTWYeKoxM52mJRzfYwN"),CREATE_CPMM_POOL_PROGRAM:new h("DRaycpLY18LhpbydsBWbVJtxpNv9oXPgjRSfpF2bWpYb"),CREATE_CPMM_POOL_AUTH:new h("CXniRufdq5xL8t8jZAPxsPZDpuudwuJSPWnbcD5Y5Nxq"),CREATE_CPMM_POOL_FEE_ACC:new h("3oE58BKVt8KuYkGxx8zBojugnymWmBiyafWgMrnb6eYy"),LOCK_CPMM_PROGRAM:new h("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),LOCK_CPMM_AUTH:new h("7qWVV8UY2bRJfDLP4s37YzBPKUkVB46DStYJBpYbQzu3"),UTIL1216:h.default,Router:new h("DRaybByLpbUL57LJARs3j8BitTxVfzBg351EaMr5UTCd"),FARM_PROGRAM_ID_V3:new h("DRayWyrLmEW5KEeqs8kdTMMaBabapqagaBC7KWpGtJeZ"),FARM_PROGRAM_ID_V4:new h("Ray1111111111111111111111111111111111111111"),FARM_PROGRAM_ID_V5:new h("DRayiCGSZgku1GTK6rXD6mVDdingXy6APAH1R6R5L2LC"),FARM_PROGRAM_ID_V6:new h("DRayzbYakXs45ELHkzH6vC3fuhQqTAnv5A68gdFuvZyZ"),LAUNCHPAD_PROGRAM:new h("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),LAUNCHPAD_AUTH:new h("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),LAUNCHPAD_PLATFORM:new h("2Jx4KTDrVSdWNazuGpcA8n3ZLTRGGBDxAWhuKe2Xcj2a"),LAUNCHPAD_CONFIG:new h("7ZR4zD7PYfY2XxoG1Gxcy2EgEeGYrpxrwzPuwdUBssEt"),FEE_DESTINATION_ID:new h("9y8ENuuZ3b19quffx9hQvRVygG5ky6snHfRvGpuSfeJy"),MODEL_DATA_PUBKEY:new h("Ray1111111111111111111111111111111111111111")};import Mi from"bn.js";import{PublicKey as nt,AddressLookupTableAccount as me}from"@solana/web3.js";async function Fe({connection:n,address:e,cluster:t="mainnet"}){let r=await wt(n,[...new Set(e.map(a=>a.toString()))].map(a=>new nt(a))),s={};for(let a=0;a<e.length;a++){let l=r[a],o=e[a];if(!l)continue;let b=new me({key:o,state:me.deserialize(l.data)});s[o.toString()]=b,t==="devnet"?pe[o.toString()]=b:Be[o.toString()]=b}return s}var Be={AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU:new me({key:new nt("AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU"),state:me.deserialize(Buffer.from("AQAAAP//////////I1rcEwAAAAAvAQYwun9CU6c5Ikm2pAj+D9IEnCOR45nK+SFTGSdpd6J6AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbd9uHXZaGT2cvhRs7reawctIXtX1s3kTqM9YV+/wCpBt324e51j94YQl285GzN2rYa/E2DuQ0n/r35KNihi/wFSlNQ+F3IgtYUpVZyeIopbd8eq6vQpgZ4iEky9O72oAVKU1qZKSEGTSTocWDaOHx8NbXdvJK7geQfqEBBBUSNBqfVFxksXFEhjMlMPUrxf1ja7gibof1E49vZigAAAAAGp9UXGMd0yShWY5hpHV62i164o5tLbVxzVVshAAAAAIyXJY9OJInxuz0QKRSODYMLWhOZ2v8QhASOe9jb6fhZC3BlsePRfEU4nVJ/awTDzVi4bHMaoP21SbbRvAP4KUbIScv+6Yw2LHF/6K0ZjUPibbSWXCirYPGuuVl7zT789IUPLW4CpHr4JNCatp3ELXDLKMv6JJ+37le50lbBJ2LvBkX2T9y7AHdNGviJAqQNtlDUDCnauQRWybsLji6nPM8Qkw5asQRvCdB3MbX6IEBwytOrpM32l4jQygKG9TKgR0vZScQ2AsM/IHeQ7RajUkyhuZdc8SGiqQz/7H34torNR/Wir3sl0ruUrVxJWEZfUg+QLNAxxODdBi53/OP7Ioil1cqeBM9dtZC3FLov4yyxWRM/wcGStyJX/QfTnLBAHqkqWotPKVlShCVQqpP9W5W1rOao65IMk5QuQ2kMIOxzDMKAy2vjGSxQODgBz0QwGA+eP4ZjIjrIAQaXENv31QfLlOdXSRCkaybRniDHF4C8YcwhcvsqrOVuTP4B2Na+9wLdtrB31uz2rtlFI5kahdsnp/d1SrASDInYCtTYtdoke4kX+hoKWcEWM4Tle8pTUkUVv4BxS6fje/EzKBE4Qu/YsA/yfEEFGcr8Z57VKDw8uQzpiru7g4lvjnfapW62W030syevD8k07SGoxUHiuT/ai7gAHWWhDsVmg/C63ajgpkH7Sn3GdutArDTfyqOkdqv4/IPC/EFFy7mGkfDd2C57N5a/4jC+BbmJy7wQaSEZr0CQU88lPtUxIVvzGjC95b8Ooss2TqmkrayGKofkPMGQn7Ux+9lfwBSNfxwH8NgbpqC/7LNlV4I7nCvsXf3p+ohQk9NrAJb2KAFpUqEIJ9ZBV7BYDzHF/ORKYlgtvPnXjudZQ6CEo5OzUDaNIomTCCsvhD16TxJjsbgne1kGnQPCFSoaxUbq2V1bPMFQ3VYP6wDZ9bKStCFKx9A3tNbwZFC5ZGAN83MFK7XoTy+OmmcFEr6rLOjfSuTfPvHJkSVxW6Qllwkl67XcBi5v00u2gQsbu+38sp+rd5pA/LvyWj4P94ZGZwc1tE2P88xekCLcAwZGb+UhFzL/7K26csOb57yM5bvF9xJrLEObOkAAAAAn+HWRkdcPKyFFMnVwEoD7vnD0jCKFIU1sImubYCxNTSVzsKpaQX+fzNxrLAI3L14JQnJx/D6Uk2LADIHGqnGELzjEbkBDAlaM77NkXMPfqXNLSveCkWI7UEgNs31WEWB6XHSYI/v5DklHOb4QTtDOR804PVbi3fjloZeLR2F8d4FuZmMMO7ck3Fnkn2zEMG5gOmqsygb6PjTitArVl52NhcSznTxVnguaIJxiZkAnurDmn3MWR0PC2GLghp2KJqHCc6QQ85odeIjFHKOlRlJyeSXVJmL8vb1UgOzsbJPVP8p6zM4M3C1Sd7uWIHP33G42AP2Zg8ucn/n6meQjjD266JgCWdxZD6PXs9CsnIeL7SSG0/6lGb9xfP0ZcWkCXB/3hjxHYVXjra/GPOeXGk0fLLKjCbk+mgs2w6d2oCwimBipTzuoZ30GiI8ij8VRzD5CzMWtu2m21eDBIfjGAEo4pQeNNonKcqzV/cleX8ySZLOHsz8PtBCrLqF+VkLm9hOzIT+6i/nIf6keR4GWKMOD4AvqfpjHoD4DuhBpz8P28+DxkGrDXXr/nr20x291VPvcTU/b+b+o2kC9G0kcXeTlLjU6a2TQXWlZ4gBUdBl1jgT7mObSTpLblNiXZsLkbmVXZwvFKXua5cUKlWed/w30skmEUraTuQqtqr5fHZPW9n57EmeTif6LjHL2YJFZkQU+TrJmFzqzmF4/b8OwrPQAprl8mX3q4LUIdAS/a+11B6DWD1Xk2++Sn94dLC4xjkO4Wtlw8c4XuzciVbepHOmnoWzVu/0y3KCrLCSfQxQ3br8DJCoVzhgtPsS2nZZjsBGIZgnU0QpMv+2MnRsnKwdp1VsrCX84j/qvaZn4WhKunippgTbN2EUs0tPTP55Qfgj+nKmjtWW5IYs72FrEwJKYoNfsmqaF4o5pf4v9zgPwVwY/5I4XJKUL2L25m9kAQcW/K+H1RTFEUoj8Z4ajpOmAB/dG0COmCphVMW2CCMvnxhcGiSgPnpDuWu6qiJ7NG7ye5kvHgefgqPLeicspNJ5EpL3XiRNLM2tmJLI1awAwOyd6iHv0dCkMYRKaa6rcaZeYwmKCkckm0kM2JNmnmmAaBQQ7mwmIM0IMxX4f5W6j9PqZWcJxF7r17T/lQBAmcjoupRiJifbnXCNUv9GhpRF19WcBdeKbivRJVlGop6I2RS6lGImJ9udcI1S/0aGlEXX1ZwF14puK9ElWUainojZFYVHLHD6dIP2ESjqBzg3ol1/wB7+/ylGwd9LS7wSZ2A630CJSVKwH47K9P4bB8PEQP8BwjMFa7xQHOqZFP1XqaQ==","base64"))})},pe={},Ve=async n=>{let e="EFhMuDw1PKEuckuFRW9PavNfTH4LKP5uKHgyXDmWpFCq";if(pe[e])return pe;let t=new nt(e),r=await n.getAccountInfo(t);return r&&(pe[e]=new me({key:t,state:me.deserialize(r.data)})),pe};import{PublicKey as ue,sendAndConfirmTransaction as rt,SystemProgram as Tn,Transaction as Le,TransactionMessage as $,VersionedTransaction as ee}from"@solana/web3.js";import wn from"axios";var ke=2e3,Ce=class{constructor(e){this.instructions=[];this.endInstructions=[];this.lookupTableAddress=[];this.signers=[];this.instructionTypes=[];this.endInstructionTypes=[];this.connection=e.connection,this.feePayer=e.feePayer,this.signAllTransactions=e.signAllTransactions,this.owner=e.owner,this.cluster=e.cluster,this.blockhashCommitment=e.blockhashCommitment,this.loopMultiTxStatus=!!e.loopMultiTxStatus}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers,instructionTypes:this.instructionTypes,endInstructionTypes:this.endInstructionTypes,lookupTableAddress:this.lookupTableAddress}}get allInstructions(){return[...this.instructions,...this.endInstructions]}async getComputeBudgetConfig(){var r;let e=(await wn.get(`https://solanacompass.com/api/fees?cacheFreshTime=${3e5}`)).data,{avg:t}=(r=e==null?void 0:e[15])!=null?r:{};if(!!t)return{units:6e5,microLamports:Math.min(Math.ceil(t*1e6/6e5),25e3)}}addCustomComputeBudget(e){if(e){let{instructions:t,instructionTypes:r}=Pe(e);return this.instructions.unshift(...t),this.instructionTypes.unshift(...r),!0}return!1}addTipInstruction(e){var t;return e?(this.endInstructions.push(Tn.transfer({fromPubkey:(t=e.feePayer)!=null?t:this.feePayer,toPubkey:new ue(e.address),lamports:BigInt(e.amount.toString())})),this.endInstructionTypes.push(U.TransferTip),!0):!1}async calComputeBudget({config:e,defaultIns:t}){try{let r=e||await this.getComputeBudgetConfig();if(this.addCustomComputeBudget(r))return;t&&this.instructions.unshift(...t)}catch{t&&this.instructions.unshift(...t)}}addInstruction({instructions:e=[],endInstructions:t=[],signers:r=[],instructionTypes:s=[],endInstructionTypes:a=[],lookupTableAddress:l=[]}){return this.instructions.push(...e),this.endInstructions.push(...t),this.signers.push(...r),this.instructionTypes.push(...s),this.endInstructionTypes.push(...a),this.lookupTableAddress.push(...l.filter(o=>o!==ue.default.toString())),this}async versionBuild({txVersion:e,extInfo:t}){return e===0?await this.buildV0(O({},t||{})):this.build(t)}build(e){var r;let t=new Le;return this.allInstructions.length&&t.add(...this.allInstructions),t.feePayer=this.feePayer,((r=this.owner)==null?void 0:r.signer)&&!this.signers.some(s=>s.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer),{builder:this,transaction:t,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async s=>{var y;let{recentBlockHash:a,skipPreflight:l=!0,sendAndConfirm:o,notSendToRpc:b}=s||{},w=a!=null?a:await ae(this.connection,this.blockhashCommitment);if(t.recentBlockhash=w,this.signers.length&&t.sign(...this.signers),ne([t]),(y=this.owner)!=null&&y.isKeyPair)return{txId:o?await rt(this.connection,t,this.signers.find(T=>T.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:l}):await this.connection.sendRawTransaction(t.serialize(),{skipPreflight:l}),signedTx:t};if(this.signAllTransactions){let m=await this.signAllTransactions([t]);if(this.signers.length)for(let T of m)try{T.sign(...this.signers)}catch{}return{txId:b?"":await this.connection.sendRawTransaction(m[0].serialize(),{skipPreflight:l}),signedTx:m[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:e||{}}}buildMultiTx(e){var w;let{extraPreBuildData:t=[],extInfo:r}=e,{transaction:s}=this.build(r),a=t.filter(y=>y.transaction.instructions.length>0),l=[s,...a.map(y=>y.transaction)],o=[this.signers,...a.map(y=>y.signers)],b=[...this.instructionTypes,...a.map(y=>y.instructionTypes).flat()];return(w=this.owner)!=null&&w.signer&&o.forEach(y=>{y.some(m=>m.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),{builder:this,transactions:l,signers:o,instructionTypes:b,execute:async y=>{var C;let{sequentially:m,onTxUpdate:T,skipTxCount:P=0,recentBlockHash:d,skipPreflight:g=!0}=y||{},i=d!=null?d:await ae(this.connection,this.blockhashCommitment);if((C=this.owner)!=null&&C.isKeyPair){if(m){let A=[],I=0;for(let p of l){if(++I,I<=P)continue;let u=await rt(this.connection,p,this.signers.find(c=>c.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:g});A.push(u)}return{txIds:A,signedTxs:l}}return{txIds:await await Promise.all(l.map(async A=>(A.recentBlockhash=i,await this.connection.sendRawTransaction(A.serialize(),{skipPreflight:g})))),signedTxs:l}}if(this.signAllTransactions){let A=l.map((p,u)=>(p.recentBlockhash=i,o[u].length&&p.sign(...o[u]),p));ne(A);let I=await this.signAllTransactions(A);if(m){let p=0,u=[],c=async()=>{if(!I[p])return;let x=await this.connection.sendRawTransaction(I[p].serialize(),{skipPreflight:g});u.push({txId:x,status:"sent",signedTx:I[p]}),T==null||T([...u]),p++;let f=!1,L=null,K=null,D=S=>{L!==null&&clearInterval(L),K!==null&&this.connection.removeSignatureListener(K);let B=u.findIndex(k=>k.txId===x);if(B>-1){if(u[B].status==="error"||u[B].status==="success")return;u[B].status=S.err?"error":"success"}T==null||T([...u]),S.err||c()};this.loopMultiTxStatus&&(L=setInterval(async()=>{var S;if(f){clearInterval(L);return}try{let B=await this.connection.getTransaction(x,{commitment:"confirmed",maxSupportedTransactionVersion:0});B&&(f=!0,clearInterval(L),D({err:((S=B.meta)==null?void 0:S.err)||null}),console.log("tx status from getTransaction:",x))}catch(B){f=!0,clearInterval(L),console.error("getTransaction timeout:",B,x)}},ke)),K=this.connection.onSignature(x,S=>{if(f){this.connection.removeSignatureListener(K);return}f=!0,D(S)},"confirmed"),this.connection.getSignatureStatus(x)};return await c(),{txIds:u.map(x=>x.txId),signedTxs:I}}else{let p=[];for(let u=0;u<I.length;u+=1){let c=await this.connection.sendRawTransaction(I[u].serialize(),{skipPreflight:g});p.push(c)}return{txIds:p,signedTxs:I}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async versionMultiBuild({extraPreBuildData:e,txVersion:t,extInfo:r}){return t===0?await this.buildV0MultiTx({extraPreBuildData:e,buildProps:r||{}}):this.buildMultiTx({extraPreBuildData:e,extInfo:r})}async buildV0(e){var g;let d=e||{},{lookupTableCache:t={},lookupTableAddress:r=[],forerunCreate:s,recentBlockhash:a}=d,l=be(d,["lookupTableCache","lookupTableAddress","forerunCreate","recentBlockhash"]),o=O(O({},this.cluster==="devnet"?await Ve(this.connection):Be),t),b=Array.from(new Set([...r,...this.lookupTableAddress])),w=[];for(let i of b)o[i]===void 0&&w.push(new ue(i));let y=await Fe({connection:this.connection,address:w});for(let[i,C]of Object.entries(y))o[i]=C;let m=s?ue.default.toBase58():a!=null?a:await ae(this.connection,this.blockhashCommitment),T=new $({payerKey:this.feePayer,recentBlockhash:m,instructions:[...this.allInstructions]}).compileToV0Message(Object.values(o));((g=this.owner)==null?void 0:g.signer)&&!this.signers.some(i=>i.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer);let P=new ee(T);return P.sign(this.signers),{builder:this,transaction:P,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async i=>{var p;let{skipPreflight:C=!0,sendAndConfirm:A,notSendToRpc:I}=i||{};if(ne([P]),(p=this.owner)!=null&&p.isKeyPair){let u=await this.connection.sendTransaction(P,{skipPreflight:C});return A&&await Ae(this.connection,u),{txId:u,signedTx:P}}if(this.signAllTransactions){let u=await this.signAllTransactions([P]);if(this.signers.length)for(let c of u)try{c.sign(this.signers)}catch{}return{txId:I?"":await this.connection.sendTransaction(u[0],{skipPreflight:C}),signedTx:u[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:l||{}}}async buildV0MultiTx(e){var w;let{extraPreBuildData:t=[],buildProps:r}=e,{transaction:s}=await this.buildV0(r),a=t.filter(y=>y.builder.instructions.length>0),l=[s,...a.map(y=>y.transaction)],o=[this.signers,...a.map(y=>y.signers)],b=[...this.instructionTypes,...a.map(y=>y.instructionTypes).flat()];return(w=this.owner)!=null&&w.signer&&o.forEach(y=>{y.some(m=>m.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),l.forEach(async(y,m)=>{y.sign(o[m])}),{builder:this,transactions:l,signers:o,instructionTypes:b,buildProps:r,execute:async y=>{var g;let{sequentially:m,onTxUpdate:T,recentBlockHash:P,skipPreflight:d=!0}=y||{};if(P&&l.forEach(i=>i.message.recentBlockhash=P),ne(l),(g=this.owner)!=null&&g.isKeyPair){if(m){let i=[];for(let C of l){let A=await this.connection.sendTransaction(C,{skipPreflight:d});await Ae(this.connection,A),i.push(A)}return{txIds:i,signedTxs:l}}return{txIds:await Promise.all(l.map(async i=>await this.connection.sendTransaction(i,{skipPreflight:d}))),signedTxs:l}}if(this.signAllTransactions){let i=await this.signAllTransactions(l);if(m){let C=0,A=[],I=async()=>{if(!i[C])return;let p=await this.connection.sendTransaction(i[C],{skipPreflight:d});A.push({txId:p,status:"sent",signedTx:i[C]}),T==null||T([...A]),C++;let u=!1,c=null,x=null,f=L=>{c!==null&&clearInterval(c),x!==null&&this.connection.removeSignatureListener(x);let K=A.findIndex(D=>D.txId===p);if(K>-1){if(A[K].status==="error"||A[K].status==="success")return;A[K].status=L.err?"error":"success"}T==null||T([...A]),L.err||I()};this.loopMultiTxStatus&&(c=setInterval(async()=>{var L;if(u){clearInterval(c);return}try{let K=await this.connection.getTransaction(p,{commitment:"confirmed",maxSupportedTransactionVersion:0});K&&(u=!0,clearInterval(c),f({err:((L=K.meta)==null?void 0:L.err)||null}),console.log("tx status from getTransaction:",p))}catch(K){u=!0,clearInterval(c),console.error("getTransaction timeout:",K,p)}},ke)),x=this.connection.onSignature(p,L=>{if(u){this.connection.removeSignatureListener(x);return}u=!0,f(L)},"confirmed"),this.connection.getSignatureStatus(p)};return I(),{txIds:[],signedTxs:i}}else{let C=[];for(let A=0;A<i.length;A+=1){let I=await this.connection.sendTransaction(i[A],{skipPreflight:d});C.push(I)}return{txIds:C,signedTxs:i}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async sizeCheckBuild(e){var T;let m=e||{},{splitIns:t=[],computeBudgetConfig:r}=m,s=be(m,["splitIns","computeBudgetConfig"]),a=r?Pe(r):{instructions:[],instructionTypes:[]},l=this.signers.reduce((P,d)=>J(O({},P),{[d.publicKey.toBase58()]:d}),{}),o=[],b=[],w=[],y=0;if(this.allInstructions.forEach(P=>{let d=[...w,P],g=r?[...a.instructions,...d]:d,C=[...new Set(d.map(A=>A.keys.filter(I=>I.isSigner).map(I=>I.pubkey.toString())).flat()).values()].map(A=>new ue(A));if(P!==t[y]&&w.length<12&&(Se({instructions:g,payer:this.feePayer,signers:C})||Se({instructions:d,payer:this.feePayer,signers:C})))w.push(P);else{if(w.length===0)throw Error("item ins too big");y+=P===t[y]?1:0,Se({instructions:r?[...a.instructions,...w]:[...w],payer:this.feePayer,signers:C})?o.push(new Le().add(...a.instructions,...w)):o.push(new Le().add(...w)),b.push(Array.from(new Set(w.map(A=>A.keys.filter(I=>I.isSigner).map(I=>I.pubkey.toString())).flat())).map(A=>l[A]).filter(A=>A!==void 0)),w=[P]}}),w.length>0){let d=[...new Set(w.map(g=>g.keys.filter(i=>i.isSigner).map(i=>i.pubkey.toString())).flat()).values()].map(g=>l[g]).filter(g=>g!==void 0);Se({instructions:r?[...a.instructions,...w]:[...w],payer:this.feePayer,signers:d.map(g=>g.publicKey)})?o.push(new Le().add(...a.instructions,...w)):o.push(new Le().add(...w)),b.push(d)}return o.forEach(P=>P.feePayer=this.feePayer),(T=this.owner)!=null&&T.signer&&b.forEach(P=>{P.some(d=>d.publicKey.equals(this.owner.publicKey))||P.push(this.owner.signer)}),{builder:this,transactions:o,signers:b,instructionTypes:this.instructionTypes,execute:async P=>{var p;let{sequentially:d,onTxUpdate:g,skipTxCount:i=0,recentBlockHash:C,skipPreflight:A=!0}=P||{},I=C!=null?C:await ae(this.connection,this.blockhashCommitment);if(o.forEach(async(u,c)=>{u.recentBlockhash=I,b[c].length&&u.sign(...b[c])}),ne(o),(p=this.owner)!=null&&p.isKeyPair){if(d){let u=0,c=[];for(let x of o){if(++u,u<=i){c.push("tx skipped");continue}let f=await rt(this.connection,x,this.signers.find(L=>L.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:A});c.push(f)}return{txIds:c,signedTxs:o}}return{txIds:await Promise.all(o.map(async u=>await this.connection.sendRawTransaction(u.serialize(),{skipPreflight:A}))),signedTxs:o}}if(this.signAllTransactions){let u=await this.signAllTransactions(o.slice(i,o.length)),c=[...o.slice(0,i),...u];if(d){let x=0,f=[],L=async()=>{if(!c[x])return;x<i&&(f.push({txId:"",status:"success",signedTx:c[x]}),g==null||g([...f]),x++,L());let K=await this.connection.sendRawTransaction(c[x].serialize(),{skipPreflight:A});f.push({txId:K,status:"sent",signedTx:c[x]}),g==null||g([...f]),x++;let D=!1,S=null,B=null,k=_=>{S!==null&&clearInterval(S),B!==null&&this.connection.removeSignatureListener(B);let N=f.findIndex(V=>V.txId===K);if(N>-1){if(f[N].status==="error"||f[N].status==="success")return;f[N].status=_.err?"error":"success"}g==null||g([...f]),_.err||L()};this.loopMultiTxStatus&&(S=setInterval(async()=>{var _;if(D){clearInterval(S);return}try{let N=await this.connection.getTransaction(K,{commitment:"confirmed",maxSupportedTransactionVersion:0});N&&(D=!0,clearInterval(S),k({err:((_=N.meta)==null?void 0:_.err)||null}),console.log("tx status from getTransaction:",K))}catch(N){D=!0,clearInterval(S),console.error("getTransaction timeout:",N,K)}},ke)),B=this.connection.onSignature(K,_=>{if(D){this.connection.removeSignatureListener(B);return}D=!0,k(_)},"confirmed"),this.connection.getSignatureStatus(K)};return await L(),{txIds:f.map(K=>K.txId),signedTxs:c}}else{let x=[];for(let f=0;f<c.length;f+=1){let L=await this.connection.sendRawTransaction(c[f].serialize(),{skipPreflight:A});x.push(L)}return{txIds:x,signedTxs:c}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:s||{}}}async sizeCheckBuildV0(e){var I;let A=e||{},{computeBudgetConfig:t,splitIns:r=[],lookupTableCache:s={},lookupTableAddress:a=[]}=A,l=be(A,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),o=O(O({},this.cluster==="devnet"?await Ve(this.connection):Be),s),b=Array.from(new Set([...this.lookupTableAddress,...a])),w=[];for(let p of b)o[p]===void 0&&w.push(new ue(p));let y=await Fe({connection:this.connection,address:w});for(let[p,u]of Object.entries(y))o[p]=u;let m=t?Pe(t):{instructions:[],instructionTypes:[]},T=await ae(this.connection,this.blockhashCommitment),P=this.signers.reduce((p,u)=>J(O({},p),{[u.publicKey.toBase58()]:u}),{}),d=[],g=[],i=[],C=0;if(this.allInstructions.forEach(p=>{let u=[...i,p],c=t?[...m.instructions,...u]:u;if(p!==r[C]&&i.length<12&&(Y({instructions:c,payer:this.feePayer,lookupTableAddressAccount:o})||Y({instructions:u,payer:this.feePayer,lookupTableAddressAccount:o})))i.push(p);else{if(i.length===0)throw Error("item ins too big");C+=p===r[C]?1:0;let x={};for(let f of[...new Set(b)])o[f]!==void 0&&(x[f]=o[f]);if(t&&Y({instructions:[...m.instructions,...i],payer:this.feePayer,lookupTableAddressAccount:o,recentBlockhash:T})){let f=new $({payerKey:this.feePayer,recentBlockhash:T,instructions:[...m.instructions,...i]}).compileToV0Message(Object.values(o));d.push(new ee(f))}else{let f=new $({payerKey:this.feePayer,recentBlockhash:T,instructions:[...i]}).compileToV0Message(Object.values(o));d.push(new ee(f))}g.push(Array.from(new Set(i.map(f=>f.keys.filter(L=>L.isSigner).map(L=>L.pubkey.toString())).flat())).map(f=>P[f]).filter(f=>f!==void 0)),i=[p]}}),i.length>0){let u=[...new Set(i.map(c=>c.keys.filter(x=>x.isSigner).map(x=>x.pubkey.toString())).flat()).values()].map(c=>P[c]).filter(c=>c!==void 0);if(t&&Y({instructions:[...m.instructions,...i],payer:this.feePayer,lookupTableAddressAccount:o,recentBlockhash:T})){let c=new $({payerKey:this.feePayer,recentBlockhash:T,instructions:[...m.instructions,...i]}).compileToV0Message(Object.values(o));d.push(new ee(c))}else{let c=new $({payerKey:this.feePayer,recentBlockhash:T,instructions:[...i]}).compileToV0Message(Object.values(o));d.push(new ee(c))}g.push(u)}return(I=this.owner)!=null&&I.signer&&g.forEach(p=>{p.some(u=>u.publicKey.equals(this.owner.publicKey))||p.push(this.owner.signer)}),d.forEach((p,u)=>{p.sign(g[u])}),{builder:this,transactions:d,buildProps:e,signers:g,instructionTypes:this.instructionTypes,execute:async p=>{var K;let{sequentially:u,onTxUpdate:c,skipTxCount:x=0,recentBlockHash:f,skipPreflight:L=!0}=p||{};if(d.map(async(D,S)=>{g[S].length&&D.sign(g[S]),f&&(D.message.recentBlockhash=f)}),ne(d),(K=this.owner)!=null&&K.isKeyPair){if(u){let D=0,S=[];for(let B of d){if(++D,D<=x){console.log("skip tx: ",D),S.push("tx skipped");continue}let k=await this.connection.sendTransaction(B,{skipPreflight:L});await Ae(this.connection,k),S.push(k)}return{txIds:S,signedTxs:d}}return{txIds:await Promise.all(d.map(async D=>await this.connection.sendTransaction(D,{skipPreflight:L}))),signedTxs:d}}if(this.signAllTransactions){let D=await this.signAllTransactions(d.slice(x,d.length)),S=[...d.slice(0,x),...D];if(u){let B=0,k=[],_=async()=>{if(!S[B])return;if(B<x){k.push({txId:"",status:"success",signedTx:S[B]}),c==null||c([...k]),B++,_();return}let N=await this.connection.sendTransaction(S[B],{skipPreflight:L});k.push({txId:N,status:"sent",signedTx:S[B]}),c==null||c([...k]),B++;let V=!1,G=null,Z=null,he=H=>{G!==null&&clearInterval(G),Z!==null&&this.connection.removeSignatureListener(Z);let W=k.findIndex(je=>je.txId===N);if(W>-1){if(k[W].status==="error"||k[W].status==="success")return;k[W].status=H.err?"error":"success"}c==null||c([...k]),H.err||_()};this.loopMultiTxStatus&&(G=setInterval(async()=>{var H;if(V){clearInterval(G);return}try{let W=await this.connection.getTransaction(N,{commitment:"confirmed",maxSupportedTransactionVersion:0});W&&(V=!0,clearInterval(G),he({err:((H=W.meta)==null?void 0:H.err)||null}),console.log("tx status from getTransaction:",N))}catch(W){V=!0,clearInterval(G),console.error("getTransaction timeout:",W,N)}},ke)),Z=this.connection.onSignature(N,H=>{if(V){this.connection.removeSignatureListener(Z);return}V=!0,he(H)},"confirmed"),this.connection.getSignatureStatus(N)};return _(),{txIds:[],signedTxs:S}}else{let B=[];for(let k=0;k<S.length;k+=1){let _=await this.connection.sendTransaction(S[k],{skipPreflight:L});B.push(_)}return{txIds:B,signedTxs:S}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:l||{}}}async buildSniperTransaction(e){var I;let A=e||{},{computeBudgetConfig:t,splitIns:r=[],lookupTableCache:s={},lookupTableAddress:a=[]}=A,l=be(A,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),o=O(O({},this.cluster==="devnet"?await Ve(this.connection):Be),s),b=Array.from(new Set([...this.lookupTableAddress,...a])),w=[];for(let p of b)o[p]===void 0&&w.push(new ue(p));let y=await Fe({connection:this.connection,address:w});for(let[p,u]of Object.entries(y))o[p]=u;let m=t?Pe(t):{instructions:[],instructionTypes:[]},T=await ae(this.connection,this.blockhashCommitment),P=this.signers.reduce((p,u)=>J(O({},p),{[u.publicKey.toBase58()]:u}),{}),d=[],g=[],i=[],C=0;if(this.allInstructions.forEach(p=>{let u=[...i,p],c=t?[...m.instructions,...u]:u;if(p!==r[C]&&i.length<12&&(Y({instructions:c,payer:this.feePayer,lookupTableAddressAccount:o})||Y({instructions:u,payer:this.feePayer,lookupTableAddressAccount:o})))i.push(p);else{if(i.length===0)throw Error("item ins too big");C+=p===r[C]?1:0;let x={};for(let f of[...new Set(b)])o[f]!==void 0&&(x[f]=o[f]);if(t&&Y({instructions:[...m.instructions,...i],payer:this.feePayer,lookupTableAddressAccount:o,recentBlockhash:T})){let f=new $({payerKey:this.feePayer,recentBlockhash:T,instructions:[...m.instructions,...i]}).compileToV0Message(Object.values(o));d.push(new ee(f))}else{let f=new $({payerKey:this.feePayer,recentBlockhash:T,instructions:[...i]}).compileToV0Message(Object.values(o));d.push(new ee(f))}g.push(Array.from(new Set(i.map(f=>f.keys.filter(L=>L.isSigner).map(L=>L.pubkey.toString())).flat())).map(f=>P[f]).filter(f=>f!==void 0)),i=[p]}}),i.length>0){let u=[...new Set(i.map(c=>c.keys.filter(x=>x.isSigner).map(x=>x.pubkey.toString())).flat()).values()].map(c=>P[c]).filter(c=>c!==void 0);if(t&&Y({instructions:[...m.instructions,...i],payer:this.feePayer,lookupTableAddressAccount:o,recentBlockhash:T})){let c=new $({payerKey:this.feePayer,recentBlockhash:T,instructions:[...m.instructions,...i]}).compileToV0Message(Object.values(o));d.push(new ee(c))}else{let c=new $({payerKey:this.feePayer,recentBlockhash:T,instructions:[...i]}).compileToV0Message(Object.values(o));d.push(new ee(c))}g.push(u)}return(I=this.owner)!=null&&I.signer&&g.forEach(p=>{p.some(u=>u.publicKey.equals(this.owner.publicKey))||p.push(this.owner.signer)}),d.forEach((p,u)=>{p.sign(g[u])}),{builder:this,transactions:d,buildProps:e,signers:g,instructionTypes:this.instructionTypes,execute:async p=>{var K;let{sequentially:u,onTxUpdate:c,skipTxCount:x=0,recentBlockHash:f,skipPreflight:L=!0}=p||{};if(d.map(async(D,S)=>{g[S].length&&D.sign(g[S]),f&&(D.message.recentBlockhash=f)}),ne(d),(K=this.owner)!=null&&K.isKeyPair){if(u){let D=0,S=[];for(let B of d){if(++D,D<=x){console.log("skip tx: ",D),S.push("tx skipped");continue}let k=await this.connection.sendTransaction(B,{skipPreflight:L});await Ae(this.connection,k),S.push(k)}return{txIds:S,signedTxs:d}}return{txIds:await Promise.all(d.map(async D=>await this.connection.sendTransaction(D,{skipPreflight:L}))),signedTxs:d}}if(this.signAllTransactions){let D=await this.signAllTransactions(d.slice(x,d.length)),S=[...d.slice(0,x),...D];if(u){let B=0,k=[],_=async()=>{if(!S[B])return;if(B<x){k.push({txId:"",status:"success",signedTx:S[B]}),c==null||c([...k]),B++,_();return}let N=await this.connection.sendTransaction(S[B],{skipPreflight:L});k.push({txId:N,status:"sent",signedTx:S[B]}),c==null||c([...k]),B++;let V=!1,G=null,Z=null,he=H=>{G!==null&&clearInterval(G),Z!==null&&this.connection.removeSignatureListener(Z);let W=k.findIndex(je=>je.txId===N);if(W>-1){if(k[W].status==="error"||k[W].status==="success")return;k[W].status=H.err?"error":"success"}c==null||c([...k]),H.err||_()};this.loopMultiTxStatus&&(G=setInterval(async()=>{var H;if(V){clearInterval(G);return}try{let W=await this.connection.getTransaction(N,{commitment:"confirmed",maxSupportedTransactionVersion:0});W&&(V=!0,clearInterval(G),he({err:((H=W.meta)==null?void 0:H.err)||null}),console.log("tx status from getTransaction:",N))}catch(W){V=!0,clearInterval(G),console.error("getTransaction timeout:",W,N)}},ke)),Z=this.connection.onSignature(N,H=>{if(V){this.connection.removeSignatureListener(Z);return}V=!0,he(H)},"confirmed"),this.connection.getSignatureStatus(N)};return _(),{txIds:[],signedTxs:S}}else{let B=[];for(let k=0;k<S.length;k+=1){let _=await this.connection.sendTransaction(S[k],{skipPreflight:L});B.push(_)}return{txIds:B,signedTxs:S}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:l||{}}}};import{PublicKey as Qi}from"@solana/web3.js";import Ji from"bn.js";import Pn from"bn.js";var ts=new Pn(1e6);var Ks=q("Raydium_amount"),Ns=Te(An);var _e=new te(0),Xs=new te(1),Ys=new te(2),$s=new te(3),ea=new te(5),Sn=new te(10),ta=new te(100),na=new te(1e3),ra=new te(1e4);import{Keypair as Vn,PublicKey as On}from"@solana/web3.js";import Au from"bn.js";import{TOKEN_PROGRAM_ID as vn}from"@solana/spl-token";function Bn(n){return n instanceof Uint8Array||n!=null&&typeof n=="object"&&n.constructor.name==="Uint8Array"}function ot(n,...e){if(!Bn(n))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(n.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${n.length}`)}function it(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")}function Ft(n,e){ot(n);let t=e.outputLen;if(n.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}var ve=n=>new DataView(n.buffer,n.byteOffset,n.byteLength),z=(n,e)=>n<<32-e|n>>>e;var aa=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Ln(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function st(n){return typeof n=="string"&&(n=Ln(n)),ot(n),n}var Oe=class{clone(){return this._cloneInto()}},ua={}.toString;function Vt(n){let e=r=>n().update(st(r)).digest(),t=n();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>n(),e}function kn(n,e,t,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,t,r);let s=BigInt(32),a=BigInt(4294967295),l=Number(t>>s&a),o=Number(t&a),b=r?4:0,w=r?0:4;n.setUint32(e+b,l,r),n.setUint32(e+w,o,r)}var Ot=(n,e,t)=>n&e^~n&t,vt=(n,e,t)=>n&e^n&t^e&t,We=class extends Oe{constructor(e,t,r,s){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ve(this.buffer)}update(e){it(this);let{view:t,buffer:r,blockLen:s}=this;e=st(e);let a=e.length;for(let l=0;l<a;){let o=Math.min(s-this.pos,a-l);if(o===s){let b=ve(e);for(;s<=a-l;l+=s)this.process(b,l);continue}r.set(e.subarray(l,l+o),this.pos),this.pos+=o,l+=o,this.pos===s&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){it(this),Ft(e,this),this.finished=!0;let{buffer:t,view:r,blockLen:s,isLE:a}=this,{pos:l}=this;t[l++]=128,this.buffer.subarray(l).fill(0),this.padOffset>s-l&&(this.process(r,0),l=0);for(let m=l;m<s;m++)t[m]=0;kn(r,s-8,BigInt(this.length*8),a),this.process(r,0);let o=ve(e),b=this.outputLen;if(b%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let w=b/4,y=this.get();if(w>y.length)throw new Error("_sha2: outputLen bigger than state");for(let m=0;m<w;m++)o.setUint32(4*m,y[m],a)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:r,length:s,finished:a,destroyed:l,pos:o}=this;return e.length=s,e.pos=o,e.finished=a,e.destroyed=l,s%t&&e.buffer.set(r),e}};var Cn=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),re=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),oe=new Uint32Array(64),at=class extends We{constructor(){super(64,32,8,!1),this.A=re[0]|0,this.B=re[1]|0,this.C=re[2]|0,this.D=re[3]|0,this.E=re[4]|0,this.F=re[5]|0,this.G=re[6]|0,this.H=re[7]|0}get(){let{A:e,B:t,C:r,D:s,E:a,F:l,G:o,H:b}=this;return[e,t,r,s,a,l,o,b]}set(e,t,r,s,a,l,o,b){this.A=e|0,this.B=t|0,this.C=r|0,this.D=s|0,this.E=a|0,this.F=l|0,this.G=o|0,this.H=b|0}process(e,t){for(let m=0;m<16;m++,t+=4)oe[m]=e.getUint32(t,!1);for(let m=16;m<64;m++){let T=oe[m-15],P=oe[m-2],d=z(T,7)^z(T,18)^T>>>3,g=z(P,17)^z(P,19)^P>>>10;oe[m]=g+oe[m-7]+d+oe[m-16]|0}let{A:r,B:s,C:a,D:l,E:o,F:b,G:w,H:y}=this;for(let m=0;m<64;m++){let T=z(o,6)^z(o,11)^z(o,25),P=y+T+Ot(o,b,w)+Cn[m]+oe[m]|0,g=(z(r,2)^z(r,13)^z(r,22))+vt(r,s,a)|0;y=w,w=b,b=o,o=l+P|0,l=a,a=s,s=r,r=P+g|0}r=r+this.A|0,s=s+this.B|0,a=a+this.C|0,l=l+this.D|0,o=o+this.E|0,b=b+this.F|0,w=w+this.G|0,y=y+this.H|0,this.set(r,s,a,l,o,b,w,y)}roundClean(){oe.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var Wt=Vt(()=>new at);import{PublicKey as _n}from"@solana/web3.js";import Gt,{isBN as pu}from"bn.js";import{bits as Mn,BitStructure as ba,blob as Rn,Blob as ya,cstr as xa,f32 as Ta,f32be as wa,f64 as Pa,f64be as Aa,greedy as Sa,Layout as In,ns64 as Ba,ns64be as La,nu64 as ka,nu64be as Ca,offset as Ma,s16 as Ra,s16be as Ia,s24 as Da,s24be as Ka,s32 as Na,s32be as Ea,s40 as _a,s40be as Fa,s48 as Va,s48be as Oa,s8 as va,seq as Wa,struct as qa,Structure as Dn,u16 as Kn,u16be as Ua,u24 as Ga,u24be as Ha,u32 as Nn,u32be as ja,u40 as za,u40be as Qa,u48 as Za,u48be as Ja,u8 as Xa,UInt as En,union as Ya,Union as $a,unionLayoutDiscriminator as eu,utf8 as tu}from"@solana/buffer-layout";var qe=In,qt=Dn;var ut=En;var Ut=Kn;var ct=Nn;var de=Rn;var lt=Mn;var pt=class extends qe{constructor(t,r,s){super(t,s);this.blob=de(t),this.signed=r}decode(t,r=0){let s=new Gt(this.blob.decode(t,r),10,"le");return this.signed?s.fromTwos(this.span*8).clone():s}encode(t,r,s=0){return typeof t=="number"&&(t=new Gt(t)),this.signed&&(t=t.toTwos(this.span*8)),this.blob.encode(t.toArrayLike(Buffer,"le",this.span),r,s)}},Ue=class extends qe{constructor(t){super(8,t);this._lower=lt(ct(),!1),this._upper=lt(ct(),!1)}addBoolean(t){this._lower.fields.length<32?this._lower.addBoolean(t):this._upper.addBoolean(t)}decode(t,r=0){let s=this._lower.decode(t,r),a=this._upper.decode(t,r+this._lower.span);return O(O({},s),a)}encode(t,r,s=0){return this._lower.encode(t,r,s)+this._upper.encode(t,r,s+this._lower.span)}};function Ge(n){return new ut(1,n)}function fe(n){return new ut(4,n)}function v(n){return new pt(8,!1,n)}var mt=class extends qe{constructor(t,r,s,a){super(t.span,a);this.layout=t,this.decoder=r,this.encoder=s}decode(t,r){return this.decoder(this.layout.decode(t,r))}encode(t,r,s){return this.layout.encode(this.encoder(t),r,s)}getSpan(t,r){return this.layout.getSpan(t,r)}};function j(n){return new mt(de(32),e=>new _n(e),e=>e.toBuffer(),n)}var dt=class extends qt{decode(e,t){return super.decode(e,t)}};function ge(n,e,t){return new dt(n,e,t)}var Fn=ge([j("mint"),j("owner"),v("amount"),fe("delegateOption"),j("delegate"),Ge("state"),fe("isNativeOption"),v("isNative"),v("delegatedAmount"),fe("closeAuthorityOption"),j("closeAuthority")]);var Cu=q("Raydium_Util");function ie({fromPublicKey:n,programId:e=vn,assignSeed:t}){let r=t?btoa(t).slice(0,32):Vn.generate().publicKey.toBase58().slice(0,32);return{publicKey:Wn(n,r,e),seed:r}}function Wn(n,e,t){let r=Buffer.concat([n.toBuffer(),Buffer.from(e),t.toBuffer()]),s=Wt(r);return new On(s)}var ft=(...n)=>n.map(e=>{try{return typeof e=="object"?JSON.stringify(e):e}catch{return e}}).join(", "),Me=class{constructor({scope:e,moduleName:t}){this.disabled=!1;this.scope=e,this.logger=q(t)}createTxBuilder(e){return this.scope.checkOwner(),new Ce({connection:this.scope.connection,feePayer:e||this.scope.ownerPubKey,cluster:this.scope.cluster,owner:this.scope.owner,blockhashCommitment:this.scope.blockhashCommitment,loopMultiTxStatus:this.scope.loopMultiTxStatus,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}createSniperTxBuilder(e,t){let r=new Q(e);return new Ce({connection:this.scope.connection,feePayer:t,cluster:this.scope.cluster,owner:r,blockhashCommitment:this.scope.blockhashCommitment,loopMultiTxStatus:this.scope.loopMultiTxStatus,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}logDebug(...e){this.logger.debug(ft(e))}logInfo(...e){this.logger.info(ft(e))}logAndCreateError(...e){let t=ft(e);throw new Error(t)}checkDisabled(){(this.disabled||!this.scope)&&this.logAndCreateError("module not working")}};import{SystemProgram as ce,SYSVAR_RENT_PUBKEY as Un,Transaction as Ht,TransactionInstruction as Gn}from"@solana/web3.js";import{createInitializeAccountInstruction as jt,TOKEN_PROGRAM_ID as zt}from"@solana/spl-token";function qn(n="accountFlags"){let e=new Ue(n);return e.addBoolean("initialized"),e.addBoolean("market"),e.addBoolean("openOrders"),e.addBoolean("requestQueue"),e.addBoolean("eventQueue"),e.addBoolean("bids"),e.addBoolean("asks"),e}var gt=ge([de(5),qn("accountFlags"),j("ownAddress"),v("vaultSignerNonce"),j("baseMint"),j("quoteMint"),j("baseVault"),v("baseDepositsTotal"),v("baseFeesAccrued"),j("quoteVault"),v("quoteDepositsTotal"),v("quoteFeesAccrued"),v("quoteDustThreshold"),j("requestQueue"),j("eventQueue"),j("bids"),j("asks"),v("baseLotSize"),v("quoteLotSize"),v("feeRateBps"),v("referrerRebatesAccrued"),de(7)]);function Hn({programId:n,marketInfo:e}){let t=ge([Ge("version"),fe("instruction"),v("baseLotSize"),v("quoteLotSize"),Ut("feeRateBps"),v("vaultSignerNonce"),v("quoteDustThreshold")]),r=[{pubkey:e.id,isSigner:!1,isWritable:!0},{pubkey:e.requestQueue,isSigner:!1,isWritable:!0},{pubkey:e.eventQueue,isSigner:!1,isWritable:!0},{pubkey:e.bids,isSigner:!1,isWritable:!0},{pubkey:e.asks,isSigner:!1,isWritable:!0},{pubkey:e.baseVault,isSigner:!1,isWritable:!0},{pubkey:e.quoteVault,isSigner:!1,isWritable:!0},{pubkey:e.baseMint,isSigner:!1,isWritable:!1},{pubkey:e.quoteMint,isSigner:!1,isWritable:!1},{pubkey:e.authority?e.quoteMint:Un,isSigner:!1,isWritable:!1}].concat(e.authority?{pubkey:e.authority,isSigner:!1,isWritable:!1}:[]).concat(e.authority&&e.pruneAuthority?{pubkey:e.pruneAuthority,isSigner:!1,isWritable:!1}:[]),s=Buffer.alloc(t.span);return t.encode({version:0,instruction:0,baseLotSize:e.baseLotSize,quoteLotSize:e.quoteLotSize,feeRateBps:e.feeRateBps,vaultSignerNonce:e.vaultSignerNonce,quoteDustThreshold:e.quoteDustThreshold},s),new Gn({keys:r,programId:n,data:s})}async function Qt({connection:n,wallet:e,marketInfo:t}){var l,o,b,w,y,m,T,P;let r=new Ht,s=await n.getMinimumBalanceForRentExemption(165);r.add(ce.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.baseVault.seed,newAccountPubkey:t.baseVault.publicKey,lamports:s,space:165,programId:zt}),ce.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.quoteVault.seed,newAccountPubkey:t.quoteVault.publicKey,lamports:s,space:165,programId:zt}),jt(t.baseVault.publicKey,t.baseMint,t.vaultOwner),jt(t.quoteVault.publicKey,t.quoteMint,t.vaultOwner),ce.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.id.seed,newAccountPubkey:t.id.publicKey,lamports:await n.getMinimumBalanceForRentExemption(gt.span),space:gt.span,programId:t.programId}));let a=new Ht;return a.add(ce.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.requestQueue.seed,newAccountPubkey:t.requestQueue.publicKey,lamports:t.lowestFeeMarket?6208320:await n.getMinimumBalanceForRentExemption((l=t.requestQueueSpace)!=null?l:5120+12),space:t.lowestFeeMarket?764:(o=t.requestQueueSpace)!=null?o:5120+12,programId:t.programId}),ce.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.eventQueue.seed,newAccountPubkey:t.eventQueue.publicKey,lamports:t.lowestFeeMarket?79594560:await n.getMinimumBalanceForRentExemption((b=t.eventQueueSpace)!=null?b:262144+12),space:t.lowestFeeMarket?11308:(w=t.eventQueueSpace)!=null?w:262144+12,programId:t.programId}),ce.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.bids.seed,newAccountPubkey:t.bids.publicKey,lamports:t.lowestFeeMarket?101977920:await n.getMinimumBalanceForRentExemption((y=t.orderbookQueueSpace)!=null?y:65536+12),space:t.lowestFeeMarket?14524:(m=t.orderbookQueueSpace)!=null?m:65536+12,programId:t.programId}),ce.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.asks.seed,newAccountPubkey:t.asks.publicKey,lamports:t.lowestFeeMarket?101977920:await n.getMinimumBalanceForRentExemption((T=t.orderbookQueueSpace)!=null?T:65536+12),space:t.lowestFeeMarket?14524:(P=t.orderbookQueueSpace)!=null?P:65536+12,programId:t.programId}),Hn({programId:t.programId,marketInfo:{id:t.id.publicKey,requestQueue:t.requestQueue.publicKey,eventQueue:t.eventQueue.publicKey,bids:t.bids.publicKey,asks:t.asks.publicKey,baseVault:t.baseVault.publicKey,quoteVault:t.quoteVault.publicKey,baseMint:t.baseMint,quoteMint:t.quoteMint,baseLotSize:t.baseLotSize,quoteLotSize:t.quoteLotSize,feeRateBps:t.feeRateBps,vaultSignerNonce:t.vaultSignerNonce,quoteDustThreshold:t.quoteDustThreshold}})),[{transaction:r,signer:[],instructionTypes:[U.CreateAccount,U.CreateAccount,U.InitAccount,U.InitAccount]},{transaction:a,signer:[],instructionTypes:[U.CreateAccount,U.CreateAccount,U.CreateAccount,U.CreateAccount,U.CreateAccount,U.InitMarket]}]}var He=class extends Me{async create({baseInfo:e,quoteInfo:t,lotSize:r,tickSize:s,dexProgramId:a,requestQueueSpace:l,eventQueueSpace:o,orderbookQueueSpace:b,lowestFeeMarket:w,assignSeed:y,txVersion:m,computeBudgetConfig:T,txTipConfig:P,feePayer:d}){let g=this.scope.ownerPubKey,i=y?`${e.mint.toBase58().slice(0,10)}-${t.mint.toBase58().slice(0,10)}-${y}`:void 0,C=ie({fromPublicKey:g,programId:a,assignSeed:i&&`${i}-market`}),A=ie({fromPublicKey:g,programId:a,assignSeed:i&&`${i}-request`}),I=ie({fromPublicKey:g,programId:a,assignSeed:i&&`${i}-event`}),p=ie({fromPublicKey:g,programId:a,assignSeed:i&&`${i}-bids`}),u=ie({fromPublicKey:g,programId:a,assignSeed:i&&`${i}-asks`}),c=ie({fromPublicKey:g,programId:Zt,assignSeed:i&&`${i}-baseVault`}),x=ie({fromPublicKey:g,programId:Zt,assignSeed:i&&`${i}-quoteVault`}),f=0,L=new Ie(100);function K(){let V=new Ie(0);for(;;)try{return{vaultOwner:Re.createProgramAddressSync([C.publicKey.toBuffer(),V.toArrayLike(Buffer,"le",8)],a),vaultSignerNonce:V}}catch{if(V.iaddn(1),V.gt(new Ie(25555)))throw Error("find vault owner error")}}let{vaultOwner:D,vaultSignerNonce:S}=K(),B=new Ie(Math.round(10**e.decimals*r)),k=new Ie(Math.round(r*10**t.decimals*s));if(B.eq(_e))throw Error("lot size is too small");if(k.eq(_e))throw Error("tick size or lot size is too small");let _=await Qt({connection:this.scope.connection,wallet:this.scope.ownerPubKey,marketInfo:{programId:a,id:C,baseMint:e.mint,quoteMint:t.mint,baseVault:c,quoteVault:x,vaultOwner:D,requestQueue:A,eventQueue:I,bids:p,asks:u,feeRateBps:f,quoteDustThreshold:L,vaultSignerNonce:S,baseLotSize:B,quoteLotSize:k,requestQueueSpace:l,eventQueueSpace:o,orderbookQueueSpace:b,lowestFeeMarket:w}}),N=this.createTxBuilder(d);N.addInstruction({instructions:_[0].transaction.instructions,signers:_[0].signer});for await(let V of _.slice(1,_.length))N.addInstruction({instructions:V.transaction.instructions,signers:V.signer,instructionTypes:V.instructionTypes});return m===0?N.sizeCheckBuildV0({computeBudgetConfig:T,address:{marketId:C.publicKey,requestQueue:A.publicKey,eventQueue:I.publicKey,bids:p.publicKey,asks:u.publicKey,baseVault:c.publicKey,quoteVault:x.publicKey,baseMint:new Re(e.mint),quoteMint:new Re(t.mint)}}):N.sizeCheckBuild({computeBudgetConfig:T,address:{marketId:C.publicKey,requestQueue:A.publicKey,eventQueue:I.publicKey,bids:p.publicKey,asks:u.publicKey,baseVault:c.publicKey,quoteVault:x.publicKey,baseMint:new Re(e.mint),quoteMint:new Re(t.mint)}})}};export{gt as MARKET_STATE_LAYOUT_V2,He as default,Hn as initializeMarket,Qt as makeCreateMarketInstruction};
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */
//# sourceMappingURL=index.mjs.map