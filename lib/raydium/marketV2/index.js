var on=Object.create;var we=Object.defineProperty,sn=Object.defineProperties,an=Object.getOwnPropertyDescriptor,un=Object.getOwnPropertyDescriptors,cn=Object.getOwnPropertyNames,_e=Object.getOwnPropertySymbols,ln=Object.getPrototypeOf,et=Object.prototype.hasOwnProperty,St=Object.prototype.propertyIsEnumerable;var At=(n,e,t)=>e in n?we(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,v=(n,e)=>{for(var t in e||(e={}))et.call(e,t)&&At(n,t,e[t]);if(_e)for(var t of _e(e))St.call(e,t)&&At(n,t,e[t]);return n},ne=(n,e)=>sn(n,un(e));var Pe=(n,e)=>{var t={};for(var r in n)et.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&_e)for(var r of _e(n))e.indexOf(r)<0&&St.call(n,r)&&(t[r]=n[r]);return t};var pn=(n,e)=>{for(var t in e)we(n,t,{get:e[t],enumerable:!0})},Bt=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of cn(e))!et.call(n,i)&&i!==t&&we(n,i,{get:()=>e[i],enumerable:!(r=an(e,i))||r.enumerable});return n};var U=(n,e,t)=>(t=n!=null?on(ln(n)):{},Bt(e||!n||!n.__esModule?we(t,"default",{value:n,enumerable:!0}):t,n)),mn=n=>Bt(we({},"__esModule",{value:!0}),n);var Vn={};pn(Vn,{MARKET_STATE_LAYOUT_V2:()=>Ye,default:()=>Ee,initializeMarket:()=>rn,makeCreateMarketInstruction:()=>wt});module.exports=mn(Vn);var ye=require("@solana/web3.js"),xe=U(require("bn.js")),Pt=require("@solana/spl-token");var ee=U(require("bn.js")),Mn=U(require("decimal.js"));var zt=U(require("big.js")),kn=U(require("bn.js"));var Ae=require("lodash");var tt=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:0,this.name=e.name}set level(e){this.logLevel=e}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let t=e.map(r=>typeof r=="object"?JSON.stringify(r):r).join(", ");throw new Error(t)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},Lt={},dn={};function G(n){let e=(0,Ae.get)(Lt,n);if(!e){let t=(0,Ae.get)(dn,n);e=new tt({name:n,logLevel:t}),(0,Ae.set)(Lt,n,e)}return e}var kt=require("@solana/web3.js");var Fe=require("@solana/spl-token"),nt=G("Raydium_accountInfo_util");async function Ct(n,e,t){let{batchRequest:r,commitment:i="confirmed",chunkCount:a=100}=v({batchRequest:!1},t),l=rt(e,a),o=new Array(l.length).fill([]);if(r){let b=l.map(m=>{let T=n._buildArgs([m.map(A=>A.toBase58())],i,"base64");return{methodName:"getMultipleAccounts",args:T}}),P=rt(b,10);o=(await(await Promise.all(P.map(async m=>await n._rpcBatchRequest(m)))).flat()).map(m=>(m.error&&nt.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${m.error.message}`),m.result.value.map(T=>{if(T){let{data:A,executable:d,lamports:g,owner:s,rentEpoch:M}=T;return A.length!==2&&A[1]!=="base64"&&nt.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(A[0],"base64"),executable:d,lamports:g,owner:new kt.PublicKey(s),rentEpoch:M}}return null})))}else try{o=await Promise.all(l.map(b=>n.getMultipleAccountsInfo(b,i)))}catch(b){b instanceof Error&&nt.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${b.message}`)}return o.flat()}var pe=U(require("bn.js"));var Mt=9007199254740991;function re(n){let e=G("Raydium_parseBigNumberish");if(n instanceof pe.default)return n;if(typeof n=="string"){if(n.match(/^-?[0-9]+$/))return new pe.default(n);e.logWithError(`invalid BigNumberish string: ${n}`)}return typeof n=="number"?(n%1&&e.logWithError(`BigNumberish number underflow: ${n}`),(n>=Mt||n<=-Mt)&&e.logWithError(`BigNumberish number overflow: ${n}`),new pe.default(String(n))):typeof n=="bigint"?new pe.default(n.toString()):(e.error(`invalid BigNumberish value: ${n}`),new pe.default(0))}var Rt=require("@solana/web3.js"),it=require("@solana/spl-token"),It={chainId:101,address:Rt.PublicKey.default.toBase58(),programId:it.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},ce={chainId:101,address:"So11111111111111111111111111111111111111112",programId:it.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};var Ve=require("@solana/web3.js");var _=require("@solana/web3.js"),Dt=require("@solana/spl-token");function st({pubkey:n,isSigner:e=!1,isWritable:t=!0}){return{pubkey:n,isWritable:t,isSigner:e}}var $n=[st({pubkey:Dt.TOKEN_PROGRAM_ID,isWritable:!1}),st({pubkey:_.SystemProgram.programId,isWritable:!1}),st({pubkey:_.SYSVAR_RENT_PUBKEY,isWritable:!1})];function Kt({publicKey:n,transformSol:e}){let t=Nt(n.toString());if(t instanceof _.PublicKey)return e&&t.equals(Se)?ot:t;if(e&&t.toString()===Se.toBase58())return ot;if(typeof t=="string"){if(t===_.PublicKey.default.toBase58())return _.PublicKey.default;try{return new _.PublicKey(t)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function Nt(n){try{return new _.PublicKey(n)}catch{return n}}var er=new _.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),tr=new _.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),nr=new _.PublicKey("SysvarRent111111111111111111111111111111111"),rr=new _.PublicKey("SysvarC1ock11111111111111111111111111111111"),or=new _.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),ir=new _.PublicKey("Sysvar1nstructions1111111111111111111111111"),sr=_.SystemProgram.programId,ar=new _.PublicKey("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),ur=new _.PublicKey("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),cr=new _.PublicKey("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),lr=new _.PublicKey("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),pr=new _.PublicKey("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),mr=new _.PublicKey("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),dr=new _.PublicKey("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),fr=new _.PublicKey("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),gr=new _.PublicKey("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),hr=new _.PublicKey("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),br=new _.PublicKey("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),ot=new _.PublicKey("So11111111111111111111111111111111111111112"),Se=_.PublicKey.default;var at=class{constructor({mint:e,decimals:t,symbol:r,name:i,skipMint:a=!1,isToken2022:l=!1}){if(e===Se.toBase58()||e instanceof Ve.PublicKey&&Se.equals(e)){this.decimals=ce.decimals,this.symbol=ce.symbol,this.name=ce.name,this.mint=new Ve.PublicKey(ce.address),this.isToken2022=!1;return}this.decimals=t,this.symbol=r||e.toString().substring(0,6),this.name=i||e.toString().substring(0,6),this.mint=a?Ve.PublicKey.default:Kt({publicKey:e}),this.isToken2022=l}equals(e){return this===e?!0:this.mint.equals(e.mint)}},me=at;me.WSOL=new at(ne(v({},ce),{mint:ce.address}));var ut=class{constructor({decimals:e,symbol:t="UNKNOWN",name:r="UNKNOWN"}){this.decimals=e,this.symbol=t,this.name=r}equals(e){return this===e}},Oe=ut;Oe.SOL=new ut(It);var Et=U(require("toformat")),fn=Et.default,Be=fn;var Le=U(require("big.js")),_t=U(require("bn.js")),Ft=U(require("decimal.js-light"));var ve=G("module/fraction"),ct=Be(Le.default),ke=Be(Ft.default),hn={[0]:ke.ROUND_DOWN,[1]:ke.ROUND_HALF_UP,[2]:ke.ROUND_UP},bn={[0]:Le.default.roundDown,[1]:Le.default.roundHalfUp,[2]:Le.default.roundUp},F=class{constructor(e,t=new _t.default(1)){this.numerator=re(e),this.denominator=re(t)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new F(this.denominator,this.numerator)}add(e){let t=e instanceof F?e:new F(re(e));return this.denominator.eq(t.denominator)?new F(this.numerator.add(t.numerator),this.denominator):new F(this.numerator.mul(t.denominator).add(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}sub(e){let t=e instanceof F?e:new F(re(e));return this.denominator.eq(t.denominator)?new F(this.numerator.sub(t.numerator),this.denominator):new F(this.numerator.mul(t.denominator).sub(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}mul(e){let t=e instanceof F?e:new F(re(e));return new F(this.numerator.mul(t.numerator),this.denominator.mul(t.denominator))}div(e){let t=e instanceof F?e:new F(re(e));return new F(this.numerator.mul(t.denominator),this.denominator.mul(t.numerator))}toSignificant(e,t={groupSeparator:""},r=1){Number.isInteger(e)||ve.logWithError(`${e} is not an integer.`),e<=0&&ve.logWithError(`${e} is not positive.`),ke.set({precision:e+1,rounding:hn[r]});let i=new ke(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return i.toFormat(i.decimalPlaces(),t)}toFixed(e,t={groupSeparator:""},r=1){return Number.isInteger(e)||ve.logWithError(`${e} is not an integer.`),e<0&&ve.logWithError(`${e} is negative.`),ct.DP=e,ct.RM=bn[r]||1,new ct(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,t)}isZero(){return this.numerator.isZero()}};var Vt=U(require("bn.js"));var Kr=new F(new Vt.default(100));var Or=G("Raydium_price");function rt(n,e=1,t=[]){let r=[...n];if(e<=0)return t;for(;r.length;)t.push(r.splice(0,e));return t}var $=class{constructor(e){this._owner=e}get publicKey(){return $.isKeyPair(this._owner)?this._owner.publicKey:this._owner}get signer(){return $.isKeyPair(this._owner)?this._owner:void 0}get isKeyPair(){return $.isKeyPair(this._owner)}get isPublicKey(){return $.isPublicKey(this._owner)}static isKeyPair(e){return e.secretKey!==void 0}static isPublicKey(e){return!$.isKeyPair(e)}};var wn=require("@solana/web3.js"),Pn=require("@solana/spl-token");var Q=require("@solana/web3.js");var H={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",ClmmLockPosition:"ClmmLockPosition",ClmmHarvestLockPosition:"ClmmHarvestLockPosition",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV4Withdraw:"FarmV4Withdraw",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut",CpmmLockLp:"CpmmLockLp",CpmmCollectLockFee:"CpmmCollectLockFee",TransferTip:"TransferTip"};var Ut=require("@solana/spl-token"),qt=G("Raydium_txUtil"),Gt=1644;function Ce(n){let e=[],t=[];return n.microLamports&&(e.push(Q.ComputeBudgetProgram.setComputeUnitPrice({microLamports:n.microLamports})),t.push(H.SetComputeUnitPrice)),n.units&&(e.push(Q.ComputeBudgetProgram.setComputeUnitLimit({units:n.units})),t.push(H.SetComputeUnitLimit)),{instructions:e,instructionTypes:t}}async function le(n,e){var r,i;let t=e!=null?e:"confirmed";return(i=await((r=n.getLatestBlockhash)==null?void 0:r.call(n,{commitment:t})))==null?void 0:i.blockhash}async function Me(n,e){return n.getSignatureStatuses([e]),new Promise((t,r)=>{let i=setTimeout(r,6e4);n.onSignature(e,a=>{if(clearTimeout(i),!a.err){t("");return}r(Object.assign(a.err,{txId:e}))},"confirmed")})}function yn(n,e){n.length<1&&qt.logWithError(`no instructions provided: ${n.toString()}`),e.length<1&&qt.logWithError(`no signers provided:, ${e.toString()}`);let t=new Q.Transaction;t.recentBlockhash="11111111111111111111111111111111",t.feePayer=e[0],t.add(...n);try{return Buffer.from(t.serialize({verifySignatures:!1})).toString("base64").length<Gt}catch{return!1}}function Re({instructions:n,payer:e,signers:t}){return yn(n,[e,...t])}function oe({instructions:n,payer:e,lookupTableAddressAccount:t,recentBlockhash:r=Q.Keypair.generate().publicKey.toString()}){let a=new Q.TransactionMessage({payerKey:e,recentBlockhash:r,instructions:n}).compileToV0Message(Object.values(t!=null?t:{}));try{return Buffer.from(new Q.VersionedTransaction(a).serialize()).toString("base64").length<Gt}catch{return!1}}var xn=n=>Buffer.isBuffer(n)?n:n instanceof Uint8Array?Buffer.from(n.buffer,n.byteOffset,n.byteLength):Buffer.from(n),Tn=n=>{let e=n.serialize({requireAllSignatures:!1,verifySignatures:!1});n instanceof Q.VersionedTransaction&&(e=xn(e));try{return e instanceof Buffer?e.toString("base64"):Buffer.from(e).toString("base64")}catch{return e.toString("base64")}};function ie(n){let e=[];return n.forEach(t=>{t instanceof Q.Transaction&&(t.recentBlockhash||(t.recentBlockhash=Ut.TOKEN_PROGRAM_ID.toBase58()),t.feePayer||(t.feePayer=Q.Keypair.generate().publicKey)),e.push(Tn(t))}),console.log("simulate tx string:",e),e}var h=require("@solana/web3.js"),ho=new h.PublicKey("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),bo=new h.PublicKey("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),yo=new h.PublicKey("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),xo=new h.PublicKey("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),To=new h.PublicKey("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),wo=new h.PublicKey("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),Po=new h.PublicKey("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),Ao=new h.PublicKey("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),So=new h.PublicKey("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),Bo=new h.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Lo=new h.PublicKey("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),ko=new h.PublicKey("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),Co=new h.PublicKey("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),Mo=new h.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Ro=new h.PublicKey("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),Io=new h.PublicKey("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),Do=new h.PublicKey("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),Ko=new h.PublicKey("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),No=new h.PublicKey("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),Eo=new h.PublicKey("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),_o=new h.PublicKey("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),Fo=new h.PublicKey("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),Vo=new h.PublicKey("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),Oo=new h.PublicKey("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),vo=new h.PublicKey("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),Wo=new h.PublicKey("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),qo=new h.PublicKey("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),Uo=new h.PublicKey("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),Go=new h.PublicKey("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),Ho=new h.PublicKey("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),jo=new h.PublicKey("6s1xP3hpbAfFoNtUNF8mfHsjr2Bd97JxFJRWLbL6aHuX");var zo={OPEN_BOOK_PROGRAM:new h.PublicKey("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),SERUM_PROGRAM_ID_V3:new h.PublicKey("Ray1111111111111111111111111111111111111111"),AMM_V4:new h.PublicKey("DRaya7Kj3aMWQSy19kSjvmuwq9docCHofyP9kanQGaav"),AMM_STABLE:new h.PublicKey("DRayDdXc1NZQ9C3hRWmoSf8zK4iapgMnjdNZWrfwsP8m"),CLMM_PROGRAM_ID:new h.PublicKey("DRayAUgENGQBKVaX8owNhgzkEDyoHTGVEGHVJT1E9pfH"),CLMM_LOCK_PROGRAM_ID:new h.PublicKey("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),CLMM_LOCK_AUTH_ID:new h.PublicKey("6Aoh8h2Lw2m5UGxYR8AdAL87jTWYeKoxM52mJRzfYwN"),CREATE_CPMM_POOL_PROGRAM:new h.PublicKey("DRaycpLY18LhpbydsBWbVJtxpNv9oXPgjRSfpF2bWpYb"),CREATE_CPMM_POOL_AUTH:new h.PublicKey("CXniRufdq5xL8t8jZAPxsPZDpuudwuJSPWnbcD5Y5Nxq"),CREATE_CPMM_POOL_FEE_ACC:new h.PublicKey("3oE58BKVt8KuYkGxx8zBojugnymWmBiyafWgMrnb6eYy"),LOCK_CPMM_PROGRAM:new h.PublicKey("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),LOCK_CPMM_AUTH:new h.PublicKey("7qWVV8UY2bRJfDLP4s37YzBPKUkVB46DStYJBpYbQzu3"),UTIL1216:h.PublicKey.default,Router:new h.PublicKey("DRaybByLpbUL57LJARs3j8BitTxVfzBg351EaMr5UTCd"),FARM_PROGRAM_ID_V3:new h.PublicKey("DRayWyrLmEW5KEeqs8kdTMMaBabapqagaBC7KWpGtJeZ"),FARM_PROGRAM_ID_V4:new h.PublicKey("Ray1111111111111111111111111111111111111111"),FARM_PROGRAM_ID_V5:new h.PublicKey("DRayiCGSZgku1GTK6rXD6mVDdingXy6APAH1R6R5L2LC"),FARM_PROGRAM_ID_V6:new h.PublicKey("DRayzbYakXs45ELHkzH6vC3fuhQqTAnv5A68gdFuvZyZ"),LAUNCHPAD_PROGRAM:new h.PublicKey("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),LAUNCHPAD_AUTH:new h.PublicKey("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),LAUNCHPAD_PLATFORM:new h.PublicKey("2Jx4KTDrVSdWNazuGpcA8n3ZLTRGGBDxAWhuKe2Xcj2a"),LAUNCHPAD_CONFIG:new h.PublicKey("7ZR4zD7PYfY2XxoG1Gxcy2EgEeGYrpxrwzPuwdUBssEt"),FEE_DESTINATION_ID:new h.PublicKey("9y8ENuuZ3b19quffx9hQvRVygG5ky6snHfRvGpuSfeJy"),MODEL_DATA_PUBKEY:new h.PublicKey("Ray1111111111111111111111111111111111111111")};var An=U(require("bn.js"));var X=require("@solana/web3.js");async function qe({connection:n,address:e,cluster:t="mainnet"}){let r=await Ct(n,[...new Set(e.map(a=>a.toString()))].map(a=>new X.PublicKey(a))),i={};for(let a=0;a<e.length;a++){let l=r[a],o=e[a];if(!l)continue;let b=new X.AddressLookupTableAccount({key:o,state:X.AddressLookupTableAccount.deserialize(l.data)});i[o.toString()]=b,t==="devnet"?de[o.toString()]=b:Ie[o.toString()]=b}return i}var Ie={AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU:new X.AddressLookupTableAccount({key:new X.PublicKey("AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU"),state:X.AddressLookupTableAccount.deserialize(Buffer.from("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","base64"))})},de={},Ue=async n=>{let e="EFhMuDw1PKEuckuFRW9PavNfTH4LKP5uKHgyXDmWpFCq";if(de[e])return de;let t=new X.PublicKey(e),r=await n.getAccountInfo(t);return r&&(de[e]=new X.AddressLookupTableAccount({key:t,state:X.AddressLookupTableAccount.deserialize(r.data)})),de};var I=require("@solana/web3.js"),Ht=U(require("axios"));var De=2e3,Ke=class{constructor(e){this.instructions=[];this.endInstructions=[];this.lookupTableAddress=[];this.signers=[];this.instructionTypes=[];this.endInstructionTypes=[];this.connection=e.connection,this.feePayer=e.feePayer,this.signAllTransactions=e.signAllTransactions,this.owner=e.owner,this.cluster=e.cluster,this.blockhashCommitment=e.blockhashCommitment,this.loopMultiTxStatus=!!e.loopMultiTxStatus}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers,instructionTypes:this.instructionTypes,endInstructionTypes:this.endInstructionTypes,lookupTableAddress:this.lookupTableAddress}}get allInstructions(){return[...this.instructions,...this.endInstructions]}async getComputeBudgetConfig(){var r;let e=(await Ht.default.get(`https://solanacompass.com/api/fees?cacheFreshTime=${3e5}`)).data,{avg:t}=(r=e==null?void 0:e[15])!=null?r:{};if(!!t)return{units:6e5,microLamports:Math.min(Math.ceil(t*1e6/6e5),25e3)}}addCustomComputeBudget(e){if(e){let{instructions:t,instructionTypes:r}=Ce(e);return this.instructions.unshift(...t),this.instructionTypes.unshift(...r),!0}return!1}addTipInstruction(e){var t;return e?(this.endInstructions.push(I.SystemProgram.transfer({fromPubkey:(t=e.feePayer)!=null?t:this.feePayer,toPubkey:new I.PublicKey(e.address),lamports:BigInt(e.amount.toString())})),this.endInstructionTypes.push(H.TransferTip),!0):!1}async calComputeBudget({config:e,defaultIns:t}){try{let r=e||await this.getComputeBudgetConfig();if(this.addCustomComputeBudget(r))return;t&&this.instructions.unshift(...t)}catch{t&&this.instructions.unshift(...t)}}addInstruction({instructions:e=[],endInstructions:t=[],signers:r=[],instructionTypes:i=[],endInstructionTypes:a=[],lookupTableAddress:l=[]}){return this.instructions.push(...e),this.endInstructions.push(...t),this.signers.push(...r),this.instructionTypes.push(...i),this.endInstructionTypes.push(...a),this.lookupTableAddress.push(...l.filter(o=>o!==I.PublicKey.default.toString())),this}async versionBuild({txVersion:e,extInfo:t}){return e===0?await this.buildV0(v({},t||{})):this.build(t)}build(e){var r;let t=new I.Transaction;return this.allInstructions.length&&t.add(...this.allInstructions),t.feePayer=this.feePayer,((r=this.owner)==null?void 0:r.signer)&&!this.signers.some(i=>i.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer),{builder:this,transaction:t,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async i=>{var y;let{recentBlockHash:a,skipPreflight:l=!0,sendAndConfirm:o,notSendToRpc:b}=i||{},P=a!=null?a:await le(this.connection,this.blockhashCommitment);if(t.recentBlockhash=P,this.signers.length&&t.sign(...this.signers),ie([t]),(y=this.owner)!=null&&y.isKeyPair)return{txId:o?await(0,I.sendAndConfirmTransaction)(this.connection,t,this.signers.find(T=>T.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:l}):await this.connection.sendRawTransaction(t.serialize(),{skipPreflight:l}),signedTx:t};if(this.signAllTransactions){let m=await this.signAllTransactions([t]);if(this.signers.length)for(let T of m)try{T.sign(...this.signers)}catch{}return{txId:b?"":await this.connection.sendRawTransaction(m[0].serialize(),{skipPreflight:l}),signedTx:m[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:e||{}}}buildMultiTx(e){var P;let{extraPreBuildData:t=[],extInfo:r}=e,{transaction:i}=this.build(r),a=t.filter(y=>y.transaction.instructions.length>0),l=[i,...a.map(y=>y.transaction)],o=[this.signers,...a.map(y=>y.signers)],b=[...this.instructionTypes,...a.map(y=>y.instructionTypes).flat()];return(P=this.owner)!=null&&P.signer&&o.forEach(y=>{y.some(m=>m.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),{builder:this,transactions:l,signers:o,instructionTypes:b,execute:async y=>{var M;let{sequentially:m,onTxUpdate:T,skipTxCount:A=0,recentBlockHash:d,skipPreflight:g=!0}=y||{},s=d!=null?d:await le(this.connection,this.blockhashCommitment);if((M=this.owner)!=null&&M.isKeyPair){if(m){let S=[],D=0;for(let p of l){if(++D,D<=A)continue;let u=await(0,I.sendAndConfirmTransaction)(this.connection,p,this.signers.find(c=>c.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:g});S.push(u)}return{txIds:S,signedTxs:l}}return{txIds:await await Promise.all(l.map(async S=>(S.recentBlockhash=s,await this.connection.sendRawTransaction(S.serialize(),{skipPreflight:g})))),signedTxs:l}}if(this.signAllTransactions){let S=l.map((p,u)=>(p.recentBlockhash=s,o[u].length&&p.sign(...o[u]),p));ie(S);let D=await this.signAllTransactions(S);if(m){let p=0,u=[],c=async()=>{if(!D[p])return;let x=await this.connection.sendRawTransaction(D[p].serialize(),{skipPreflight:g});u.push({txId:x,status:"sent",signedTx:D[p]}),T==null||T([...u]),p++;let f=!1,k=null,N=null,K=B=>{k!==null&&clearInterval(k),N!==null&&this.connection.removeSignatureListener(N);let L=u.findIndex(C=>C.txId===x);if(L>-1){if(u[L].status==="error"||u[L].status==="success")return;u[L].status=B.err?"error":"success"}T==null||T([...u]),B.err||c()};this.loopMultiTxStatus&&(k=setInterval(async()=>{var B;if(f){clearInterval(k);return}try{let L=await this.connection.getTransaction(x,{commitment:"confirmed",maxSupportedTransactionVersion:0});L&&(f=!0,clearInterval(k),K({err:((B=L.meta)==null?void 0:B.err)||null}),console.log("tx status from getTransaction:",x))}catch(L){f=!0,clearInterval(k),console.error("getTransaction timeout:",L,x)}},De)),N=this.connection.onSignature(x,B=>{if(f){this.connection.removeSignatureListener(N);return}f=!0,K(B)},"confirmed"),this.connection.getSignatureStatus(x)};return await c(),{txIds:u.map(x=>x.txId),signedTxs:D}}else{let p=[];for(let u=0;u<D.length;u+=1){let c=await this.connection.sendRawTransaction(D[u].serialize(),{skipPreflight:g});p.push(c)}return{txIds:p,signedTxs:D}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async versionMultiBuild({extraPreBuildData:e,txVersion:t,extInfo:r}){return t===0?await this.buildV0MultiTx({extraPreBuildData:e,buildProps:r||{}}):this.buildMultiTx({extraPreBuildData:e,extInfo:r})}async buildV0(e){var g;let d=e||{},{lookupTableCache:t={},lookupTableAddress:r=[],forerunCreate:i,recentBlockhash:a}=d,l=Pe(d,["lookupTableCache","lookupTableAddress","forerunCreate","recentBlockhash"]),o=v(v({},this.cluster==="devnet"?await Ue(this.connection):Ie),t),b=Array.from(new Set([...r,...this.lookupTableAddress])),P=[];for(let s of b)o[s]===void 0&&P.push(new I.PublicKey(s));let y=await qe({connection:this.connection,address:P});for(let[s,M]of Object.entries(y))o[s]=M;let m=i?I.PublicKey.default.toBase58():a!=null?a:await le(this.connection,this.blockhashCommitment),T=new I.TransactionMessage({payerKey:this.feePayer,recentBlockhash:m,instructions:[...this.allInstructions]}).compileToV0Message(Object.values(o));((g=this.owner)==null?void 0:g.signer)&&!this.signers.some(s=>s.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer);let A=new I.VersionedTransaction(T);return A.sign(this.signers),{builder:this,transaction:A,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async s=>{var p;let{skipPreflight:M=!0,sendAndConfirm:S,notSendToRpc:D}=s||{};if(ie([A]),(p=this.owner)!=null&&p.isKeyPair){let u=await this.connection.sendTransaction(A,{skipPreflight:M});return S&&await Me(this.connection,u),{txId:u,signedTx:A}}if(this.signAllTransactions){let u=await this.signAllTransactions([A]);if(this.signers.length)for(let c of u)try{c.sign(this.signers)}catch{}return{txId:D?"":await this.connection.sendTransaction(u[0],{skipPreflight:M}),signedTx:u[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:l||{}}}async buildV0MultiTx(e){var P;let{extraPreBuildData:t=[],buildProps:r}=e,{transaction:i}=await this.buildV0(r),a=t.filter(y=>y.builder.instructions.length>0),l=[i,...a.map(y=>y.transaction)],o=[this.signers,...a.map(y=>y.signers)],b=[...this.instructionTypes,...a.map(y=>y.instructionTypes).flat()];return(P=this.owner)!=null&&P.signer&&o.forEach(y=>{y.some(m=>m.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),l.forEach(async(y,m)=>{y.sign(o[m])}),{builder:this,transactions:l,signers:o,instructionTypes:b,buildProps:r,execute:async y=>{var g;let{sequentially:m,onTxUpdate:T,recentBlockHash:A,skipPreflight:d=!0}=y||{};if(A&&l.forEach(s=>s.message.recentBlockhash=A),ie(l),(g=this.owner)!=null&&g.isKeyPair){if(m){let s=[];for(let M of l){let S=await this.connection.sendTransaction(M,{skipPreflight:d});await Me(this.connection,S),s.push(S)}return{txIds:s,signedTxs:l}}return{txIds:await Promise.all(l.map(async s=>await this.connection.sendTransaction(s,{skipPreflight:d}))),signedTxs:l}}if(this.signAllTransactions){let s=await this.signAllTransactions(l);if(m){let M=0,S=[],D=async()=>{if(!s[M])return;let p=await this.connection.sendTransaction(s[M],{skipPreflight:d});S.push({txId:p,status:"sent",signedTx:s[M]}),T==null||T([...S]),M++;let u=!1,c=null,x=null,f=k=>{c!==null&&clearInterval(c),x!==null&&this.connection.removeSignatureListener(x);let N=S.findIndex(K=>K.txId===p);if(N>-1){if(S[N].status==="error"||S[N].status==="success")return;S[N].status=k.err?"error":"success"}T==null||T([...S]),k.err||D()};this.loopMultiTxStatus&&(c=setInterval(async()=>{var k;if(u){clearInterval(c);return}try{let N=await this.connection.getTransaction(p,{commitment:"confirmed",maxSupportedTransactionVersion:0});N&&(u=!0,clearInterval(c),f({err:((k=N.meta)==null?void 0:k.err)||null}),console.log("tx status from getTransaction:",p))}catch(N){u=!0,clearInterval(c),console.error("getTransaction timeout:",N,p)}},De)),x=this.connection.onSignature(p,k=>{if(u){this.connection.removeSignatureListener(x);return}u=!0,f(k)},"confirmed"),this.connection.getSignatureStatus(p)};return D(),{txIds:[],signedTxs:s}}else{let M=[];for(let S=0;S<s.length;S+=1){let D=await this.connection.sendTransaction(s[S],{skipPreflight:d});M.push(D)}return{txIds:M,signedTxs:s}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async sizeCheckBuild(e){var T;let m=e||{},{splitIns:t=[],computeBudgetConfig:r}=m,i=Pe(m,["splitIns","computeBudgetConfig"]),a=r?Ce(r):{instructions:[],instructionTypes:[]},l=this.signers.reduce((A,d)=>ne(v({},A),{[d.publicKey.toBase58()]:d}),{}),o=[],b=[],P=[],y=0;if(this.allInstructions.forEach(A=>{let d=[...P,A],g=r?[...a.instructions,...d]:d,M=[...new Set(d.map(S=>S.keys.filter(D=>D.isSigner).map(D=>D.pubkey.toString())).flat()).values()].map(S=>new I.PublicKey(S));if(A!==t[y]&&P.length<12&&(Re({instructions:g,payer:this.feePayer,signers:M})||Re({instructions:d,payer:this.feePayer,signers:M})))P.push(A);else{if(P.length===0)throw Error("item ins too big");y+=A===t[y]?1:0,Re({instructions:r?[...a.instructions,...P]:[...P],payer:this.feePayer,signers:M})?o.push(new I.Transaction().add(...a.instructions,...P)):o.push(new I.Transaction().add(...P)),b.push(Array.from(new Set(P.map(S=>S.keys.filter(D=>D.isSigner).map(D=>D.pubkey.toString())).flat())).map(S=>l[S]).filter(S=>S!==void 0)),P=[A]}}),P.length>0){let d=[...new Set(P.map(g=>g.keys.filter(s=>s.isSigner).map(s=>s.pubkey.toString())).flat()).values()].map(g=>l[g]).filter(g=>g!==void 0);Re({instructions:r?[...a.instructions,...P]:[...P],payer:this.feePayer,signers:d.map(g=>g.publicKey)})?o.push(new I.Transaction().add(...a.instructions,...P)):o.push(new I.Transaction().add(...P)),b.push(d)}return o.forEach(A=>A.feePayer=this.feePayer),(T=this.owner)!=null&&T.signer&&b.forEach(A=>{A.some(d=>d.publicKey.equals(this.owner.publicKey))||A.push(this.owner.signer)}),{builder:this,transactions:o,signers:b,instructionTypes:this.instructionTypes,execute:async A=>{var p;let{sequentially:d,onTxUpdate:g,skipTxCount:s=0,recentBlockHash:M,skipPreflight:S=!0}=A||{},D=M!=null?M:await le(this.connection,this.blockhashCommitment);if(o.forEach(async(u,c)=>{u.recentBlockhash=D,b[c].length&&u.sign(...b[c])}),ie(o),(p=this.owner)!=null&&p.isKeyPair){if(d){let u=0,c=[];for(let x of o){if(++u,u<=s){c.push("tx skipped");continue}let f=await(0,I.sendAndConfirmTransaction)(this.connection,x,this.signers.find(k=>k.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:S});c.push(f)}return{txIds:c,signedTxs:o}}return{txIds:await Promise.all(o.map(async u=>await this.connection.sendRawTransaction(u.serialize(),{skipPreflight:S}))),signedTxs:o}}if(this.signAllTransactions){let u=await this.signAllTransactions(o.slice(s,o.length)),c=[...o.slice(0,s),...u];if(d){let x=0,f=[],k=async()=>{if(!c[x])return;x<s&&(f.push({txId:"",status:"success",signedTx:c[x]}),g==null||g([...f]),x++,k());let N=await this.connection.sendRawTransaction(c[x].serialize(),{skipPreflight:S});f.push({txId:N,status:"sent",signedTx:c[x]}),g==null||g([...f]),x++;let K=!1,B=null,L=null,C=V=>{B!==null&&clearInterval(B),L!==null&&this.connection.removeSignatureListener(L);let E=f.findIndex(O=>O.txId===N);if(E>-1){if(f[E].status==="error"||f[E].status==="success")return;f[E].status=V.err?"error":"success"}g==null||g([...f]),V.err||k()};this.loopMultiTxStatus&&(B=setInterval(async()=>{var V;if(K){clearInterval(B);return}try{let E=await this.connection.getTransaction(N,{commitment:"confirmed",maxSupportedTransactionVersion:0});E&&(K=!0,clearInterval(B),C({err:((V=E.meta)==null?void 0:V.err)||null}),console.log("tx status from getTransaction:",N))}catch(E){K=!0,clearInterval(B),console.error("getTransaction timeout:",E,N)}},De)),L=this.connection.onSignature(N,V=>{if(K){this.connection.removeSignatureListener(L);return}K=!0,C(V)},"confirmed"),this.connection.getSignatureStatus(N)};return await k(),{txIds:f.map(N=>N.txId),signedTxs:c}}else{let x=[];for(let f=0;f<c.length;f+=1){let k=await this.connection.sendRawTransaction(c[f].serialize(),{skipPreflight:S});x.push(k)}return{txIds:x,signedTxs:c}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:i||{}}}async sizeCheckBuildV0(e){var D;let S=e||{},{computeBudgetConfig:t,splitIns:r=[],lookupTableCache:i={},lookupTableAddress:a=[]}=S,l=Pe(S,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),o=v(v({},this.cluster==="devnet"?await Ue(this.connection):Ie),i),b=Array.from(new Set([...this.lookupTableAddress,...a])),P=[];for(let p of b)o[p]===void 0&&P.push(new I.PublicKey(p));let y=await qe({connection:this.connection,address:P});for(let[p,u]of Object.entries(y))o[p]=u;let m=t?Ce(t):{instructions:[],instructionTypes:[]},T=await le(this.connection,this.blockhashCommitment),A=this.signers.reduce((p,u)=>ne(v({},p),{[u.publicKey.toBase58()]:u}),{}),d=[],g=[],s=[],M=0;if(this.allInstructions.forEach(p=>{let u=[...s,p],c=t?[...m.instructions,...u]:u;if(p!==r[M]&&s.length<12&&(oe({instructions:c,payer:this.feePayer,lookupTableAddressAccount:o})||oe({instructions:u,payer:this.feePayer,lookupTableAddressAccount:o})))s.push(p);else{if(s.length===0)throw Error("item ins too big");M+=p===r[M]?1:0;let x={};for(let f of[...new Set(b)])o[f]!==void 0&&(x[f]=o[f]);if(t&&oe({instructions:[...m.instructions,...s],payer:this.feePayer,lookupTableAddressAccount:o,recentBlockhash:T})){let f=new I.TransactionMessage({payerKey:this.feePayer,recentBlockhash:T,instructions:[...m.instructions,...s]}).compileToV0Message(Object.values(o));d.push(new I.VersionedTransaction(f))}else{let f=new I.TransactionMessage({payerKey:this.feePayer,recentBlockhash:T,instructions:[...s]}).compileToV0Message(Object.values(o));d.push(new I.VersionedTransaction(f))}g.push(Array.from(new Set(s.map(f=>f.keys.filter(k=>k.isSigner).map(k=>k.pubkey.toString())).flat())).map(f=>A[f]).filter(f=>f!==void 0)),s=[p]}}),s.length>0){let u=[...new Set(s.map(c=>c.keys.filter(x=>x.isSigner).map(x=>x.pubkey.toString())).flat()).values()].map(c=>A[c]).filter(c=>c!==void 0);if(t&&oe({instructions:[...m.instructions,...s],payer:this.feePayer,lookupTableAddressAccount:o,recentBlockhash:T})){let c=new I.TransactionMessage({payerKey:this.feePayer,recentBlockhash:T,instructions:[...m.instructions,...s]}).compileToV0Message(Object.values(o));d.push(new I.VersionedTransaction(c))}else{let c=new I.TransactionMessage({payerKey:this.feePayer,recentBlockhash:T,instructions:[...s]}).compileToV0Message(Object.values(o));d.push(new I.VersionedTransaction(c))}g.push(u)}return(D=this.owner)!=null&&D.signer&&g.forEach(p=>{p.some(u=>u.publicKey.equals(this.owner.publicKey))||p.push(this.owner.signer)}),d.forEach((p,u)=>{p.sign(g[u])}),{builder:this,transactions:d,buildProps:e,signers:g,instructionTypes:this.instructionTypes,execute:async p=>{var N;let{sequentially:u,onTxUpdate:c,skipTxCount:x=0,recentBlockHash:f,skipPreflight:k=!0}=p||{};if(d.map(async(K,B)=>{g[B].length&&K.sign(g[B]),f&&(K.message.recentBlockhash=f)}),ie(d),(N=this.owner)!=null&&N.isKeyPair){if(u){let K=0,B=[];for(let L of d){if(++K,K<=x){console.log("skip tx: ",K),B.push("tx skipped");continue}let C=await this.connection.sendTransaction(L,{skipPreflight:k});await Me(this.connection,C),B.push(C)}return{txIds:B,signedTxs:d}}return{txIds:await Promise.all(d.map(async K=>await this.connection.sendTransaction(K,{skipPreflight:k}))),signedTxs:d}}if(this.signAllTransactions){let K=await this.signAllTransactions(d.slice(x,d.length)),B=[...d.slice(0,x),...K];if(u){let L=0,C=[],V=async()=>{if(!B[L])return;if(L<x){C.push({txId:"",status:"success",signedTx:B[L]}),c==null||c([...C]),L++,V();return}let E=await this.connection.sendTransaction(B[L],{skipPreflight:k});C.push({txId:E,status:"sent",signedTx:B[L]}),c==null||c([...C]),L++;let O=!1,j=null,te=null,Te=z=>{j!==null&&clearInterval(j),te!==null&&this.connection.removeSignatureListener(te);let q=C.findIndex($e=>$e.txId===E);if(q>-1){if(C[q].status==="error"||C[q].status==="success")return;C[q].status=z.err?"error":"success"}c==null||c([...C]),z.err||V()};this.loopMultiTxStatus&&(j=setInterval(async()=>{var z;if(O){clearInterval(j);return}try{let q=await this.connection.getTransaction(E,{commitment:"confirmed",maxSupportedTransactionVersion:0});q&&(O=!0,clearInterval(j),Te({err:((z=q.meta)==null?void 0:z.err)||null}),console.log("tx status from getTransaction:",E))}catch(q){O=!0,clearInterval(j),console.error("getTransaction timeout:",q,E)}},De)),te=this.connection.onSignature(E,z=>{if(O){this.connection.removeSignatureListener(te);return}O=!0,Te(z)},"confirmed"),this.connection.getSignatureStatus(E)};return V(),{txIds:[],signedTxs:B}}else{let L=[];for(let C=0;C<B.length;C+=1){let V=await this.connection.sendTransaction(B[C],{skipPreflight:k});L.push(V)}return{txIds:L,signedTxs:B}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:l||{}}}async buildSniperTransaction(e){var D;let S=e||{},{computeBudgetConfig:t,splitIns:r=[],lookupTableCache:i={},lookupTableAddress:a=[]}=S,l=Pe(S,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),o=v(v({},this.cluster==="devnet"?await Ue(this.connection):Ie),i),b=Array.from(new Set([...this.lookupTableAddress,...a])),P=[];for(let p of b)o[p]===void 0&&P.push(new I.PublicKey(p));let y=await qe({connection:this.connection,address:P});for(let[p,u]of Object.entries(y))o[p]=u;let m=t?Ce(t):{instructions:[],instructionTypes:[]},T=await le(this.connection,this.blockhashCommitment),A=this.signers.reduce((p,u)=>ne(v({},p),{[u.publicKey.toBase58()]:u}),{}),d=[],g=[],s=[],M=0;if(this.allInstructions.forEach(p=>{let u=[...s,p],c=t?[...m.instructions,...u]:u;if(p!==r[M]&&s.length<12&&(oe({instructions:c,payer:this.feePayer,lookupTableAddressAccount:o})||oe({instructions:u,payer:this.feePayer,lookupTableAddressAccount:o})))s.push(p);else{if(s.length===0)throw Error("item ins too big");M+=p===r[M]?1:0;let x={};for(let f of[...new Set(b)])o[f]!==void 0&&(x[f]=o[f]);if(t&&oe({instructions:[...m.instructions,...s],payer:this.feePayer,lookupTableAddressAccount:o,recentBlockhash:T})){let f=new I.TransactionMessage({payerKey:this.feePayer,recentBlockhash:T,instructions:[...m.instructions,...s]}).compileToV0Message(Object.values(o));d.push(new I.VersionedTransaction(f))}else{let f=new I.TransactionMessage({payerKey:this.feePayer,recentBlockhash:T,instructions:[...s]}).compileToV0Message(Object.values(o));d.push(new I.VersionedTransaction(f))}g.push(Array.from(new Set(s.map(f=>f.keys.filter(k=>k.isSigner).map(k=>k.pubkey.toString())).flat())).map(f=>A[f]).filter(f=>f!==void 0)),s=[p]}}),s.length>0){let u=[...new Set(s.map(c=>c.keys.filter(x=>x.isSigner).map(x=>x.pubkey.toString())).flat()).values()].map(c=>A[c]).filter(c=>c!==void 0);if(t&&oe({instructions:[...m.instructions,...s],payer:this.feePayer,lookupTableAddressAccount:o,recentBlockhash:T})){let c=new I.TransactionMessage({payerKey:this.feePayer,recentBlockhash:T,instructions:[...m.instructions,...s]}).compileToV0Message(Object.values(o));d.push(new I.VersionedTransaction(c))}else{let c=new I.TransactionMessage({payerKey:this.feePayer,recentBlockhash:T,instructions:[...s]}).compileToV0Message(Object.values(o));d.push(new I.VersionedTransaction(c))}g.push(u)}return(D=this.owner)!=null&&D.signer&&g.forEach(p=>{p.some(u=>u.publicKey.equals(this.owner.publicKey))||p.push(this.owner.signer)}),d.forEach((p,u)=>{p.sign(g[u])}),{builder:this,transactions:d,buildProps:e,signers:g,instructionTypes:this.instructionTypes,execute:async p=>{var N;let{sequentially:u,onTxUpdate:c,skipTxCount:x=0,recentBlockHash:f,skipPreflight:k=!0}=p||{};if(d.map(async(K,B)=>{g[B].length&&K.sign(g[B]),f&&(K.message.recentBlockhash=f)}),ie(d),(N=this.owner)!=null&&N.isKeyPair){if(u){let K=0,B=[];for(let L of d){if(++K,K<=x){console.log("skip tx: ",K),B.push("tx skipped");continue}let C=await this.connection.sendTransaction(L,{skipPreflight:k});await Me(this.connection,C),B.push(C)}return{txIds:B,signedTxs:d}}return{txIds:await Promise.all(d.map(async K=>await this.connection.sendTransaction(K,{skipPreflight:k}))),signedTxs:d}}if(this.signAllTransactions){let K=await this.signAllTransactions(d.slice(x,d.length)),B=[...d.slice(0,x),...K];if(u){let L=0,C=[],V=async()=>{if(!B[L])return;if(L<x){C.push({txId:"",status:"success",signedTx:B[L]}),c==null||c([...C]),L++,V();return}let E=await this.connection.sendTransaction(B[L],{skipPreflight:k});C.push({txId:E,status:"sent",signedTx:B[L]}),c==null||c([...C]),L++;let O=!1,j=null,te=null,Te=z=>{j!==null&&clearInterval(j),te!==null&&this.connection.removeSignatureListener(te);let q=C.findIndex($e=>$e.txId===E);if(q>-1){if(C[q].status==="error"||C[q].status==="success")return;C[q].status=z.err?"error":"success"}c==null||c([...C]),z.err||V()};this.loopMultiTxStatus&&(j=setInterval(async()=>{var z;if(O){clearInterval(j);return}try{let q=await this.connection.getTransaction(E,{commitment:"confirmed",maxSupportedTransactionVersion:0});q&&(O=!0,clearInterval(j),Te({err:((z=q.meta)==null?void 0:z.err)||null}),console.log("tx status from getTransaction:",E))}catch(q){O=!0,clearInterval(j),console.error("getTransaction timeout:",q,E)}},De)),te=this.connection.onSignature(E,z=>{if(O){this.connection.removeSignatureListener(te);return}O=!0,Te(z)},"confirmed"),this.connection.getSignatureStatus(E)};return V(),{txIds:[],signedTxs:B}}else{let L=[];for(let C=0;C<B.length;C+=1){let V=await this.connection.sendTransaction(B[C],{skipPreflight:k});L.push(V)}return{txIds:L,signedTxs:B}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:l||{}}}};var Bn=require("@solana/web3.js"),Ln=U(require("bn.js"));var jt=U(require("bn.js")),mi=new jt.default(1e6);var Wi=G("Raydium_amount"),qi=Be(zt.default);var We=new ee.default(0),ns=new ee.default(1),rs=new ee.default(2),os=new ee.default(3),is=new ee.default(5),Cn=new ee.default(10),ss=new ee.default(100),as=new ee.default(1e3),us=new ee.default(1e4);var Xe=require("@solana/web3.js"),En=U(require("bn.js"));var nn=require("@solana/spl-token");function Rn(n){return n instanceof Uint8Array||n!=null&&typeof n=="object"&&n.constructor.name==="Uint8Array"}function lt(n,...e){if(!Rn(n))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(n.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${n.length}`)}function pt(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")}function Qt(n,e){lt(n);let t=e.outputLen;if(n.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}var He=n=>new DataView(n.buffer,n.byteOffset,n.byteLength),Y=(n,e)=>n<<32-e|n>>>e;var ms=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function In(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function mt(n){return typeof n=="string"&&(n=In(n)),lt(n),n}var Ge=class{clone(){return this._cloneInto()}},ds={}.toString;function Zt(n){let e=r=>n().update(mt(r)).digest(),t=n();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>n(),e}function Dn(n,e,t,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,t,r);let i=BigInt(32),a=BigInt(4294967295),l=Number(t>>i&a),o=Number(t&a),b=r?4:0,P=r?0:4;n.setUint32(e+b,l,r),n.setUint32(e+P,o,r)}var Jt=(n,e,t)=>n&e^~n&t,Xt=(n,e,t)=>n&e^n&t^e&t,je=class extends Ge{constructor(e,t,r,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=He(this.buffer)}update(e){pt(this);let{view:t,buffer:r,blockLen:i}=this;e=mt(e);let a=e.length;for(let l=0;l<a;){let o=Math.min(i-this.pos,a-l);if(o===i){let b=He(e);for(;i<=a-l;l+=i)this.process(b,l);continue}r.set(e.subarray(l,l+o),this.pos),this.pos+=o,l+=o,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){pt(this),Qt(e,this),this.finished=!0;let{buffer:t,view:r,blockLen:i,isLE:a}=this,{pos:l}=this;t[l++]=128,this.buffer.subarray(l).fill(0),this.padOffset>i-l&&(this.process(r,0),l=0);for(let m=l;m<i;m++)t[m]=0;Dn(r,i-8,BigInt(this.length*8),a),this.process(r,0);let o=He(e),b=this.outputLen;if(b%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let P=b/4,y=this.get();if(P>y.length)throw new Error("_sha2: outputLen bigger than state");for(let m=0;m<P;m++)o.setUint32(4*m,y[m],a)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:r,length:i,finished:a,destroyed:l,pos:o}=this;return e.length=i,e.pos=o,e.finished=a,e.destroyed=l,i%t&&e.buffer.set(r),e}};var Kn=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),se=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ae=new Uint32Array(64),dt=class extends je{constructor(){super(64,32,8,!1),this.A=se[0]|0,this.B=se[1]|0,this.C=se[2]|0,this.D=se[3]|0,this.E=se[4]|0,this.F=se[5]|0,this.G=se[6]|0,this.H=se[7]|0}get(){let{A:e,B:t,C:r,D:i,E:a,F:l,G:o,H:b}=this;return[e,t,r,i,a,l,o,b]}set(e,t,r,i,a,l,o,b){this.A=e|0,this.B=t|0,this.C=r|0,this.D=i|0,this.E=a|0,this.F=l|0,this.G=o|0,this.H=b|0}process(e,t){for(let m=0;m<16;m++,t+=4)ae[m]=e.getUint32(t,!1);for(let m=16;m<64;m++){let T=ae[m-15],A=ae[m-2],d=Y(T,7)^Y(T,18)^T>>>3,g=Y(A,17)^Y(A,19)^A>>>10;ae[m]=g+ae[m-7]+d+ae[m-16]|0}let{A:r,B:i,C:a,D:l,E:o,F:b,G:P,H:y}=this;for(let m=0;m<64;m++){let T=Y(o,6)^Y(o,11)^Y(o,25),A=y+T+Jt(o,b,P)+Kn[m]+ae[m]|0,g=(Y(r,2)^Y(r,13)^Y(r,22))+Xt(r,i,a)|0;y=P,P=b,b=o,o=l+A|0,l=a,a=i,i=r,r=A+g|0}r=r+this.A|0,i=i+this.B|0,a=a+this.C|0,l=l+this.D|0,o=o+this.E|0,b=b+this.F|0,P=P+this.G|0,y=y+this.H|0,this.set(r,i,a,l,o,b,P,y)}roundClean(){ae.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var Yt=Zt(()=>new dt);var tn=require("@solana/web3.js"),Qe=U(require("bn.js"));var w=require("@solana/buffer-layout"),ze=w.Layout,$t=w.Structure;var ft=w.UInt;var en=w.u16;var gt=w.u32;var fe=w.blob;var ht=w.bits;var bt=class extends ze{constructor(t,r,i){super(t,i);this.blob=fe(t),this.signed=r}decode(t,r=0){let i=new Qe.default(this.blob.decode(t,r),10,"le");return this.signed?i.fromTwos(this.span*8).clone():i}encode(t,r,i=0){return typeof t=="number"&&(t=new Qe.default(t)),this.signed&&(t=t.toTwos(this.span*8)),this.blob.encode(t.toArrayLike(Buffer,"le",this.span),r,i)}},Ze=class extends ze{constructor(t){super(8,t);this._lower=ht(gt(),!1),this._upper=ht(gt(),!1)}addBoolean(t){this._lower.fields.length<32?this._lower.addBoolean(t):this._upper.addBoolean(t)}decode(t,r=0){let i=this._lower.decode(t,r),a=this._upper.decode(t,r+this._lower.span);return v(v({},i),a)}encode(t,r,i=0){return this._lower.encode(t,r,i)+this._upper.encode(t,r,i+this._lower.span)}};function Je(n){return new ft(1,n)}function ge(n){return new ft(4,n)}function W(n){return new bt(8,!1,n)}var yt=class extends ze{constructor(t,r,i,a){super(t.span,a);this.layout=t,this.decoder=r,this.encoder=i}decode(t,r){return this.decoder(this.layout.decode(t,r))}encode(t,r,i){return this.layout.encode(this.encoder(t),r,i)}getSpan(t,r){return this.layout.getSpan(t,r)}};function Z(n){return new yt(fe(32),e=>new tn.PublicKey(e),e=>e.toBuffer(),n)}var xt=class extends $t{decode(e,t){return super.decode(e,t)}};function he(n,e,t){return new xt(n,e,t)}var Nn=he([Z("mint"),Z("owner"),W("amount"),ge("delegateOption"),Z("delegate"),Je("state"),ge("isNativeOption"),W("isNative"),W("delegatedAmount"),ge("closeAuthorityOption"),Z("closeAuthority")]);var vs=G("Raydium_Util");function ue({fromPublicKey:n,programId:e=nn.TOKEN_PROGRAM_ID,assignSeed:t}){let r=t?btoa(t).slice(0,32):Xe.Keypair.generate().publicKey.toBase58().slice(0,32);return{publicKey:_n(n,r,e),seed:r}}function _n(n,e,t){let r=Buffer.concat([n.toBuffer(),Buffer.from(e),t.toBuffer()]),i=Yt(r);return new Xe.PublicKey(i)}var Tt=(...n)=>n.map(e=>{try{return typeof e=="object"?JSON.stringify(e):e}catch{return e}}).join(", "),Ne=class{constructor({scope:e,moduleName:t}){this.disabled=!1;this.scope=e,this.logger=G(t)}createTxBuilder(e){return this.scope.checkOwner(),new Ke({connection:this.scope.connection,feePayer:e||this.scope.ownerPubKey,cluster:this.scope.cluster,owner:this.scope.owner,blockhashCommitment:this.scope.blockhashCommitment,loopMultiTxStatus:this.scope.loopMultiTxStatus,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}createSniperTxBuilder(e,t){let r=new $(e);return new Ke({connection:this.scope.connection,feePayer:t,cluster:this.scope.cluster,owner:r,blockhashCommitment:this.scope.blockhashCommitment,loopMultiTxStatus:this.scope.loopMultiTxStatus,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}logDebug(...e){this.logger.debug(Tt(e))}logInfo(...e){this.logger.info(Tt(e))}logAndCreateError(...e){let t=Tt(e);throw new Error(t)}checkDisabled(){(this.disabled||!this.scope)&&this.logAndCreateError("module not working")}};var J=require("@solana/web3.js"),be=require("@solana/spl-token");function Fn(n="accountFlags"){let e=new Ze(n);return e.addBoolean("initialized"),e.addBoolean("market"),e.addBoolean("openOrders"),e.addBoolean("requestQueue"),e.addBoolean("eventQueue"),e.addBoolean("bids"),e.addBoolean("asks"),e}var Ye=he([fe(5),Fn("accountFlags"),Z("ownAddress"),W("vaultSignerNonce"),Z("baseMint"),Z("quoteMint"),Z("baseVault"),W("baseDepositsTotal"),W("baseFeesAccrued"),Z("quoteVault"),W("quoteDepositsTotal"),W("quoteFeesAccrued"),W("quoteDustThreshold"),Z("requestQueue"),Z("eventQueue"),Z("bids"),Z("asks"),W("baseLotSize"),W("quoteLotSize"),W("feeRateBps"),W("referrerRebatesAccrued"),fe(7)]);function rn({programId:n,marketInfo:e}){let t=he([Je("version"),ge("instruction"),W("baseLotSize"),W("quoteLotSize"),en("feeRateBps"),W("vaultSignerNonce"),W("quoteDustThreshold")]),r=[{pubkey:e.id,isSigner:!1,isWritable:!0},{pubkey:e.requestQueue,isSigner:!1,isWritable:!0},{pubkey:e.eventQueue,isSigner:!1,isWritable:!0},{pubkey:e.bids,isSigner:!1,isWritable:!0},{pubkey:e.asks,isSigner:!1,isWritable:!0},{pubkey:e.baseVault,isSigner:!1,isWritable:!0},{pubkey:e.quoteVault,isSigner:!1,isWritable:!0},{pubkey:e.baseMint,isSigner:!1,isWritable:!1},{pubkey:e.quoteMint,isSigner:!1,isWritable:!1},{pubkey:e.authority?e.quoteMint:J.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}].concat(e.authority?{pubkey:e.authority,isSigner:!1,isWritable:!1}:[]).concat(e.authority&&e.pruneAuthority?{pubkey:e.pruneAuthority,isSigner:!1,isWritable:!1}:[]),i=Buffer.alloc(t.span);return t.encode({version:0,instruction:0,baseLotSize:e.baseLotSize,quoteLotSize:e.quoteLotSize,feeRateBps:e.feeRateBps,vaultSignerNonce:e.vaultSignerNonce,quoteDustThreshold:e.quoteDustThreshold},i),new J.TransactionInstruction({keys:r,programId:n,data:i})}async function wt({connection:n,wallet:e,marketInfo:t}){var l,o,b,P,y,m,T,A;let r=new J.Transaction,i=await n.getMinimumBalanceForRentExemption(165);r.add(J.SystemProgram.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.baseVault.seed,newAccountPubkey:t.baseVault.publicKey,lamports:i,space:165,programId:be.TOKEN_PROGRAM_ID}),J.SystemProgram.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.quoteVault.seed,newAccountPubkey:t.quoteVault.publicKey,lamports:i,space:165,programId:be.TOKEN_PROGRAM_ID}),(0,be.createInitializeAccountInstruction)(t.baseVault.publicKey,t.baseMint,t.vaultOwner),(0,be.createInitializeAccountInstruction)(t.quoteVault.publicKey,t.quoteMint,t.vaultOwner),J.SystemProgram.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.id.seed,newAccountPubkey:t.id.publicKey,lamports:await n.getMinimumBalanceForRentExemption(Ye.span),space:Ye.span,programId:t.programId}));let a=new J.Transaction;return a.add(J.SystemProgram.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.requestQueue.seed,newAccountPubkey:t.requestQueue.publicKey,lamports:t.lowestFeeMarket?6208320:await n.getMinimumBalanceForRentExemption((l=t.requestQueueSpace)!=null?l:5120+12),space:t.lowestFeeMarket?764:(o=t.requestQueueSpace)!=null?o:5120+12,programId:t.programId}),J.SystemProgram.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.eventQueue.seed,newAccountPubkey:t.eventQueue.publicKey,lamports:t.lowestFeeMarket?79594560:await n.getMinimumBalanceForRentExemption((b=t.eventQueueSpace)!=null?b:262144+12),space:t.lowestFeeMarket?11308:(P=t.eventQueueSpace)!=null?P:262144+12,programId:t.programId}),J.SystemProgram.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.bids.seed,newAccountPubkey:t.bids.publicKey,lamports:t.lowestFeeMarket?101977920:await n.getMinimumBalanceForRentExemption((y=t.orderbookQueueSpace)!=null?y:65536+12),space:t.lowestFeeMarket?14524:(m=t.orderbookQueueSpace)!=null?m:65536+12,programId:t.programId}),J.SystemProgram.createAccountWithSeed({fromPubkey:e,basePubkey:e,seed:t.asks.seed,newAccountPubkey:t.asks.publicKey,lamports:t.lowestFeeMarket?101977920:await n.getMinimumBalanceForRentExemption((T=t.orderbookQueueSpace)!=null?T:65536+12),space:t.lowestFeeMarket?14524:(A=t.orderbookQueueSpace)!=null?A:65536+12,programId:t.programId}),rn({programId:t.programId,marketInfo:{id:t.id.publicKey,requestQueue:t.requestQueue.publicKey,eventQueue:t.eventQueue.publicKey,bids:t.bids.publicKey,asks:t.asks.publicKey,baseVault:t.baseVault.publicKey,quoteVault:t.quoteVault.publicKey,baseMint:t.baseMint,quoteMint:t.quoteMint,baseLotSize:t.baseLotSize,quoteLotSize:t.quoteLotSize,feeRateBps:t.feeRateBps,vaultSignerNonce:t.vaultSignerNonce,quoteDustThreshold:t.quoteDustThreshold}})),[{transaction:r,signer:[],instructionTypes:[H.CreateAccount,H.CreateAccount,H.InitAccount,H.InitAccount]},{transaction:a,signer:[],instructionTypes:[H.CreateAccount,H.CreateAccount,H.CreateAccount,H.CreateAccount,H.CreateAccount,H.InitMarket]}]}var Ee=class extends Ne{async create({baseInfo:e,quoteInfo:t,lotSize:r,tickSize:i,dexProgramId:a,requestQueueSpace:l,eventQueueSpace:o,orderbookQueueSpace:b,lowestFeeMarket:P,assignSeed:y,txVersion:m,computeBudgetConfig:T,txTipConfig:A,feePayer:d}){let g=this.scope.ownerPubKey,s=y?`${e.mint.toBase58().slice(0,10)}-${t.mint.toBase58().slice(0,10)}-${y}`:void 0,M=ue({fromPublicKey:g,programId:a,assignSeed:s&&`${s}-market`}),S=ue({fromPublicKey:g,programId:a,assignSeed:s&&`${s}-request`}),D=ue({fromPublicKey:g,programId:a,assignSeed:s&&`${s}-event`}),p=ue({fromPublicKey:g,programId:a,assignSeed:s&&`${s}-bids`}),u=ue({fromPublicKey:g,programId:a,assignSeed:s&&`${s}-asks`}),c=ue({fromPublicKey:g,programId:Pt.TOKEN_PROGRAM_ID,assignSeed:s&&`${s}-baseVault`}),x=ue({fromPublicKey:g,programId:Pt.TOKEN_PROGRAM_ID,assignSeed:s&&`${s}-quoteVault`}),f=0,k=new xe.default(100);function N(){let O=new xe.default(0);for(;;)try{return{vaultOwner:ye.PublicKey.createProgramAddressSync([M.publicKey.toBuffer(),O.toArrayLike(Buffer,"le",8)],a),vaultSignerNonce:O}}catch{if(O.iaddn(1),O.gt(new xe.default(25555)))throw Error("find vault owner error")}}let{vaultOwner:K,vaultSignerNonce:B}=N(),L=new xe.default(Math.round(10**e.decimals*r)),C=new xe.default(Math.round(r*10**t.decimals*i));if(L.eq(We))throw Error("lot size is too small");if(C.eq(We))throw Error("tick size or lot size is too small");let V=await wt({connection:this.scope.connection,wallet:this.scope.ownerPubKey,marketInfo:{programId:a,id:M,baseMint:e.mint,quoteMint:t.mint,baseVault:c,quoteVault:x,vaultOwner:K,requestQueue:S,eventQueue:D,bids:p,asks:u,feeRateBps:f,quoteDustThreshold:k,vaultSignerNonce:B,baseLotSize:L,quoteLotSize:C,requestQueueSpace:l,eventQueueSpace:o,orderbookQueueSpace:b,lowestFeeMarket:P}}),E=this.createTxBuilder(d);E.addInstruction({instructions:V[0].transaction.instructions,signers:V[0].signer});for await(let O of V.slice(1,V.length))E.addInstruction({instructions:O.transaction.instructions,signers:O.signer,instructionTypes:O.instructionTypes});return m===0?E.sizeCheckBuildV0({computeBudgetConfig:T,address:{marketId:M.publicKey,requestQueue:S.publicKey,eventQueue:D.publicKey,bids:p.publicKey,asks:u.publicKey,baseVault:c.publicKey,quoteVault:x.publicKey,baseMint:new ye.PublicKey(e.mint),quoteMint:new ye.PublicKey(t.mint)}}):E.sizeCheckBuild({computeBudgetConfig:T,address:{marketId:M.publicKey,requestQueue:S.publicKey,eventQueue:D.publicKey,bids:p.publicKey,asks:u.publicKey,baseVault:c.publicKey,quoteVault:x.publicKey,baseMint:new ye.PublicKey(e.mint),quoteMint:new ye.PublicKey(t.mint)}})}};0&&(module.exports={MARKET_STATE_LAYOUT_V2,initializeMarket,makeCreateMarketInstruction});
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */
//# sourceMappingURL=index.js.map