var ur=Object.create;var bt=Object.defineProperty,lr=Object.defineProperties,mr=Object.getOwnPropertyDescriptor,dr=Object.getOwnPropertyDescriptors,pr=Object.getOwnPropertyNames,Et=Object.getOwnPropertySymbols,fr=Object.getPrototypeOf,nn=Object.prototype.hasOwnProperty,ti=Object.prototype.propertyIsEnumerable;var ei=(o,e,t)=>e in o?bt(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,V=(o,e)=>{for(var t in e||(e={}))nn.call(e,t)&&ei(o,t,e[t]);if(Et)for(var t of Et(e))ti.call(e,t)&&ei(o,t,e[t]);return o},Z=(o,e)=>lr(o,dr(e));var ve=(o,e)=>{var t={};for(var n in o)nn.call(o,n)&&e.indexOf(n)<0&&(t[n]=o[n]);if(o!=null&&Et)for(var n of Et(o))e.indexOf(n)<0&&ti.call(o,n)&&(t[n]=o[n]);return t};var br=(o,e)=>{for(var t in e)bt(o,t,{get:e[t],enumerable:!0})},ni=(o,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of pr(e))!nn.call(o,i)&&i!==t&&bt(o,i,{get:()=>e[i],enumerable:!(n=mr(e,i))||n.enumerable});return o};var U=(o,e,t)=>(t=o!=null?ur(fr(o)):{},ni(e||!o||!o.__esModule?bt(t,"default",{value:o,enumerable:!0}):t,o)),yr=o=>ni(bt({},"__esModule",{value:!0}),o);var Bo={};br(Bo,{LaunchpadPoolInitParam:()=>Xe,default:()=>Jt});module.exports=yr(Bo);var yt=require("lodash");var rn=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:0,this.name=e.name}set level(e){this.logLevel=e}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let t=e.map(n=>typeof n=="object"?JSON.stringify(n):n).join(", ");throw new Error(t)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},ii={},gr={};function le(o){let e=(0,yt.get)(ii,o);if(!e){let t=(0,yt.get)(gr,o);e=new rn({name:o,logLevel:t}),(0,yt.set)(ii,o,e)}return e}var X=require("@solana/web3.js"),hi=U(require("axios"));var he=require("@solana/web3.js");var ki=require("@solana/web3.js");var ke=U(require("bn.js")),Cr=U(require("decimal.js"));var ci=U(require("big.js")),kr=U(require("bn.js"));var ri=U(require("toformat")),Pr=ri.default,gt=Pr;var Pt=U(require("big.js")),si=U(require("bn.js")),ai=U(require("decimal.js-light"));var et=U(require("bn.js"));var oi=9007199254740991;function Ke(o){let e=le("Raydium_parseBigNumberish");if(o instanceof et.default)return o;if(typeof o=="string"){if(o.match(/^-?[0-9]+$/))return new et.default(o);e.logWithError(`invalid BigNumberish string: ${o}`)}return typeof o=="number"?(o%1&&e.logWithError(`BigNumberish number underflow: ${o}`),(o>=oi||o<=-oi)&&e.logWithError(`BigNumberish number overflow: ${o}`),new et.default(String(o))):typeof o=="bigint"?new et.default(o.toString()):(e.error(`invalid BigNumberish value: ${o}`),new et.default(0))}var vt=le("module/fraction"),on=gt(Pt.default),At=gt(ai.default),wr={[0]:At.ROUND_DOWN,[1]:At.ROUND_HALF_UP,[2]:At.ROUND_UP},Tr={[0]:Pt.default.roundDown,[1]:Pt.default.roundHalfUp,[2]:Pt.default.roundUp},ie=class{constructor(e,t=new si.default(1)){this.numerator=Ke(e),this.denominator=Ke(t)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new ie(this.denominator,this.numerator)}add(e){let t=e instanceof ie?e:new ie(Ke(e));return this.denominator.eq(t.denominator)?new ie(this.numerator.add(t.numerator),this.denominator):new ie(this.numerator.mul(t.denominator).add(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}sub(e){let t=e instanceof ie?e:new ie(Ke(e));return this.denominator.eq(t.denominator)?new ie(this.numerator.sub(t.numerator),this.denominator):new ie(this.numerator.mul(t.denominator).sub(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}mul(e){let t=e instanceof ie?e:new ie(Ke(e));return new ie(this.numerator.mul(t.numerator),this.denominator.mul(t.denominator))}div(e){let t=e instanceof ie?e:new ie(Ke(e));return new ie(this.numerator.mul(t.denominator),this.denominator.mul(t.numerator))}toSignificant(e,t={groupSeparator:""},n=1){Number.isInteger(e)||vt.logWithError(`${e} is not an integer.`),e<=0&&vt.logWithError(`${e} is not positive.`),At.set({precision:e+1,rounding:wr[n]});let i=new At(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return i.toFormat(i.decimalPlaces(),t)}toFixed(e,t={groupSeparator:""},n=1){return Number.isInteger(e)||vt.logWithError(`${e} is not an integer.`),e<0&&vt.logWithError(`${e} is negative.`),on.DP=e,on.RM=Tr[n]||1,new on(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,t)}isZero(){return this.numerator.isZero()}};var Uo=le("Raydium_amount"),Xo=gt(ci.default);var ui=require("@solana/web3.js"),sn=require("@solana/spl-token"),an={chainId:101,address:ui.PublicKey.default.toBase58(),programId:sn.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},De={chainId:101,address:"So11111111111111111111111111111111111111112",programId:sn.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};var Wt=require("@solana/web3.js");var J=require("@solana/web3.js"),li=require("@solana/spl-token");function cn({pubkey:o,isSigner:e=!1,isWritable:t=!0}){return{pubkey:o,isWritable:t,isSigner:e}}var Qo=[cn({pubkey:li.TOKEN_PROGRAM_ID,isWritable:!1}),cn({pubkey:J.SystemProgram.programId,isWritable:!1}),cn({pubkey:J.SYSVAR_RENT_PUBKEY,isWritable:!1})];function mi({publicKey:o,transformSol:e}){let t=di(o.toString());if(t instanceof J.PublicKey)return e&&t.equals(wt)?Dt:t;if(e&&t.toString()===wt.toBase58())return Dt;if(typeof t=="string"){if(t===J.PublicKey.default.toBase58())return J.PublicKey.default;try{return new J.PublicKey(t)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function di(o){try{return new J.PublicKey(o)}catch{return o}}var hr=new J.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),xr=new J.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),un=new J.PublicKey("SysvarRent111111111111111111111111111111111"),Zo=new J.PublicKey("SysvarC1ock11111111111111111111111111111111"),tt=new J.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),Yo=new J.PublicKey("Sysvar1nstructions1111111111111111111111111"),Jo=J.SystemProgram.programId,$o=new J.PublicKey("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),es=new J.PublicKey("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),ts=new J.PublicKey("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),ns=new J.PublicKey("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),is=new J.PublicKey("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),rs=new J.PublicKey("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),os=new J.PublicKey("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),ss=new J.PublicKey("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),as=new J.PublicKey("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),cs=new J.PublicKey("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),us=new J.PublicKey("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),Dt=new J.PublicKey("So11111111111111111111111111111111111111112"),wt=J.PublicKey.default;var ln=class{constructor({mint:e,decimals:t,symbol:n,name:i,skipMint:r=!1,isToken2022:s=!1}){if(e===wt.toBase58()||e instanceof Wt.PublicKey&&wt.equals(e)){this.decimals=De.decimals,this.symbol=De.symbol,this.name=De.name,this.mint=new Wt.PublicKey(De.address),this.isToken2022=!1;return}this.decimals=t,this.symbol=n||e.toString().substring(0,6),this.name=i||e.toString().substring(0,6),this.mint=r?Wt.PublicKey.default:mi({publicKey:e}),this.isToken2022=s}equals(e){return this===e?!0:this.mint.equals(e.mint)}},We=ln;We.WSOL=new ln(Z(V({},De),{mint:De.address}));var mn=class{constructor({decimals:e,symbol:t="UNKNOWN",name:n="UNKNOWN"}){this.decimals=e,this.symbol=t,this.name=n}equals(e){return this===e}},Vt=mn;Vt.SOL=new mn(an);var pi=U(require("bn.js"));var As=new ie(new pi.default(100));var xs=le("Raydium_price");var Sr=require("@solana/web3.js"),Kr=U(require("bn.js"));var Ir=new ke.default(0),na=new ke.default(1),ia=new ke.default(2),ra=new ke.default(3),oa=new ke.default(5),Br=new ke.default(10),sa=new ke.default(100),aa=new ke.default(1e3),ca=new ke.default(1e4);function fi(o,e,t){return o.mul(e).add(t).sub(new ke.default(1)).div(t)}function fn(o,e=1,t=[]){let n=[...o];if(e<=0)return t;for(;n.length;)t.push(n.splice(0,e));return t}var Ce=class{constructor(e){this._owner=e}get publicKey(){return Ce.isKeyPair(this._owner)?this._owner.publicKey:this._owner}get signer(){return Ce.isKeyPair(this._owner)?this._owner:void 0}get isKeyPair(){return Ce.isKeyPair(this._owner)}get isPublicKey(){return Ce.isPublicKey(this._owner)}static isKeyPair(e){return e.secretKey!==void 0}static isPublicKey(e){return!Ce.isKeyPair(e)}};var Pi=require("@solana/web3.js"),Ai=require("@solana/spl-token");var me=require("@solana/web3.js");var He={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",ClmmLockPosition:"ClmmLockPosition",ClmmHarvestLockPosition:"ClmmHarvestLockPosition",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV4Withdraw:"FarmV4Withdraw",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut",CpmmLockLp:"CpmmLockLp",CpmmCollectLockFee:"CpmmCollectLockFee",TransferTip:"TransferTip"};var yi=require("@solana/spl-token"),bi=le("Raydium_txUtil"),gi=1644;function Tt(o){let e=[],t=[];return o.microLamports&&(e.push(me.ComputeBudgetProgram.setComputeUnitPrice({microLamports:o.microLamports})),t.push(He.SetComputeUnitPrice)),o.units&&(e.push(me.ComputeBudgetProgram.setComputeUnitLimit({units:o.units})),t.push(He.SetComputeUnitLimit)),{instructions:e,instructionTypes:t}}async function je(o,e){var n,i;let t=e!=null?e:"confirmed";return(i=await((n=o.getLatestBlockhash)==null?void 0:n.call(o,{commitment:t})))==null?void 0:i.blockhash}async function kt(o,e){return o.getSignatureStatuses([e]),new Promise((t,n)=>{let i=setTimeout(n,6e4);o.onSignature(e,r=>{if(clearTimeout(i),!r.err){t("");return}n(Object.assign(r.err,{txId:e}))},"confirmed")})}function Nr(o,e){o.length<1&&bi.logWithError(`no instructions provided: ${o.toString()}`),e.length<1&&bi.logWithError(`no signers provided:, ${e.toString()}`);let t=new me.Transaction;t.recentBlockhash="11111111111111111111111111111111",t.feePayer=e[0],t.add(...o);try{return Buffer.from(t.serialize({verifySignatures:!1})).toString("base64").length<gi}catch{return!1}}function de(o,e){let[t,n]=me.PublicKey.findProgramAddressSync(o,e);return{publicKey:t,nonce:n}}function Bt({instructions:o,payer:e,signers:t}){return Nr(o,[e,...t])}function Le({instructions:o,payer:e,lookupTableAddressAccount:t,recentBlockhash:n=me.Keypair.generate().publicKey.toString()}){let r=new me.TransactionMessage({payerKey:e,recentBlockhash:n,instructions:o}).compileToV0Message(Object.values(t!=null?t:{}));try{return Buffer.from(new me.VersionedTransaction(r).serialize()).toString("base64").length<gi}catch{return!1}}var Rr=o=>Buffer.isBuffer(o)?o:o instanceof Uint8Array?Buffer.from(o.buffer,o.byteOffset,o.byteLength):Buffer.from(o),Lr=o=>{let e=o.serialize({requireAllSignatures:!1,verifySignatures:!1});o instanceof me.VersionedTransaction&&(e=Rr(e));try{return e instanceof Buffer?e.toString("base64"):Buffer.from(e).toString("base64")}catch{return e.toString("base64")}};function Ve(o){let e=[];return o.forEach(t=>{t instanceof me.Transaction&&(t.recentBlockhash||(t.recentBlockhash=yi.TOKEN_PROGRAM_ID.toBase58()),t.feePayer||(t.feePayer=me.Keypair.generate().publicKey)),e.push(Lr(t))}),console.log("simulate tx string:",e),e}function Be(o,e,t){return de([o.toBuffer(),(t!=null?t:Ai.TOKEN_PROGRAM_ID).toBuffer(),e.toBuffer()],new Pi.PublicKey("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"))}var O=require("@solana/web3.js"),ha=new O.PublicKey("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),xa=new O.PublicKey("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),Ia=new O.PublicKey("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),Sa=new O.PublicKey("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),Ka=new O.PublicKey("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),Ca=new O.PublicKey("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),Na=new O.PublicKey("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),Ra=new O.PublicKey("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),La=new O.PublicKey("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),Fa=new O.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Fr=new O.PublicKey("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),Mr=new O.PublicKey("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),Or=new O.PublicKey("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),Ma=new O.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Oa=new O.PublicKey("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),Ea=new O.PublicKey("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),va=new O.PublicKey("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),Da=new O.PublicKey("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),Wa=new O.PublicKey("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),Va=new O.PublicKey("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),_a=new O.PublicKey("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),qa=new O.PublicKey("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),Ga=new O.PublicKey("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),Ua=new O.PublicKey("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),Xa=new O.PublicKey("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),ae=new O.PublicKey("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),za=new O.PublicKey("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),Ha=new O.PublicKey("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),ja=new O.PublicKey("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),Qa=new O.PublicKey("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),Za=new O.PublicKey("6s1xP3hpbAfFoNtUNF8mfHsjr2Bd97JxFJRWLbL6aHuX");var Ya={OPEN_BOOK_PROGRAM:new O.PublicKey("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),SERUM_PROGRAM_ID_V3:new O.PublicKey("Ray1111111111111111111111111111111111111111"),AMM_V4:new O.PublicKey("DRaya7Kj3aMWQSy19kSjvmuwq9docCHofyP9kanQGaav"),AMM_STABLE:new O.PublicKey("DRayDdXc1NZQ9C3hRWmoSf8zK4iapgMnjdNZWrfwsP8m"),CLMM_PROGRAM_ID:new O.PublicKey("DRayAUgENGQBKVaX8owNhgzkEDyoHTGVEGHVJT1E9pfH"),CLMM_LOCK_PROGRAM_ID:new O.PublicKey("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),CLMM_LOCK_AUTH_ID:new O.PublicKey("6Aoh8h2Lw2m5UGxYR8AdAL87jTWYeKoxM52mJRzfYwN"),CREATE_CPMM_POOL_PROGRAM:new O.PublicKey("DRaycpLY18LhpbydsBWbVJtxpNv9oXPgjRSfpF2bWpYb"),CREATE_CPMM_POOL_AUTH:new O.PublicKey("CXniRufdq5xL8t8jZAPxsPZDpuudwuJSPWnbcD5Y5Nxq"),CREATE_CPMM_POOL_FEE_ACC:new O.PublicKey("3oE58BKVt8KuYkGxx8zBojugnymWmBiyafWgMrnb6eYy"),LOCK_CPMM_PROGRAM:new O.PublicKey("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),LOCK_CPMM_AUTH:new O.PublicKey("7qWVV8UY2bRJfDLP4s37YzBPKUkVB46DStYJBpYbQzu3"),UTIL1216:O.PublicKey.default,Router:new O.PublicKey("DRaybByLpbUL57LJARs3j8BitTxVfzBg351EaMr5UTCd"),FARM_PROGRAM_ID_V3:new O.PublicKey("DRayWyrLmEW5KEeqs8kdTMMaBabapqagaBC7KWpGtJeZ"),FARM_PROGRAM_ID_V4:new O.PublicKey("Ray1111111111111111111111111111111111111111"),FARM_PROGRAM_ID_V5:new O.PublicKey("DRayiCGSZgku1GTK6rXD6mVDdingXy6APAH1R6R5L2LC"),FARM_PROGRAM_ID_V6:new O.PublicKey("DRayzbYakXs45ELHkzH6vC3fuhQqTAnv5A68gdFuvZyZ"),LAUNCHPAD_PROGRAM:new O.PublicKey("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),LAUNCHPAD_AUTH:new O.PublicKey("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),LAUNCHPAD_PLATFORM:new O.PublicKey("2Jx4KTDrVSdWNazuGpcA8n3ZLTRGGBDxAWhuKe2Xcj2a"),LAUNCHPAD_CONFIG:new O.PublicKey("7ZR4zD7PYfY2XxoG1Gxcy2EgEeGYrpxrwzPuwdUBssEt"),FEE_DESTINATION_ID:new O.PublicKey("9y8ENuuZ3b19quffx9hQvRVygG5ky6snHfRvGpuSfeJy"),MODEL_DATA_PUBKEY:new O.PublicKey("Ray1111111111111111111111111111111111111111")};var ce=U(require("bn.js")),ht=1e4;function bn(o,e){let{div:t,mod:n}=o.divmod(e);return n.gt(new ce.default(0))?t.add(new ce.default(1)):t}function Qe(o,e){if(o.isZero())return new ce.default(0);let t=o.div(e);return t.isZero()?new ce.default(1):o.mod(e).gt(new ce.default(0))?t.add(new ce.default(1)):t}function yn(o,e,t){if(e===void 0)return{amount:o,fee:void 0,expirationTime:void 0};let n=Math.floor(t/432e3),i=n<e.newerTransferFee.epoch?e.olderTransferFee:e.newerTransferFee,r=new ce.default(i.maximumFee.toString()),s=n<e.newerTransferFee.epoch?(Number(e.newerTransferFee.epoch)*432e3-t)*400/1e3:void 0,a=bn(o.mul(new ce.default(i.transferFeeBasisPoints)),new ce.default(ht)),l=a.gt(r)?r:a;return{amount:o,fee:l,expirationTime:s}}function gn(o,e,t){if(e===void 0)return{amount:o,fee:void 0,expirationTime:void 0};let n=Math.floor(t/432e3),i=n<e.newerTransferFee.epoch?e.olderTransferFee:e.newerTransferFee,r=new ce.default(i.maximumFee.toString()),s=n<e.newerTransferFee.epoch?(Number(e.newerTransferFee.epoch)*432e3-t)*400/1e3:void 0;if(i.transferFeeBasisPoints===ht){let a=new ce.default(i.maximumFee.toString());return{amount:o.add(a),fee:a,expirationTime:s}}else{let a=bn(o.mul(new ce.default(ht)),new ce.default(ht-i.transferFeeBasisPoints)),l=new ce.default(i.maximumFee.toString()),c=a.sub(o).gt(l)?o.add(l):a,p=bn(c.mul(new ce.default(i.transferFeeBasisPoints)),new ce.default(ht)),m=p.gt(r)?r:p;return{amount:c,fee:m,expirationTime:s}}}var wi=U(require("bn.js")),Ze=new wi.default(1e6);var qt=require("@solana/spl-token"),Pn=le("Raydium_accountInfo_util");async function xt(o,e,t){let{batchRequest:n,commitment:i="confirmed",chunkCount:r=100}=V({batchRequest:!1},t),s=fn(e,r),a=new Array(s.length).fill([]);if(n){let l=s.map(m=>{let w=o._buildArgs([m.map(A=>A.toBase58())],i,"base64");return{methodName:"getMultipleAccounts",args:w}}),c=fn(l,10);a=(await(await Promise.all(c.map(async m=>await o._rpcBatchRequest(m)))).flat()).map(m=>(m.error&&Pn.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${m.error.message}`),m.result.value.map(w=>{if(w){let{data:A,executable:u,lamports:y,owner:b,rentEpoch:h}=w;return A.length!==2&&A[1]!=="base64"&&Pn.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(A[0],"base64"),executable:u,lamports:y,owner:new ki.PublicKey(b),rentEpoch:h}}return null})))}else try{a=await Promise.all(s.map(l=>o.getMultipleAccountsInfo(l,i)))}catch(l){l instanceof Error&&Pn.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${l.message}`)}return a.flat()}async function Fe(o,e,t){let n=await xt(o,e.map(i=>i.pubkey),t);return e.map((i,r)=>Z(V({},i),{accountInfo:n[r]}))}async function Gt({connection:o,address:e,cluster:t="mainnet"}){let n=await xt(o,[...new Set(e.map(r=>r.toString()))].map(r=>new he.PublicKey(r))),i={};for(let r=0;r<e.length;r++){let s=n[r],a=e[r];if(!s)continue;let l=new he.AddressLookupTableAccount({key:a,state:he.AddressLookupTableAccount.deserialize(s.data)});i[a.toString()]=l,t==="devnet"?nt[a.toString()]=l:It[a.toString()]=l}return i}var It={AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU:new he.AddressLookupTableAccount({key:new he.PublicKey("AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU"),state:he.AddressLookupTableAccount.deserialize(Buffer.from("AQAAAP//////////I1rcEwAAAAAvAQYwun9CU6c5Ikm2pAj+D9IEnCOR45nK+SFTGSdpd6J6AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbd9uHXZaGT2cvhRs7reawctIXtX1s3kTqM9YV+/wCpBt324e51j94YQl285GzN2rYa/E2DuQ0n/r35KNihi/wFSlNQ+F3IgtYUpVZyeIopbd8eq6vQpgZ4iEky9O72oAVKU1qZKSEGTSTocWDaOHx8NbXdvJK7geQfqEBBBUSNBqfVFxksXFEhjMlMPUrxf1ja7gibof1E49vZigAAAAAGp9UXGMd0yShWY5hpHV62i164o5tLbVxzVVshAAAAAIyXJY9OJInxuz0QKRSODYMLWhOZ2v8QhASOe9jb6fhZC3BlsePRfEU4nVJ/awTDzVi4bHMaoP21SbbRvAP4KUbIScv+6Yw2LHF/6K0ZjUPibbSWXCirYPGuuVl7zT789IUPLW4CpHr4JNCatp3ELXDLKMv6JJ+37le50lbBJ2LvBkX2T9y7AHdNGviJAqQNtlDUDCnauQRWybsLji6nPM8Qkw5asQRvCdB3MbX6IEBwytOrpM32l4jQygKG9TKgR0vZScQ2AsM/IHeQ7RajUkyhuZdc8SGiqQz/7H34torNR/Wir3sl0ruUrVxJWEZfUg+QLNAxxODdBi53/OP7Ioil1cqeBM9dtZC3FLov4yyxWRM/wcGStyJX/QfTnLBAHqkqWotPKVlShCVQqpP9W5W1rOao65IMk5QuQ2kMIOxzDMKAy2vjGSxQODgBz0QwGA+eP4ZjIjrIAQaXENv31QfLlOdXSRCkaybRniDHF4C8YcwhcvsqrOVuTP4B2Na+9wLdtrB31uz2rtlFI5kahdsnp/d1SrASDInYCtTYtdoke4kX+hoKWcEWM4Tle8pTUkUVv4BxS6fje/EzKBE4Qu/YsA/yfEEFGcr8Z57VKDw8uQzpiru7g4lvjnfapW62W030syevD8k07SGoxUHiuT/ai7gAHWWhDsVmg/C63ajgpkH7Sn3GdutArDTfyqOkdqv4/IPC/EFFy7mGkfDd2C57N5a/4jC+BbmJy7wQaSEZr0CQU88lPtUxIVvzGjC95b8Ooss2TqmkrayGKofkPMGQn7Ux+9lfwBSNfxwH8NgbpqC/7LNlV4I7nCvsXf3p+ohQk9NrAJb2KAFpUqEIJ9ZBV7BYDzHF/ORKYlgtvPnXjudZQ6CEo5OzUDaNIomTCCsvhD16TxJjsbgne1kGnQPCFSoaxUbq2V1bPMFQ3VYP6wDZ9bKStCFKx9A3tNbwZFC5ZGAN83MFK7XoTy+OmmcFEr6rLOjfSuTfPvHJkSVxW6Qllwkl67XcBi5v00u2gQsbu+38sp+rd5pA/LvyWj4P94ZGZwc1tE2P88xekCLcAwZGb+UhFzL/7K26csOb57yM5bvF9xJrLEObOkAAAAAn+HWRkdcPKyFFMnVwEoD7vnD0jCKFIU1sImubYCxNTSVzsKpaQX+fzNxrLAI3L14JQnJx/D6Uk2LADIHGqnGELzjEbkBDAlaM77NkXMPfqXNLSveCkWI7UEgNs31WEWB6XHSYI/v5DklHOb4QTtDOR804PVbi3fjloZeLR2F8d4FuZmMMO7ck3Fnkn2zEMG5gOmqsygb6PjTitArVl52NhcSznTxVnguaIJxiZkAnurDmn3MWR0PC2GLghp2KJqHCc6QQ85odeIjFHKOlRlJyeSXVJmL8vb1UgOzsbJPVP8p6zM4M3C1Sd7uWIHP33G42AP2Zg8ucn/n6meQjjD266JgCWdxZD6PXs9CsnIeL7SSG0/6lGb9xfP0ZcWkCXB/3hjxHYVXjra/GPOeXGk0fLLKjCbk+mgs2w6d2oCwimBipTzuoZ30GiI8ij8VRzD5CzMWtu2m21eDBIfjGAEo4pQeNNonKcqzV/cleX8ySZLOHsz8PtBCrLqF+VkLm9hOzIT+6i/nIf6keR4GWKMOD4AvqfpjHoD4DuhBpz8P28+DxkGrDXXr/nr20x291VPvcTU/b+b+o2kC9G0kcXeTlLjU6a2TQXWlZ4gBUdBl1jgT7mObSTpLblNiXZsLkbmVXZwvFKXua5cUKlWed/w30skmEUraTuQqtqr5fHZPW9n57EmeTif6LjHL2YJFZkQU+TrJmFzqzmF4/b8OwrPQAprl8mX3q4LUIdAS/a+11B6DWD1Xk2++Sn94dLC4xjkO4Wtlw8c4XuzciVbepHOmnoWzVu/0y3KCrLCSfQxQ3br8DJCoVzhgtPsS2nZZjsBGIZgnU0QpMv+2MnRsnKwdp1VsrCX84j/qvaZn4WhKunippgTbN2EUs0tPTP55Qfgj+nKmjtWW5IYs72FrEwJKYoNfsmqaF4o5pf4v9zgPwVwY/5I4XJKUL2L25m9kAQcW/K+H1RTFEUoj8Z4ajpOmAB/dG0COmCphVMW2CCMvnxhcGiSgPnpDuWu6qiJ7NG7ye5kvHgefgqPLeicspNJ5EpL3XiRNLM2tmJLI1awAwOyd6iHv0dCkMYRKaa6rcaZeYwmKCkckm0kM2JNmnmmAaBQQ7mwmIM0IMxX4f5W6j9PqZWcJxF7r17T/lQBAmcjoupRiJifbnXCNUv9GhpRF19WcBdeKbivRJVlGop6I2RS6lGImJ9udcI1S/0aGlEXX1ZwF14puK9ElWUainojZFYVHLHD6dIP2ESjqBzg3ol1/wB7+/ylGwd9LS7wSZ2A630CJSVKwH47K9P4bB8PEQP8BwjMFa7xQHOqZFP1XqaQ==","base64"))})},nt={},Ut=async o=>{let e="EFhMuDw1PKEuckuFRW9PavNfTH4LKP5uKHgyXDmWpFCq";if(nt[e])return nt;let t=new he.PublicKey(e),n=await o.getAccountInfo(t);return n&&(nt[e]=new he.AddressLookupTableAccount({key:t,state:he.AddressLookupTableAccount.deserialize(n.data)})),nt};var St=2e3,Kt=class{constructor(e){this.instructions=[];this.endInstructions=[];this.lookupTableAddress=[];this.signers=[];this.instructionTypes=[];this.endInstructionTypes=[];this.connection=e.connection,this.feePayer=e.feePayer,this.signAllTransactions=e.signAllTransactions,this.owner=e.owner,this.cluster=e.cluster,this.blockhashCommitment=e.blockhashCommitment,this.loopMultiTxStatus=!!e.loopMultiTxStatus}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers,instructionTypes:this.instructionTypes,endInstructionTypes:this.endInstructionTypes,lookupTableAddress:this.lookupTableAddress}}get allInstructions(){return[...this.instructions,...this.endInstructions]}async getComputeBudgetConfig(){var n;let e=(await hi.default.get(`https://solanacompass.com/api/fees?cacheFreshTime=${3e5}`)).data,{avg:t}=(n=e==null?void 0:e[15])!=null?n:{};if(!!t)return{units:6e5,microLamports:Math.min(Math.ceil(t*1e6/6e5),25e3)}}addCustomComputeBudget(e){if(e){let{instructions:t,instructionTypes:n}=Tt(e);return this.instructions.unshift(...t),this.instructionTypes.unshift(...n),!0}return!1}addTipInstruction(e){var t;return e?(this.endInstructions.push(X.SystemProgram.transfer({fromPubkey:(t=e.feePayer)!=null?t:this.feePayer,toPubkey:new X.PublicKey(e.address),lamports:BigInt(e.amount.toString())})),this.endInstructionTypes.push(He.TransferTip),!0):!1}async calComputeBudget({config:e,defaultIns:t}){try{let n=e||await this.getComputeBudgetConfig();if(this.addCustomComputeBudget(n))return;t&&this.instructions.unshift(...t)}catch{t&&this.instructions.unshift(...t)}}addInstruction({instructions:e=[],endInstructions:t=[],signers:n=[],instructionTypes:i=[],endInstructionTypes:r=[],lookupTableAddress:s=[]}){return this.instructions.push(...e),this.endInstructions.push(...t),this.signers.push(...n),this.instructionTypes.push(...i),this.endInstructionTypes.push(...r),this.lookupTableAddress.push(...s.filter(a=>a!==X.PublicKey.default.toString())),this}async versionBuild({txVersion:e,extInfo:t}){return e===0?await this.buildV0(V({},t||{})):this.build(t)}build(e){var n;let t=new X.Transaction;return this.allInstructions.length&&t.add(...this.allInstructions),t.feePayer=this.feePayer,((n=this.owner)==null?void 0:n.signer)&&!this.signers.some(i=>i.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer),{builder:this,transaction:t,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async i=>{var p;let{recentBlockHash:r,skipPreflight:s=!0,sendAndConfirm:a,notSendToRpc:l}=i||{},c=r!=null?r:await je(this.connection,this.blockhashCommitment);if(t.recentBlockhash=c,this.signers.length&&t.sign(...this.signers),Ve([t]),(p=this.owner)!=null&&p.isKeyPair)return{txId:a?await(0,X.sendAndConfirmTransaction)(this.connection,t,this.signers.find(w=>w.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:s}):await this.connection.sendRawTransaction(t.serialize(),{skipPreflight:s}),signedTx:t};if(this.signAllTransactions){let m=await this.signAllTransactions([t]);if(this.signers.length)for(let w of m)try{w.sign(...this.signers)}catch{}return{txId:l?"":await this.connection.sendRawTransaction(m[0].serialize(),{skipPreflight:s}),signedTx:m[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:e||{}}}buildMultiTx(e){var c;let{extraPreBuildData:t=[],extInfo:n}=e,{transaction:i}=this.build(n),r=t.filter(p=>p.transaction.instructions.length>0),s=[i,...r.map(p=>p.transaction)],a=[this.signers,...r.map(p=>p.signers)],l=[...this.instructionTypes,...r.map(p=>p.instructionTypes).flat()];return(c=this.owner)!=null&&c.signer&&a.forEach(p=>{p.some(m=>m.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),{builder:this,transactions:s,signers:a,instructionTypes:l,execute:async p=>{var h;let{sequentially:m,onTxUpdate:w,skipTxCount:A=0,recentBlockHash:u,skipPreflight:y=!0}=p||{},b=u!=null?u:await je(this.connection,this.blockhashCommitment);if((h=this.owner)!=null&&h.isKeyPair){if(m){let f=[],I=0;for(let T of s){if(++I,I<=A)continue;let d=await(0,X.sendAndConfirmTransaction)(this.connection,T,this.signers.find(P=>P.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:y});f.push(d)}return{txIds:f,signedTxs:s}}return{txIds:await await Promise.all(s.map(async f=>(f.recentBlockhash=b,await this.connection.sendRawTransaction(f.serialize(),{skipPreflight:y})))),signedTxs:s}}if(this.signAllTransactions){let f=s.map((T,d)=>(T.recentBlockhash=b,a[d].length&&T.sign(...a[d]),T));Ve(f);let I=await this.signAllTransactions(f);if(m){let T=0,d=[],P=async()=>{if(!I[T])return;let x=await this.connection.sendRawTransaction(I[T].serialize(),{skipPreflight:y});d.push({txId:x,status:"sent",signedTx:I[T]}),w==null||w([...d]),T++;let k=!1,K=null,N=null,B=L=>{K!==null&&clearInterval(K),N!==null&&this.connection.removeSignatureListener(N);let F=d.findIndex(D=>D.txId===x);if(F>-1){if(d[F].status==="error"||d[F].status==="success")return;d[F].status=L.err?"error":"success"}w==null||w([...d]),L.err||P()};this.loopMultiTxStatus&&(K=setInterval(async()=>{var L;if(k){clearInterval(K);return}try{let F=await this.connection.getTransaction(x,{commitment:"confirmed",maxSupportedTransactionVersion:0});F&&(k=!0,clearInterval(K),B({err:((L=F.meta)==null?void 0:L.err)||null}),console.log("tx status from getTransaction:",x))}catch(F){k=!0,clearInterval(K),console.error("getTransaction timeout:",F,x)}},St)),N=this.connection.onSignature(x,L=>{if(k){this.connection.removeSignatureListener(N);return}k=!0,B(L)},"confirmed"),this.connection.getSignatureStatus(x)};return await P(),{txIds:d.map(x=>x.txId),signedTxs:I}}else{let T=[];for(let d=0;d<I.length;d+=1){let P=await this.connection.sendRawTransaction(I[d].serialize(),{skipPreflight:y});T.push(P)}return{txIds:T,signedTxs:I}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:n||{}}}async versionMultiBuild({extraPreBuildData:e,txVersion:t,extInfo:n}){return t===0?await this.buildV0MultiTx({extraPreBuildData:e,buildProps:n||{}}):this.buildMultiTx({extraPreBuildData:e,extInfo:n})}async buildV0(e){var y;let u=e||{},{lookupTableCache:t={},lookupTableAddress:n=[],forerunCreate:i,recentBlockhash:r}=u,s=ve(u,["lookupTableCache","lookupTableAddress","forerunCreate","recentBlockhash"]),a=V(V({},this.cluster==="devnet"?await Ut(this.connection):It),t),l=Array.from(new Set([...n,...this.lookupTableAddress])),c=[];for(let b of l)a[b]===void 0&&c.push(new X.PublicKey(b));let p=await Gt({connection:this.connection,address:c});for(let[b,h]of Object.entries(p))a[b]=h;let m=i?X.PublicKey.default.toBase58():r!=null?r:await je(this.connection,this.blockhashCommitment),w=new X.TransactionMessage({payerKey:this.feePayer,recentBlockhash:m,instructions:[...this.allInstructions]}).compileToV0Message(Object.values(a));((y=this.owner)==null?void 0:y.signer)&&!this.signers.some(b=>b.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer);let A=new X.VersionedTransaction(w);return A.sign(this.signers),{builder:this,transaction:A,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async b=>{var T;let{skipPreflight:h=!0,sendAndConfirm:f,notSendToRpc:I}=b||{};if(Ve([A]),(T=this.owner)!=null&&T.isKeyPair){let d=await this.connection.sendTransaction(A,{skipPreflight:h});return f&&await kt(this.connection,d),{txId:d,signedTx:A}}if(this.signAllTransactions){let d=await this.signAllTransactions([A]);if(this.signers.length)for(let P of d)try{P.sign(this.signers)}catch{}return{txId:I?"":await this.connection.sendTransaction(d[0],{skipPreflight:h}),signedTx:d[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:s||{}}}async buildV0MultiTx(e){var c;let{extraPreBuildData:t=[],buildProps:n}=e,{transaction:i}=await this.buildV0(n),r=t.filter(p=>p.builder.instructions.length>0),s=[i,...r.map(p=>p.transaction)],a=[this.signers,...r.map(p=>p.signers)],l=[...this.instructionTypes,...r.map(p=>p.instructionTypes).flat()];return(c=this.owner)!=null&&c.signer&&a.forEach(p=>{p.some(m=>m.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),s.forEach(async(p,m)=>{p.sign(a[m])}),{builder:this,transactions:s,signers:a,instructionTypes:l,buildProps:n,execute:async p=>{var y;let{sequentially:m,onTxUpdate:w,recentBlockHash:A,skipPreflight:u=!0}=p||{};if(A&&s.forEach(b=>b.message.recentBlockhash=A),Ve(s),(y=this.owner)!=null&&y.isKeyPair){if(m){let b=[];for(let h of s){let f=await this.connection.sendTransaction(h,{skipPreflight:u});await kt(this.connection,f),b.push(f)}return{txIds:b,signedTxs:s}}return{txIds:await Promise.all(s.map(async b=>await this.connection.sendTransaction(b,{skipPreflight:u}))),signedTxs:s}}if(this.signAllTransactions){let b=await this.signAllTransactions(s);if(m){let h=0,f=[],I=async()=>{if(!b[h])return;let T=await this.connection.sendTransaction(b[h],{skipPreflight:u});f.push({txId:T,status:"sent",signedTx:b[h]}),w==null||w([...f]),h++;let d=!1,P=null,x=null,k=K=>{P!==null&&clearInterval(P),x!==null&&this.connection.removeSignatureListener(x);let N=f.findIndex(B=>B.txId===T);if(N>-1){if(f[N].status==="error"||f[N].status==="success")return;f[N].status=K.err?"error":"success"}w==null||w([...f]),K.err||I()};this.loopMultiTxStatus&&(P=setInterval(async()=>{var K;if(d){clearInterval(P);return}try{let N=await this.connection.getTransaction(T,{commitment:"confirmed",maxSupportedTransactionVersion:0});N&&(d=!0,clearInterval(P),k({err:((K=N.meta)==null?void 0:K.err)||null}),console.log("tx status from getTransaction:",T))}catch(N){d=!0,clearInterval(P),console.error("getTransaction timeout:",N,T)}},St)),x=this.connection.onSignature(T,K=>{if(d){this.connection.removeSignatureListener(x);return}d=!0,k(K)},"confirmed"),this.connection.getSignatureStatus(T)};return I(),{txIds:[],signedTxs:b}}else{let h=[];for(let f=0;f<b.length;f+=1){let I=await this.connection.sendTransaction(b[f],{skipPreflight:u});h.push(I)}return{txIds:h,signedTxs:b}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:n||{}}}async sizeCheckBuild(e){var w;let m=e||{},{splitIns:t=[],computeBudgetConfig:n}=m,i=ve(m,["splitIns","computeBudgetConfig"]),r=n?Tt(n):{instructions:[],instructionTypes:[]},s=this.signers.reduce((A,u)=>Z(V({},A),{[u.publicKey.toBase58()]:u}),{}),a=[],l=[],c=[],p=0;if(this.allInstructions.forEach(A=>{let u=[...c,A],y=n?[...r.instructions,...u]:u,h=[...new Set(u.map(f=>f.keys.filter(I=>I.isSigner).map(I=>I.pubkey.toString())).flat()).values()].map(f=>new X.PublicKey(f));if(A!==t[p]&&c.length<12&&(Bt({instructions:y,payer:this.feePayer,signers:h})||Bt({instructions:u,payer:this.feePayer,signers:h})))c.push(A);else{if(c.length===0)throw Error("item ins too big");p+=A===t[p]?1:0,Bt({instructions:n?[...r.instructions,...c]:[...c],payer:this.feePayer,signers:h})?a.push(new X.Transaction().add(...r.instructions,...c)):a.push(new X.Transaction().add(...c)),l.push(Array.from(new Set(c.map(f=>f.keys.filter(I=>I.isSigner).map(I=>I.pubkey.toString())).flat())).map(f=>s[f]).filter(f=>f!==void 0)),c=[A]}}),c.length>0){let u=[...new Set(c.map(y=>y.keys.filter(b=>b.isSigner).map(b=>b.pubkey.toString())).flat()).values()].map(y=>s[y]).filter(y=>y!==void 0);Bt({instructions:n?[...r.instructions,...c]:[...c],payer:this.feePayer,signers:u.map(y=>y.publicKey)})?a.push(new X.Transaction().add(...r.instructions,...c)):a.push(new X.Transaction().add(...c)),l.push(u)}return a.forEach(A=>A.feePayer=this.feePayer),(w=this.owner)!=null&&w.signer&&l.forEach(A=>{A.some(u=>u.publicKey.equals(this.owner.publicKey))||A.push(this.owner.signer)}),{builder:this,transactions:a,signers:l,instructionTypes:this.instructionTypes,execute:async A=>{var T;let{sequentially:u,onTxUpdate:y,skipTxCount:b=0,recentBlockHash:h,skipPreflight:f=!0}=A||{},I=h!=null?h:await je(this.connection,this.blockhashCommitment);if(a.forEach(async(d,P)=>{d.recentBlockhash=I,l[P].length&&d.sign(...l[P])}),Ve(a),(T=this.owner)!=null&&T.isKeyPair){if(u){let d=0,P=[];for(let x of a){if(++d,d<=b){P.push("tx skipped");continue}let k=await(0,X.sendAndConfirmTransaction)(this.connection,x,this.signers.find(K=>K.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:f});P.push(k)}return{txIds:P,signedTxs:a}}return{txIds:await Promise.all(a.map(async d=>await this.connection.sendRawTransaction(d.serialize(),{skipPreflight:f}))),signedTxs:a}}if(this.signAllTransactions){let d=await this.signAllTransactions(a.slice(b,a.length)),P=[...a.slice(0,b),...d];if(u){let x=0,k=[],K=async()=>{if(!P[x])return;x<b&&(k.push({txId:"",status:"success",signedTx:P[x]}),y==null||y([...k]),x++,K());let N=await this.connection.sendRawTransaction(P[x].serialize(),{skipPreflight:f});k.push({txId:N,status:"sent",signedTx:P[x]}),y==null||y([...k]),x++;let B=!1,L=null,F=null,D=S=>{L!==null&&clearInterval(L),F!==null&&this.connection.removeSignatureListener(F);let R=k.findIndex(H=>H.txId===N);if(R>-1){if(k[R].status==="error"||k[R].status==="success")return;k[R].status=S.err?"error":"success"}y==null||y([...k]),S.err||K()};this.loopMultiTxStatus&&(L=setInterval(async()=>{var S;if(B){clearInterval(L);return}try{let R=await this.connection.getTransaction(N,{commitment:"confirmed",maxSupportedTransactionVersion:0});R&&(B=!0,clearInterval(L),D({err:((S=R.meta)==null?void 0:S.err)||null}),console.log("tx status from getTransaction:",N))}catch(R){B=!0,clearInterval(L),console.error("getTransaction timeout:",R,N)}},St)),F=this.connection.onSignature(N,S=>{if(B){this.connection.removeSignatureListener(F);return}B=!0,D(S)},"confirmed"),this.connection.getSignatureStatus(N)};return await K(),{txIds:k.map(N=>N.txId),signedTxs:P}}else{let x=[];for(let k=0;k<P.length;k+=1){let K=await this.connection.sendRawTransaction(P[k].serialize(),{skipPreflight:f});x.push(K)}return{txIds:x,signedTxs:P}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:i||{}}}async sizeCheckBuildV0(e){var I;let f=e||{},{computeBudgetConfig:t,splitIns:n=[],lookupTableCache:i={},lookupTableAddress:r=[]}=f,s=ve(f,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),a=V(V({},this.cluster==="devnet"?await Ut(this.connection):It),i),l=Array.from(new Set([...this.lookupTableAddress,...r])),c=[];for(let T of l)a[T]===void 0&&c.push(new X.PublicKey(T));let p=await Gt({connection:this.connection,address:c});for(let[T,d]of Object.entries(p))a[T]=d;let m=t?Tt(t):{instructions:[],instructionTypes:[]},w=await je(this.connection,this.blockhashCommitment),A=this.signers.reduce((T,d)=>Z(V({},T),{[d.publicKey.toBase58()]:d}),{}),u=[],y=[],b=[],h=0;if(this.allInstructions.forEach(T=>{let d=[...b,T],P=t?[...m.instructions,...d]:d;if(T!==n[h]&&b.length<12&&(Le({instructions:P,payer:this.feePayer,lookupTableAddressAccount:a})||Le({instructions:d,payer:this.feePayer,lookupTableAddressAccount:a})))b.push(T);else{if(b.length===0)throw Error("item ins too big");h+=T===n[h]?1:0;let x={};for(let k of[...new Set(l)])a[k]!==void 0&&(x[k]=a[k]);if(t&&Le({instructions:[...m.instructions,...b],payer:this.feePayer,lookupTableAddressAccount:a,recentBlockhash:w})){let k=new X.TransactionMessage({payerKey:this.feePayer,recentBlockhash:w,instructions:[...m.instructions,...b]}).compileToV0Message(Object.values(a));u.push(new X.VersionedTransaction(k))}else{let k=new X.TransactionMessage({payerKey:this.feePayer,recentBlockhash:w,instructions:[...b]}).compileToV0Message(Object.values(a));u.push(new X.VersionedTransaction(k))}y.push(Array.from(new Set(b.map(k=>k.keys.filter(K=>K.isSigner).map(K=>K.pubkey.toString())).flat())).map(k=>A[k]).filter(k=>k!==void 0)),b=[T]}}),b.length>0){let d=[...new Set(b.map(P=>P.keys.filter(x=>x.isSigner).map(x=>x.pubkey.toString())).flat()).values()].map(P=>A[P]).filter(P=>P!==void 0);if(t&&Le({instructions:[...m.instructions,...b],payer:this.feePayer,lookupTableAddressAccount:a,recentBlockhash:w})){let P=new X.TransactionMessage({payerKey:this.feePayer,recentBlockhash:w,instructions:[...m.instructions,...b]}).compileToV0Message(Object.values(a));u.push(new X.VersionedTransaction(P))}else{let P=new X.TransactionMessage({payerKey:this.feePayer,recentBlockhash:w,instructions:[...b]}).compileToV0Message(Object.values(a));u.push(new X.VersionedTransaction(P))}y.push(d)}return(I=this.owner)!=null&&I.signer&&y.forEach(T=>{T.some(d=>d.publicKey.equals(this.owner.publicKey))||T.push(this.owner.signer)}),u.forEach((T,d)=>{T.sign(y[d])}),{builder:this,transactions:u,buildProps:e,signers:y,blockHash:w,instructionTypes:this.instructionTypes,execute:async T=>{var N;let{sequentially:d,onTxUpdate:P,skipTxCount:x=0,recentBlockHash:k,skipPreflight:K=!0}=T||{};if(u.map(async(B,L)=>{y[L].length&&B.sign(y[L]),k&&(B.message.recentBlockhash=k)}),Ve(u),(N=this.owner)!=null&&N.isKeyPair){if(d){let B=0,L=[];for(let F of u){if(++B,B<=x){console.log("skip tx: ",B),L.push("tx skipped");continue}let D=await this.connection.sendTransaction(F,{skipPreflight:K});await kt(this.connection,D),L.push(D)}return{txIds:L,signedTxs:u}}return{txIds:await Promise.all(u.map(async B=>await this.connection.sendTransaction(B,{skipPreflight:K}))),signedTxs:u}}if(this.signAllTransactions){let B=await this.signAllTransactions(u.slice(x,u.length)),L=[...u.slice(0,x),...B];if(d){let F=0,D=[],S=async()=>{if(!L[F])return;if(F<x){D.push({txId:"",status:"success",signedTx:L[F]}),P==null||P([...D]),F++,S();return}let R=await this.connection.sendTransaction(L[F],{skipPreflight:K});D.push({txId:R,status:"sent",signedTx:L[F]}),P==null||P([...D]),F++;let H=!1,z=null,$=null,j=ee=>{z!==null&&clearInterval(z),$!==null&&this.connection.removeSignatureListener($);let te=D.findIndex(oe=>oe.txId===R);if(te>-1){if(D[te].status==="error"||D[te].status==="success")return;D[te].status=ee.err?"error":"success"}P==null||P([...D]),ee.err||S()};this.loopMultiTxStatus&&(z=setInterval(async()=>{var ee;if(H){clearInterval(z);return}try{let te=await this.connection.getTransaction(R,{commitment:"confirmed",maxSupportedTransactionVersion:0});te&&(H=!0,clearInterval(z),j({err:((ee=te.meta)==null?void 0:ee.err)||null}),console.log("tx status from getTransaction:",R))}catch(te){H=!0,clearInterval(z),console.error("getTransaction timeout:",te,R)}},St)),$=this.connection.onSignature(R,ee=>{if(H){this.connection.removeSignatureListener($);return}H=!0,j(ee)},"confirmed"),this.connection.getSignatureStatus(R)};return S(),{txIds:[],signedTxs:L}}else{let F=[];for(let D=0;D<L.length;D+=1){let S=await this.connection.sendTransaction(L[D],{skipPreflight:K});F.push(S)}return{txIds:F,signedTxs:L}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:s||{}}}async buildSniperTransaction(e){var I;let f=e||{},{computeBudgetConfig:t,splitIns:n=[],lookupTableCache:i={},lookupTableAddress:r=[]}=f,s=ve(f,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),a=V(V({},this.cluster==="devnet"?await Ut(this.connection):It),i),l=Array.from(new Set([...this.lookupTableAddress,...r])),c=[];for(let T of l)a[T]===void 0&&c.push(new X.PublicKey(T));let p=await Gt({connection:this.connection,address:c});for(let[T,d]of Object.entries(p))a[T]=d;let m=t?Tt(t):{instructions:[],instructionTypes:[]},w=await je(this.connection,this.blockhashCommitment),A=this.signers.reduce((T,d)=>Z(V({},T),{[d.publicKey.toBase58()]:d}),{}),u=[],y=[],b=[],h=0;if(this.allInstructions.forEach(T=>{let d=[...b,T],P=t?[...m.instructions,...d]:d;if(T!==n[h]&&b.length<12&&(Le({instructions:P,payer:this.feePayer,lookupTableAddressAccount:a})||Le({instructions:d,payer:this.feePayer,lookupTableAddressAccount:a})))b.push(T);else{if(b.length===0)throw Error("item ins too big");h+=T===n[h]?1:0;let x={};for(let k of[...new Set(l)])a[k]!==void 0&&(x[k]=a[k]);if(t&&Le({instructions:[...m.instructions,...b],payer:this.feePayer,lookupTableAddressAccount:a,recentBlockhash:w})){let k=new X.TransactionMessage({payerKey:this.feePayer,recentBlockhash:w,instructions:[...m.instructions,...b]}).compileToV0Message(Object.values(a));u.push(new X.VersionedTransaction(k))}else{let k=new X.TransactionMessage({payerKey:this.feePayer,recentBlockhash:w,instructions:[...b]}).compileToV0Message(Object.values(a));u.push(new X.VersionedTransaction(k))}y.push(Array.from(new Set(b.map(k=>k.keys.filter(K=>K.isSigner).map(K=>K.pubkey.toString())).flat())).map(k=>A[k]).filter(k=>k!==void 0)),b=[T]}}),b.length>0){let d=[...new Set(b.map(P=>P.keys.filter(x=>x.isSigner).map(x=>x.pubkey.toString())).flat()).values()].map(P=>A[P]).filter(P=>P!==void 0);if(t&&Le({instructions:[...m.instructions,...b],payer:this.feePayer,lookupTableAddressAccount:a,recentBlockhash:w})){let P=new X.TransactionMessage({payerKey:this.feePayer,recentBlockhash:w,instructions:[...m.instructions,...b]}).compileToV0Message(Object.values(a));u.push(new X.VersionedTransaction(P))}else{let P=new X.TransactionMessage({payerKey:this.feePayer,recentBlockhash:w,instructions:[...b]}).compileToV0Message(Object.values(a));u.push(new X.VersionedTransaction(P))}y.push(d)}return(I=this.owner)!=null&&I.signer&&y.forEach(T=>{T.some(d=>d.publicKey.equals(this.owner.publicKey))||T.push(this.owner.signer)}),u.forEach((T,d)=>{T.sign(y[d])}),{builder:this,transactions:u,buildProps:e,signers:y,instructionTypes:this.instructionTypes,execute:async T=>{var N;let{sequentially:d,onTxUpdate:P,skipTxCount:x=0,recentBlockHash:k,skipPreflight:K=!0}=T||{};if(u.map(async(B,L)=>{y[L].length&&B.sign(y[L]),k&&(B.message.recentBlockhash=k)}),Ve(u),(N=this.owner)!=null&&N.isKeyPair){if(d){let B=0,L=[];for(let F of u){if(++B,B<=x){console.log("skip tx: ",B),L.push("tx skipped");continue}let D=await this.connection.sendTransaction(F,{skipPreflight:K});await kt(this.connection,D),L.push(D)}return{txIds:L,signedTxs:u}}return{txIds:await Promise.all(u.map(async B=>await this.connection.sendTransaction(B,{skipPreflight:K}))),signedTxs:u}}if(this.signAllTransactions){let B=await this.signAllTransactions(u.slice(x,u.length)),L=[...u.slice(0,x),...B];if(d){let F=0,D=[],S=async()=>{if(!L[F])return;if(F<x){D.push({txId:"",status:"success",signedTx:L[F]}),P==null||P([...D]),F++,S();return}let R=await this.connection.sendTransaction(L[F],{skipPreflight:K});D.push({txId:R,status:"sent",signedTx:L[F]}),P==null||P([...D]),F++;let H=!1,z=null,$=null,j=ee=>{z!==null&&clearInterval(z),$!==null&&this.connection.removeSignatureListener($);let te=D.findIndex(oe=>oe.txId===R);if(te>-1){if(D[te].status==="error"||D[te].status==="success")return;D[te].status=ee.err?"error":"success"}P==null||P([...D]),ee.err||S()};this.loopMultiTxStatus&&(z=setInterval(async()=>{var ee;if(H){clearInterval(z);return}try{let te=await this.connection.getTransaction(R,{commitment:"confirmed",maxSupportedTransactionVersion:0});te&&(H=!0,clearInterval(z),j({err:((ee=te.meta)==null?void 0:ee.err)||null}),console.log("tx status from getTransaction:",R))}catch(te){H=!0,clearInterval(z),console.error("getTransaction timeout:",te,R)}},St)),$=this.connection.onSignature(R,ee=>{if(H){this.connection.removeSignatureListener($);return}H=!0,j(ee)},"confirmed"),this.connection.getSignatureStatus(R)};return S(),{txIds:[],signedTxs:L}}else{let F=[];for(let D=0;D<L.length;D+=1){let S=await this.connection.sendTransaction(L[D],{skipPreflight:K});F.push(S)}return{txIds:F,signedTxs:L}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:s||{}}}};var An=(...o)=>o.map(e=>{try{return typeof e=="object"?JSON.stringify(e):e}catch{return e}}).join(", "),it=class{constructor({scope:e,moduleName:t}){this.disabled=!1;this.scope=e,this.logger=le(t)}createTxBuilder(e){return this.scope.checkOwner(),new Kt({connection:this.scope.connection,feePayer:e||this.scope.ownerPubKey,cluster:this.scope.cluster,owner:this.scope.owner,blockhashCommitment:this.scope.blockhashCommitment,loopMultiTxStatus:this.scope.loopMultiTxStatus,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}createSniperTxBuilder(e,t){let n=new Ce(e);return new Kt({connection:this.scope.connection,feePayer:t,cluster:this.scope.cluster,owner:n,blockhashCommitment:this.scope.blockhashCommitment,loopMultiTxStatus:this.scope.loopMultiTxStatus,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}logDebug(...e){this.logger.debug(An(e))}logInfo(...e){this.logger.info(An(e))}logAndCreateError(...e){let t=An(e);throw new Error(t)}checkDisabled(){(this.disabled||!this.scope)&&this.logAndCreateError("module not working")}};var fo=require("@solana/web3.js"),bo=U(require("bn.js")),yo=U(require("decimal.js"));var Ht=require("@solana/spl-token");var Er=require("@solana/web3.js"),xi=require("@solana/spl-token");var zt=require("@solana/web3.js"),po=U(require("bn.js"));var Ln=require("@solana/spl-token");var Ri=require("@solana/web3.js"),rt=U(require("bn.js"));var E=require("@solana/buffer-layout"),wn=E.Layout,Ii=E.Structure;var Tn=E.UInt;var Si=E.u8,Me=E.u16;var Ki=E.u32;var Oe=E.s32;var Ci=E.seq;var fe=E.blob;var Ni=E.offset;var ot=class extends wn{constructor(t,n,i){super(t,i);this.blob=fe(t),this.signed=n}decode(t,n=0){let i=new rt.default(this.blob.decode(t,n),10,"le");return this.signed?i.fromTwos(this.span*8).clone():i}encode(t,n,i=0){return typeof t=="number"&&(t=new rt.default(t)),this.signed&&(t=t.toTwos(this.span*8)),this.blob.encode(t.toArrayLike(Buffer,"le",this.span),n,i)}};function _(o){return new Tn(1,o)}function at(o){return new Tn(4,o)}function g(o){return new ot(8,!1,o)}function re(o){return new ot(16,!1,o)}function Li(o){return new ot(8,!0,o)}function Fi(o){return new ot(16,!0,o)}var st=class extends wn{constructor(t,n,i,r){super(t.span,r);this.layout=t,this.decoder=n,this.encoder=i}decode(t,n){return this.decoder(this.layout.decode(t,n))}encode(t,n,i){return this.layout.encode(this.encoder(t),n,i)}getSpan(t,n){return this.layout.getSpan(t,n)}};function v(o){return new st(fe(32),e=>new Ri.PublicKey(e),e=>e.toBuffer(),o)}function Bn(o){return new st(Si(),vr,Dr,o)}function vr(o){if(o===0)return!1;if(o===1)return!0;throw new Error("Invalid bool: "+o)}function Dr(o){return o?1:0}function Wr(o){let e=Ki("length"),t=q([e,fe(Ni(e,-e.span),"data")]);return new st(t,({data:n})=>n,n=>({data:n}),o)}function be(o){return new st(Wr(),e=>e.toString("utf-8"),e=>Buffer.from(e,"utf-8"),o)}var kn=class extends Ii{decode(e,t){return super.decode(e,t)}};function q(o,e,t){return new kn(o,e,t)}function Y(o,e,t){let n,i=typeof e=="number"?e:(0,rt.isBN)(e)?e.toNumber():new Proxy(e,{get(r,s){if(!n){let a=Reflect.get(r,"count");n=(0,rt.isBN)(a)?a.toNumber():a,Reflect.set(r,"count",n)}return Reflect.get(r,s)},set(r,s,a){return s==="count"&&(n=a),Reflect.set(r,s,a)}});return Ci(o,i,t)}var eo=U(require("bn.js")),to=U(require("decimal.js"));var ge=U(require("bn.js")),hn=new ge.default(0),Mi=new ge.default(1),Oi=new ge.default(-1),Ne=new ge.default(1).shln(64),Ei=new ge.default(1).shln(128),xn=Ne.sub(Mi);var Vr=Ei.subn(1),ct=-443636,Ct=-ct,In=new ge.default("4295048016"),Sn=new ge.default("79226673521066979257578248091"),ou=new ge.default("4295048017"),su=new ge.default("79226673521066979257578248090");var _r=new ge.default(10).pow(new ge.default(6));var au=new ge.default("18446744073700000000");var Jr=U(require("bn.js")),$r=U(require("decimal.js"));var pu=Buffer.from("amm_config","utf8"),vi=Buffer.from("pool","utf8"),Di=Buffer.from("pool_vault","utf8"),fu=Buffer.from("pool_reward_vault","utf8"),bu=Buffer.from("position","utf8"),yu=Buffer.from("tick_array","utf8"),gu=Buffer.from("operation","utf8"),Pu=Buffer.from("pool_tick_array_bitmap_extension","utf8"),Au=Buffer.from("observation","utf8");function Kn(o){return de([Buffer.from("metadata","utf8"),tt.toBuffer(),o.toBuffer()],tt)}var wu=Buffer.from("locked_position","utf8");var Tu=Buffer.from("support_mint","utf8");var Hr=require("@solana/web3.js"),jr=require("@solana/spl-token"),Qr=U(require("bn.js")),Zr=U(require("decimal.js"));var Gr=U(require("bn.js")),Ur=U(require("decimal.js"));var Rn=14;var Xt=60;var no=q([fe(8),_("bump"),Me("index"),v(""),at("protocolFeeRate"),at("tradeFeeRate"),Me("tickSpacing"),Y(g(),8,"")]),io=q([at("blockTimestamp"),Li("tickCumulative"),Y(g(),4)]),ji=q([fe(8),Bn("initialized"),g("recentEpoch"),Me("observationIndex"),v("poolId"),Y(io,100,"observations"),Y(g(),4)]),ro=q([_("rewardState"),g("openTime"),g("endTime"),g("lastUpdateTime"),re("emissionsPerSecondX64"),g("rewardTotalEmissioned"),g("rewardClaimed"),v("tokenMint"),v("tokenVault"),v("creator"),re("rewardGrowthGlobalX64")]),Xi=q([fe(8),_("bump"),v("ammConfig"),v("creator"),v("mintA"),v("mintB"),v("vaultA"),v("vaultB"),v("observationId"),_("mintDecimalsA"),_("mintDecimalsB"),Me("tickSpacing"),re("liquidity"),re("sqrtPriceX64"),Oe("tickCurrent"),at(),re("feeGrowthGlobalX64A"),re("feeGrowthGlobalX64B"),g("protocolFeesTokenA"),g("protocolFeesTokenB"),re("swapInAmountTokenA"),re("swapOutAmountTokenB"),re("swapInAmountTokenB"),re("swapOutAmountTokenA"),_("status"),Y(_(),7,""),Y(ro,3,"rewardInfos"),Y(g(),16,"tickArrayBitmap"),g("totalFeesTokenA"),g("totalFeesClaimedTokenA"),g("totalFeesTokenB"),g("totalFeesClaimedTokenB"),g("fundFeesTokenA"),g("fundFeesTokenB"),g("startTime"),Y(g(),15*4-3,"padding")]),oo=q([re("growthInsideLastX64"),g("rewardAmountOwed")]),zi=q([fe(8),_("bump"),v("nftMint"),v("poolId"),Oe("tickLower"),Oe("tickUpper"),re("liquidity"),re("feeGrowthInsideLastX64A"),re("feeGrowthInsideLastX64B"),g("tokenFeesOwedA"),g("tokenFeesOwedB"),Y(oo,3,"rewardInfos"),Y(g(),8,"")]),Ml=q([fe(8),_("bump"),v("poolId"),Oe("tickLowerIndex"),Oe("tickUpperIndex"),re("liquidity"),re("feeGrowthInsideLastX64A"),re("feeGrowthInsideLastX64B"),g("tokenFeesOwedA"),g("tokenFeesOwedB"),Y(re(),3,"rewardGrowthInside"),Y(g(),8,"")]),so=q([Oe("tick"),Fi("liquidityNet"),re("liquidityGross"),re("feeGrowthOutsideX64A"),re("feeGrowthOutsideX64B"),Y(re(),3,"rewardGrowthsOutsideX64"),Y(at(),13,"")]),qi=q([fe(8),v("poolId"),Oe("startTickIndex"),Y(so,Xt,"ticks"),_("initializedTickCount"),Y(_(),115,"")]),ao=q([fe(329),Y(v(),100,"whitelistMints")]),Yr=q([fe(8),v("poolId"),Y(Y(g(),8),Rn,"positiveTickArrayBitmap"),Y(Y(g(),8),Rn,"negativeTickArrayBitmap")]),Ol=q([g(),_("bump"),v("owner"),v("poolId"),v("positionId"),v("nftAccount"),Y(g(),8)]),co=q([fe(8),_("bump"),v("lockOwner"),v("poolId"),v("positionId"),v("nftAccount"),v("lockNftMint"),g("recentEpoch"),Y(g(),8)]);ji.span;var $l=le("Raydium_Clmm");var go=Buffer.from("vault_auth_seed","utf8"),Hm=Buffer.from("global_config","utf8"),Po=Buffer.from("pool_vesting","utf8"),Ao=Buffer.from("platform_config","utf8"),wo=Buffer.from("platform_fee_vault_auth_seed","utf8"),To=Buffer.from("creator_fee_vault_auth_seed","utf8");function Re(o){return de([go],o)}function ut(o,e,t){return de([vi,e.toBuffer(),t.toBuffer()],o)}function Fn(o,e,t){return de([Di,e.toBuffer(),t.toBuffer()],o)}function Ye(o){return de([Buffer.from("__event_authority","utf8")],o)}function Mn(o,e){return de([Ao,e.toBuffer()],o)}function Lt(o,e,t){return de([Po,e.toBuffer(),t.toBuffer()],o)}function Je(o,e,t){return de([e.toBuffer(),t.toBuffer()],o)}function On(o){return de([wo],o)}function lt(o,e,t){return de([e.toBuffer(),t.toBuffer()],o)}function Qi(o){return de([To],o)}var ne=require("@solana/web3.js"),xe=require("@solana/spl-token"),mt=U(require("bn.js"));var Pe={initialize:Buffer.from([175,175,109,31,13,152,155,237]),buyExactIn:Buffer.from([250,234,13,123,213,156,19,236]),buyExactOut:Buffer.from([24,211,116,40,105,3,153,56]),sellExactIn:Buffer.from([149,39,222,155,211,124,152,26]),sellExactOut:Buffer.from([95,200,71,34,8,9,11,166]),createVestingAccount:Buffer.from([129,178,2,13,217,172,230,218]),claimVestedToken:Buffer.from([49,33,104,30,189,157,79,35]),createPlatformConfig:Buffer.from([176,90,196,175,253,113,220,20]),claimPlatformFee:Buffer.from([156,39,208,135,76,237,61,72]),updatePlaformConfig:Buffer.from([195,60,76,129,146,45,67,143]),initializeWithToken2022:Buffer.from([37,190,126,222,44,154,171,17]),claimPlatformFeeFromVault:Buffer.from([117,241,198,168,248,218,80,29]),claimCreatorFee:Buffer.from([26,97,138,203,132,171,141,252])};function Zi(o,e,t,n,i,r,s,a,l,c,p,m,w,A,u,y,b,h,f,I){let T=q([_("decimals"),be("name"),be("symbol"),be("uri")]),d=q([g("totalLockedAmount"),g("cliffPeriod"),g("unlockPeriod")]),P=q([_("index"),g("supply"),g("totalFundRaisingB"),_("migrateType")]),x=q([_("index"),g("supply"),g("totalSellA"),g("totalFundRaisingB"),_("migrateType")]),k=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!0,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:xe.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:xe.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:tt,isSigner:!1,isWritable:!1},{pubkey:ne.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:un,isSigner:!1,isWritable:!1},{pubkey:Ye(o).publicKey,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1}],K=Buffer.alloc(Buffer.from(A,"utf-8").length+Buffer.from(u,"utf-8").length+Buffer.from(y,"utf-8").length+4*3+1),N=Buffer.alloc(d.span),B=Buffer.alloc(b.type==="ConstantCurve"?x.span:P.span);return T.encode({decimals:w,name:A,symbol:u,uri:y},K),b.type==="ConstantCurve"?x.encode(Z(V({index:0},b),{migrateType:b.migrateType==="amm"?0:1}),B):b.type==="FixedCurve"?P.encode(Z(V({index:1},b),{migrateType:b.migrateType==="amm"?0:1}),B):b.type==="LinearCurve"&&P.encode(Z(V({index:2},b),{migrateType:b.migrateType==="amm"?0:1}),B),d.encode({totalLockedAmount:h,cliffPeriod:f,unlockPeriod:I},N),new ne.TransactionInstruction({keys:k,programId:o,data:Buffer.from([...Pe.initialize,...K,...B,...N])})}function Yi(o,e,t,n,i,r,s,a,l,c,p,m,w,A,u,y,b,h,f,I){let T=q([_("decimals"),be("name"),be("symbol"),be("uri")]),d=q([g("totalLockedAmount"),g("cliffPeriod"),g("unlockPeriod"),_("transferFeeExtensionParamsOption"),q([Me("transferFeeBasePoints"),g("maxinumFee")]).replicate("transferFeeExtensionParams")]),P=q([_("index"),g("supply"),g("totalFundRaisingB"),_("migrateType")]),x=q([_("index"),g("supply"),g("totalSellA"),g("totalFundRaisingB"),_("migrateType")]),k=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!0,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:xe.TOKEN_2022_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:xe.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:ne.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:Ye(o).publicKey,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1}],K=Buffer.alloc(Buffer.from(w,"utf-8").length+Buffer.from(A,"utf-8").length+Buffer.from(u,"utf-8").length+4*3+1),N=Buffer.alloc(d.span),B=Buffer.alloc(y.type==="ConstantCurve"?x.span:P.span);return T.encode({decimals:m,name:w,symbol:A,uri:u},K),y.type==="ConstantCurve"?x.encode(Z(V({index:0},y),{migrateType:y.migrateType==="amm"?0:1}),B):y.type==="FixedCurve"?P.encode(Z(V({index:1},y),{migrateType:y.migrateType==="amm"?0:1}),B):y.type==="LinearCurve"&&P.encode(Z(V({index:2},y),{migrateType:y.migrateType==="amm"?0:1}),B),d.encode({totalLockedAmount:b,cliffPeriod:h,unlockPeriod:f,transferFeeExtensionParamsOption:I?1:0,transferFeeExtensionParams:I!=null?I:{transferFeeBasePoints:0,maxinumFee:new mt.default(0)}},N),new ne.TransactionInstruction({keys:k,programId:o,data:Buffer.from([...Pe.initializeWithToken2022,...K,...B,...N])})}function Ji(o,e,t,n,i,r,s,a,l,c,p,m,w,A,u,y,b,h,f,I){let T=q([g("amountB"),g("minAmountA"),g("shareFeeRate")]),d=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:w,isSigner:!1,isWritable:!1},{pubkey:A,isSigner:!1,isWritable:!1},{pubkey:Ye(o).publicKey,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1}];I&&d.push({pubkey:I,isSigner:!1,isWritable:!0}),d.push({pubkey:ne.SystemProgram.programId,isSigner:!1,isWritable:!1}),d.push({pubkey:u,isSigner:!1,isWritable:!0}),d.push({pubkey:y,isSigner:!1,isWritable:!0});let P=Buffer.alloc(T.span);return T.encode({amountB:b,minAmountA:h,shareFeeRate:f!=null?f:new mt.default(0)},P),new ne.TransactionInstruction({keys:d,programId:o,data:Buffer.from([...Pe.buyExactIn,...P])})}function $i(o,e,t,n,i,r,s,a,l,c,p,m,w,A,u,y,b,h,f,I){let T=q([g("amountA"),g("maxAmountB"),g("shareFeeRate")]),d=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:w,isSigner:!1,isWritable:!1},{pubkey:A,isSigner:!1,isWritable:!1},{pubkey:Ye(o).publicKey,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1}];I&&d.push({pubkey:I,isSigner:!1,isWritable:!0}),d.push({pubkey:ne.SystemProgram.programId,isSigner:!1,isWritable:!1}),d.push({pubkey:u,isSigner:!1,isWritable:!0}),d.push({pubkey:y,isSigner:!1,isWritable:!0});let P=Buffer.alloc(T.span);return T.encode({amountA:b,maxAmountB:h,shareFeeRate:f!=null?f:new mt.default(0)},P),new ne.TransactionInstruction({keys:d,programId:o,data:Buffer.from([...Pe.buyExactOut,...P])})}function er(o,e,t,n,i,r,s,a,l,c,p,m,w,A,u,y,b,h,f,I){let T=q([g("amountA"),g("minAmountB"),g("shareFeeRate")]),d=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:w,isSigner:!1,isWritable:!1},{pubkey:A,isSigner:!1,isWritable:!1},{pubkey:Ye(o).publicKey,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1}];I&&d.push({pubkey:I,isSigner:!1,isWritable:!0}),d.push({pubkey:ne.SystemProgram.programId,isSigner:!1,isWritable:!1}),d.push({pubkey:u,isSigner:!1,isWritable:!0}),d.push({pubkey:y,isSigner:!1,isWritable:!0});let P=Buffer.alloc(T.span);return T.encode({amountA:b,minAmountB:h,shareFeeRate:f!=null?f:new mt.default(0)},P),new ne.TransactionInstruction({keys:d,programId:o,data:Buffer.from([...Pe.sellExactIn,...P])})}function tr(o,e,t,n,i,r,s,a,l,c,p,m,w,A,u,y,b,h,f,I){let T=q([g("amountB"),g("maxAmountA"),g("shareFeeRate")]),d=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:w,isSigner:!1,isWritable:!1},{pubkey:A,isSigner:!1,isWritable:!1},{pubkey:Ye(o).publicKey,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1}];I&&d.push({pubkey:I,isSigner:!1,isWritable:!0}),d.push({pubkey:ne.SystemProgram.programId,isSigner:!1,isWritable:!1}),d.push({pubkey:u,isSigner:!1,isWritable:!0}),d.push({pubkey:y,isSigner:!1,isWritable:!0});let P=Buffer.alloc(T.span);return T.encode({amountB:b,maxAmountA:h,shareFeeRate:f!=null?f:new mt.default(0)},P),new ne.TransactionInstruction({keys:d,programId:o,data:Buffer.from([...Pe.sellExactOut,...P])})}function En(o,e,t,n,i,r,s,a,l){let c=q([]),p=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:ne.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:xe.ASSOCIATED_TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}],m=Buffer.alloc(c.span);return c.encode({},m),new ne.TransactionInstruction({keys:p,programId:o,data:Buffer.from([...Pe.claimVestedToken,...m])})}function vn(o,e,t,n,i,r){let s=q([g("shareAmount")]),a=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:ne.SystemProgram.programId,isSigner:!1,isWritable:!1}],l=Buffer.alloc(s.span);return s.encode({shareAmount:r},l),new ne.TransactionInstruction({keys:a,programId:o,data:Buffer.from([...Pe.createVestingAccount,...l])})}function Dn(o,e,t,n,i,r,s,a,l){let c=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:ne.SystemProgram.programId,isSigner:!1,isWritable:!0},{pubkey:xe.ASSOCIATED_TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!0}];return new ne.TransactionInstruction({keys:c,programId:o,data:Pe.claimPlatformFee})}function nr(o,e,t,n,i,r,s,a,l,c,p,m,w){let A=q([g("platformScale"),g("creatorScale"),g("burnScale"),g("feeRate"),be("name"),be("web"),be("img"),g("creatorFeeRate")]),u=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:ne.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!1}],y=Buffer.alloc(8*5+Buffer.from(p,"utf-8").length+Buffer.from(m,"utf-8").length+Buffer.from(w,"utf-8").length+4*3);return A.encode({platformScale:a.platformScale,creatorScale:a.creatorScale,burnScale:a.burnScale,feeRate:l,name:p,web:m,img:w,creatorFeeRate:c},y),new ne.TransactionInstruction({keys:u,programId:o,data:Buffer.from([...Pe.createPlatformConfig,...y])})}function ir(o,e,t,n){let i=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!0}],r;if(n.type==="updateClaimFeeWallet"){let s=q([_("index"),v("value")]);r=Buffer.alloc(s.span),s.encode({index:0,value:n.value},r)}else if(n.type==="updateLockNftWallet"){let s=q([_("index"),v("value")]);r=Buffer.alloc(s.span),s.encode({index:1,value:n.value},r)}else if(n.type==="migrateCpLockNftScale"){let s=q([_("index"),g("platformScale"),g("creatorScale"),g("burnScale")]);r=Buffer.alloc(s.span),s.encode(V({index:2},n.value),r)}else if(n.type==="updateFeeRate"){let s=q([_("index"),g("value")]);r=Buffer.alloc(s.span),s.encode({index:3,value:n.value},r)}else if(n.type==="updateImg"||n.type==="updateName"||n.type==="updateWeb"){let s=q([_("index"),be("value")]);r=Buffer.alloc(Buffer.from(n.value,"utf-8").length+4+1*1),n.type==="updateName"?s.encode({index:4,value:n.value},r):n.type==="updateWeb"?s.encode({index:5,value:n.value},r):n.type==="updateImg"&&s.encode({index:6,value:n.value},r)}else if(n.type==="updateCpConfigId"){i.push({pubkey:n.value,isSigner:!1,isWritable:!1});let s=q([_("index")]);r=Buffer.alloc(s.span),s.encode({index:7},r)}else if(n.type==="updateAll"){i.push({pubkey:n.value.cpConfigId,isSigner:!1,isWritable:!1});let s=q([_("index"),v("platformClaimFeeWallet"),v("platformLockNftWallet"),g("platformScale"),g("creatorScale"),g("burnScale"),g("feeRate"),be("name"),be("web"),be("img"),v("transferFeeExtensionAuth"),g("creatorFeeRate")]);r=Buffer.alloc(1+32+32+8*4+4*3+Buffer.from(n.value.name,"utf-8").length+Buffer.from(n.value.web,"utf-8").length+Buffer.from(n.value.img,"utf-8").length),s.encode({index:8,platformClaimFeeWallet:n.value.platformClaimFeeWallet,platformLockNftWallet:n.value.platformLockNftWallet,platformScale:n.value.migrateCpLockNftScale.platformScale,creatorScale:n.value.migrateCpLockNftScale.creatorScale,burnScale:n.value.migrateCpLockNftScale.burnScale,feeRate:n.value.feeRate,name:n.value.name,web:n.value.web,img:n.value.img,transferFeeExtensionAuth:n.value.transferFeeExtensionAuth,creatorFeeRate:n.value.creatorFeeRate},r)}else throw Error("updateInfo params type error");return new ne.TransactionInstruction({keys:i,programId:o,data:Buffer.from([...Pe.updatePlaformConfig,...r])})}function Wn(o,e,t,n,i,r,s,a){let l=[{pubkey:t,isSigner:!0,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:e,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:ne.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:xe.ASSOCIATED_TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}];return new ne.TransactionInstruction({keys:l,programId:o,data:Pe.claimPlatformFeeFromVault})}function rr(o,e,t,n,i,r,s){let a=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:ne.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:xe.ASSOCIATED_TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}];return new ne.TransactionInstruction({keys:a,programId:o,data:Pe.claimCreatorFee})}var C=require("@solana/spl-token"),W=U(require("bn.js")),qn=require("@solana/web3.js");var _e=q([g(),g("epoch"),_("curveType"),Me("index"),g("migrateFee"),g("tradeFeeRate"),g("maxShareFeeRate"),g("minSupplyA"),g("maxLockRate"),g("minSellRateA"),g("minMigrateRateA"),g("minFundRaisingB"),v("mintB"),v("protocolFeeOwner"),v("migrateFeeOwner"),v("migrateToAmmWallet"),v("migrateToCpmmWallet"),Y(g(),16)]),ko=q([g("totalLockedAmount"),g("cliffPeriod"),g("unlockPeriod"),g("startTime"),g("totalAllocatedShare")]),Ie=q([g(),g("epoch"),_("bump"),_("status"),_("mintDecimalsA"),_("mintDecimalsB"),_("migrateType"),g("supply"),g("totalSellA"),g("virtualA"),g("virtualB"),g("realA"),g("realB"),g("totalFundRaisingB"),g("protocolFee"),g("platformFee"),g("migrateFee"),ko.replicate("vestingSchedule"),v("configId"),v("platformId"),v("mintA"),v("mintB"),v("vaultA"),v("vaultB"),v("creator"),_("mintProgramFlag"),Y(_(),63)]),nd=q([g(),g("epoch"),v("poolId"),v("beneficiary"),g("claimedAmount"),g("tokenShareAmount"),Y(g(),8)]),dt=q([g(),g("epoch"),v("platformClaimFeeWallet"),v("platformLockNftWallet"),g("platformScale"),g("creatorScale"),g("burnScale"),g("feeRate"),Y(_(),64,"name"),Y(_(),256,"web"),Y(_(),256,"img"),v("cpConfigId"),g("creatorFeeRate"),v("transferFeeExtensionAuth"),Y(_(),184)]);var Ae=U(require("bn.js")),_n=U(require("decimal.js"));var Ft=U(require("bn.js")),pt=U(require("decimal.js"));var qe=class{static getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n}){throw Error()}static getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:i}){throw Error()}static getPoolPrice({poolInfo:e,decimalA:t,decimalB:n}){throw Error()}static getPoolEndPrice({supply:e,totalSell:t,totalLockedAmount:n,totalFundRaising:i,migrateFee:r,decimalA:s,decimalB:a}){throw Error()}static getPoolEndPriceReal({poolInfo:e,decimalA:t,decimalB:n}){throw Error()}static getInitParam({supply:e,totalFundRaising:t,totalSell:n,totalLockedAmount:i,migrateFee:r}){throw Error()}static buyExactIn({poolInfo:e,amount:t}){throw Error()}static buyExactOut({poolInfo:e,amount:t}){throw Error()}static sellExactIn({poolInfo:e,amount:t}){throw Error()}static sellExactOut({poolInfo:e,amount:t}){throw Error()}};var jt=class extends qe{static getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n}){return new pt.default(e.virtualB.toString()).div(e.virtualA.toString()).mul(10**(t-n))}static getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:i}){return new pt.default(t.toString()).div(e.toString()).mul(10**(n-i))}static getPoolPrice({poolInfo:e,decimalA:t,decimalB:n}){return new pt.default(e.virtualB.add(e.realB).toString()).div(e.virtualA.sub(e.realA).toString()).mul(10**(t-n))}static getPoolEndPrice({supply:e,totalSell:t,totalLockedAmount:n,totalFundRaising:i,migrateFee:r,decimalA:s,decimalB:a}){return new pt.default(i.sub(r).toString()).div(e.sub(t).sub(n).toString()).mul(10**(s-a))}static getPoolEndPriceReal({poolInfo:e,decimalA:t,decimalB:n}){let i=e.totalSellA.sub(e.realA),r=e.totalFundRaisingB.sub(e.realB);return new pt.default(e.virtualB.add(e.realB.add(r)).toString()).div(e.virtualA.sub(e.realA.add(i)).toString()).mul(10**(t-n))}static getInitParam({supply:e,totalFundRaising:t,totalSell:n,totalLockedAmount:i,migrateFee:r}){if(e.lte(n))throw Error("supply need gt total sell");let s=e.sub(n).sub(i);if(s.lte(new Ft.default(0)))throw Error("supplyMinusSellLocked <= 0");let a=t.sub(r);if(a.lte(new Ft.default(0)))throw Error("tfMinusMf <= 0");let l=a.mul(n).mul(n).div(s),c=a.mul(n).div(s).sub(t),p=l.div(c),m=t.mul(t).div(c);if(p.lt(new Ft.default(0))||m.lt(new Ft.default(0)))throw Error("invalid input 0");return{a:p,b:m,c:n}}static buyExactIn({poolInfo:e,amount:t}){return this.getAmountOut({amountIn:t,inputReserve:e.virtualB.add(e.realB),outputReserve:e.virtualA.sub(e.realA)})}static buyExactOut({poolInfo:e,amount:t}){return this.getAmountIn({amountOut:t,inputReserve:e.virtualB.add(e.realB),outputReserve:e.virtualA.sub(e.realA)})}static sellExactIn({poolInfo:e,amount:t}){return this.getAmountOut({amountIn:t,inputReserve:e.virtualA.sub(e.realA),outputReserve:e.virtualB.add(e.realB)})}static sellExactOut({poolInfo:e,amount:t}){return this.getAmountIn({amountOut:t,inputReserve:e.virtualA.sub(e.realA),outputReserve:e.virtualB.add(e.realB)})}static getAmountOut({amountIn:e,inputReserve:t,outputReserve:n}){let i=e.mul(n),r=t.add(e);return i.div(r)}static getAmountIn({amountOut:e,inputReserve:t,outputReserve:n}){let i=t.mul(e),r=n.sub(e);return Qe(i,r)}};var Mt=U(require("bn.js")),ft=U(require("decimal.js"));var Qt=class extends qe{static getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n}){return new ft.default(e.virtualB.toString()).div(e.virtualA.toString()).mul(10**(t-n))}static getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:i}){return new ft.default(t.toString()).div(e.toString()).mul(10**(n-i))}static getPoolPrice({poolInfo:e,decimalA:t,decimalB:n}){return new ft.default(e.virtualB.toString()).div(e.virtualA.toString()).mul(10**(t-n))}static getPoolEndPrice({supply:e,totalSell:t,totalLockedAmount:n,totalFundRaising:i,migrateFee:r,decimalA:s,decimalB:a}){return new ft.default(i.sub(r).toString()).div(e.sub(t).sub(n).toString()).mul(10**(s-a))}static getPoolEndPriceReal({poolInfo:e,decimalA:t,decimalB:n}){let i=e.totalSellA.sub(e.realA),r=e.totalFundRaisingB.sub(e.realB);return new ft.default(e.virtualB.add(e.realB).add(r).toString()).div(e.virtualA.sub(e.realA).add(i).toString()).mul(10**(t-n))}static getInitParam({supply:e,totalFundRaising:t,totalSell:n,totalLockedAmount:i,migrateFee:r}){let s=e.sub(i);if(s.lte(new Mt.default(0)))throw Error("invalid input 1");let a=new Mt.default(2).mul(t).sub(r),c=t.mul(s).div(a);if(c.lt(new Mt.default(0))||t.lt(new Mt.default(0)))throw Error("invalid input 0");return{a:c,b:t,c}}static buyExactIn({poolInfo:e,amount:t}){return this.getAmountOut({amountIn:t,initInput:e.virtualB,initOutput:e.virtualA})}static buyExactOut({poolInfo:e,amount:t}){return this.getAmountIn({amountOut:t,initInput:e.virtualB,initOutput:e.virtualA})}static sellExactIn({poolInfo:e,amount:t}){return this.getAmountOut({amountIn:t,initInput:e.virtualA,initOutput:e.virtualB})}static sellExactOut({poolInfo:e,amount:t}){return this.getAmountIn({amountOut:t,initInput:e.virtualA,initOutput:e.virtualB})}static getAmountOut({amountIn:e,initInput:t,initOutput:n}){return n.mul(e).div(t)}static getAmountIn({amountOut:e,initInput:t,initOutput:n}){let i=t.mul(e);return Qe(i,n)}};var pe=U(require("bn.js")),Ge=U(require("decimal.js"));var Vn=U(require("bn.js")),Zt=U(require("decimal.js")),Ot=class{static _multipler(e){return new Zt.default(10).pow(e)}static getPrice({priceX64:e,decimalA:t,decimalB:n}){return new Zt.default(e.toString()).div(this._Q64).mul(this._multipler(t)).div(this._multipler(n))}static getPriceX64({price:e,decimalA:t,decimalB:n}){let i=e.mul(this._multipler(n)).div(this._multipler(t));return new Vn.default(i.mul(this._Q64).toFixed(0))}};Ot._Q64=new Zt.default(new Vn.default(1).shln(64).toString());var Yt=class extends qe{static getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n}){return new Ge.default(0)}static getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:i}){return new Ge.default(0)}static getPoolPrice({poolInfo:e,decimalA:t,decimalB:n}){return new Ge.default(e.virtualA.mul(e.realA).toString()).div(Ot._Q64).mul(10**(t-n))}static getPoolEndPrice({supply:e,totalSell:t,totalLockedAmount:n,totalFundRaising:i,migrateFee:r,decimalA:s,decimalB:a}){return new Ge.default(i.sub(r).toString()).div(e.sub(t).sub(n).toString()).mul(10**(s-a))}static getPoolEndPriceReal({poolInfo:e,decimalA:t,decimalB:n}){let i=e.totalSellA.sub(e.realA),r=e.totalFundRaisingB.sub(e.realB);return new Ge.default(e.virtualB.add(e.realB).add(r).toString()).div(e.virtualA.sub(e.realA).add(i).toString()).mul(10**(t-n))}static getInitParam({supply:e,totalFundRaising:t,totalSell:n,totalLockedAmount:i,migrateFee:r}){let s=e.sub(i);if(s.lte(new pe.default(0)))throw Error("supplyMinusLocked need gt 0");let a=t.mul(new pe.default(3)).sub(r),c=t.mul(new pe.default(2)).mul(s).div(a),p=c.mul(c),m=t.mul(new pe.default(2)).mul(Ne).div(p);if(!m.gt(new pe.default(0)))throw Error("a need gt 0");if(!xn.gt(m))throw Error("a need lt u64 max");if(m.lt(new pe.default(0))||c.lt(new pe.default(0)))throw Error("invalid input 0");return{a:m,b:new pe.default(0),c}}static buyExactIn({poolInfo:e,amount:t}){let n=e.realB.add(t),i=new pe.default(2).mul(n).mul(Ne).div(e.virtualA);return new pe.default(new Ge.default(i.toString()).sqrt().toFixed(0)).sub(e.realA)}static buyExactOut({poolInfo:e,amount:t}){let n=e.realA.add(t),i=n.mul(n);return Qe(e.virtualA.mul(i),new pe.default(2).mul(Ne)).sub(e.realB)}static sellExactIn({poolInfo:e,amount:t}){let n=e.realA.sub(t),i=n.mul(n),r=Qe(e.virtualA.mul(i),new pe.default(2).mul(Ne));return e.realB.sub(r)}static sellExactOut({poolInfo:e,amount:t}){let n=e.realB.sub(t),i=new pe.default(2).mul(n).mul(Ne).div(e.virtualA),r=new pe.default(new Ge.default(i.toString()).sqrt().toFixed(0));return e.realA.sub(r)}};var we=class{static getPoolCurvePointByPoolInfo({curveType:e,pointCount:t,poolInfo:n}){return this.getPoolCurvePointByInit({curveType:e,pointCount:t,supply:n.supply,totalFundRaising:n.totalFundRaisingB,totalSell:n.totalSellA,totalLockedAmount:n.vestingSchedule.totalLockedAmount,migrateFee:n.migrateFee,decimalA:n.mintDecimalsA,decimalB:n.mintDecimalsB})}static getPoolCurvePointByInit({curveType:e,pointCount:t,supply:n,totalFundRaising:i,totalSell:r,totalLockedAmount:s,migrateFee:a,decimalA:l,decimalB:c}){if(t<3)throw Error("point count < 3");let p=this.getCurve(e),m=p.getInitParam({supply:n,totalFundRaising:i,totalSell:r,totalLockedAmount:s,migrateFee:a}),w=p.getPoolInitPriceByInit(Z(V({},m),{decimalA:l,decimalB:c})),A=i.div(new Ae.default(t-1)),u=new Ae.default(0),y=[{price:w,totalSellSupply:0}],{a:b,b:h}=m,f=u,I=u;for(let T=1;T<t;T++){let d=T!==t-1?A:i.sub(I),P=this.buyExactIn({poolInfo:{virtualA:b,virtualB:h,realA:f,realB:I,totalFundRaisingB:i,totalSellA:r},amountB:d,protocolFeeRate:u,platformFeeRate:u,curveType:e,shareFeeRate:u,creatorFeeRate:u,transferFeeConfigA:void 0,slot:0});f=f.add(P.amountA.amount),I=I.add(P.amountB);let x=this.getPrice({poolInfo:{virtualA:b,virtualB:h,realA:f,realB:I},decimalA:l,decimalB:c,curveType:e});y.push({price:x,totalSellSupply:new _n.default(f.toString()).div(10**l).toNumber()})}return y}static getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n,curveType:i}){return this.getCurve(i).getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n})}static getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:i,curveType:r}){return this.getCurve(r).getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:i})}static getPrice({poolInfo:e,curveType:t,decimalA:n,decimalB:i}){return this.getCurve(t).getPoolPrice({poolInfo:e,decimalA:n,decimalB:i})}static getEndPrice({poolInfo:e,curveType:t,decimalA:n,decimalB:i}){return this.getCurve(t).getPoolPrice({poolInfo:e,decimalA:n,decimalB:i})}static getPoolEndPriceReal({poolInfo:e,curveType:t,decimalA:n,decimalB:i}){return this.getCurve(t).getPoolEndPriceReal({poolInfo:e,decimalA:n,decimalB:i})}static checkParam({supply:e,totalFundRaising:t,totalSell:n,totalLockedAmount:i,decimals:r,config:s,migrateType:a}){if(Number(r)!==6)throw Error("decimals = 6");if(e.mul(s.maxLockRate).div(Ze).lt(i))throw Error("total lock amount gte max lock amount");if(e.lt(s.minSupplyA.mul(new Ae.default(10**r))))throw Error("supply lt min supply");let c=e.mul(s.minSellRateA).div(Ze);if(n.lt(c))throw Error("invalid input");if(t.lt(s.minFundRaisingB))throw Error("total fund raising lt min fund raising");let p=e.sub(n).sub(i),m=e.mul(s.minMigrateRateA).div(Ze);if(p.lt(m))throw Error("migrate lt min migrate amoount");let w=e.sub(n).sub(i),A=new Ae.default(new _n.default(w.mul(t).toString()).sqrt().toFixed(0));if(a==="amm"){let u=new Ae.default(10).pow(new Ae.default(r));if(A.lte(u))throw Error("check migrate lp error")}else if(a==="cpmm"){let u=new Ae.default(100);if(A.lte(u))throw Error("check migrate lp error")}else throw Error("migrate type error")}static buyExactIn({poolInfo:e,amountB:t,protocolFeeRate:n,platformFeeRate:i,curveType:r,shareFeeRate:s,creatorFeeRate:a,transferFeeConfigA:l,slot:c}){let p=this.totalFeeRate({protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a}),m=this.calculateFee({amount:t,feeRate:p}),w=t.sub(m),A=this.getCurve(r),u=A.buyExactIn({poolInfo:e,amount:w}),y=e.totalSellA.sub(e.realA),b,h,f;if(u.gt(y)){b=y;let T=A.buyExactOut({poolInfo:e,amount:b});h=this.calculatePreFee({postFeeAmount:T,feeRate:p}),f=h.sub(T)}else b=u,h=t,f=m;let I=this.splitFee({totalFee:f,protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a});return{amountA:yn(b,l,c),amountB:h,splitFee:I}}static buyExactOut({poolInfo:e,amountA:t,protocolFeeRate:n,platformFeeRate:i,curveType:r,shareFeeRate:s,creatorFeeRate:a,transferFeeConfigA:l,slot:c}){let p=e.totalSellA.sub(e.realA),m=gn(t,l,c),w=m.fee?m.amount.add(m.fee):m.amount;t.gt(p)&&(w=p);let u=this.getCurve(r).buyExactOut({poolInfo:e,amount:w}),y=this.totalFeeRate({protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a}),b=this.calculatePreFee({postFeeAmount:u,feeRate:y}),h=b.sub(u),f=this.splitFee({totalFee:h,protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a});return{amountA:m,amountB:b,splitFee:f}}static sellExactIn({poolInfo:e,amountA:t,protocolFeeRate:n,platformFeeRate:i,curveType:r,shareFeeRate:s,creatorFeeRate:a,transferFeeConfigA:l,slot:c}){let p=this.getCurve(r),m=yn(t,l,c),w=m.fee?m.amount.sub(m.fee):m.amount,A=p.sellExactIn({poolInfo:e,amount:w}),u=this.calculateFee({amount:A,feeRate:this.totalFeeRate({protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a})}),y=this.splitFee({totalFee:u,protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a});return{amountA:m,amountB:A.sub(u),splitFee:y}}static sellExactOut({poolInfo:e,amountB:t,protocolFeeRate:n,platformFeeRate:i,curveType:r,shareFeeRate:s,creatorFeeRate:a,transferFeeConfigA:l,slot:c}){let p=this.totalFeeRate({protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a}),m=this.calculatePreFee({postFeeAmount:t,feeRate:p});if(e.realB.lt(m))throw Error("Insufficient liquidity");let w=m.sub(t),u=we.getCurve(r).sellExactOut({poolInfo:e,amount:m});if(u.gt(e.realA))throw Error();let y=this.splitFee({totalFee:w,protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a});return{amountA:gn(u,l,c),amountB:t,splitFee:y}}static splitFee({totalFee:e,protocolFeeRate:t,platformFeeRate:n,shareFeeRate:i,creatorFeeRate:r}){let s=this.totalFeeRate({protocolFeeRate:t,platformFeeRate:n,shareFeeRate:i,creatorFeeRate:r}),a=s.isZero()?new Ae.default(0):e.mul(n).div(s),l=s.isZero()?new Ae.default(0):e.mul(i).div(s),c=s.isZero()?new Ae.default(0):e.mul(r).div(s),p=e.sub(a).sub(l).sub(c);return{platformFee:a,shareFee:l,protocolFee:p,creatorFee:c}}static calculateFee({amount:e,feeRate:t}){return fi(e,t,Ze)}static calculatePreFee({postFeeAmount:e,feeRate:t}){if(t.isZero())return e;let n=e.mul(Ze),i=Ze.sub(t);return n.add(i).sub(new Ae.default(1)).div(i)}static totalFeeRate({protocolFeeRate:e,platformFeeRate:t,shareFeeRate:n,creatorFeeRate:i}){if(e.add(t).add(n).add(i).gt(new Ae.default(1e6)))throw Error("total fee rate gt 1_000_000");return e.add(t).add(n).add(i)}static getCurve(e){switch(e){case 0:return jt;case 1:return Qt;case 2:return Yt}throw Error("find curve error")}};var ye=U(require("decimal.js")),Xe={initPriceX64:new W.default("515752397214619"),supply:new W.default(1e15),totalSellA:new W.default(7931e11),totalFundRaisingB:new W.default(85e9),totalLockedAmount:new W.default("0"),cliffPeriod:new W.default("0"),unlockPeriod:new W.default("0"),decimals:6,virtualA:new W.default("1073471847374405"),virtualB:new W.default("30050573465"),realA:new W.default(0),realB:new W.default(0),protocolFee:new W.default(0),platformId:new qn.PublicKey("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),vestingSchedule:{totalLockedAmount:new W.default(0),cliffPeriod:new W.default(0),unlockPeriod:new W.default(0),startTime:new W.default(0),totalAllocatedShare:new W.default(0)}},Ue=new W.default(1e4),Jt=class extends it{constructor(e){super(e)}async sayHello(){console.log("hello")}async createLaunchpad(L){var F=L,{programId:e=ae,authProgramId:t,platformId:n=Xe.platformId,mintA:i,decimals:r=6,mintBDecimals:s=9,name:a,symbol:l,uri:c,migrateType:p,configId:m,snipers:w,configInfo:A,platformFeeRate:u,txVersion:y,computeBudgetConfig:b,txTipConfig:h,feePayer:f,buyAmount:I,minMintAAmount:T,slippage:d,associatedOnly:P=!0,checkCreateATAOwner:x=!1,extraSigners:k,token2022:K,transferFeeExtensionParams:N}=F,B=ve(F,["programId","authProgramId","platformId","mintA","decimals","mintBDecimals","name","symbol","uri","migrateType","configId","snipers","configInfo","platformFeeRate","txVersion","computeBudgetConfig","txTipConfig","feePayer","buyAmount","minMintAAmount","slippage","associatedOnly","checkCreateATAOwner","extraSigners","token2022","transferFeeExtensionParams"]);var Gn,Un,Xn,zn,Hn,jn,Qn,Zn,Yn,Jn;let D=[],S=this.createTxBuilder(f);t=t!=null?t:Re(e).publicKey,K=!!N,K&&(p="cpmm");let R=A;if(!R&&m){let Te=await this.scope.connection.getAccountInfo(m);Te&&(R=_e.decode(Te.data))}R||this.logAndCreateError("config not found");let H=R.mintB,z=R.curveType,{publicKey:$}=ut(e,i,H),{publicKey:j}=Fn(e,$,i),{publicKey:ee}=Fn(e,$,H),{publicKey:te}=Kn(i);this.logDebug(`create token: ${i.toBase58()}, mintB: ${H.toBase58()}, decimals A:${r}/B:${s}, config:${m.toBase58()}`),l.length>10&&this.logAndCreateError("Symbol length should shorter than 11"),c||this.logAndCreateError("uri should not empty");let oe=(Gn=B==null?void 0:B.supply)!=null?Gn:Xe.supply,Q=(Un=B==null?void 0:B.totalSellA)!=null?Un:Xe.totalSellA,G=(Xn=B==null?void 0:B.totalFundRaisingB)!=null?Xn:Xe.totalFundRaisingB,se=(zn=B==null?void 0:B.totalLockedAmount)!=null?zn:new W.default(0),ze=u;if(!u){let Te=await this.scope.connection.getAccountInfo(n);Te||this.logAndCreateError("platform id not found:",n.toString()),ze=dt.decode(Te.data).feeRate}let $e=we.getCurve(R.curveType).getInitParam({supply:oe,totalFundRaising:G,totalSell:Q,totalLockedAmount:se,migrateFee:R.migrateFee}),Se={epoch:new W.default(896),bump:254,status:0,mintDecimalsA:r,mintDecimalsB:s,supply:oe,totalSellA:Q,mintA:new qn.PublicKey(i),mintB:H,virtualA:$e.a,virtualB:$e.b,realA:Xe.realA,realB:Xe.realB,migrateFee:R.migrateFee,migrateType:p==="amm"?0:1,protocolFee:Xe.protocolFee,platformFee:ze,platformId:n,configId:m,vaultA:j,vaultB:ee,creator:this.scope.ownerPubKey,totalFundRaisingB:G,vestingSchedule:{totalLockedAmount:se,cliffPeriod:new W.default(0),unlockPeriod:new W.default(0),startTime:new W.default(0),totalAllocatedShare:new W.default(0)},mintProgramFlag:K?1:0},or=we.getCurve(R.curveType),{c:sr}=or.getInitParam({supply:Se.supply,totalFundRaising:Se.totalFundRaisingB,totalLockedAmount:se,totalSell:R.curveType===0?Se.totalSellA:new W.default(0),migrateFee:R.migrateFee});try{we.checkParam({supply:Se.supply,totalFundRaising:Se.totalFundRaisingB,totalSell:sr,totalLockedAmount:se,decimals:Se.mintDecimalsA,config:R,migrateType:p}),this.logDebug("check init params success")}catch(Te){this.logAndCreateError(`check create mint params failed, ${Te.message}`)}S.addInstruction({instructions:[K?Yi(e,f!=null?f:this.scope.ownerPubKey,this.scope.ownerPubKey,m,n,t,$,i,H,j,ee,r,a,l,c||"https://",{type:z===0?"ConstantCurve":z===1?"FixedCurve":z===2?"LinearCurve":"ConstantCurve",totalSellA:Q,migrateType:p,supply:oe,totalFundRaisingB:G},se,(Hn=B==null?void 0:B.cliffPeriod)!=null?Hn:new W.default(0),(jn=B==null?void 0:B.unlockPeriod)!=null?jn:new W.default(0),N):Zi(e,f!=null?f:this.scope.ownerPubKey,this.scope.ownerPubKey,m,n,t,$,i,H,j,ee,te,r,a,l,c||"https://",{type:z===0?"ConstantCurve":z===1?"FixedCurve":z===2?"LinearCurve":"ConstantCurve",totalSellA:Q,migrateType:p,supply:oe,totalFundRaisingB:G},se,(Qn=B==null?void 0:B.cliffPeriod)!=null?Qn:new W.default(0),(Zn=B==null?void 0:B.unlockPeriod)!=null?Zn:new W.default(0))]});let $t=K?await this.scope.connection.getEpochInfo():void 0,Ee=N?{epoch:BigInt(($t==null?void 0:$t.epoch)||0),maximumFee:BigInt((Yn=N==null?void 0:N.maxinumFee.toString())!=null?Yn:0),transferFeeBasisPoints:(Jn=N==null?void 0:N.transferFeeBasePoints)!=null?Jn:0}:void 0,en={amountA:{amount:new W.default(0),fee:void 0,expirationTime:void 0},amountB:new W.default(0),splitFee:{platformFee:new W.default(0),shareFee:new W.default(0),protocolFee:new W.default(0),creatorFee:new W.default(0)}},tn;if(k!=null&&k.length&&S.addInstruction({signers:k}),!B.createOnly){let{builder:Te,extInfo:ar}=await this.buyToken({programId:e,authProgramId:t,mintAProgram:K?C.TOKEN_2022_PROGRAM_ID:void 0,mintA:i,mintB:H,poolInfo:Se,buyAmount:I,minMintAAmount:T,shareFeeRate:B.shareFeeRate,shareFeeReceiver:B.shareFeeReceiver,configInfo:R,platformFeeRate:ze,slippage:d,associatedOnly:P,checkCreateATAOwner:x,skipCheckMintA:!Ee,transferFeeConfigA:Ee?{transferFeeConfigAuthority:t,withdrawWithheldAuthority:t,withheldAmount:BigInt(0),olderTransferFee:Ee,newerTransferFee:Ee}:void 0});console.log("PREPARING SNIPER TRANSACTIONS");for(let $n of w){let{builder:cr,extInfo:xo}=await this.buyToken({programId:e,authProgramId:t,mintAProgram:K?C.TOKEN_2022_PROGRAM_ID:void 0,mintA:i,mintB:H,poolInfo:Se,buyAmount:$n.amount,minMintAAmount:T,shareFeeRate:B.shareFeeRate,shareFeeReceiver:B.shareFeeReceiver,configInfo:R,platformFeeRate:ze,slippage:d,sniper:$n,associatedOnly:P,checkCreateATAOwner:x,skipCheckMintA:!Ee,transferFeeConfigA:Ee?{transferFeeConfigAuthority:t,withdrawWithheldAuthority:t,withheldAmount:BigInt(0),olderTransferFee:Ee,newerTransferFee:Ee}:void 0});D.push(Z(V({},cr.AllTxData),{blockHash:this.scope.blockhashCommitment}))}S.addInstruction(V({},Te.AllTxData)),en=V({},ar),tn=(this.scope.cluster==="devnet"||y===1)&&B.shareFeeReceiver?[Te.allInstructions[0]]:void 0}return S.addTipInstruction(h),y===0?{tx:await S.sizeCheckBuildV0({computeBudgetConfig:b,swapInfo:en,splitIns:tn,address:Z(V({},Se),{poolId:$})}),txs:D}:{tx:await S.sizeCheckBuild({computeBudgetConfig:b,swapInfo:en,splitIns:tn,address:Z(V({},Se),{poolId:$})}),txs:D}}async buyToken({programId:e=ae,authProgramId:t,mintA:n,mintAProgram:i=C.TOKEN_PROGRAM_ID,mintB:r=C.NATIVE_MINT,poolInfo:s,configInfo:a,platformFeeRate:l,txVersion:c,computeBudgetConfig:p,txTipConfig:m,feePayer:w,buyAmount:A,minMintAAmount:u,slippage:y,shareFeeRate:b=new W.default(0),shareFeeReceiver:h,sniper:f,associatedOnly:I=!0,checkCreateATAOwner:T=!1,transferFeeConfigA:d,skipCheckMintA:P=!1}){var G,se,ze;A.lte(new W.default(0))&&this.logAndCreateError("buy amount should gt 0:",A.toString());let x=f?this.createSniperTxBuilder(f.owner,f.owner.publicKey):this.createTxBuilder(w),{publicKey:k}=ut(e,n,r);t=t!=null?t:Re(e).publicKey;let K=d;if(!P)if(K)i=C.TOKEN_2022_PROGRAM_ID;else{let ue=await this.scope.connection.getAccountInfo(n);if(ue&&ue.owner.equals(C.TOKEN_2022_PROGRAM_ID)){i=ue.owner;let $e=(0,C.unpackMint)(n,ue,i);K=(0,C.getTransferFeeConfig)($e)||void 0}}let N=f?this.scope.account.getAssociatedTokenAccountByOwner(f.owner.publicKey,n,i):this.scope.account.getAssociatedTokenAccount(n,i),B=null,L=r.equals(C.NATIVE_MINT);console.log("userTokenAccountA: ",N),console.log("mintAProgram: ",i),x.addInstruction({instructions:[(0,C.createAssociatedTokenAccountIdempotentInstruction)((f==null?void 0:f.owner.publicKey)||this.scope.ownerPubKey,N,(f==null?void 0:f.owner.publicKey)||this.scope.ownerPubKey,n,i)]});let{account:F,instructionParams:D}=await this.scope.account.getOrCreateTokenAccount({mint:r,owner:(f==null?void 0:f.owner.publicKey)||this.scope.ownerPubKey,createInfo:L?{payer:(f==null?void 0:f.owner.publicKey)||this.scope.ownerPubKey,amount:A}:void 0,skipCloseAccount:!L,notUseTokenAccount:L,associatedOnly:L?!1:I,checkCreateATAOwner:T});F&&(B=F),x.addInstruction(D||{}),B===void 0&&this.logAndCreateError(`cannot found mintB(${r.toBase58()}) token accounts`,"tokenAccounts",this.scope.account.tokenAccounts);let S=s;if(!S){let ue=await this.scope.connection.getAccountInfo(k,{commitment:"processed"});ue||this.logAndCreateError("cannot found pool:",k.toBase58()),S=Ie.decode(ue.data)}let R=a,H=await Fe(this.scope.connection,[R?void 0:S.configId,S.platformId].filter(Boolean).map(ue=>({pubkey:ue})));if(!R){let ue=H.find($e=>$e.pubkey.equals(S.configId));(!ue||!ue.accountInfo)&&this.logAndCreateError("config not found: ",S.configId.toBase58()),R=_e.decode(ue.accountInfo.data)}let z=H.find(ue=>ue.pubkey.equals(S.platformId));(!z||!z.accountInfo)&&this.logAndCreateError("platform info not found: ",S.configId.toBase58());let $=dt.decode(z.accountInfo.data);l=l||$.feeRate;let j=we.buyExactIn({poolInfo:S,amountB:A,protocolFeeRate:R.tradeFeeRate,platformFeeRate:l,curveType:R.curveType,shareFeeRate:b,creatorFeeRate:$.creatorFeeRate,transferFeeConfigA:K,slot:await this.scope.connection.getSlot()}),ee=new ye.default(j.amountA.amount.toString()).sub((se=(G=j.amountA.fee)==null?void 0:G.toString())!=null?se:0),te=y?new ye.default(Ue.sub(y).toNumber()/Ue.toNumber()).clampedTo(0,1):new ye.default(1),oe=u!=null?u:y?new W.default(ee.mul(te).toFixed(0)):j.amountA.amount.sub((ze=j.amountA.fee)!=null?ze:new W.default(0));j.amountB.lt(A)&&console.log(`maximum ${n.toBase58()} amount can buy is ${j.amountA.toString()}, input ${r.toBase58()} amount: ${j.amountB.toString()}`);let Q=h?Be(h,r,C.TOKEN_PROGRAM_ID).publicKey:void 0;return Q&&x.addInstruction({instructions:[(0,C.createAssociatedTokenAccountIdempotentInstruction)((f==null?void 0:f.owner.publicKey)||this.scope.ownerPubKey,Q,h,r)]}),x.addInstruction({instructions:[Ji(e,(f==null?void 0:f.owner.publicKey)||this.scope.ownerPubKey,t,S.configId,S.platformId,k,N,B,S.vaultA,S.vaultB,n,r,i,C.TOKEN_PROGRAM_ID,Je(e,S.platformId,r).publicKey,lt(e,S.creator,r).publicKey,j.amountB.lt(A)?j.amountB:A,oe,b,Q)]}),x.addCustomComputeBudget(p),x.addTipInstruction(m),x.versionBuild({txVersion:c,extInfo:Z(V({},j),{decimalOutAmount:ee,minDecimalOutAmount:new ye.default(oe.toString())})})}async buyTokenExactOut({programId:e=ae,authProgramId:t,mintA:n,mintAProgram:i=C.TOKEN_PROGRAM_ID,mintB:r=C.NATIVE_MINT,poolInfo:s,configInfo:a,transferFeeConfigA:l,platformFeeRate:c,txVersion:p,computeBudgetConfig:m,txTipConfig:w,feePayer:A,maxBuyAmount:u,outAmount:y,slippage:b,shareFeeRate:h=new W.default(0),shareFeeReceiver:f,associatedOnly:I=!0,checkCreateATAOwner:T=!1,skipCheckMintA:d=!1}){y.lte(new W.default(0))&&this.logAndCreateError("out amount should gt 0:",y.toString());let P=this.createTxBuilder(A),{publicKey:x}=ut(e,n,r);t=t!=null?t:Re(e).publicKey;let k=s;if(!k){let Q=await this.scope.connection.getAccountInfo(x,{commitment:"processed"});Q||this.logAndCreateError("cannot found pool:",x.toBase58()),k=Ie.decode(Q.data)}let K=a,N=await Fe(this.scope.connection,[K?void 0:k.configId,k.platformId].filter(Boolean).map(Q=>({pubkey:Q})));if(!K){let Q=N.find(G=>G.pubkey.equals(k.configId));(!Q||!Q.accountInfo)&&this.logAndCreateError("config not found: ",k.configId.toBase58()),K=_e.decode(Q.accountInfo.data)}let B=N.find(Q=>Q.pubkey.equals(k.platformId));(!B||!B.accountInfo)&&this.logAndCreateError("platform info not found: ",k.configId.toBase58());let L=dt.decode(B.accountInfo.data);c=c||L.feeRate;let F=l;if(!d)if(F)i=C.TOKEN_2022_PROGRAM_ID;else{let Q=await this.scope.connection.getAccountInfo(n);if(Q&&Q.owner.equals(C.TOKEN_2022_PROGRAM_ID)){i=Q.owner;let G=(0,C.unpackMint)(n,Q,i);F=(0,C.getTransferFeeConfig)(G)||void 0}}let D=we.buyExactOut({poolInfo:k,amountA:y,protocolFeeRate:K.tradeFeeRate,platformFeeRate:c,curveType:K.curveType,shareFeeRate:h,creatorFeeRate:L.creatorFeeRate,transferFeeConfigA:F,slot:await this.scope.connection.getSlot()}),S=new ye.default(D.amountB.toString()),R=b?new ye.default(Ue.add(b).toNumber()/Ue.toNumber()).clampedTo(0,Number.MIN_SAFE_INTEGER):new ye.default(1),H=(u!=null?u:b)?new W.default(S.mul(R).toFixed(0)):D.amountB,z=this.scope.account.getAssociatedTokenAccount(n,i),$=null,j=r.equals(C.NATIVE_MINT);P.addInstruction({instructions:[(0,C.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,z,this.scope.ownerPubKey,n,i)]});let{account:ee,instructionParams:te}=await this.scope.account.getOrCreateTokenAccount({mint:r,owner:this.scope.ownerPubKey,createInfo:j?{payer:this.scope.ownerPubKey,amount:D.amountB}:void 0,skipCloseAccount:!j,notUseTokenAccount:j,associatedOnly:j?!1:I,checkCreateATAOwner:T});ee&&($=ee),P.addInstruction(te||{}),$===void 0&&this.logAndCreateError(`cannot found mintB(${r.toBase58()}) token accounts`,"tokenAccounts",this.scope.account.tokenAccounts);let oe=f?Be(f,r,C.TOKEN_PROGRAM_ID).publicKey:void 0;return oe&&P.addInstruction({instructions:[(0,C.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,oe,f,r)]}),P.addInstruction({instructions:[$i(e,this.scope.ownerPubKey,t,k.configId,k.platformId,x,z,$,k.vaultA,k.vaultB,n,r,i,C.TOKEN_PROGRAM_ID,Je(e,k.platformId,r).publicKey,lt(e,k.creator,r).publicKey,y,H,h,oe)]}),P.addCustomComputeBudget(m),P.addTipInstruction(w),P.versionBuild({txVersion:p,extInfo:{maxSpentAmount:H,outAmount:y}})}async sellToken({programId:e=ae,authProgramId:t,mintAProgram:n=C.TOKEN_PROGRAM_ID,mintA:i,mintB:r=C.NATIVE_MINT,poolInfo:s,configInfo:a,platformFeeRate:l,txVersion:c,computeBudgetConfig:p,txTipConfig:m,feePayer:w,sellAmount:A,minAmountB:u,slippage:y,shareFeeRate:b=new W.default(0),shareFeeReceiver:h,associatedOnly:f=!0,checkCreateATAOwner:I=!1,skipCheckMintA:T=!1}){t=t!=null?t:Re(e).publicKey;let d=this.createTxBuilder(w);A.lte(new W.default(0))&&this.logAndCreateError("sell amount should be gt 0");let{publicKey:P}=ut(e,i,r),x;if(!T){let G=await this.scope.connection.getAccountInfo(i);if(G&&G.owner.equals(C.TOKEN_2022_PROGRAM_ID)){n=G.owner;let se=(0,C.unpackMint)(i,G,n);x=(0,C.getTransferFeeConfig)(se)||void 0}}let k=null,K=null,N=r.equals(C.NATIVE_MINT),{account:B,instructionParams:L}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:n,mint:i,owner:this.scope.ownerPubKey,createInfo:void 0,skipCloseAccount:!0,notUseTokenAccount:!1,associatedOnly:f,checkCreateATAOwner:I});B&&(k=B),d.addInstruction(L||{}),k===void 0&&this.logAndCreateError("cannot found mintA token accounts","tokenAccounts",this.scope.account.tokenAccounts);let{account:F,instructionParams:D}=await this.scope.account.getOrCreateTokenAccount({mint:r,owner:this.scope.ownerPubKey,createInfo:N?{payer:this.scope.ownerPubKey,amount:0}:void 0,skipCloseAccount:!N,notUseTokenAccount:N,associatedOnly:N?!1:f,checkCreateATAOwner:I});F&&(K=F),d.addInstruction(D||{}),K===void 0&&this.logAndCreateError("cannot found mintB token accounts","tokenAccounts",this.scope.account.tokenAccounts);let S=s;if(!S){let G=await this.scope.connection.getAccountInfo(P,{commitment:"processed"});G||this.logAndCreateError("cannot found pool",P.toBase58()),S=Ie.decode(G.data)}let R=a,H=await Fe(this.scope.connection,[R?void 0:S.configId,S.platformId].filter(Boolean).map(G=>({pubkey:G})));if(!R){let G=H.find(se=>se.pubkey.equals(S.configId));(!G||!G.accountInfo)&&this.logAndCreateError("config not found: ",S.configId.toBase58()),R=_e.decode(G.accountInfo.data)}let z=H.find(G=>G.pubkey.equals(S.platformId));(!z||!z.accountInfo)&&this.logAndCreateError("platform info not found: ",S.configId.toBase58());let $=dt.decode(z.accountInfo.data);l=l||$.feeRate;let j=we.sellExactIn({poolInfo:S,amountA:A,protocolFeeRate:R.tradeFeeRate,platformFeeRate:l,curveType:R.curveType,shareFeeRate:b,creatorFeeRate:$.creatorFeeRate,transferFeeConfigA:x,slot:await this.scope.connection.getSlot()}),ee=new ye.default(j.amountB.toString()),te=y?new ye.default(Ue.sub(y).toNumber()/Ue.toNumber()).clampedTo(0,1):new ye.default(1),oe=u!=null?u:y?new W.default(ee.mul(te).toFixed(0)):j.amountB;oe.lte(new W.default(0))&&this.logAndCreateError(`out ${r.toBase58()} amount should be gt 0`);let Q=h?Be(h,r,C.TOKEN_PROGRAM_ID).publicKey:void 0;return Q&&d.addInstruction({instructions:[(0,C.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,Q,h,r)]}),d.addInstruction({instructions:[er(e,this.scope.ownerPubKey,t,S.configId,S.platformId,P,k,K,S.vaultA,S.vaultB,i,r,n,C.TOKEN_PROGRAM_ID,Je(e,S.platformId,r).publicKey,lt(e,S.creator,r).publicKey,j.amountA.amount.lt(A)?j.amountA.amount:A,oe,b,Q)]}),d.addCustomComputeBudget(p),d.addTipInstruction(m),d.versionBuild({txVersion:c,extInfo:{outAmount:oe}})}async sellTokenExactOut({programId:e=ae,authProgramId:t,mintAProgram:n=C.TOKEN_PROGRAM_ID,mintA:i,mintB:r=C.NATIVE_MINT,poolInfo:s,configInfo:a,platformFeeRate:l,txVersion:c,computeBudgetConfig:p,txTipConfig:m,feePayer:w,inAmount:A,maxSellAmount:u,slippage:y,shareFeeRate:b=new W.default(0),shareFeeReceiver:h,associatedOnly:f=!0,checkCreateATAOwner:I=!1,skipCheckMintA:T=!1}){t=t!=null?t:Re(e).publicKey;let d=this.createTxBuilder(w);u!=null&&u.lte(new W.default(0))&&this.logAndCreateError("max sell amount should be gt 0");let{publicKey:P}=ut(e,i,r),x;if(!T){let G=await this.scope.connection.getAccountInfo(i);if(G&&G.owner.equals(C.TOKEN_2022_PROGRAM_ID)){n=G.owner;let se=(0,C.unpackMint)(i,G,n);x=(0,C.getTransferFeeConfig)(se)||void 0}}let k=null,K=null,N=r.equals(C.NATIVE_MINT),{account:B,instructionParams:L}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:n,mint:i,owner:this.scope.ownerPubKey,createInfo:void 0,skipCloseAccount:!0,notUseTokenAccount:!1,associatedOnly:f,checkCreateATAOwner:I});B&&(k=B),d.addInstruction(L||{}),k===void 0&&this.logAndCreateError("cannot found mintA token accounts","tokenAccounts",this.scope.account.tokenAccounts);let{account:F,instructionParams:D}=await this.scope.account.getOrCreateTokenAccount({mint:r,owner:this.scope.ownerPubKey,createInfo:N?{payer:this.scope.ownerPubKey,amount:0}:void 0,skipCloseAccount:!N,notUseTokenAccount:N,associatedOnly:N?!1:f,checkCreateATAOwner:I});F&&(K=F),d.addInstruction(D||{}),K===void 0&&this.logAndCreateError("cannot found mintB token accounts","tokenAccounts",this.scope.account.tokenAccounts);let S=s;if(!S){let G=await this.scope.connection.getAccountInfo(P,{commitment:"processed"});G||this.logAndCreateError("cannot found pool",P.toBase58()),S=Ie.decode(G.data)}let R=a,H=await Fe(this.scope.connection,[R?void 0:S.configId,S.platformId].filter(Boolean).map(G=>({pubkey:G})));if(!R){let G=H.find(se=>se.pubkey.equals(S.configId));(!G||!G.accountInfo)&&this.logAndCreateError("config not found: ",S.configId.toBase58()),R=_e.decode(G.accountInfo.data)}let z=H.find(G=>G.pubkey.equals(S.platformId));(!z||!z.accountInfo)&&this.logAndCreateError("platform info not found: ",S.configId.toBase58());let $=dt.decode(z.accountInfo.data);l=l||$.feeRate;let j=we.sellExactOut({poolInfo:S,amountB:A,protocolFeeRate:R.tradeFeeRate,platformFeeRate:l,curveType:R.curveType,shareFeeRate:b,creatorFeeRate:$.creatorFeeRate,transferFeeConfigA:x,slot:await this.scope.connection.getSlot()}),ee=new ye.default(j.amountA.amount.toString()),te=y?new ye.default(Ue.add(y).toNumber()/Ue.toNumber()).clampedTo(0,Number.MAX_SAFE_INTEGER):new ye.default(1),oe=(u!=null?u:y)?new W.default(ee.mul(te).toFixed(0)):j.amountA.amount,Q=h?Be(h,r,C.TOKEN_PROGRAM_ID).publicKey:void 0;return Q&&d.addInstruction({instructions:[(0,C.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,Q,h,r)]}),d.addInstruction({instructions:[tr(e,this.scope.ownerPubKey,t,S.configId,S.platformId,P,k,K,S.vaultA,S.vaultB,i,r,n,C.TOKEN_PROGRAM_ID,Je(e,S.platformId,r).publicKey,lt(e,S.creator,r).publicKey,A,oe,b,Q)]}),d.addCustomComputeBudget(p),d.addTipInstruction(m),d.versionBuild({txVersion:c,extInfo:{maxSellAmount:oe}})}async createPlatformConfig({programId:e=ae,platformAdmin:t,platformClaimFeeWallet:n,platformLockNftWallet:i,cpConfigId:r,migrateCpLockNftScale:s,transferFeeExtensionAuth:a,creatorFeeRate:l,feeRate:c,name:p,web:m,img:w,txVersion:A,computeBudgetConfig:u,txTipConfig:y,feePayer:b}){let h=this.createTxBuilder(b),{publicKey:f}=Mn(e,t);return h.addInstruction({instructions:[nr(e,t,n,i,f,r,a,s,c,l,p,m,w)]}),h.addCustomComputeBudget(u),h.addTipInstruction(y),h.versionBuild({txVersion:A,extInfo:{platformId:f}})}async updatePlatformConfig({programId:e=ae,platformAdmin:t,platformId:n,updateInfo:i,txVersion:r,computeBudgetConfig:s,txTipConfig:a,feePayer:l}){let c=this.createTxBuilder(l),p=n!=null?n:Mn(e,t).publicKey;return c.addInstruction({instructions:[ir(e,t,p,i)]}),c.addCustomComputeBudget(s),c.addTipInstruction(a),c.versionBuild({txVersion:r})}async claimPlatformFee({programId:e=ae,authProgramId:t,platformId:n,poolId:i,platformClaimFeeWallet:r,mintB:s,vaultB:a,mintBProgram:l=C.TOKEN_PROGRAM_ID,txVersion:c,computeBudgetConfig:p,txTipConfig:m,feePayer:w}){var h;let A=this.createTxBuilder(w);t=t!=null?t:Re(e).publicKey;let u=s,y=a;if(!u){let f=await this.scope.connection.getAccountInfo(i,{commitment:"processed"});f||this.logAndCreateError("cannot found pool:",i.toBase58());let I=Ie.decode(f.data),T=await this.scope.connection.getAccountInfo(I.configId,{commitment:"processed"});T||this.logAndCreateError("cannot found config:",I.configId.toBase58()),u=_e.decode(T.data).mintB,y=y!=null?y:I.vaultB}(!u||!y)&&this.logAndCreateError("cannot found mint info, mintB: ",u.toBase58(),", vaultB: ",(h=y==null?void 0:y.toBase58())!=null?h:"");let b=Be(this.scope.ownerPubKey,u,C.TOKEN_PROGRAM_ID).publicKey;return A.addInstruction({instructions:[(0,C.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,b,this.scope.ownerPubKey,u)]}),A.addInstruction({instructions:[Dn(e,r,t,i,n,y,b,u,l)]}),A.addCustomComputeBudget(p),A.addTipInstruction(m),A.versionBuild({txVersion:c})}async claimAllPlatformFee({programId:e=ae,authProgramId:t,platformId:n,platformClaimFeeWallet:i,txVersion:r,computeBudgetConfig:s,txTipConfig:a,feePayer:l}){let c=this.createTxBuilder(l);return t=t!=null?t:Re(e).publicKey,(await this.scope.connection.getProgramAccounts(e,{filters:[{dataSize:Ie.span},{memcmp:{offset:Ie.offsetOf("platformId"),bytes:n.toString()}}]})).forEach(m=>{let w=Ie.decode(m.account.data);if(w.platformFee.lte(new W.default(0)))return;let A=Be(this.scope.ownerPubKey,w.mintB,C.TOKEN_PROGRAM_ID).publicKey;c.addInstruction({instructions:[(0,C.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,A,this.scope.ownerPubKey,w.mintB)]}),c.addInstruction({instructions:[Dn(e,i,t,m.pubkey,n,w.vaultB,A,w.mintB,C.TOKEN_PROGRAM_ID)]})}),c.addTipInstruction(a),r===0?c.sizeCheckBuildV0({computeBudgetConfig:s}):c.sizeCheckBuild({computeBudgetConfig:s})}async createVesting({programId:e=ae,poolId:t,beneficiary:n,shareAmount:i,txVersion:r,computeBudgetConfig:s,txTipConfig:a,feePayer:l}){let c=this.createTxBuilder(l),p=await this.getRpcPoolInfo({poolId:t});i.add(p.vestingSchedule.totalAllocatedShare).gt(p.vestingSchedule.totalLockedAmount)&&this.logAndCreateError("share amount exceed total locked amount");let m=Lt(e,t,n).publicKey;return c.addInstruction({instructions:[vn(e,this.scope.ownerPubKey,n,t,m,i)]}),c.addCustomComputeBudget(s),c.addTipInstruction(a),c.versionBuild({txVersion:r})}async createMultipleVesting({programId:e=ae,poolId:t,beneficiaryList:n,txVersion:i,computeBudgetConfig:r,feePayer:s}){let a=this.createTxBuilder(s);n.length===0&&this.logAndCreateError("beneficiaryList is null");let l=await this.getRpcPoolInfo({poolId:t});return n.reduce((p,m)=>p.add(m.shareAmount),l.vestingSchedule.totalAllocatedShare).gt(l.vestingSchedule.totalLockedAmount)&&this.logAndCreateError("share amount exceed total locked amount"),n.forEach(p=>{let m=Lt(e,t,p.wallet).publicKey;a.addInstruction({instructions:[vn(e,this.scope.ownerPubKey,p.wallet,t,m,p.shareAmount)]})}),i===0?a.sizeCheckBuildV0({computeBudgetConfig:r}):a.sizeCheckBuild({computeBudgetConfig:r})}async claimVesting({programId:e=ae,poolId:t,poolInfo:n,vestingRecord:i,txVersion:r,computeBudgetConfig:s,txTipConfig:a,feePayer:l}){let c=this.createTxBuilder(l),p=Re(e).publicKey,m=i||Lt(e,t,this.scope.ownerPubKey).publicKey,w=n;if(!w){let u=await this.scope.connection.getAccountInfo(t);u||this.logAndCreateError("pool not found"),w=Ie.decode(u.data)}let A=Be(this.scope.ownerPubKey,w.mintA,C.TOKEN_PROGRAM_ID).publicKey;return c.addInstruction({instructions:[(0,C.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,A,this.scope.ownerPubKey,w.mintA)]}),c.addInstruction({instructions:[En(e,this.scope.ownerPubKey,p,t,m,A,w.vaultA,w.mintA,C.TOKEN_PROGRAM_ID)]}),c.addCustomComputeBudget(s),c.addTipInstruction(a),c.versionBuild({txVersion:r})}async claimMultiVesting({programId:e=ae,poolIdList:t,poolsInfo:n={},vestingRecords:i={},txVersion:r,computeBudgetConfig:s,feePayer:a}){let l=this.createTxBuilder(a),c=V({},n),p=Re(e).publicKey,m=t.filter(w=>!c[w.toBase58()]);if(m.length){let w=await this.getRpcPoolsInfo({poolIdList:m});c=V(V({},c),w.poolInfoMap)}return t.forEach(w=>{let A=w.toBase58(),u=c[A];u||this.logAndCreateError(`pool info not found: ${A}`);let y=i[A]||Lt(e,w,this.scope.ownerPubKey).publicKey,b=Be(this.scope.ownerPubKey,u.mintA,C.TOKEN_PROGRAM_ID).publicKey;l.addInstruction({instructions:[(0,C.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,b,this.scope.ownerPubKey,u.mintA)]}),l.addInstruction({instructions:[En(e,this.scope.ownerPubKey,p,w,y,b,u.vaultA,u.mintA,C.TOKEN_PROGRAM_ID)]})}),r===0?l.sizeCheckBuildV0({computeBudgetConfig:s}):l.sizeCheckBuild({computeBudgetConfig:s})}async claimVaultPlatformFee({programId:e=ae,platformId:t,mintB:n,mintBProgram:i=C.TOKEN_PROGRAM_ID,claimFeeWallet:r,txVersion:s,computeBudgetConfig:a,txTipConfig:l,feePayer:c}){let p=this.createTxBuilder(c),m=Je(e,t,n).publicKey,w=On(e).publicKey,A=this.scope.account.getAssociatedTokenAccount(n,i);return p.addInstruction({instructions:[(0,C.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,A,this.scope.ownerPubKey,n,i),Wn(e,t,r!=null?r:this.scope.ownerPubKey,w,m,A,n,i)]}),p.addCustomComputeBudget(a),p.addTipInstruction(l),p.versionBuild({txVersion:s})}async claimMultipleVaultPlatformFee({programId:e=ae,platformList:t,unwrapSol:n=!0,txVersion:i,computeBudgetConfig:r,feePayer:s,associatedOnly:a=!0,checkCreateATAOwner:l=!1}){let c=this.createTxBuilder(s),p={};return t.forEach(async m=>{var b,h;let w=On(e).publicKey,A=Je(e,m.id,m.mintB).publicKey,u=m.mintB.equals(C.NATIVE_MINT)&&n,y=p[m.mintB.toBase58()];if(!y){let{account:f,instructionParams:I}=await this.scope.account.getOrCreateTokenAccount({mint:m.mintB,owner:this.scope.ownerPubKey,createInfo:u?{payer:this.scope.ownerPubKey,amount:0}:void 0,skipCloseAccount:!u,notUseTokenAccount:u,associatedOnly:u?!1:a,checkCreateATAOwner:l});f&&(y=f),c.addInstruction(I||{}),y===void 0&&this.logAndCreateError(`cannot found platform ${m.id.toBase58()} mintB(${m.mintB.toBase58()}) token accounts`,"tokenAccounts",this.scope.account.tokenAccounts)}c.addInstruction({instructions:[Wn(e,m.id,(b=m.claimFeeWallet)!=null?b:this.scope.ownerPubKey,A,w,y,m.mintB,(h=m.mintBProgram)!=null?h:C.TOKEN_PROGRAM_ID)]})}),i===0?c.sizeCheckBuildV0({computeBudgetConfig:r}):c.sizeCheckBuild({computeBudgetConfig:r})}async claimCreatorFee({programId:e=ae,mintB:t,mintBProgram:n=C.TOKEN_PROGRAM_ID,txVersion:i,computeBudgetConfig:r,txTipConfig:s,feePayer:a}){let l=this.createTxBuilder(a),c=lt(e,this.scope.ownerPubKey,t).publicKey,p=Qi(e).publicKey,m=this.scope.account.getAssociatedTokenAccount(t,n);return l.addInstruction({instructions:[(0,C.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,m,this.scope.ownerPubKey,t,n),rr(e,this.scope.ownerPubKey,p,c,m,t,n)]}),l.addCustomComputeBudget(r),l.addTipInstruction(s),l.versionBuild({txVersion:i})}async getRpcPoolInfo({poolId:e}){return(await this.getRpcPoolsInfo({poolIdList:[e]})).poolInfoMap[e.toBase58()]}async getRpcPoolsInfo({poolIdList:e,config:t}){let n=await Fe(this.scope.connection,e.map(l=>({pubkey:l})),t),i={},r=[];for(let l=0;l<e.length;l++){let c=n[l];if(c===null||!c.accountInfo)throw Error("fetch pool info error: "+e[l].toBase58());let p=Ie.decode(c.accountInfo.data);i[e[l].toBase58()]=Z(V({},p),{poolId:c.accountInfo.owner}),r.push(p.configId)}let s=await Fe(this.scope.connection,r.map(l=>({pubkey:l})),t),a={};for(let l=0;l<r.length;l++){let c=s[l];if(c===null||!c.accountInfo)throw Error("fetch config info error: "+r[l].toBase58());let p=_e.decode(c.accountInfo.data);a[r[l].toBase58()]=Z(V({},p),{configId:c.accountInfo.owner})}return{poolInfoMap:Object.keys(i).reduce((l,c)=>Z(V({},l),{[c]:Z(V({},i[c]),{configInfo:a[i[c].configId.toBase58()]})}),{})}}};0&&(module.exports={LaunchpadPoolInitParam});
//# sourceMappingURL=launchpad.js.map