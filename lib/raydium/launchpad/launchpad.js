var dr=Object.create;var bt=Object.defineProperty,pr=Object.defineProperties,fr=Object.getOwnPropertyDescriptor,br=Object.getOwnPropertyDescriptors,yr=Object.getOwnPropertyNames,Et=Object.getOwnPropertySymbols,gr=Object.getPrototypeOf,nn=Object.prototype.hasOwnProperty,si=Object.prototype.propertyIsEnumerable;var oi=(o,e,t)=>e in o?bt(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,q=(o,e)=>{for(var t in e||(e={}))nn.call(e,t)&&oi(o,t,e[t]);if(Et)for(var t of Et(e))si.call(e,t)&&oi(o,t,e[t]);return o},Q=(o,e)=>pr(o,br(e));var We=(o,e)=>{var t={};for(var n in o)nn.call(o,n)&&e.indexOf(n)<0&&(t[n]=o[n]);if(o!=null&&Et)for(var n of Et(o))e.indexOf(n)<0&&si.call(o,n)&&(t[n]=o[n]);return t};var Pr=(o,e)=>{for(var t in e)bt(o,t,{get:e[t],enumerable:!0})},ai=(o,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of yr(e))!nn.call(o,i)&&i!==t&&bt(o,i,{get:()=>e[i],enumerable:!(n=fr(e,i))||n.enumerable});return o};var X=(o,e,t)=>(t=o!=null?dr(gr(o)):{},ai(e||!o||!o.__esModule?bt(t,"default",{value:o,enumerable:!0}):t,o)),Ar=o=>ai(bt({},"__esModule",{value:!0}),o);var So={};Pr(So,{LaunchpadPoolInitParam:()=>He,default:()=>Jt});module.exports=Ar(So);var yt=require("lodash");var rn=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:0,this.name=e.name}set level(e){this.logLevel=e}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let t=e.map(n=>typeof n=="object"?JSON.stringify(n):n).join(", ");throw new Error(t)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},ui={},Tr={};function ce(o){let e=(0,yt.get)(ui,o);if(!e){let t=(0,yt.get)(Tr,o);e=new rn({name:o,logLevel:t}),(0,yt.set)(ui,o,e)}return e}var z=require("@solana/web3.js"),Ci=X(require("axios"));var he=require("@solana/web3.js");var Si=require("@solana/web3.js");var we=X(require("bn.js")),Nr=X(require("decimal.js"));var pi=X(require("big.js")),xr=X(require("bn.js"));var ci=X(require("toformat")),kr=ci.default,gt=kr;var Pt=X(require("big.js")),mi=X(require("bn.js")),di=X(require("decimal.js-light"));var it=X(require("bn.js"));var li=9007199254740991;function Ce(o){let e=ce("Raydium_parseBigNumberish");if(o instanceof it.default)return o;if(typeof o=="string"){if(o.match(/^-?[0-9]+$/))return new it.default(o);e.logWithError(`invalid BigNumberish string: ${o}`)}return typeof o=="number"?(o%1&&e.logWithError(`BigNumberish number underflow: ${o}`),(o>=li||o<=-li)&&e.logWithError(`BigNumberish number overflow: ${o}`),new it.default(String(o))):typeof o=="bigint"?new it.default(o.toString()):(e.error(`invalid BigNumberish value: ${o}`),new it.default(0))}var vt=ce("module/fraction"),on=gt(Pt.default),At=gt(di.default),Br={[0]:At.ROUND_DOWN,[1]:At.ROUND_HALF_UP,[2]:At.ROUND_UP},hr={[0]:Pt.default.roundDown,[1]:Pt.default.roundHalfUp,[2]:Pt.default.roundUp},re=class{constructor(e,t=new mi.default(1)){this.numerator=Ce(e),this.denominator=Ce(t)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new re(this.denominator,this.numerator)}add(e){let t=e instanceof re?e:new re(Ce(e));return this.denominator.eq(t.denominator)?new re(this.numerator.add(t.numerator),this.denominator):new re(this.numerator.mul(t.denominator).add(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}sub(e){let t=e instanceof re?e:new re(Ce(e));return this.denominator.eq(t.denominator)?new re(this.numerator.sub(t.numerator),this.denominator):new re(this.numerator.mul(t.denominator).sub(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}mul(e){let t=e instanceof re?e:new re(Ce(e));return new re(this.numerator.mul(t.numerator),this.denominator.mul(t.denominator))}div(e){let t=e instanceof re?e:new re(Ce(e));return new re(this.numerator.mul(t.denominator),this.denominator.mul(t.numerator))}toSignificant(e,t={groupSeparator:""},n=1){Number.isInteger(e)||vt.logWithError(`${e} is not an integer.`),e<=0&&vt.logWithError(`${e} is not positive.`),At.set({precision:e+1,rounding:Br[n]});let i=new At(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return i.toFormat(i.decimalPlaces(),t)}toFixed(e,t={groupSeparator:""},n=1){return Number.isInteger(e)||vt.logWithError(`${e} is not an integer.`),e<0&&vt.logWithError(`${e} is negative.`),on.DP=e,on.RM=hr[n]||1,new on(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,t)}isZero(){return this.numerator.isZero()}};var jo=ce("Raydium_amount"),Zo=gt(pi.default);var fi=require("@solana/web3.js"),sn=require("@solana/spl-token"),an={chainId:101,address:fi.PublicKey.default.toBase58(),programId:sn.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},De={chainId:101,address:"So11111111111111111111111111111111111111112",programId:sn.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};var Dt=require("@solana/web3.js");var $=require("@solana/web3.js"),bi=require("@solana/spl-token");function un({pubkey:o,isSigner:e=!1,isWritable:t=!0}){return{pubkey:o,isWritable:t,isSigner:e}}var es=[un({pubkey:bi.TOKEN_PROGRAM_ID,isWritable:!1}),un({pubkey:$.SystemProgram.programId,isWritable:!1}),un({pubkey:$.SYSVAR_RENT_PUBKEY,isWritable:!1})];function yi({publicKey:o,transformSol:e}){let t=gi(o.toString());if(t instanceof $.PublicKey)return e&&t.equals(Tt)?Wt:t;if(e&&t.toString()===Tt.toBase58())return Wt;if(typeof t=="string"){if(t===$.PublicKey.default.toBase58())return $.PublicKey.default;try{return new $.PublicKey(t)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function gi(o){try{return new $.PublicKey(o)}catch{return o}}var Sr=new $.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),Kr=new $.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),cn=new $.PublicKey("SysvarRent111111111111111111111111111111111"),ts=new $.PublicKey("SysvarC1ock11111111111111111111111111111111"),rt=new $.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),ns=new $.PublicKey("Sysvar1nstructions1111111111111111111111111"),is=$.SystemProgram.programId,rs=new $.PublicKey("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),os=new $.PublicKey("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),ss=new $.PublicKey("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),as=new $.PublicKey("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),us=new $.PublicKey("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),cs=new $.PublicKey("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),ls=new $.PublicKey("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),ms=new $.PublicKey("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),ds=new $.PublicKey("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),ps=new $.PublicKey("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),fs=new $.PublicKey("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),Wt=new $.PublicKey("So11111111111111111111111111111111111111112"),Tt=$.PublicKey.default;var ln=class{constructor({mint:e,decimals:t,symbol:n,name:i,skipMint:r=!1,isToken2022:s=!1}){if(e===Tt.toBase58()||e instanceof Dt.PublicKey&&Tt.equals(e)){this.decimals=De.decimals,this.symbol=De.symbol,this.name=De.name,this.mint=new Dt.PublicKey(De.address),this.isToken2022=!1;return}this.decimals=t,this.symbol=n||e.toString().substring(0,6),this.name=i||e.toString().substring(0,6),this.mint=r?Dt.PublicKey.default:yi({publicKey:e}),this.isToken2022=s}equals(e){return this===e?!0:this.mint.equals(e.mint)}},Ve=ln;Ve.WSOL=new ln(Q(q({},De),{mint:De.address}));var mn=class{constructor({decimals:e,symbol:t="UNKNOWN",name:n="UNKNOWN"}){this.decimals=e,this.symbol=t,this.name=n}equals(e){return this===e}},Vt=mn;Vt.SOL=new mn(an);var Pi=X(require("bn.js"));var hs=new re(new Pi.default(100));var Ns=ce("Raydium_price");var Cr=new we.default(0),na=new we.default(1),ia=new we.default(2),ra=new we.default(3),oa=new we.default(5),Ir=new we.default(10),sa=new we.default(100),aa=new we.default(1e3),ua=new we.default(1e4);function Ai(o,e,t){return o.mul(e).add(t).sub(new we.default(1)).div(t)}function fn(o,e=1,t=[]){let n=[...o];if(e<=0)return t;for(;n.length;)t.push(n.splice(0,e));return t}var Ne=class{constructor(e){this._owner=e}get publicKey(){return Ne.isKeyPair(this._owner)?this._owner.publicKey:this._owner}get signer(){return Ne.isKeyPair(this._owner)?this._owner:void 0}get isKeyPair(){return Ne.isKeyPair(this._owner)}get isPublicKey(){return Ne.isPublicKey(this._owner)}static isKeyPair(e){return e.secretKey!==void 0}static isPublicKey(e){return!Ne.isKeyPair(e)}};var Bi=require("@solana/web3.js"),hi=require("@solana/spl-token");var le=require("@solana/web3.js");var Ye={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",ClmmLockPosition:"ClmmLockPosition",ClmmHarvestLockPosition:"ClmmHarvestLockPosition",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV4Withdraw:"FarmV4Withdraw",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut",CpmmLockLp:"CpmmLockLp",CpmmCollectLockFee:"CpmmCollectLockFee",TransferTip:"TransferTip"};var ki=require("@solana/spl-token"),Ti=ce("Raydium_txUtil"),wi=1644;function kt(o){let e=[],t=[];return o.microLamports&&(e.push(le.ComputeBudgetProgram.setComputeUnitPrice({microLamports:o.microLamports})),t.push(Ye.SetComputeUnitPrice)),o.units&&(e.push(le.ComputeBudgetProgram.setComputeUnitLimit({units:o.units})),t.push(Ye.SetComputeUnitLimit)),{instructions:e,instructionTypes:t}}async function je(o,e){var n,i;let t=e!=null?e:"confirmed";return(i=await((n=o.getLatestBlockhash)==null?void 0:n.call(o,{commitment:t})))==null?void 0:i.blockhash}async function wt(o,e){return o.getSignatureStatuses([e]),new Promise((t,n)=>{let i=setTimeout(n,6e4);o.onSignature(e,r=>{if(clearTimeout(i),!r.err){t("");return}n(Object.assign(r.err,{txId:e}))},"confirmed")})}function Rr(o,e){o.length<1&&Ti.logWithError(`no instructions provided: ${o.toString()}`),e.length<1&&Ti.logWithError(`no signers provided:, ${e.toString()}`);let t=new le.Transaction;t.recentBlockhash="11111111111111111111111111111111",t.feePayer=e[0],t.add(...o);try{return Buffer.from(t.serialize({verifySignatures:!1})).toString("base64").length<wi}catch{return!1}}function de(o,e){let[t,n]=le.PublicKey.findProgramAddressSync(o,e);return{publicKey:t,nonce:n}}function Bt({instructions:o,payer:e,signers:t}){return Rr(o,[e,...t])}function Fe({instructions:o,payer:e,lookupTableAddressAccount:t,recentBlockhash:n=le.Keypair.generate().publicKey.toString()}){let r=new le.TransactionMessage({payerKey:e,recentBlockhash:n,instructions:o}).compileToV0Message(Object.values(t!=null?t:{}));try{return Buffer.from(new le.VersionedTransaction(r).serialize()).toString("base64").length<wi}catch{return!1}}var Lr=o=>Buffer.isBuffer(o)?o:o instanceof Uint8Array?Buffer.from(o.buffer,o.byteOffset,o.byteLength):Buffer.from(o),Fr=o=>{let e=o.serialize({requireAllSignatures:!1,verifySignatures:!1});o instanceof le.VersionedTransaction&&(e=Lr(e));try{return e instanceof Buffer?e.toString("base64"):Buffer.from(e).toString("base64")}catch{return e.toString("base64")}};function _e(o){let e=[];return o.forEach(t=>{t instanceof le.Transaction&&(t.recentBlockhash||(t.recentBlockhash=ki.TOKEN_PROGRAM_ID.toBase58()),t.feePayer||(t.feePayer=le.Keypair.generate().publicKey)),e.push(Fr(t))}),console.log("simulate tx string:",e),e}function Be(o,e,t){return de([o.toBuffer(),(t!=null?t:hi.TOKEN_PROGRAM_ID).toBuffer(),e.toBuffer()],new Bi.PublicKey("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"))}var O=require("@solana/web3.js"),ha=new O.PublicKey("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),xa=new O.PublicKey("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),Ia=new O.PublicKey("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),Sa=new O.PublicKey("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),Ka=new O.PublicKey("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),Ca=new O.PublicKey("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),Na=new O.PublicKey("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),Ra=new O.PublicKey("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),La=new O.PublicKey("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),Fa=new O.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Mr=new O.PublicKey("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),Or=new O.PublicKey("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),Er=new O.PublicKey("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),Ma=new O.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Oa=new O.PublicKey("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),Ea=new O.PublicKey("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),va=new O.PublicKey("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),Wa=new O.PublicKey("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),Da=new O.PublicKey("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),Va=new O.PublicKey("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),_a=new O.PublicKey("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),qa=new O.PublicKey("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),Ga=new O.PublicKey("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),Ua=new O.PublicKey("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),Xa=new O.PublicKey("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),ae=new O.PublicKey("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),za=new O.PublicKey("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),Ha=new O.PublicKey("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),Ya=new O.PublicKey("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),ja=new O.PublicKey("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),Za=new O.PublicKey("6s1xP3hpbAfFoNtUNF8mfHsjr2Bd97JxFJRWLbL6aHuX");var Qa={OPEN_BOOK_PROGRAM:new O.PublicKey("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),SERUM_PROGRAM_ID_V3:new O.PublicKey("Ray1111111111111111111111111111111111111111"),AMM_V4:new O.PublicKey("DRaya7Kj3aMWQSy19kSjvmuwq9docCHofyP9kanQGaav"),AMM_STABLE:new O.PublicKey("DRayDdXc1NZQ9C3hRWmoSf8zK4iapgMnjdNZWrfwsP8m"),CLMM_PROGRAM_ID:new O.PublicKey("DRayAUgENGQBKVaX8owNhgzkEDyoHTGVEGHVJT1E9pfH"),CLMM_LOCK_PROGRAM_ID:new O.PublicKey("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),CLMM_LOCK_AUTH_ID:new O.PublicKey("6Aoh8h2Lw2m5UGxYR8AdAL87jTWYeKoxM52mJRzfYwN"),CREATE_CPMM_POOL_PROGRAM:new O.PublicKey("DRaycpLY18LhpbydsBWbVJtxpNv9oXPgjRSfpF2bWpYb"),CREATE_CPMM_POOL_AUTH:new O.PublicKey("CXniRufdq5xL8t8jZAPxsPZDpuudwuJSPWnbcD5Y5Nxq"),CREATE_CPMM_POOL_FEE_ACC:new O.PublicKey("3oE58BKVt8KuYkGxx8zBojugnymWmBiyafWgMrnb6eYy"),LOCK_CPMM_PROGRAM:new O.PublicKey("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),LOCK_CPMM_AUTH:new O.PublicKey("7qWVV8UY2bRJfDLP4s37YzBPKUkVB46DStYJBpYbQzu3"),UTIL1216:O.PublicKey.default,Router:new O.PublicKey("DRaybByLpbUL57LJARs3j8BitTxVfzBg351EaMr5UTCd"),FARM_PROGRAM_ID_V3:new O.PublicKey("DRayWyrLmEW5KEeqs8kdTMMaBabapqagaBC7KWpGtJeZ"),FARM_PROGRAM_ID_V4:new O.PublicKey("Ray1111111111111111111111111111111111111111"),FARM_PROGRAM_ID_V5:new O.PublicKey("DRayiCGSZgku1GTK6rXD6mVDdingXy6APAH1R6R5L2LC"),FARM_PROGRAM_ID_V6:new O.PublicKey("DRayzbYakXs45ELHkzH6vC3fuhQqTAnv5A68gdFuvZyZ"),LAUNCHPAD_PROGRAM:new O.PublicKey("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),LAUNCHPAD_AUTH:new O.PublicKey("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),LAUNCHPAD_PLATFORM:new O.PublicKey("2Jx4KTDrVSdWNazuGpcA8n3ZLTRGGBDxAWhuKe2Xcj2a"),LAUNCHPAD_CONFIG:new O.PublicKey("7ZR4zD7PYfY2XxoG1Gxcy2EgEeGYrpxrwzPuwdUBssEt"),FEE_DESTINATION_ID:new O.PublicKey("9y8ENuuZ3b19quffx9hQvRVygG5ky6snHfRvGpuSfeJy"),MODEL_DATA_PUBKEY:new O.PublicKey("Ray1111111111111111111111111111111111111111")};var ue=X(require("bn.js")),ht=1e4;function bn(o,e){let{div:t,mod:n}=o.divmod(e);return n.gt(new ue.default(0))?t.add(new ue.default(1)):t}function Ze(o,e){if(o.isZero())return new ue.default(0);let t=o.div(e);return t.isZero()?new ue.default(1):o.mod(e).gt(new ue.default(0))?t.add(new ue.default(1)):t}function yn(o,e,t){if(e===void 0)return{amount:o,fee:void 0,expirationTime:void 0};let n=Math.floor(t/432e3),i=n<e.newerTransferFee.epoch?e.olderTransferFee:e.newerTransferFee,r=new ue.default(i.maximumFee.toString()),s=n<e.newerTransferFee.epoch?(Number(e.newerTransferFee.epoch)*432e3-t)*400/1e3:void 0,a=bn(o.mul(new ue.default(i.transferFeeBasisPoints)),new ue.default(ht)),c=a.gt(r)?r:a;return{amount:o,fee:c,expirationTime:s}}function gn(o,e,t){if(e===void 0)return{amount:o,fee:void 0,expirationTime:void 0};let n=Math.floor(t/432e3),i=n<e.newerTransferFee.epoch?e.olderTransferFee:e.newerTransferFee,r=new ue.default(i.maximumFee.toString()),s=n<e.newerTransferFee.epoch?(Number(e.newerTransferFee.epoch)*432e3-t)*400/1e3:void 0;if(i.transferFeeBasisPoints===ht){let a=new ue.default(i.maximumFee.toString());return{amount:o.add(a),fee:a,expirationTime:s}}else{let a=bn(o.mul(new ue.default(ht)),new ue.default(ht-i.transferFeeBasisPoints)),c=new ue.default(i.maximumFee.toString()),u=a.sub(o).gt(c)?o.add(c):a,f=bn(u.mul(new ue.default(i.transferFeeBasisPoints)),new ue.default(ht)),l=f.gt(r)?r:f;return{amount:u,fee:l,expirationTime:s}}}var vr=require("@solana/web3.js"),Wr=X(require("bn.js"));var xi=X(require("bn.js")),Qe=new xi.default(1e6);var qt=require("@solana/spl-token"),Pn=ce("Raydium_accountInfo_util");async function xt(o,e,t){let{batchRequest:n,commitment:i="confirmed",chunkCount:r=100}=q({batchRequest:!1},t),s=fn(e,r),a=new Array(s.length).fill([]);if(n){let c=s.map(l=>{let T=o._buildArgs([l.map(A=>A.toBase58())],i,"base64");return{methodName:"getMultipleAccounts",args:T}}),u=fn(c,10);a=(await(await Promise.all(u.map(async l=>await o._rpcBatchRequest(l)))).flat()).map(l=>(l.error&&Pn.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${l.error.message}`),l.result.value.map(T=>{if(T){let{data:A,executable:m,lamports:g,owner:y,rentEpoch:h}=T;return A.length!==2&&A[1]!=="base64"&&Pn.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(A[0],"base64"),executable:m,lamports:g,owner:new Si.PublicKey(y),rentEpoch:h}}return null})))}else try{a=await Promise.all(s.map(c=>o.getMultipleAccountsInfo(c,i)))}catch(c){c instanceof Error&&Pn.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${c.message}`)}return a.flat()}async function Me(o,e,t){let n=await xt(o,e.map(i=>i.pubkey),t);return e.map((i,r)=>Q(q({},i),{accountInfo:n[r]}))}async function Gt({connection:o,address:e,cluster:t="mainnet"}){let n=await xt(o,[...new Set(e.map(r=>r.toString()))].map(r=>new he.PublicKey(r))),i={};for(let r=0;r<e.length;r++){let s=n[r],a=e[r];if(!s)continue;let c=new he.AddressLookupTableAccount({key:a,state:he.AddressLookupTableAccount.deserialize(s.data)});i[a.toString()]=c,t==="devnet"?ot[a.toString()]=c:qe[a.toString()]=c}return i}var qe={},An=async o=>{let e="AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU";if(qe[e])return qe;let t=new he.PublicKey(e),n=await o.getAccountInfo(t);return n&&(qe[e]=new he.AddressLookupTableAccount({key:t,state:he.AddressLookupTableAccount.deserialize(n.data)})),qe},ot={},Ut=async o=>{let e="EFhMuDw1PKEuckuFRW9PavNfTH4LKP5uKHgyXDmWpFCq";if(ot[e])return ot;let t=new he.PublicKey(e),n=await o.getAccountInfo(t);return n&&(ot[e]=new he.AddressLookupTableAccount({key:t,state:he.AddressLookupTableAccount.deserialize(n.data)})),ot};var It=2e3,St=class{constructor(e){this.instructions=[];this.endInstructions=[];this.lookupTableAddress=[];this.signers=[];this.instructionTypes=[];this.endInstructionTypes=[];this.connection=e.connection,this.feePayer=e.feePayer,this.signAllTransactions=e.signAllTransactions,this.owner=e.owner,this.cluster=e.cluster,this.blockhashCommitment=e.blockhashCommitment,this.loopMultiTxStatus=!!e.loopMultiTxStatus}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers,instructionTypes:this.instructionTypes,endInstructionTypes:this.endInstructionTypes,lookupTableAddress:this.lookupTableAddress}}get allInstructions(){return[...this.instructions,...this.endInstructions]}async getComputeBudgetConfig(){var n;let e=(await Ci.default.get(`https://solanacompass.com/api/fees?cacheFreshTime=${3e5}`)).data,{avg:t}=(n=e==null?void 0:e[15])!=null?n:{};if(!!t)return{units:6e5,microLamports:Math.min(Math.ceil(t*1e6/6e5),25e3)}}addCustomComputeBudget(e){if(e){let{instructions:t,instructionTypes:n}=kt(e);return this.instructions.unshift(...t),this.instructionTypes.unshift(...n),!0}return!1}addTipInstruction(e){var t;return e?(this.endInstructions.push(z.SystemProgram.transfer({fromPubkey:(t=e.feePayer)!=null?t:this.feePayer,toPubkey:new z.PublicKey(e.address),lamports:BigInt(e.amount.toString())})),this.endInstructionTypes.push(Ye.TransferTip),!0):!1}async calComputeBudget({config:e,defaultIns:t}){try{let n=e||await this.getComputeBudgetConfig();if(this.addCustomComputeBudget(n))return;t&&this.instructions.unshift(...t)}catch{t&&this.instructions.unshift(...t)}}addInstruction({instructions:e=[],endInstructions:t=[],signers:n=[],instructionTypes:i=[],endInstructionTypes:r=[],lookupTableAddress:s=[]}){return this.instructions.push(...e),this.endInstructions.push(...t),this.signers.push(...n),this.instructionTypes.push(...i),this.endInstructionTypes.push(...r),this.lookupTableAddress.push(...s.filter(a=>a!==z.PublicKey.default.toString())),this}async versionBuild({txVersion:e,extInfo:t}){return e===0?await this.buildV0(q({},t||{})):this.build(t)}build(e){var n;let t=new z.Transaction;return this.allInstructions.length&&t.add(...this.allInstructions),t.feePayer=this.feePayer,((n=this.owner)==null?void 0:n.signer)&&!this.signers.some(i=>i.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer),{builder:this,transaction:t,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async i=>{var f;let{recentBlockHash:r,skipPreflight:s=!0,sendAndConfirm:a,notSendToRpc:c}=i||{},u=r!=null?r:await je(this.connection,this.blockhashCommitment);if(t.recentBlockhash=u,this.signers.length&&t.sign(...this.signers),_e([t]),(f=this.owner)!=null&&f.isKeyPair)return{txId:a?await(0,z.sendAndConfirmTransaction)(this.connection,t,this.signers.find(T=>T.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:s}):await this.connection.sendRawTransaction(t.serialize(),{skipPreflight:s}),signedTx:t};if(this.signAllTransactions){let l=await this.signAllTransactions([t]);if(this.signers.length)for(let T of l)try{T.sign(...this.signers)}catch{}return{txId:c?"":await this.connection.sendRawTransaction(l[0].serialize(),{skipPreflight:s}),signedTx:l[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:e||{}}}buildMultiTx(e){var u;let{extraPreBuildData:t=[],extInfo:n}=e,{transaction:i}=this.build(n),r=t.filter(f=>f.transaction.instructions.length>0),s=[i,...r.map(f=>f.transaction)],a=[this.signers,...r.map(f=>f.signers)],c=[...this.instructionTypes,...r.map(f=>f.instructionTypes).flat()];return(u=this.owner)!=null&&u.signer&&a.forEach(f=>{f.some(l=>l.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),{builder:this,transactions:s,signers:a,instructionTypes:c,execute:async f=>{var h;let{sequentially:l,onTxUpdate:T,skipTxCount:A=0,recentBlockHash:m,skipPreflight:g=!0}=f||{},y=m!=null?m:await je(this.connection,this.blockhashCommitment);if((h=this.owner)!=null&&h.isKeyPair){if(l){let d=[],x=0;for(let k of s){if(++x,x<=A)continue;let p=await(0,z.sendAndConfirmTransaction)(this.connection,k,this.signers.find(P=>P.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:g});d.push(p)}return{txIds:d,signedTxs:s}}return{txIds:await await Promise.all(s.map(async d=>(d.recentBlockhash=y,await this.connection.sendRawTransaction(d.serialize(),{skipPreflight:g})))),signedTxs:s}}if(this.signAllTransactions){let d=s.map((k,p)=>(k.recentBlockhash=y,a[p].length&&k.sign(...a[p]),k));_e(d);let x=await this.signAllTransactions(d);if(l){let k=0,p=[],P=async()=>{if(!x[k])return;let I=await this.connection.sendRawTransaction(x[k].serialize(),{skipPreflight:g});p.push({txId:I,status:"sent",signedTx:x[k]}),T==null||T([...p]),k++;let w=!1,K=null,N=null,F=B=>{K!==null&&clearInterval(K),N!==null&&this.connection.removeSignatureListener(N);let M=p.findIndex(C=>C.txId===I);if(M>-1){if(p[M].status==="error"||p[M].status==="success")return;p[M].status=B.err?"error":"success"}T==null||T([...p]),B.err||P()};this.loopMultiTxStatus&&(K=setInterval(async()=>{var B;if(w){clearInterval(K);return}try{let M=await this.connection.getTransaction(I,{commitment:"confirmed",maxSupportedTransactionVersion:0});M&&(w=!0,clearInterval(K),F({err:((B=M.meta)==null?void 0:B.err)||null}),console.log("tx status from getTransaction:",I))}catch(M){w=!0,clearInterval(K),console.error("getTransaction timeout:",M,I)}},It)),N=this.connection.onSignature(I,B=>{if(w){this.connection.removeSignatureListener(N);return}w=!0,F(B)},"confirmed"),this.connection.getSignatureStatus(I)};return await P(),{txIds:p.map(I=>I.txId),signedTxs:x}}else{let k=[];for(let p=0;p<x.length;p+=1){let P=await this.connection.sendRawTransaction(x[p].serialize(),{skipPreflight:g});k.push(P)}return{txIds:k,signedTxs:x}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:n||{}}}async versionMultiBuild({extraPreBuildData:e,txVersion:t,extInfo:n}){return t===0?await this.buildV0MultiTx({extraPreBuildData:e,buildProps:n||{}}):this.buildMultiTx({extraPreBuildData:e,extInfo:n})}async buildV0(e){var g;let m=e||{},{lookupTableCache:t={},lookupTableAddress:n=[],forerunCreate:i,recentBlockhash:r}=m,s=We(m,["lookupTableCache","lookupTableAddress","forerunCreate","recentBlockhash"]),a=q(q({},this.cluster==="devnet"?await Ut(this.connection):await An(this.connection)),t),c=Array.from(new Set([...n,...this.lookupTableAddress])),u=[];for(let y of c)a[y]===void 0&&u.push(new z.PublicKey(y));let f=await Gt({connection:this.connection,address:u});for(let[y,h]of Object.entries(f))a[y]=h;let l=i?z.PublicKey.default.toBase58():r!=null?r:await je(this.connection,this.blockhashCommitment),T=new z.TransactionMessage({payerKey:this.feePayer,recentBlockhash:l,instructions:[...this.allInstructions]}).compileToV0Message(Object.values(a));((g=this.owner)==null?void 0:g.signer)&&!this.signers.some(y=>y.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer);let A=new z.VersionedTransaction(T);return A.sign(this.signers),{builder:this,transaction:A,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async y=>{var k;let{skipPreflight:h=!0,sendAndConfirm:d,notSendToRpc:x}=y||{};if(_e([A]),(k=this.owner)!=null&&k.isKeyPair){let p=await this.connection.sendTransaction(A,{skipPreflight:h});return d&&await wt(this.connection,p),{txId:p,signedTx:A}}if(this.signAllTransactions){let p=await this.signAllTransactions([A]);if(this.signers.length)for(let P of p)try{P.sign(this.signers)}catch{}return{txId:x?"":await this.connection.sendTransaction(p[0],{skipPreflight:h}),signedTx:p[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:s||{}}}async buildV0MultiTx(e){var u;let{extraPreBuildData:t=[],buildProps:n}=e,{transaction:i}=await this.buildV0(n),r=t.filter(f=>f.builder.instructions.length>0),s=[i,...r.map(f=>f.transaction)],a=[this.signers,...r.map(f=>f.signers)],c=[...this.instructionTypes,...r.map(f=>f.instructionTypes).flat()];return(u=this.owner)!=null&&u.signer&&a.forEach(f=>{f.some(l=>l.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),s.forEach(async(f,l)=>{f.sign(a[l])}),{builder:this,transactions:s,signers:a,instructionTypes:c,buildProps:n,execute:async f=>{var g;let{sequentially:l,onTxUpdate:T,recentBlockHash:A,skipPreflight:m=!0}=f||{};if(A&&s.forEach(y=>y.message.recentBlockhash=A),_e(s),(g=this.owner)!=null&&g.isKeyPair){if(l){let y=[];for(let h of s){let d=await this.connection.sendTransaction(h,{skipPreflight:m});await wt(this.connection,d),y.push(d)}return{txIds:y,signedTxs:s}}return{txIds:await Promise.all(s.map(async y=>await this.connection.sendTransaction(y,{skipPreflight:m}))),signedTxs:s}}if(this.signAllTransactions){let y=await this.signAllTransactions(s);if(l){let h=0,d=[],x=async()=>{if(!y[h])return;let k=await this.connection.sendTransaction(y[h],{skipPreflight:m});d.push({txId:k,status:"sent",signedTx:y[h]}),T==null||T([...d]),h++;let p=!1,P=null,I=null,w=K=>{P!==null&&clearInterval(P),I!==null&&this.connection.removeSignatureListener(I);let N=d.findIndex(F=>F.txId===k);if(N>-1){if(d[N].status==="error"||d[N].status==="success")return;d[N].status=K.err?"error":"success"}T==null||T([...d]),K.err||x()};this.loopMultiTxStatus&&(P=setInterval(async()=>{var K;if(p){clearInterval(P);return}try{let N=await this.connection.getTransaction(k,{commitment:"confirmed",maxSupportedTransactionVersion:0});N&&(p=!0,clearInterval(P),w({err:((K=N.meta)==null?void 0:K.err)||null}),console.log("tx status from getTransaction:",k))}catch(N){p=!0,clearInterval(P),console.error("getTransaction timeout:",N,k)}},It)),I=this.connection.onSignature(k,K=>{if(p){this.connection.removeSignatureListener(I);return}p=!0,w(K)},"confirmed"),this.connection.getSignatureStatus(k)};return x(),{txIds:[],signedTxs:y}}else{let h=[];for(let d=0;d<y.length;d+=1){let x=await this.connection.sendTransaction(y[d],{skipPreflight:m});h.push(x)}return{txIds:h,signedTxs:y}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:n||{}}}async sizeCheckBuild(e){var T;let l=e||{},{splitIns:t=[],computeBudgetConfig:n}=l,i=We(l,["splitIns","computeBudgetConfig"]),r=n?kt(n):{instructions:[],instructionTypes:[]},s=this.signers.reduce((A,m)=>Q(q({},A),{[m.publicKey.toBase58()]:m}),{}),a=[],c=[],u=[],f=0;if(this.allInstructions.forEach(A=>{let m=[...u,A],g=n?[...r.instructions,...m]:m,h=[...new Set(m.map(d=>d.keys.filter(x=>x.isSigner).map(x=>x.pubkey.toString())).flat()).values()].map(d=>new z.PublicKey(d));if(A!==t[f]&&u.length<12&&(Bt({instructions:g,payer:this.feePayer,signers:h})||Bt({instructions:m,payer:this.feePayer,signers:h})))u.push(A);else{if(u.length===0)throw Error("item ins too big");f+=A===t[f]?1:0,Bt({instructions:n?[...r.instructions,...u]:[...u],payer:this.feePayer,signers:h})?a.push(new z.Transaction().add(...r.instructions,...u)):a.push(new z.Transaction().add(...u)),c.push(Array.from(new Set(u.map(d=>d.keys.filter(x=>x.isSigner).map(x=>x.pubkey.toString())).flat())).map(d=>s[d]).filter(d=>d!==void 0)),u=[A]}}),u.length>0){let m=[...new Set(u.map(g=>g.keys.filter(y=>y.isSigner).map(y=>y.pubkey.toString())).flat()).values()].map(g=>s[g]).filter(g=>g!==void 0);Bt({instructions:n?[...r.instructions,...u]:[...u],payer:this.feePayer,signers:m.map(g=>g.publicKey)})?a.push(new z.Transaction().add(...r.instructions,...u)):a.push(new z.Transaction().add(...u)),c.push(m)}return a.forEach(A=>A.feePayer=this.feePayer),(T=this.owner)!=null&&T.signer&&c.forEach(A=>{A.some(m=>m.publicKey.equals(this.owner.publicKey))||A.push(this.owner.signer)}),{builder:this,transactions:a,signers:c,instructionTypes:this.instructionTypes,execute:async A=>{var k;let{sequentially:m,onTxUpdate:g,skipTxCount:y=0,recentBlockHash:h,skipPreflight:d=!0}=A||{},x=h!=null?h:await je(this.connection,this.blockhashCommitment);if(a.forEach(async(p,P)=>{p.recentBlockhash=x,c[P].length&&p.sign(...c[P])}),_e(a),(k=this.owner)!=null&&k.isKeyPair){if(m){let p=0,P=[];for(let I of a){if(++p,p<=y){P.push("tx skipped");continue}let w=await(0,z.sendAndConfirmTransaction)(this.connection,I,this.signers.find(K=>K.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:d});P.push(w)}return{txIds:P,signedTxs:a}}return{txIds:await Promise.all(a.map(async p=>await this.connection.sendRawTransaction(p.serialize(),{skipPreflight:d}))),signedTxs:a}}if(this.signAllTransactions){let p=await this.signAllTransactions(a.slice(y,a.length)),P=[...a.slice(0,y),...p];if(m){let I=0,w=[],K=async()=>{if(!P[I])return;I<y&&(w.push({txId:"",status:"success",signedTx:P[I]}),g==null||g([...w]),I++,K());let N=await this.connection.sendRawTransaction(P[I].serialize(),{skipPreflight:d});w.push({txId:N,status:"sent",signedTx:P[I]}),g==null||g([...w]),I++;let F=!1,B=null,M=null,C=R=>{B!==null&&clearInterval(B),M!==null&&this.connection.removeSignatureListener(M);let _=w.findIndex(U=>U.txId===N);if(_>-1){if(w[_].status==="error"||w[_].status==="success")return;w[_].status=R.err?"error":"success"}g==null||g([...w]),R.err||K()};this.loopMultiTxStatus&&(B=setInterval(async()=>{var R;if(F){clearInterval(B);return}try{let _=await this.connection.getTransaction(N,{commitment:"confirmed",maxSupportedTransactionVersion:0});_&&(F=!0,clearInterval(B),C({err:((R=_.meta)==null?void 0:R.err)||null}),console.log("tx status from getTransaction:",N))}catch(_){F=!0,clearInterval(B),console.error("getTransaction timeout:",_,N)}},It)),M=this.connection.onSignature(N,R=>{if(F){this.connection.removeSignatureListener(M);return}F=!0,C(R)},"confirmed"),this.connection.getSignatureStatus(N)};return await K(),{txIds:w.map(N=>N.txId),signedTxs:P}}else{let I=[];for(let w=0;w<P.length;w+=1){let K=await this.connection.sendRawTransaction(P[w].serialize(),{skipPreflight:d});I.push(K)}return{txIds:I,signedTxs:P}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:i||{}}}async sizeCheckBuildV0(e){var x;let d=e||{},{computeBudgetConfig:t,splitIns:n=[],lookupTableCache:i={},lookupTableAddress:r=[]}=d,s=We(d,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),a=q(q({},this.cluster==="devnet"?await Ut(this.connection):qe),i),c=Array.from(new Set([...this.lookupTableAddress,...r])),u=[];for(let k of c)a[k]===void 0&&u.push(new z.PublicKey(k));let f=await Gt({connection:this.connection,address:u});for(let[k,p]of Object.entries(f))a[k]=p;let l=t?kt(t):{instructions:[],instructionTypes:[]},T=await je(this.connection,this.blockhashCommitment),A=this.signers.reduce((k,p)=>Q(q({},k),{[p.publicKey.toBase58()]:p}),{}),m=[],g=[],y=[],h=0;if(this.allInstructions.forEach(k=>{let p=[...y,k],P=t?[...l.instructions,...p]:p;if(k!==n[h]&&y.length<12&&(Fe({instructions:P,payer:this.feePayer,lookupTableAddressAccount:a})||Fe({instructions:p,payer:this.feePayer,lookupTableAddressAccount:a})))y.push(k);else{if(y.length===0)throw Error("item ins too big");h+=k===n[h]?1:0;let I={};for(let w of[...new Set(c)])a[w]!==void 0&&(I[w]=a[w]);if(t&&Fe({instructions:[...l.instructions,...y],payer:this.feePayer,lookupTableAddressAccount:a,recentBlockhash:T})){let w=new z.TransactionMessage({payerKey:this.feePayer,recentBlockhash:T,instructions:[...l.instructions,...y]}).compileToV0Message(Object.values(a));m.push(new z.VersionedTransaction(w))}else{let w=new z.TransactionMessage({payerKey:this.feePayer,recentBlockhash:T,instructions:[...y]}).compileToV0Message(Object.values(a));m.push(new z.VersionedTransaction(w))}g.push(Array.from(new Set(y.map(w=>w.keys.filter(K=>K.isSigner).map(K=>K.pubkey.toString())).flat())).map(w=>A[w]).filter(w=>w!==void 0)),y=[k]}}),y.length>0){let p=[...new Set(y.map(P=>P.keys.filter(I=>I.isSigner).map(I=>I.pubkey.toString())).flat()).values()].map(P=>A[P]).filter(P=>P!==void 0);if(t&&Fe({instructions:[...l.instructions,...y],payer:this.feePayer,lookupTableAddressAccount:a,recentBlockhash:T})){let P=new z.TransactionMessage({payerKey:this.feePayer,recentBlockhash:T,instructions:[...l.instructions,...y]}).compileToV0Message(Object.values(a));m.push(new z.VersionedTransaction(P))}else{let P=new z.TransactionMessage({payerKey:this.feePayer,recentBlockhash:T,instructions:[...y]}).compileToV0Message(Object.values(a));m.push(new z.VersionedTransaction(P))}g.push(p)}return(x=this.owner)!=null&&x.signer&&g.forEach(k=>{k.some(p=>p.publicKey.equals(this.owner.publicKey))||k.push(this.owner.signer)}),m.forEach((k,p)=>{k.sign(g[p])}),{builder:this,transactions:m,buildProps:e,signers:g,blockHash:T,instructionTypes:this.instructionTypes,execute:async k=>{var N;let{sequentially:p,onTxUpdate:P,skipTxCount:I=0,recentBlockHash:w,skipPreflight:K=!0}=k||{};if(m.map(async(F,B)=>{g[B].length&&F.sign(g[B]),w&&(F.message.recentBlockhash=w)}),_e(m),(N=this.owner)!=null&&N.isKeyPair){if(p){let F=0,B=[];for(let M of m){if(++F,F<=I){console.log("skip tx: ",F),B.push("tx skipped");continue}let C=await this.connection.sendTransaction(M,{skipPreflight:K});await wt(this.connection,C),B.push(C)}return{txIds:B,signedTxs:m}}return{txIds:await Promise.all(m.map(async F=>await this.connection.sendTransaction(F,{skipPreflight:K}))),signedTxs:m}}if(this.signAllTransactions){let F=await this.signAllTransactions(m.slice(I,m.length)),B=[...m.slice(0,I),...F];if(p){let M=0,C=[],R=async()=>{if(!B[M])return;if(M<I){C.push({txId:"",status:"success",signedTx:B[M]}),P==null||P([...C]),M++,R();return}let _=await this.connection.sendTransaction(B[M],{skipPreflight:K});C.push({txId:_,status:"sent",signedTx:B[M]}),P==null||P([...C]),M++;let U=!1,Y=null,H=null,ee=te=>{Y!==null&&clearInterval(Y),H!==null&&this.connection.removeSignatureListener(H);let Z=C.findIndex(se=>se.txId===_);if(Z>-1){if(C[Z].status==="error"||C[Z].status==="success")return;C[Z].status=te.err?"error":"success"}P==null||P([...C]),te.err||R()};this.loopMultiTxStatus&&(Y=setInterval(async()=>{var te;if(U){clearInterval(Y);return}try{let Z=await this.connection.getTransaction(_,{commitment:"confirmed",maxSupportedTransactionVersion:0});Z&&(U=!0,clearInterval(Y),ee({err:((te=Z.meta)==null?void 0:te.err)||null}),console.log("tx status from getTransaction:",_))}catch(Z){U=!0,clearInterval(Y),console.error("getTransaction timeout:",Z,_)}},It)),H=this.connection.onSignature(_,te=>{if(U){this.connection.removeSignatureListener(H);return}U=!0,ee(te)},"confirmed"),this.connection.getSignatureStatus(_)};return R(),{txIds:[],signedTxs:B}}else{let M=[];for(let C=0;C<B.length;C+=1){let R=await this.connection.sendTransaction(B[C],{skipPreflight:K});M.push(R)}return{txIds:M,signedTxs:B}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:s||{}}}async buildSniperTransaction(e){var x;let d=e||{},{computeBudgetConfig:t,splitIns:n=[],lookupTableCache:i={},lookupTableAddress:r=[]}=d,s=We(d,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),a=q(q({},this.cluster==="devnet"?await Ut(this.connection):await An(this.connection)),i),c=Array.from(new Set([...this.lookupTableAddress,...r])),u=[];for(let k of c)a[k]===void 0&&u.push(new z.PublicKey(k));let f=await Gt({connection:this.connection,address:u});for(let[k,p]of Object.entries(f))a[k]=p;let l=t?kt(t):{instructions:[],instructionTypes:[]},T=await je(this.connection,this.blockhashCommitment),A=this.signers.reduce((k,p)=>Q(q({},k),{[p.publicKey.toBase58()]:p}),{}),m=[],g=[],y=[],h=0;if(this.allInstructions.forEach(k=>{let p=[...y,k],P=t?[...l.instructions,...p]:p;if(k!==n[h]&&y.length<12&&(Fe({instructions:P,payer:this.feePayer,lookupTableAddressAccount:a})||Fe({instructions:p,payer:this.feePayer,lookupTableAddressAccount:a})))y.push(k);else{if(y.length===0)throw Error("item ins too big");h+=k===n[h]?1:0;let I={};for(let w of[...new Set(c)])a[w]!==void 0&&(I[w]=a[w]);if(t&&Fe({instructions:[...l.instructions,...y],payer:this.feePayer,lookupTableAddressAccount:a,recentBlockhash:T})){let w=new z.TransactionMessage({payerKey:this.feePayer,recentBlockhash:T,instructions:[...l.instructions,...y]}).compileToV0Message(Object.values(a));m.push(new z.VersionedTransaction(w))}else{let w=new z.TransactionMessage({payerKey:this.feePayer,recentBlockhash:T,instructions:[...y]}).compileToV0Message(Object.values(a));m.push(new z.VersionedTransaction(w))}g.push(Array.from(new Set(y.map(w=>w.keys.filter(K=>K.isSigner).map(K=>K.pubkey.toString())).flat())).map(w=>A[w]).filter(w=>w!==void 0)),y=[k]}}),y.length>0){let p=[...new Set(y.map(P=>P.keys.filter(I=>I.isSigner).map(I=>I.pubkey.toString())).flat()).values()].map(P=>A[P]).filter(P=>P!==void 0);if(t&&Fe({instructions:[...l.instructions,...y],payer:this.feePayer,lookupTableAddressAccount:a,recentBlockhash:T})){let P=new z.TransactionMessage({payerKey:this.feePayer,recentBlockhash:T,instructions:[...l.instructions,...y]}).compileToV0Message(Object.values(a));m.push(new z.VersionedTransaction(P))}else{let P=new z.TransactionMessage({payerKey:this.feePayer,recentBlockhash:T,instructions:[...y]}).compileToV0Message(Object.values(a));m.push(new z.VersionedTransaction(P))}g.push(p)}return(x=this.owner)!=null&&x.signer&&g.forEach(k=>{k.some(p=>p.publicKey.equals(this.owner.publicKey))||k.push(this.owner.signer)}),m.forEach((k,p)=>{k.sign(g[p])}),{builder:this,transactions:m,buildProps:e,signers:g,instructionTypes:this.instructionTypes,execute:async k=>{var N;let{sequentially:p,onTxUpdate:P,skipTxCount:I=0,recentBlockHash:w,skipPreflight:K=!0}=k||{};if(m.map(async(F,B)=>{g[B].length&&F.sign(g[B]),w&&(F.message.recentBlockhash=w)}),_e(m),(N=this.owner)!=null&&N.isKeyPair){if(p){let F=0,B=[];for(let M of m){if(++F,F<=I){console.log("skip tx: ",F),B.push("tx skipped");continue}let C=await this.connection.sendTransaction(M,{skipPreflight:K});await wt(this.connection,C),B.push(C)}return{txIds:B,signedTxs:m}}return{txIds:await Promise.all(m.map(async F=>await this.connection.sendTransaction(F,{skipPreflight:K}))),signedTxs:m}}if(this.signAllTransactions){let F=await this.signAllTransactions(m.slice(I,m.length)),B=[...m.slice(0,I),...F];if(p){let M=0,C=[],R=async()=>{if(!B[M])return;if(M<I){C.push({txId:"",status:"success",signedTx:B[M]}),P==null||P([...C]),M++,R();return}let _=await this.connection.sendTransaction(B[M],{skipPreflight:K});C.push({txId:_,status:"sent",signedTx:B[M]}),P==null||P([...C]),M++;let U=!1,Y=null,H=null,ee=te=>{Y!==null&&clearInterval(Y),H!==null&&this.connection.removeSignatureListener(H);let Z=C.findIndex(se=>se.txId===_);if(Z>-1){if(C[Z].status==="error"||C[Z].status==="success")return;C[Z].status=te.err?"error":"success"}P==null||P([...C]),te.err||R()};this.loopMultiTxStatus&&(Y=setInterval(async()=>{var te;if(U){clearInterval(Y);return}try{let Z=await this.connection.getTransaction(_,{commitment:"confirmed",maxSupportedTransactionVersion:0});Z&&(U=!0,clearInterval(Y),ee({err:((te=Z.meta)==null?void 0:te.err)||null}),console.log("tx status from getTransaction:",_))}catch(Z){U=!0,clearInterval(Y),console.error("getTransaction timeout:",Z,_)}},It)),H=this.connection.onSignature(_,te=>{if(U){this.connection.removeSignatureListener(H);return}U=!0,ee(te)},"confirmed"),this.connection.getSignatureStatus(_)};return R(),{txIds:[],signedTxs:B}}else{let M=[];for(let C=0;C<B.length;C+=1){let R=await this.connection.sendTransaction(B[C],{skipPreflight:K});M.push(R)}return{txIds:M,signedTxs:B}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:s||{}}}};var Tn=(...o)=>o.map(e=>{try{return typeof e=="object"?JSON.stringify(e):e}catch{return e}}).join(", "),st=class{constructor({scope:e,moduleName:t}){this.disabled=!1;this.scope=e,this.logger=ce(t)}createTxBuilder(e){return this.scope.checkOwner(),new St({connection:this.scope.connection,feePayer:e||this.scope.ownerPubKey,cluster:this.scope.cluster,owner:this.scope.owner,blockhashCommitment:this.scope.blockhashCommitment,loopMultiTxStatus:this.scope.loopMultiTxStatus,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}createSniperTxBuilder(e,t){let n=new Ne(e);return new St({connection:this.scope.connection,feePayer:t,cluster:this.scope.cluster,owner:n,blockhashCommitment:this.scope.blockhashCommitment,loopMultiTxStatus:this.scope.loopMultiTxStatus,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}logDebug(...e){this.logger.debug(Tn(e))}logInfo(...e){this.logger.info(Tn(e))}logAndCreateError(...e){let t=Tn(e);throw new Error(t)}checkDisabled(){(this.disabled||!this.scope)&&this.logAndCreateError("module not working")}};var go=require("@solana/web3.js"),Po=X(require("bn.js")),Ao=X(require("decimal.js"));var Ht=require("@solana/spl-token");var Dr=require("@solana/web3.js"),Ni=require("@solana/spl-token");var zt=require("@solana/web3.js"),yo=X(require("bn.js"));var On=require("@solana/spl-token");var Mi=require("@solana/web3.js"),at=X(require("bn.js"));var E=require("@solana/buffer-layout"),kn=E.Layout,Ri=E.Structure;var wn=E.UInt;var Li=E.u8,Oe=E.u16;var Bn=E.u32;var Ee=E.s32;var Fi=E.seq;var fe=E.blob;var hn=E.offset;var ut=class extends kn{constructor(t,n,i){super(t,i);this.blob=fe(t),this.signed=n}decode(t,n=0){let i=new at.default(this.blob.decode(t,n),10,"le");return this.signed?i.fromTwos(this.span*8).clone():i}encode(t,n,i=0){return typeof t=="number"&&(t=new at.default(t)),this.signed&&(t=t.toTwos(this.span*8)),this.blob.encode(t.toArrayLike(Buffer,"le",this.span),n,i)}};function W(o){return new wn(1,o)}function ct(o){return new wn(4,o)}function b(o){return new ut(8,!1,o)}function oe(o){return new ut(16,!1,o)}function Oi(o){return new ut(8,!0,o)}function Ei(o){return new ut(16,!0,o)}var Je=class extends kn{constructor(t,n,i,r){super(t.span,r);this.layout=t,this.decoder=n,this.encoder=i}decode(t,n){return this.decoder(this.layout.decode(t,n))}encode(t,n,i){return this.layout.encode(this.encoder(t),n,i)}getSpan(t,n){return this.layout.getSpan(t,n)}};function v(o){return new Je(fe(32),e=>new Mi.PublicKey(e),e=>e.toBuffer(),o)}function In(o){return new Je(Li(),Vr,_r,o)}function Vr(o){if(o===0)return!1;if(o===1)return!0;throw new Error("Invalid bool: "+o)}function _r(o){return o?1:0}function vi(o,e){let t=Bn("length"),n=V([t,j(o,hn(t,-t.span),"values")]);return new Je(n,({values:i})=>i,i=>({values:i}),e)}function qr(o){let e=Bn("length"),t=V([e,fe(hn(e,-e.span),"data")]);return new Je(t,({data:n})=>n,n=>({data:n}),o)}function be(o){return new Je(qr(),e=>e.toString("utf-8"),e=>Buffer.from(e,"utf-8"),o)}var xn=class extends Ri{decode(e,t){return super.decode(e,t)}};function V(o,e,t){return new xn(o,e,t)}function j(o,e,t){let n,i=typeof e=="number"?e:(0,at.isBN)(e)?e.toNumber():new Proxy(e,{get(r,s){if(!n){let a=Reflect.get(r,"count");n=(0,at.isBN)(a)?a.toNumber():a,Reflect.set(r,"count",n)}return Reflect.get(r,s)},set(r,s,a){return s==="count"&&(n=a),Reflect.set(r,s,a)}});return Fi(o,i,t)}var io=X(require("bn.js")),ro=X(require("decimal.js"));var ge=X(require("bn.js")),Sn=new ge.default(0),Wi=new ge.default(1),Di=new ge.default(-1),Re=new ge.default(1).shln(64),Vi=new ge.default(1).shln(128),Kn=Re.sub(Wi);var Gr=Vi.subn(1),lt=-443636,Kt=-lt,Cn=new ge.default("4295048016"),Nn=new ge.default("79226673521066979257578248091"),lc=new ge.default("4295048017"),mc=new ge.default("79226673521066979257578248090");var Ur=new ge.default(10).pow(new ge.default(6));var dc=new ge.default("18446744073700000000");var to=X(require("bn.js")),no=X(require("decimal.js"));var Pc=Buffer.from("amm_config","utf8"),_i=Buffer.from("pool","utf8"),qi=Buffer.from("pool_vault","utf8"),Ac=Buffer.from("pool_reward_vault","utf8"),Tc=Buffer.from("position","utf8"),kc=Buffer.from("tick_array","utf8"),wc=Buffer.from("operation","utf8"),Bc=Buffer.from("pool_tick_array_bitmap_extension","utf8"),hc=Buffer.from("observation","utf8");function Rn(o){return de([Buffer.from("metadata","utf8"),rt.toBuffer(),o.toBuffer()],rt)}var xc=Buffer.from("locked_position","utf8");var Ic=Buffer.from("support_mint","utf8");var Zr=require("@solana/web3.js"),Qr=require("@solana/spl-token"),Jr=X(require("bn.js")),$r=X(require("decimal.js"));var zr=X(require("bn.js")),Hr=X(require("decimal.js"));var Mn=14;var Xt=60;var oo=V([fe(8),W("bump"),Oe("index"),v(""),ct("protocolFeeRate"),ct("tradeFeeRate"),Oe("tickSpacing"),j(b(),8,"")]),so=V([ct("blockTimestamp"),Oi("tickCumulative"),j(b(),4)]),Ji=V([fe(8),In("initialized"),b("recentEpoch"),Oe("observationIndex"),v("poolId"),j(so,100,"observations"),j(b(),4)]),ao=V([W("rewardState"),b("openTime"),b("endTime"),b("lastUpdateTime"),oe("emissionsPerSecondX64"),b("rewardTotalEmissioned"),b("rewardClaimed"),v("tokenMint"),v("tokenVault"),v("creator"),oe("rewardGrowthGlobalX64")]),ji=V([fe(8),W("bump"),v("ammConfig"),v("creator"),v("mintA"),v("mintB"),v("vaultA"),v("vaultB"),v("observationId"),W("mintDecimalsA"),W("mintDecimalsB"),Oe("tickSpacing"),oe("liquidity"),oe("sqrtPriceX64"),Ee("tickCurrent"),ct(),oe("feeGrowthGlobalX64A"),oe("feeGrowthGlobalX64B"),b("protocolFeesTokenA"),b("protocolFeesTokenB"),oe("swapInAmountTokenA"),oe("swapOutAmountTokenB"),oe("swapInAmountTokenB"),oe("swapOutAmountTokenA"),W("status"),j(W(),7,""),j(ao,3,"rewardInfos"),j(b(),16,"tickArrayBitmap"),b("totalFeesTokenA"),b("totalFeesClaimedTokenA"),b("totalFeesTokenB"),b("totalFeesClaimedTokenB"),b("fundFeesTokenA"),b("fundFeesTokenB"),b("startTime"),j(b(),15*4-3,"padding")]),uo=V([oe("growthInsideLastX64"),b("rewardAmountOwed")]),Zi=V([fe(8),W("bump"),v("nftMint"),v("poolId"),Ee("tickLower"),Ee("tickUpper"),oe("liquidity"),oe("feeGrowthInsideLastX64A"),oe("feeGrowthInsideLastX64B"),b("tokenFeesOwedA"),b("tokenFeesOwedB"),j(uo,3,"rewardInfos"),j(b(),8,"")]),Vl=V([fe(8),W("bump"),v("poolId"),Ee("tickLowerIndex"),Ee("tickUpperIndex"),oe("liquidity"),oe("feeGrowthInsideLastX64A"),oe("feeGrowthInsideLastX64B"),b("tokenFeesOwedA"),b("tokenFeesOwedB"),j(oe(),3,"rewardGrowthInside"),j(b(),8,"")]),co=V([Ee("tick"),Ei("liquidityNet"),oe("liquidityGross"),oe("feeGrowthOutsideX64A"),oe("feeGrowthOutsideX64B"),j(oe(),3,"rewardGrowthsOutsideX64"),j(ct(),13,"")]),zi=V([fe(8),v("poolId"),Ee("startTickIndex"),j(co,Xt,"ticks"),W("initializedTickCount"),j(W(),115,"")]),lo=V([fe(329),j(v(),100,"whitelistMints")]),eo=V([fe(8),v("poolId"),j(j(b(),8),Mn,"positiveTickArrayBitmap"),j(j(b(),8),Mn,"negativeTickArrayBitmap")]),_l=V([b(),W("bump"),v("owner"),v("poolId"),v("positionId"),v("nftAccount"),j(b(),8)]),mo=V([fe(8),W("bump"),v("lockOwner"),v("poolId"),v("positionId"),v("nftAccount"),v("lockNftMint"),b("recentEpoch"),j(b(),8)]);Ji.span;var om=ce("Raydium_Clmm");var To=Buffer.from("vault_auth_seed","utf8"),$m=Buffer.from("global_config","utf8"),ko=Buffer.from("pool_vesting","utf8"),wo=Buffer.from("platform_config","utf8"),Bo=Buffer.from("platform_fee_vault_auth_seed","utf8"),ho=Buffer.from("creator_fee_vault_auth_seed","utf8");function Le(o){return de([To],o)}function mt(o,e,t){return de([_i,e.toBuffer(),t.toBuffer()],o)}function En(o,e,t){return de([qi,e.toBuffer(),t.toBuffer()],o)}function $e(o){return de([Buffer.from("__event_authority","utf8")],o)}function vn(o,e){return de([wo,e.toBuffer()],o)}function Rt(o,e,t){return de([ko,e.toBuffer(),t.toBuffer()],o)}function et(o,e,t){return de([e.toBuffer(),t.toBuffer()],o)}function Wn(o){return de([Bo],o)}function tt(o,e,t){return de([e.toBuffer(),t.toBuffer()],o)}function Dn(o){return de([ho],o)}var Ie=require("@solana/spl-token"),ne=require("@solana/web3.js"),nt=X(require("bn.js"));var Ge=V([b(),b("epoch"),W("curveType"),Oe("index"),b("migrateFee"),b("tradeFeeRate"),b("maxShareFeeRate"),b("minSupplyA"),b("maxLockRate"),b("minSellRateA"),b("minMigrateRateA"),b("minFundRaisingB"),v("mintB"),v("protocolFeeOwner"),v("migrateFeeOwner"),v("migrateToAmmWallet"),v("migrateToCpmmWallet"),j(b(),16)]),xo=V([b("totalLockedAmount"),b("cliffPeriod"),b("unlockPeriod"),b("startTime"),b("totalAllocatedShare")]),xe=V([b(),b("epoch"),W("bump"),W("status"),W("mintDecimalsA"),W("mintDecimalsB"),W("migrateType"),b("supply"),b("totalSellA"),b("virtualA"),b("virtualB"),b("realA"),b("realB"),b("totalFundRaisingB"),b("protocolFee"),b("platformFee"),b("migrateFee"),xo.replicate("vestingSchedule"),v("configId"),v("platformId"),v("mintA"),v("mintB"),v("vaultA"),v("vaultB"),v("creator"),W("mintProgramFlag"),W("cpmmCreatorFeeOn"),j(W(),62)]),nd=V([b(),b("epoch"),v("poolId"),v("beneficiary"),b("claimedAmount"),b("tokenShareAmount"),j(b(),8)]),$i=V([W("migrateType"),W("migrateCpmmFeeOn"),b("supply"),b("totalSellA"),b("totalFundRaisingB"),b("totalLockedAmount"),b("cliffPeriod"),b("unlockPeriod")]),Io=V([b("epoch"),W("index"),v("configId"),$i.replicate("bondingCurveParam"),j(b(),50)]),dt=V([b(),b("epoch"),v("platformClaimFeeWallet"),v("platformLockNftWallet"),b("platformScale"),b("creatorScale"),b("burnScale"),b("feeRate"),j(W(),64,"name"),j(W(),256,"web"),j(W(),256,"img"),v("cpConfigId"),b("creatorFeeRate"),v("transferFeeExtensionAuth"),j(W(),180),vi(Io,"platformCurve")]);var Pe={initialize:Buffer.from([175,175,109,31,13,152,155,237]),initializeV2:Buffer.from([67,153,175,39,218,16,38,32]),buyExactIn:Buffer.from([250,234,13,123,213,156,19,236]),buyExactOut:Buffer.from([24,211,116,40,105,3,153,56]),sellExactIn:Buffer.from([149,39,222,155,211,124,152,26]),sellExactOut:Buffer.from([95,200,71,34,8,9,11,166]),createVestingAccount:Buffer.from([129,178,2,13,217,172,230,218]),claimVestedToken:Buffer.from([49,33,104,30,189,157,79,35]),createPlatformConfig:Buffer.from([176,90,196,175,253,113,220,20]),claimPlatformFee:Buffer.from([156,39,208,135,76,237,61,72]),updatePlaformConfig:Buffer.from([195,60,76,129,146,45,67,143]),initializeWithToken2022:Buffer.from([37,190,126,222,44,154,171,17]),claimPlatformFeeFromVault:Buffer.from([117,241,198,168,248,218,80,29]),claimCreatorFee:Buffer.from([26,97,138,203,132,171,141,252]),updatePlatformCurveParam:Buffer.from([138,144,138,250,220,128,4,57]),removePlatformCurveParam:Buffer.from([27,30,62,169,93,224,24,145])};function er(o,e,t,n,i,r,s,a,c,u,f,l,T,A,m,g,y,h,d,x,k){let p=V([W("decimals"),be("name"),be("symbol"),be("uri")]),P=V([b("totalLockedAmount"),b("cliffPeriod"),b("unlockPeriod"),W("cpmmCreatorFeeOn")]),I=V([W("index"),b("supply"),b("totalFundRaisingB"),W("migrateType")]),w=V([W("index"),b("supply"),b("totalSellA"),b("totalFundRaisingB"),W("migrateType")]),K=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!0,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!1},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:Ie.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:Ie.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:rt,isSigner:!1,isWritable:!1},{pubkey:ne.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:cn,isSigner:!1,isWritable:!1},{pubkey:$e(o).publicKey,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1}],N=Buffer.alloc(Buffer.from(A,"utf-8").length+Buffer.from(m,"utf-8").length+Buffer.from(g,"utf-8").length+4*3+1),F=Buffer.alloc(P.span),B=Buffer.alloc(y.type==="ConstantCurve"?w.span:I.span);return p.encode({decimals:T,name:A,symbol:m,uri:g},N),y.type==="ConstantCurve"?w.encode(Q(q({index:0},y),{migrateType:y.migrateType==="amm"?0:1}),B):y.type==="FixedCurve"?I.encode(Q(q({index:1},y),{migrateType:y.migrateType==="amm"?0:1}),B):y.type==="LinearCurve"&&I.encode(Q(q({index:2},y),{migrateType:y.migrateType==="amm"?0:1}),B),P.encode({totalLockedAmount:h,cliffPeriod:d,unlockPeriod:x,cpmmCreatorFeeOn:k},F),new ne.TransactionInstruction({keys:K,programId:o,data:Buffer.from([...Pe.initializeV2,...N,...B,...F])})}function tr(o,e,t,n,i,r,s,a,c,u,f,l,T,A,m,g,y,h,d,x,k){let p=V([W("decimals"),be("name"),be("symbol"),be("uri")]),P=V([b("totalLockedAmount"),b("cliffPeriod"),b("unlockPeriod"),W("cpmmCreatorFeeOn"),W("transferFeeExtensionParamsOption"),V([Oe("transferFeeBasePoints"),b("maxinumFee")]).replicate("transferFeeExtensionParams")]),I=V([W("index"),b("supply"),b("totalFundRaisingB"),W("migrateType")]),w=V([W("index"),b("supply"),b("totalSellA"),b("totalFundRaisingB"),W("migrateType")]),K=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!0,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!1},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:Ie.TOKEN_2022_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:Ie.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:ne.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:$e(o).publicKey,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1}],N=Buffer.alloc(Buffer.from(T,"utf-8").length+Buffer.from(A,"utf-8").length+Buffer.from(m,"utf-8").length+4*3+1),F=Buffer.alloc(P.span),B=Buffer.alloc(g.type==="ConstantCurve"?w.span:I.span);return p.encode({decimals:l,name:T,symbol:A,uri:m},N),g.type==="ConstantCurve"?w.encode(Q(q({index:0},g),{migrateType:g.migrateType==="amm"?0:1}),B):g.type==="FixedCurve"?I.encode(Q(q({index:1},g),{migrateType:g.migrateType==="amm"?0:1}),B):g.type==="LinearCurve"&&I.encode(Q(q({index:2},g),{migrateType:g.migrateType==="amm"?0:1}),B),P.encode({totalLockedAmount:y,cliffPeriod:h,unlockPeriod:d,cpmmCreatorFeeOn:x,transferFeeExtensionParamsOption:k?1:0,transferFeeExtensionParams:k!=null?k:{transferFeeBasePoints:0,maxinumFee:new nt.default(0)}},F),new ne.TransactionInstruction({keys:K,programId:o,data:Buffer.from([...Pe.initializeWithToken2022,...N,...B,...F])})}function nr(o,e,t,n,i,r,s,a,c,u,f,l,T,A,m,g,y,h,d,x){let k=V([b("amountB"),b("minAmountA"),b("shareFeeRate")]),p=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:T,isSigner:!1,isWritable:!1},{pubkey:A,isSigner:!1,isWritable:!1},{pubkey:$e(o).publicKey,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1}];x&&p.push({pubkey:x,isSigner:!1,isWritable:!0}),p.push({pubkey:ne.SystemProgram.programId,isSigner:!1,isWritable:!1}),p.push({pubkey:m,isSigner:!1,isWritable:!0}),p.push({pubkey:g,isSigner:!1,isWritable:!0});let P=Buffer.alloc(k.span);return k.encode({amountB:y,minAmountA:h,shareFeeRate:d!=null?d:new nt.default(0)},P),new ne.TransactionInstruction({keys:p,programId:o,data:Buffer.from([...Pe.buyExactIn,...P])})}function ir(o,e,t,n,i,r,s,a,c,u,f,l,T,A,m,g,y,h,d,x){let k=V([b("amountA"),b("maxAmountB"),b("shareFeeRate")]),p=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:T,isSigner:!1,isWritable:!1},{pubkey:A,isSigner:!1,isWritable:!1},{pubkey:$e(o).publicKey,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1}];x&&p.push({pubkey:x,isSigner:!1,isWritable:!0}),p.push({pubkey:ne.SystemProgram.programId,isSigner:!1,isWritable:!1}),p.push({pubkey:m,isSigner:!1,isWritable:!0}),p.push({pubkey:g,isSigner:!1,isWritable:!0});let P=Buffer.alloc(k.span);return k.encode({amountA:y,maxAmountB:h,shareFeeRate:d!=null?d:new nt.default(0)},P),new ne.TransactionInstruction({keys:p,programId:o,data:Buffer.from([...Pe.buyExactOut,...P])})}function rr(o,e,t,n,i,r,s,a,c,u,f,l,T,A,m,g,y,h,d,x){let k=V([b("amountA"),b("minAmountB"),b("shareFeeRate")]),p=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:T,isSigner:!1,isWritable:!1},{pubkey:A,isSigner:!1,isWritable:!1},{pubkey:$e(o).publicKey,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1}];x&&p.push({pubkey:x,isSigner:!1,isWritable:!0}),p.push({pubkey:ne.SystemProgram.programId,isSigner:!1,isWritable:!1}),p.push({pubkey:m,isSigner:!1,isWritable:!0}),p.push({pubkey:g,isSigner:!1,isWritable:!0});let P=Buffer.alloc(k.span);return k.encode({amountA:y,minAmountB:h,shareFeeRate:d!=null?d:new nt.default(0)},P),new ne.TransactionInstruction({keys:p,programId:o,data:Buffer.from([...Pe.sellExactIn,...P])})}function or(o,e,t,n,i,r,s,a,c,u,f,l,T,A,m,g,y,h,d,x){let k=V([b("amountB"),b("maxAmountA"),b("shareFeeRate")]),p=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:T,isSigner:!1,isWritable:!1},{pubkey:A,isSigner:!1,isWritable:!1},{pubkey:$e(o).publicKey,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1}];x&&p.push({pubkey:x,isSigner:!1,isWritable:!0}),p.push({pubkey:ne.SystemProgram.programId,isSigner:!1,isWritable:!1}),p.push({pubkey:m,isSigner:!1,isWritable:!0}),p.push({pubkey:g,isSigner:!1,isWritable:!0});let P=Buffer.alloc(k.span);return k.encode({amountB:y,maxAmountA:h,shareFeeRate:d!=null?d:new nt.default(0)},P),new ne.TransactionInstruction({keys:p,programId:o,data:Buffer.from([...Pe.sellExactOut,...P])})}function Vn(o,e,t,n,i,r,s,a,c){let u=V([]),f=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!1},{pubkey:ne.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:Ie.ASSOCIATED_TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}],l=Buffer.alloc(u.span);return u.encode({},l),new ne.TransactionInstruction({keys:f,programId:o,data:Buffer.from([...Pe.claimVestedToken,...l])})}function _n(o,e,t,n,i,r){let s=V([b("shareAmount")]),a=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:ne.SystemProgram.programId,isSigner:!1,isWritable:!1}],c=Buffer.alloc(s.span);return s.encode({shareAmount:r},c),new ne.TransactionInstruction({keys:a,programId:o,data:Buffer.from([...Pe.createVestingAccount,...c])})}function qn(o,e,t,n,i,r,s,a,c){let u=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:ne.SystemProgram.programId,isSigner:!1,isWritable:!0},{pubkey:Ie.ASSOCIATED_TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!0}];return new ne.TransactionInstruction({keys:u,programId:o,data:Pe.claimPlatformFee})}function sr(o,e,t,n,i,r,s,a,c,u,f,l,T){let A=V([b("platformScale"),b("creatorScale"),b("burnScale"),b("feeRate"),be("name"),be("web"),be("img"),b("creatorFeeRate")]),m=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:ne.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!1}],g=Buffer.alloc(8*5+Buffer.from(f,"utf-8").length+Buffer.from(l,"utf-8").length+Buffer.from(T,"utf-8").length+4*3);return A.encode({platformScale:a.platformScale,creatorScale:a.creatorScale,burnScale:a.burnScale,feeRate:c,name:f,web:l,img:T,creatorFeeRate:u},g),new ne.TransactionInstruction({keys:m,programId:o,data:Buffer.from([...Pe.createPlatformConfig,...g])})}function ar(o,e,t,n){let i=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!0}],r;if(n.type==="updateClaimFeeWallet"){let s=V([W("index"),v("value")]);r=Buffer.alloc(s.span),s.encode({index:0,value:n.value},r)}else if(n.type==="updateLockNftWallet"){let s=V([W("index"),v("value")]);r=Buffer.alloc(s.span),s.encode({index:1,value:n.value},r)}else if(n.type==="migrateCpLockNftScale"){let s=V([W("index"),b("platformScale"),b("creatorScale"),b("burnScale")]);r=Buffer.alloc(s.span),s.encode(q({index:2},n.value),r)}else if(n.type==="updateFeeRate"){let s=V([W("index"),b("value")]);r=Buffer.alloc(s.span),s.encode({index:3,value:n.value},r)}else if(n.type==="updateImg"||n.type==="updateName"||n.type==="updateWeb"){let s=V([W("index"),be("value")]);r=Buffer.alloc(Buffer.from(n.value,"utf-8").length+4+1*1),n.type==="updateName"?s.encode({index:4,value:n.value},r):n.type==="updateWeb"?s.encode({index:5,value:n.value},r):n.type==="updateImg"&&s.encode({index:6,value:n.value},r)}else if(n.type==="updateCpConfigId"){i.push({pubkey:n.value,isSigner:!1,isWritable:!1});let s=V([W("index")]);r=Buffer.alloc(s.span),s.encode({index:7},r)}else if(n.type==="updateAll"){i.push({pubkey:n.value.cpConfigId,isSigner:!1,isWritable:!1});let s=V([W("index"),v("platformClaimFeeWallet"),v("platformLockNftWallet"),b("platformScale"),b("creatorScale"),b("burnScale"),b("feeRate"),be("name"),be("web"),be("img"),v("transferFeeExtensionAuth"),b("creatorFeeRate")]);r=Buffer.alloc(1+32+32+8*4+4*3+Buffer.from(n.value.name,"utf-8").length+Buffer.from(n.value.web,"utf-8").length+Buffer.from(n.value.img,"utf-8").length+32+8),s.encode({index:8,platformClaimFeeWallet:n.value.platformClaimFeeWallet,platformLockNftWallet:n.value.platformLockNftWallet,platformScale:n.value.migrateCpLockNftScale.platformScale,creatorScale:n.value.migrateCpLockNftScale.creatorScale,burnScale:n.value.migrateCpLockNftScale.burnScale,feeRate:n.value.feeRate,name:n.value.name,web:n.value.web,img:n.value.img,transferFeeExtensionAuth:n.value.transferFeeExtensionAuth,creatorFeeRate:n.value.creatorFeeRate},r)}else throw Error("updateInfo params type error");return new ne.TransactionInstruction({keys:i,programId:o,data:Buffer.from([...Pe.updatePlaformConfig,...r])})}function Gn(o,e,t,n,i,r,s,a){let c=[{pubkey:t,isSigner:!0,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:e,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:ne.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:Ie.ASSOCIATED_TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}];return new ne.TransactionInstruction({keys:c,programId:o,data:Pe.claimPlatformFeeFromVault})}function Un(o,e,t,n,i,r,s){let a=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:ne.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:Ie.ASSOCIATED_TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}];return new ne.TransactionInstruction({keys:a,programId:o,data:Pe.claimCreatorFee})}var md=new nt.default("18446744073709551615");var S=require("@solana/spl-token"),D=X(require("bn.js")),Ot=require("@solana/web3.js");var Ae=X(require("bn.js")),zn=X(require("decimal.js"));var Lt=X(require("bn.js")),pt=X(require("decimal.js"));var Ue=class{static getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n}){throw Error()}static getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:i}){throw Error()}static getPoolPrice({poolInfo:e,decimalA:t,decimalB:n}){throw Error()}static getPoolEndPrice({supply:e,totalSell:t,totalLockedAmount:n,totalFundRaising:i,migrateFee:r,decimalA:s,decimalB:a}){throw Error()}static getPoolEndPriceReal({poolInfo:e,decimalA:t,decimalB:n}){throw Error()}static getInitParam({supply:e,totalFundRaising:t,totalSell:n,totalLockedAmount:i,migrateFee:r}){throw Error()}static buyExactIn({poolInfo:e,amount:t}){throw Error()}static buyExactOut({poolInfo:e,amount:t}){throw Error()}static sellExactIn({poolInfo:e,amount:t}){throw Error()}static sellExactOut({poolInfo:e,amount:t}){throw Error()}};var Yt=class extends Ue{static getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n}){return new pt.default(e.virtualB.toString()).div(e.virtualA.toString()).mul(10**(t-n))}static getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:i}){return new pt.default(t.toString()).div(e.toString()).mul(10**(n-i))}static getPoolPrice({poolInfo:e,decimalA:t,decimalB:n}){return new pt.default(e.virtualB.add(e.realB).toString()).div(e.virtualA.sub(e.realA).toString()).mul(10**(t-n))}static getPoolEndPrice({supply:e,totalSell:t,totalLockedAmount:n,totalFundRaising:i,migrateFee:r,decimalA:s,decimalB:a}){return new pt.default(i.sub(r).toString()).div(e.sub(t).sub(n).toString()).mul(10**(s-a))}static getPoolEndPriceReal({poolInfo:e,decimalA:t,decimalB:n}){let i=e.totalSellA.sub(e.realA),r=e.totalFundRaisingB.sub(e.realB);return new pt.default(e.virtualB.add(e.realB.add(r)).toString()).div(e.virtualA.sub(e.realA.add(i)).toString()).mul(10**(t-n))}static getInitParam({supply:e,totalFundRaising:t,totalSell:n,totalLockedAmount:i,migrateFee:r}){if(e.lte(n))throw Error("supply need gt total sell");let s=e.sub(n).sub(i);if(s.lte(new Lt.default(0)))throw Error("supplyMinusSellLocked <= 0");let a=t.sub(r);if(a.lte(new Lt.default(0)))throw Error("tfMinusMf <= 0");let c=a.mul(n).mul(n).div(s),u=a.mul(n).div(s).sub(t),f=c.div(u),l=t.mul(t).div(u);if(f.lt(new Lt.default(0))||l.lt(new Lt.default(0)))throw Error("invalid input 0");return{a:f,b:l,c:n}}static buyExactIn({poolInfo:e,amount:t}){return this.getAmountOut({amountIn:t,inputReserve:e.virtualB.add(e.realB),outputReserve:e.virtualA.sub(e.realA)})}static buyExactOut({poolInfo:e,amount:t}){return this.getAmountIn({amountOut:t,inputReserve:e.virtualB.add(e.realB),outputReserve:e.virtualA.sub(e.realA)})}static sellExactIn({poolInfo:e,amount:t}){return this.getAmountOut({amountIn:t,inputReserve:e.virtualA.sub(e.realA),outputReserve:e.virtualB.add(e.realB)})}static sellExactOut({poolInfo:e,amount:t}){return this.getAmountIn({amountOut:t,inputReserve:e.virtualA.sub(e.realA),outputReserve:e.virtualB.add(e.realB)})}static getAmountOut({amountIn:e,inputReserve:t,outputReserve:n}){let i=e.mul(n),r=t.add(e);return i.div(r)}static getAmountIn({amountOut:e,inputReserve:t,outputReserve:n}){let i=t.mul(e),r=n.sub(e);return Ze(i,r)}};var Ft=X(require("bn.js")),ft=X(require("decimal.js"));var jt=class extends Ue{static getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n}){return new ft.default(e.virtualB.toString()).div(e.virtualA.toString()).mul(10**(t-n))}static getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:i}){return new ft.default(t.toString()).div(e.toString()).mul(10**(n-i))}static getPoolPrice({poolInfo:e,decimalA:t,decimalB:n}){return new ft.default(e.virtualB.toString()).div(e.virtualA.toString()).mul(10**(t-n))}static getPoolEndPrice({supply:e,totalSell:t,totalLockedAmount:n,totalFundRaising:i,migrateFee:r,decimalA:s,decimalB:a}){return new ft.default(i.sub(r).toString()).div(e.sub(t).sub(n).toString()).mul(10**(s-a))}static getPoolEndPriceReal({poolInfo:e,decimalA:t,decimalB:n}){let i=e.totalSellA.sub(e.realA),r=e.totalFundRaisingB.sub(e.realB);return new ft.default(e.virtualB.add(e.realB).add(r).toString()).div(e.virtualA.sub(e.realA).add(i).toString()).mul(10**(t-n))}static getInitParam({supply:e,totalFundRaising:t,totalSell:n,totalLockedAmount:i,migrateFee:r}){let s=e.sub(i);if(s.lte(new Ft.default(0)))throw Error("invalid input 1");let a=new Ft.default(2).mul(t).sub(r),u=t.mul(s).div(a);if(u.lt(new Ft.default(0))||t.lt(new Ft.default(0)))throw Error("invalid input 0");return{a:u,b:t,c:u}}static buyExactIn({poolInfo:e,amount:t}){return this.getAmountOut({amountIn:t,initInput:e.virtualB,initOutput:e.virtualA})}static buyExactOut({poolInfo:e,amount:t}){return this.getAmountIn({amountOut:t,initInput:e.virtualB,initOutput:e.virtualA})}static sellExactIn({poolInfo:e,amount:t}){return this.getAmountOut({amountIn:t,initInput:e.virtualA,initOutput:e.virtualB})}static sellExactOut({poolInfo:e,amount:t}){return this.getAmountIn({amountOut:t,initInput:e.virtualA,initOutput:e.virtualB})}static getAmountOut({amountIn:e,initInput:t,initOutput:n}){return n.mul(e).div(t)}static getAmountIn({amountOut:e,initInput:t,initOutput:n}){let i=t.mul(e);return Ze(i,n)}};var pe=X(require("bn.js")),Xe=X(require("decimal.js"));var Xn=X(require("bn.js")),Zt=X(require("decimal.js")),Mt=class{static _multipler(e){return new Zt.default(10).pow(e)}static getPrice({priceX64:e,decimalA:t,decimalB:n}){return new Zt.default(e.toString()).div(this._Q64).mul(this._multipler(t)).div(this._multipler(n))}static getPriceX64({price:e,decimalA:t,decimalB:n}){let i=e.mul(this._multipler(n)).div(this._multipler(t));return new Xn.default(i.mul(this._Q64).toFixed(0))}};Mt._Q64=new Zt.default(new Xn.default(1).shln(64).toString());var Qt=class extends Ue{static getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n}){return new Xe.default(0)}static getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:i}){return new Xe.default(0)}static getPoolPrice({poolInfo:e,decimalA:t,decimalB:n}){return new Xe.default(e.virtualA.mul(e.realA).toString()).div(Mt._Q64).mul(10**(t-n))}static getPoolEndPrice({supply:e,totalSell:t,totalLockedAmount:n,totalFundRaising:i,migrateFee:r,decimalA:s,decimalB:a}){return new Xe.default(i.sub(r).toString()).div(e.sub(t).sub(n).toString()).mul(10**(s-a))}static getPoolEndPriceReal({poolInfo:e,decimalA:t,decimalB:n}){let i=e.totalSellA.sub(e.realA),r=e.totalFundRaisingB.sub(e.realB);return new Xe.default(e.virtualB.add(e.realB).add(r).toString()).div(e.virtualA.sub(e.realA).add(i).toString()).mul(10**(t-n))}static getInitParam({supply:e,totalFundRaising:t,totalSell:n,totalLockedAmount:i,migrateFee:r}){let s=e.sub(i);if(s.lte(new pe.default(0)))throw Error("supplyMinusLocked need gt 0");let a=t.mul(new pe.default(3)).sub(r),u=t.mul(new pe.default(2)).mul(s).div(a),f=u.mul(u),l=t.mul(new pe.default(2)).mul(Re).div(f);if(!l.gt(new pe.default(0)))throw Error("a need gt 0");if(!Kn.gt(l))throw Error("a need lt u64 max");if(l.lt(new pe.default(0))||u.lt(new pe.default(0)))throw Error("invalid input 0");return{a:l,b:new pe.default(0),c:u}}static buyExactIn({poolInfo:e,amount:t}){let n=e.realB.add(t),i=new pe.default(2).mul(n).mul(Re).div(e.virtualA);return new pe.default(new Xe.default(i.toString()).sqrt().toFixed(0)).sub(e.realA)}static buyExactOut({poolInfo:e,amount:t}){let n=e.realA.add(t),i=n.mul(n);return Ze(e.virtualA.mul(i),new pe.default(2).mul(Re)).sub(e.realB)}static sellExactIn({poolInfo:e,amount:t}){let n=e.realA.sub(t),i=n.mul(n),r=Ze(e.virtualA.mul(i),new pe.default(2).mul(Re));return e.realB.sub(r)}static sellExactOut({poolInfo:e,amount:t}){let n=e.realB.sub(t),i=new pe.default(2).mul(n).mul(Re).div(e.virtualA),r=new pe.default(new Xe.default(i.toString()).sqrt().toFixed(0));return e.realA.sub(r)}};var Te=class{static getPoolCurvePointByPoolInfo({curveType:e,pointCount:t,poolInfo:n}){return this.getPoolCurvePointByInit({curveType:e,pointCount:t,supply:n.supply,totalFundRaising:n.totalFundRaisingB,totalSell:n.totalSellA,totalLockedAmount:n.vestingSchedule.totalLockedAmount,migrateFee:n.migrateFee,decimalA:n.mintDecimalsA,decimalB:n.mintDecimalsB})}static getPoolCurvePointByInit({curveType:e,pointCount:t,supply:n,totalFundRaising:i,totalSell:r,totalLockedAmount:s,migrateFee:a,decimalA:c,decimalB:u}){if(t<3)throw Error("point count < 3");let f=this.getCurve(e),l=f.getInitParam({supply:n,totalFundRaising:i,totalSell:r,totalLockedAmount:s,migrateFee:a}),T=f.getPoolInitPriceByInit(Q(q({},l),{decimalA:c,decimalB:u})),A=i.div(new Ae.default(t-1)),m=new Ae.default(0),g=[{price:T,totalSellSupply:0}],{a:y,b:h}=l,d=m,x=m;for(let k=1;k<t;k++){let p=k!==t-1?A:i.sub(x),P=this.buyExactIn({poolInfo:{virtualA:y,virtualB:h,realA:d,realB:x,totalFundRaisingB:i,totalSellA:r},amountB:p,protocolFeeRate:m,platformFeeRate:m,curveType:e,shareFeeRate:m,creatorFeeRate:m,transferFeeConfigA:void 0,slot:0});d=d.add(P.amountA.amount),x=x.add(P.amountB);let I=this.getPrice({poolInfo:{virtualA:y,virtualB:h,realA:d,realB:x},decimalA:c,decimalB:u,curveType:e});g.push({price:I,totalSellSupply:new zn.default(d.toString()).div(10**c).toNumber()})}return g}static getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n,curveType:i}){return this.getCurve(i).getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n})}static getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:i,curveType:r}){return this.getCurve(r).getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:i})}static getPrice({poolInfo:e,curveType:t,decimalA:n,decimalB:i}){return this.getCurve(t).getPoolPrice({poolInfo:e,decimalA:n,decimalB:i})}static getEndPrice({poolInfo:e,curveType:t,decimalA:n,decimalB:i}){return this.getCurve(t).getPoolPrice({poolInfo:e,decimalA:n,decimalB:i})}static getPoolEndPriceReal({poolInfo:e,curveType:t,decimalA:n,decimalB:i}){return this.getCurve(t).getPoolEndPriceReal({poolInfo:e,decimalA:n,decimalB:i})}static checkParam({supply:e,totalFundRaising:t,totalSell:n,totalLockedAmount:i,decimals:r,config:s,migrateType:a}){if(Number(r)!==6)throw Error("decimals = 6");if(e.mul(s.maxLockRate).div(Qe).lt(i))throw Error("total lock amount gte max lock amount");if(e.lt(s.minSupplyA.mul(new Ae.default(10**r))))throw Error("supply lt min supply");let u=e.mul(s.minSellRateA).div(Qe);if(n.lt(u))throw Error("invalid input");if(t.lt(s.minFundRaisingB))throw Error("total fund raising lt min fund raising");let f=e.sub(n).sub(i),l=e.mul(s.minMigrateRateA).div(Qe);if(f.lt(l))throw Error("migrate lt min migrate amoount");let T=e.sub(n).sub(i),A=new Ae.default(new zn.default(T.mul(t).toString()).sqrt().toFixed(0));if(a==="amm"){let m=new Ae.default(10).pow(new Ae.default(r));if(A.lte(m))throw Error("check migrate lp error")}else if(a==="cpmm"){let m=new Ae.default(100);if(A.lte(m))throw Error("check migrate lp error")}else throw Error("migrate type error")}static buyExactIn({poolInfo:e,amountB:t,protocolFeeRate:n,platformFeeRate:i,curveType:r,shareFeeRate:s,creatorFeeRate:a,transferFeeConfigA:c,slot:u}){let f=this.totalFeeRate({protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a}),l=this.calculateFee({amount:t,feeRate:f}),T=t.sub(l),A=this.getCurve(r),m=A.buyExactIn({poolInfo:e,amount:T}),g=e.totalSellA.sub(e.realA),y,h,d;if(m.gt(g)){y=g;let k=A.buyExactOut({poolInfo:e,amount:y});h=this.calculatePreFee({postFeeAmount:k,feeRate:f}),d=h.sub(k)}else y=m,h=t,d=l;let x=this.splitFee({totalFee:d,protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a});return{amountA:yn(y,c,u),amountB:h,splitFee:x}}static buyExactOut({poolInfo:e,amountA:t,protocolFeeRate:n,platformFeeRate:i,curveType:r,shareFeeRate:s,creatorFeeRate:a,transferFeeConfigA:c,slot:u}){let f=e.totalSellA.sub(e.realA),l=gn(t,c,u),T=l.fee?l.amount.add(l.fee):l.amount;t.gt(f)&&(T=f);let m=this.getCurve(r).buyExactOut({poolInfo:e,amount:T}),g=this.totalFeeRate({protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a}),y=this.calculatePreFee({postFeeAmount:m,feeRate:g}),h=y.sub(m),d=this.splitFee({totalFee:h,protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a});return{amountA:l,amountB:y,splitFee:d}}static sellExactIn({poolInfo:e,amountA:t,protocolFeeRate:n,platformFeeRate:i,curveType:r,shareFeeRate:s,creatorFeeRate:a,transferFeeConfigA:c,slot:u}){let f=this.getCurve(r),l=yn(t,c,u),T=l.fee?l.amount.sub(l.fee):l.amount,A=f.sellExactIn({poolInfo:e,amount:T}),m=this.calculateFee({amount:A,feeRate:this.totalFeeRate({protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a})}),g=this.splitFee({totalFee:m,protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a});return{amountA:l,amountB:A.sub(m),splitFee:g}}static sellExactOut({poolInfo:e,amountB:t,protocolFeeRate:n,platformFeeRate:i,curveType:r,shareFeeRate:s,creatorFeeRate:a,transferFeeConfigA:c,slot:u}){let f=this.totalFeeRate({protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a}),l=this.calculatePreFee({postFeeAmount:t,feeRate:f});if(e.realB.lt(l))throw Error("Insufficient liquidity");let T=l.sub(t),m=Te.getCurve(r).sellExactOut({poolInfo:e,amount:l});if(m.gt(e.realA))throw Error();let g=this.splitFee({totalFee:T,protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a});return{amountA:gn(m,c,u),amountB:t,splitFee:g}}static splitFee({totalFee:e,protocolFeeRate:t,platformFeeRate:n,shareFeeRate:i,creatorFeeRate:r}){let s=this.totalFeeRate({protocolFeeRate:t,platformFeeRate:n,shareFeeRate:i,creatorFeeRate:r}),a=s.isZero()?new Ae.default(0):e.mul(n).div(s),c=s.isZero()?new Ae.default(0):e.mul(i).div(s),u=s.isZero()?new Ae.default(0):e.mul(r).div(s),f=e.sub(a).sub(c).sub(u);return{platformFee:a,shareFee:c,protocolFee:f,creatorFee:u}}static calculateFee({amount:e,feeRate:t}){return Ai(e,t,Qe)}static calculatePreFee({postFeeAmount:e,feeRate:t}){if(t.isZero())return e;let n=e.mul(Qe),i=Qe.sub(t);return n.add(i).sub(new Ae.default(1)).div(i)}static totalFeeRate({protocolFeeRate:e,platformFeeRate:t,shareFeeRate:n,creatorFeeRate:i}){if(e.add(t).add(n).add(i).gt(new Ae.default(1e6)))throw Error("total fee rate gt 1_000_000");return e.add(t).add(n).add(i)}static getCurve(e){switch(e){case 0:return Yt;case 1:return jt;case 2:return Qt}throw Error("find curve error")}};var ye=X(require("decimal.js")),He={initPriceX64:new D.default("515752397214619"),supply:new D.default(1e15),totalSellA:new D.default(7931e11),totalFundRaisingB:new D.default(85e9),totalLockedAmount:new D.default("0"),cliffPeriod:new D.default("0"),unlockPeriod:new D.default("0"),decimals:6,virtualA:new D.default("1073471847374405"),virtualB:new D.default("30050573465"),realA:new D.default(0),realB:new D.default(0),protocolFee:new D.default(0),platformId:new Ot.PublicKey("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),vestingSchedule:{totalLockedAmount:new D.default(0),cliffPeriod:new D.default(0),unlockPeriod:new D.default(0),startTime:new D.default(0),totalAllocatedShare:new D.default(0)}},ze=new D.default(1e4),Jt=class extends st{constructor(e){super(e)}async sayHello(){console.log("hello")}async createLaunchpad(M){var C=M,{programId:e=ae,authProgramId:t,platformId:n=He.platformId,mintA:i,decimals:r=6,mintBDecimals:s=9,name:a,symbol:c,uri:u,migrateType:f,configId:l,snipers:T,configInfo:A,platformFeeRate:m,txVersion:g,computeBudgetConfig:y,txTipConfig:h,feePayer:d,buyAmount:x,minMintAAmount:k,slippage:p,associatedOnly:P=!0,checkCreateATAOwner:I=!1,extraSigners:w,token2022:K,transferFeeExtensionParams:N,creatorFeeOn:F=0}=C,B=We(C,["programId","authProgramId","platformId","mintA","decimals","mintBDecimals","name","symbol","uri","migrateType","configId","snipers","configInfo","platformFeeRate","txVersion","computeBudgetConfig","txTipConfig","feePayer","buyAmount","minMintAAmount","slippage","associatedOnly","checkCreateATAOwner","extraSigners","token2022","transferFeeExtensionParams","creatorFeeOn"]);var Yn,jn,Zn,Qn,Jn,$n,ei,ti,ni,ii;let R=[],_=this.createTxBuilder(d);t=t!=null?t:Le(e).publicKey,K=!!N,K&&(f="cpmm");let U=A;if(!U&&l){let ke=await this.scope.connection.getAccountInfo(l);ke&&(U=Ge.decode(ke.data))}U||this.logAndCreateError("config not found");let Y=U.mintB,H=U.curveType,{publicKey:ee}=mt(e,i,Y),{publicKey:te}=En(e,ee,i),{publicKey:Z}=En(e,ee,Y),{publicKey:se}=Rn(i);this.logDebug(`create token: ${i.toBase58()}, mintB: ${Y.toBase58()}, decimals A:${r}/B:${s}, config:${l.toBase58()}`),c.length>10&&this.logAndCreateError("Symbol length should shorter than 11"),u||this.logAndCreateError("uri should not empty");let J=(Yn=B==null?void 0:B.supply)!=null?Yn:He.supply,G=(jn=B==null?void 0:B.totalSellA)!=null?jn:He.totalSellA,me=(Zn=B==null?void 0:B.totalFundRaisingB)!=null?Zn:He.totalFundRaisingB,ie=(Qn=B==null?void 0:B.totalLockedAmount)!=null?Qn:new D.default(0),Se=m;if(!m){let ke=await this.scope.connection.getAccountInfo(n);ke||this.logAndCreateError("platform id not found:",n.toString()),Se=dt.decode(ke.data).feeRate}let Hn=Te.getCurve(U.curveType).getInitParam({supply:J,totalFundRaising:me,totalSell:G,totalLockedAmount:ie,migrateFee:U.migrateFee}),Ke={epoch:new D.default(896),bump:254,status:0,mintDecimalsA:r,mintDecimalsB:s,supply:J,totalSellA:G,mintA:new Ot.PublicKey(i),mintB:Y,virtualA:Hn.a,virtualB:Hn.b,realA:He.realA,realB:He.realB,migrateFee:U.migrateFee,migrateType:f==="amm"?0:1,protocolFee:He.protocolFee,platformFee:Se,platformId:n,configId:l,vaultA:te,vaultB:Z,creator:this.scope.ownerPubKey,totalFundRaisingB:me,vestingSchedule:{totalLockedAmount:ie,cliffPeriod:new D.default(0),unlockPeriod:new D.default(0),startTime:new D.default(0),totalAllocatedShare:new D.default(0)},mintProgramFlag:K?1:0,cpmmCreatorFeeOn:F},ur=Te.getCurve(U.curveType),{c:cr}=ur.getInitParam({supply:Ke.supply,totalFundRaising:Ke.totalFundRaisingB,totalLockedAmount:ie,totalSell:U.curveType===0?Ke.totalSellA:new D.default(0),migrateFee:U.migrateFee});try{Te.checkParam({supply:Ke.supply,totalFundRaising:Ke.totalFundRaisingB,totalSell:cr,totalLockedAmount:ie,decimals:Ke.mintDecimalsA,config:U,migrateType:f}),this.logDebug("check init params success")}catch(ke){this.logAndCreateError(`check create mint params failed, ${ke.message}`)}_.addInstruction({instructions:[K?tr(e,d!=null?d:this.scope.ownerPubKey,this.scope.ownerPubKey,l,n,t,ee,i,Y,te,Z,r,a,c,u||"https://",{type:H===0?"ConstantCurve":H===1?"FixedCurve":H===2?"LinearCurve":"ConstantCurve",totalSellA:G,migrateType:f,supply:J,totalFundRaisingB:me},ie,(Jn=B==null?void 0:B.cliffPeriod)!=null?Jn:new D.default(0),($n=B==null?void 0:B.unlockPeriod)!=null?$n:new D.default(0),F,N):er(e,d!=null?d:this.scope.ownerPubKey,this.scope.ownerPubKey,l,n,t,ee,i,Y,te,Z,se,r,a,c,u||"https://",{type:H===0?"ConstantCurve":H===1?"FixedCurve":H===2?"LinearCurve":"ConstantCurve",totalSellA:G,migrateType:f,supply:J,totalFundRaisingB:me},ie,(ei=B==null?void 0:B.cliffPeriod)!=null?ei:new D.default(0),(ti=B==null?void 0:B.unlockPeriod)!=null?ti:new D.default(0),F)]});let $t=K?await this.scope.connection.getEpochInfo():void 0,ve=N?{epoch:BigInt(($t==null?void 0:$t.epoch)||0),maximumFee:BigInt((ni=N==null?void 0:N.maxinumFee.toString())!=null?ni:0),transferFeeBasisPoints:(ii=N==null?void 0:N.transferFeeBasePoints)!=null?ii:0}:void 0,en={amountA:{amount:new D.default(0),fee:void 0,expirationTime:void 0},amountB:new D.default(0),splitFee:{platformFee:new D.default(0),shareFee:new D.default(0),protocolFee:new D.default(0),creatorFee:new D.default(0)}},tn;if(w!=null&&w.length&&_.addInstruction({signers:w}),!B.createOnly){let{builder:ke,extInfo:lr}=await this.buyToken({programId:e,authProgramId:t,mintAProgram:K?S.TOKEN_2022_PROGRAM_ID:void 0,mintA:i,mintB:Y,poolInfo:Ke,buyAmount:x,minMintAAmount:k,shareFeeRate:B.shareFeeRate,shareFeeReceiver:B.shareFeeReceiver,configInfo:U,platformFeeRate:Se,slippage:p,associatedOnly:P,checkCreateATAOwner:I,skipCheckMintA:!ve,transferFeeConfigA:ve?{transferFeeConfigAuthority:t,withdrawWithheldAuthority:t,withheldAmount:BigInt(0),olderTransferFee:ve,newerTransferFee:ve}:void 0,fromCreate:!0});console.log("PREPARING SNIPER TRANSACTIONS");for(let ri of T){let{builder:mr,extInfo:No}=await this.buyToken({programId:e,authProgramId:t,mintAProgram:K?S.TOKEN_2022_PROGRAM_ID:void 0,mintA:i,mintB:Y,poolInfo:Ke,buyAmount:ri.amount,minMintAAmount:k,shareFeeRate:B.shareFeeRate,shareFeeReceiver:B.shareFeeReceiver,configInfo:U,platformFeeRate:Se,slippage:p,sniper:ri,associatedOnly:P,checkCreateATAOwner:I,skipCheckMintA:!ve,transferFeeConfigA:ve?{transferFeeConfigAuthority:t,withdrawWithheldAuthority:t,withheldAmount:BigInt(0),olderTransferFee:ve,newerTransferFee:ve}:void 0,fromCreate:!0});R.push(Q(q({},mr.AllTxData),{blockHash:this.scope.blockhashCommitment}))}_.addInstruction(q({},ke.AllTxData)),en=q({},lr),tn=(this.scope.cluster==="devnet"||g===1)&&B.shareFeeReceiver?[ke.allInstructions[0]]:void 0}return _.addTipInstruction(h),g===0?(console.log("VERSION V0"),{tx:await _.sizeCheckBuildV0({computeBudgetConfig:y,swapInfo:en,splitIns:tn,address:Q(q({},Ke),{poolId:ee})}),txs:R}):(console.log("VERSION PLAIN"),{tx:await _.sizeCheckBuild({computeBudgetConfig:y,swapInfo:en,splitIns:tn,address:Q(q({},Ke),{poolId:ee})}),txs:R})}async buyToken({programId:e=ae,authProgramId:t,mintA:n,mintAProgram:i=S.TOKEN_PROGRAM_ID,mintB:r=S.NATIVE_MINT,poolInfo:s,configInfo:a,platformFeeRate:c,txVersion:u,computeBudgetConfig:f,txTipConfig:l,feePayer:T,buyAmount:A,minMintAAmount:m,slippage:g,shareFeeRate:y=new D.default(0),shareFeeReceiver:h,sniper:d,associatedOnly:x=!0,checkCreateATAOwner:k=!1,fromCreate:p=!1,transferFeeConfigA:P,skipCheckMintA:I=!1}){var J,G,me;A.lte(new D.default(0))&&this.logAndCreateError("buy amount should gt 0:",A.toString());let w=d?this.createSniperTxBuilder(d.owner,d.owner.publicKey):this.createTxBuilder(T),{publicKey:K}=mt(e,n,r);t=t!=null?t:Le(e).publicKey;let N=P;if(!I)if(N)i=S.TOKEN_2022_PROGRAM_ID;else{let ie=await this.scope.connection.getAccountInfo(n);if(ie&&ie.owner.equals(S.TOKEN_2022_PROGRAM_ID)){i=ie.owner;let Se=(0,S.unpackMint)(n,ie,i);N=(0,S.getTransferFeeConfig)(Se)||void 0}}let F=d?this.scope.account.getAssociatedTokenAccountByOwner(d.owner.publicKey,n,i):this.scope.account.getAssociatedTokenAccount(n,i),B=p?d?this.scope.account.getAssociatedTokenAccountByOwner(d.owner.publicKey,r,S.TOKEN_PROGRAM_ID):this.scope.account.getAssociatedTokenAccount(r,S.TOKEN_PROGRAM_ID):null,M=r.equals(S.NATIVE_MINT);if(console.log("userTokenAccountA: ",F),console.log("mintAProgram: ",i),w.addInstruction({instructions:[(0,S.createAssociatedTokenAccountIdempotentInstruction)((d==null?void 0:d.owner.publicKey)||this.scope.ownerPubKey,F,(d==null?void 0:d.owner.publicKey)||this.scope.ownerPubKey,n,i),...p?[(0,S.createAssociatedTokenAccountIdempotentInstruction)((d==null?void 0:d.owner.publicKey)||this.scope.ownerPubKey,B,(d==null?void 0:d.owner.publicKey)||this.scope.ownerPubKey,r,S.TOKEN_PROGRAM_ID),Ot.SystemProgram.transfer({fromPubkey:(d==null?void 0:d.owner.publicKey)||this.scope.ownerPubKey,toPubkey:B,lamports:BigInt(A.toString())}),(0,S.createSyncNativeInstruction)(B)]:[]]}),!p){let{account:ie,instructionParams:Se}=await this.scope.account.getOrCreateTokenAccount({mint:r,owner:this.scope.ownerPubKey,createInfo:M?{payer:this.scope.ownerPubKey,amount:A}:void 0,skipCloseAccount:!M,notUseTokenAccount:M,associatedOnly:M?!1:x,checkCreateATAOwner:k});ie&&(B=ie),w.addInstruction(Se||{})}B===void 0&&this.logAndCreateError(`cannot found mintB(${r.toBase58()}) token accounts`,"tokenAccounts",this.scope.account.tokenAccounts);let C=s;if(!C){let ie=await this.scope.connection.getAccountInfo(K,{commitment:"processed"});ie||this.logAndCreateError("cannot found pool:",K.toBase58()),C=xe.decode(ie.data)}let R=a,_=await Me(this.scope.connection,[R?void 0:C.configId,C.platformId].filter(Boolean).map(ie=>({pubkey:ie})));if(!R){let ie=_.find(Se=>Se.pubkey.equals(C.configId));(!ie||!ie.accountInfo)&&this.logAndCreateError("config not found: ",C.configId.toBase58()),R=Ge.decode(ie.accountInfo.data)}let U=_.find(ie=>ie.pubkey.equals(C.platformId));(!U||!U.accountInfo)&&this.logAndCreateError("platform info not found: ",C.configId.toBase58());let Y=dt.decode(U.accountInfo.data);c=c||Y.feeRate;let H=Te.buyExactIn({poolInfo:C,amountB:A,protocolFeeRate:R.tradeFeeRate,platformFeeRate:c,curveType:R.curveType,shareFeeRate:y,creatorFeeRate:Y.creatorFeeRate,transferFeeConfigA:N,slot:await this.scope.connection.getSlot()}),ee=new ye.default(H.amountA.amount.toString()).sub((G=(J=H.amountA.fee)==null?void 0:J.toString())!=null?G:0),te=g?new ye.default(ze.sub(g).toNumber()/ze.toNumber()).clampedTo(0,1):new ye.default(1),Z=m!=null?m:g?new D.default(ee.mul(te).toFixed(0)):H.amountA.amount.sub((me=H.amountA.fee)!=null?me:new D.default(0));H.amountB.lt(A)&&console.log(`maximum ${n.toBase58()} amount can buy is ${H.amountA.toString()}, input ${r.toBase58()} amount: ${H.amountB.toString()}`);let se=h?Be(h,r,S.TOKEN_PROGRAM_ID).publicKey:void 0;return se&&w.addInstruction({instructions:[(0,S.createAssociatedTokenAccountIdempotentInstruction)((d==null?void 0:d.owner.publicKey)||this.scope.ownerPubKey,se,h,r)]}),w.addInstruction({instructions:[nr(e,(d==null?void 0:d.owner.publicKey)||this.scope.ownerPubKey,t,C.configId,C.platformId,K,F,B,C.vaultA,C.vaultB,n,r,i,S.TOKEN_PROGRAM_ID,et(e,C.platformId,r).publicKey,tt(e,C.creator,r).publicKey,H.amountB.lt(A)?H.amountB:A,Z,y,se)]}),w.addCustomComputeBudget(f),console.log("Adding Tip Config: ",l),w.addTipInstruction(l),w.versionBuild({txVersion:u,extInfo:Q(q({},H),{decimalOutAmount:ee,minDecimalOutAmount:new ye.default(Z.toString())})})}async buyTokenExactOut({programId:e=ae,authProgramId:t,mintA:n,mintAProgram:i=S.TOKEN_PROGRAM_ID,mintB:r=S.NATIVE_MINT,poolInfo:s,configInfo:a,transferFeeConfigA:c,platformFeeRate:u,txVersion:f,computeBudgetConfig:l,txTipConfig:T,feePayer:A,maxBuyAmount:m,outAmount:g,slippage:y,shareFeeRate:h=new D.default(0),shareFeeReceiver:d,associatedOnly:x=!0,checkCreateATAOwner:k=!1,skipCheckMintA:p=!1}){g.lte(new D.default(0))&&this.logAndCreateError("out amount should gt 0:",g.toString());let P=this.createTxBuilder(A),{publicKey:I}=mt(e,n,r);t=t!=null?t:Le(e).publicKey;let w=s;if(!w){let J=await this.scope.connection.getAccountInfo(I,{commitment:"processed"});J||this.logAndCreateError("cannot found pool:",I.toBase58()),w=xe.decode(J.data)}let K=a,N=await Me(this.scope.connection,[K?void 0:w.configId,w.platformId].filter(Boolean).map(J=>({pubkey:J})));if(!K){let J=N.find(G=>G.pubkey.equals(w.configId));(!J||!J.accountInfo)&&this.logAndCreateError("config not found: ",w.configId.toBase58()),K=Ge.decode(J.accountInfo.data)}let F=N.find(J=>J.pubkey.equals(w.platformId));(!F||!F.accountInfo)&&this.logAndCreateError("platform info not found: ",w.configId.toBase58());let B=dt.decode(F.accountInfo.data);u=u||B.feeRate;let M=c;if(!p)if(M)i=S.TOKEN_2022_PROGRAM_ID;else{let J=await this.scope.connection.getAccountInfo(n);if(J&&J.owner.equals(S.TOKEN_2022_PROGRAM_ID)){i=J.owner;let G=(0,S.unpackMint)(n,J,i);M=(0,S.getTransferFeeConfig)(G)||void 0}}let C=Te.buyExactOut({poolInfo:w,amountA:g,protocolFeeRate:K.tradeFeeRate,platformFeeRate:u,curveType:K.curveType,shareFeeRate:h,creatorFeeRate:B.creatorFeeRate,transferFeeConfigA:M,slot:await this.scope.connection.getSlot()}),R=new ye.default(C.amountB.toString()),_=y?new ye.default(ze.add(y).toNumber()/ze.toNumber()).clampedTo(0,Number.MIN_SAFE_INTEGER):new ye.default(1),U=(m!=null?m:y)?new D.default(R.mul(_).toFixed(0)):C.amountB,Y=this.scope.account.getAssociatedTokenAccount(n,i),H=null,ee=r.equals(S.NATIVE_MINT);P.addInstruction({instructions:[(0,S.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,Y,this.scope.ownerPubKey,n,i)]});let{account:te,instructionParams:Z}=await this.scope.account.getOrCreateTokenAccount({mint:r,owner:this.scope.ownerPubKey,createInfo:ee?{payer:this.scope.ownerPubKey,amount:C.amountB}:void 0,skipCloseAccount:!ee,notUseTokenAccount:ee,associatedOnly:ee?!1:x,checkCreateATAOwner:k});te&&(H=te),P.addInstruction(Z||{}),H===void 0&&this.logAndCreateError(`cannot found mintB(${r.toBase58()}) token accounts`,"tokenAccounts",this.scope.account.tokenAccounts);let se=d?Be(d,r,S.TOKEN_PROGRAM_ID).publicKey:void 0;return se&&P.addInstruction({instructions:[(0,S.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,se,d,r)]}),P.addInstruction({instructions:[ir(e,this.scope.ownerPubKey,t,w.configId,w.platformId,I,Y,H,w.vaultA,w.vaultB,n,r,i,S.TOKEN_PROGRAM_ID,et(e,w.platformId,r).publicKey,tt(e,w.creator,r).publicKey,g,U,h,se)]}),P.addCustomComputeBudget(l),P.addTipInstruction(T),P.versionBuild({txVersion:f,extInfo:{maxSpentAmount:U,outAmount:g}})}async sellToken({programId:e=ae,authProgramId:t,mintAProgram:n=S.TOKEN_PROGRAM_ID,mintA:i,mintB:r=S.NATIVE_MINT,poolInfo:s,configInfo:a,platformFeeRate:c,txVersion:u,computeBudgetConfig:f,txTipConfig:l,feePayer:T,sellAmount:A,minAmountB:m,slippage:g,shareFeeRate:y=new D.default(0),shareFeeReceiver:h,associatedOnly:d=!0,checkCreateATAOwner:x=!1,skipCheckMintA:k=!1}){t=t!=null?t:Le(e).publicKey;let p=this.createTxBuilder(T);A.lte(new D.default(0))&&this.logAndCreateError("sell amount should be gt 0");let{publicKey:P}=mt(e,i,r),I;if(!k){let G=await this.scope.connection.getAccountInfo(i);if(G&&G.owner.equals(S.TOKEN_2022_PROGRAM_ID)){n=G.owner;let me=(0,S.unpackMint)(i,G,n);I=(0,S.getTransferFeeConfig)(me)||void 0}}let w=null,K=null,N=r.equals(S.NATIVE_MINT),{account:F,instructionParams:B}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:n,mint:i,owner:this.scope.ownerPubKey,createInfo:void 0,skipCloseAccount:!0,notUseTokenAccount:!1,associatedOnly:d,checkCreateATAOwner:x});F&&(w=F),p.addInstruction(B||{}),w===void 0&&this.logAndCreateError("cannot found mintA token accounts","tokenAccounts",this.scope.account.tokenAccounts);let{account:M,instructionParams:C}=await this.scope.account.getOrCreateTokenAccount({mint:r,owner:this.scope.ownerPubKey,createInfo:N?{payer:this.scope.ownerPubKey,amount:0}:void 0,skipCloseAccount:!N,notUseTokenAccount:N,associatedOnly:N?!1:d,checkCreateATAOwner:x});M&&(K=M),p.addInstruction(C||{}),K===void 0&&this.logAndCreateError("cannot found mintB token accounts","tokenAccounts",this.scope.account.tokenAccounts);let R=s;if(!R){let G=await this.scope.connection.getAccountInfo(P,{commitment:"processed"});G||this.logAndCreateError("cannot found pool",P.toBase58()),R=xe.decode(G.data)}let _=a,U=await Me(this.scope.connection,[_?void 0:R.configId,R.platformId].filter(Boolean).map(G=>({pubkey:G})));if(!_){let G=U.find(me=>me.pubkey.equals(R.configId));(!G||!G.accountInfo)&&this.logAndCreateError("config not found: ",R.configId.toBase58()),_=Ge.decode(G.accountInfo.data)}let Y=U.find(G=>G.pubkey.equals(R.platformId));(!Y||!Y.accountInfo)&&this.logAndCreateError("platform info not found: ",R.configId.toBase58());let H=dt.decode(Y.accountInfo.data);c=c||H.feeRate;let ee=Te.sellExactIn({poolInfo:R,amountA:A,protocolFeeRate:_.tradeFeeRate,platformFeeRate:c,curveType:_.curveType,shareFeeRate:y,creatorFeeRate:H.creatorFeeRate,transferFeeConfigA:I,slot:await this.scope.connection.getSlot()}),te=new ye.default(ee.amountB.toString()),Z=g?new ye.default(ze.sub(g).toNumber()/ze.toNumber()).clampedTo(0,1):new ye.default(1),se=m!=null?m:g?new D.default(te.mul(Z).toFixed(0)):ee.amountB;se.lte(new D.default(0))&&this.logAndCreateError(`out ${r.toBase58()} amount should be gt 0`);let J=h?Be(h,r,S.TOKEN_PROGRAM_ID).publicKey:void 0;return J&&p.addInstruction({instructions:[(0,S.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,J,h,r)]}),p.addInstruction({instructions:[rr(e,this.scope.ownerPubKey,t,R.configId,R.platformId,P,w,K,R.vaultA,R.vaultB,i,r,n,S.TOKEN_PROGRAM_ID,et(e,R.platformId,r).publicKey,tt(e,R.creator,r).publicKey,ee.amountA.amount.lt(A)?ee.amountA.amount:A,se,y,J)]}),p.addCustomComputeBudget(f),p.addTipInstruction(l),p.versionBuild({txVersion:u,extInfo:{outAmount:se}})}async sellTokenExactOut({programId:e=ae,authProgramId:t,mintAProgram:n=S.TOKEN_PROGRAM_ID,mintA:i,mintB:r=S.NATIVE_MINT,poolInfo:s,configInfo:a,platformFeeRate:c,txVersion:u,computeBudgetConfig:f,txTipConfig:l,feePayer:T,inAmount:A,maxSellAmount:m,slippage:g,shareFeeRate:y=new D.default(0),shareFeeReceiver:h,associatedOnly:d=!0,checkCreateATAOwner:x=!1,skipCheckMintA:k=!1}){t=t!=null?t:Le(e).publicKey;let p=this.createTxBuilder(T);m!=null&&m.lte(new D.default(0))&&this.logAndCreateError("max sell amount should be gt 0");let{publicKey:P}=mt(e,i,r),I;if(!k){let G=await this.scope.connection.getAccountInfo(i);if(G&&G.owner.equals(S.TOKEN_2022_PROGRAM_ID)){n=G.owner;let me=(0,S.unpackMint)(i,G,n);I=(0,S.getTransferFeeConfig)(me)||void 0}}let w=null,K=null,N=r.equals(S.NATIVE_MINT),{account:F,instructionParams:B}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:n,mint:i,owner:this.scope.ownerPubKey,createInfo:void 0,skipCloseAccount:!0,notUseTokenAccount:!1,associatedOnly:d,checkCreateATAOwner:x});F&&(w=F),p.addInstruction(B||{}),w===void 0&&this.logAndCreateError("cannot found mintA token accounts","tokenAccounts",this.scope.account.tokenAccounts);let{account:M,instructionParams:C}=await this.scope.account.getOrCreateTokenAccount({mint:r,owner:this.scope.ownerPubKey,createInfo:N?{payer:this.scope.ownerPubKey,amount:0}:void 0,skipCloseAccount:!N,notUseTokenAccount:N,associatedOnly:N?!1:d,checkCreateATAOwner:x});M&&(K=M),p.addInstruction(C||{}),K===void 0&&this.logAndCreateError("cannot found mintB token accounts","tokenAccounts",this.scope.account.tokenAccounts);let R=s;if(!R){let G=await this.scope.connection.getAccountInfo(P,{commitment:"processed"});G||this.logAndCreateError("cannot found pool",P.toBase58()),R=xe.decode(G.data)}let _=a,U=await Me(this.scope.connection,[_?void 0:R.configId,R.platformId].filter(Boolean).map(G=>({pubkey:G})));if(!_){let G=U.find(me=>me.pubkey.equals(R.configId));(!G||!G.accountInfo)&&this.logAndCreateError("config not found: ",R.configId.toBase58()),_=Ge.decode(G.accountInfo.data)}let Y=U.find(G=>G.pubkey.equals(R.platformId));(!Y||!Y.accountInfo)&&this.logAndCreateError("platform info not found: ",R.configId.toBase58());let H=dt.decode(Y.accountInfo.data);c=c||H.feeRate;let ee=Te.sellExactOut({poolInfo:R,amountB:A,protocolFeeRate:_.tradeFeeRate,platformFeeRate:c,curveType:_.curveType,shareFeeRate:y,creatorFeeRate:H.creatorFeeRate,transferFeeConfigA:I,slot:await this.scope.connection.getSlot()}),te=new ye.default(ee.amountA.amount.toString()),Z=g?new ye.default(ze.add(g).toNumber()/ze.toNumber()).clampedTo(0,Number.MAX_SAFE_INTEGER):new ye.default(1),se=(m!=null?m:g)?new D.default(te.mul(Z).toFixed(0)):ee.amountA.amount,J=h?Be(h,r,S.TOKEN_PROGRAM_ID).publicKey:void 0;return J&&p.addInstruction({instructions:[(0,S.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,J,h,r)]}),p.addInstruction({instructions:[or(e,this.scope.ownerPubKey,t,R.configId,R.platformId,P,w,K,R.vaultA,R.vaultB,i,r,n,S.TOKEN_PROGRAM_ID,et(e,R.platformId,r).publicKey,tt(e,R.creator,r).publicKey,A,se,y,J)]}),p.addCustomComputeBudget(f),p.addTipInstruction(l),p.versionBuild({txVersion:u,extInfo:{maxSellAmount:se}})}async createPlatformConfig({programId:e=ae,platformAdmin:t,platformClaimFeeWallet:n,platformLockNftWallet:i,cpConfigId:r,migrateCpLockNftScale:s,transferFeeExtensionAuth:a,creatorFeeRate:c,feeRate:u,name:f,web:l,img:T,txVersion:A,computeBudgetConfig:m,txTipConfig:g,feePayer:y}){let h=this.createTxBuilder(y),{publicKey:d}=vn(e,t);return h.addInstruction({instructions:[sr(e,t,n,i,d,r,a,s,u,c,f,l,T)]}),h.addCustomComputeBudget(m),h.addTipInstruction(g),h.versionBuild({txVersion:A,extInfo:{platformId:d}})}async updatePlatformConfig({programId:e=ae,platformAdmin:t,platformId:n,updateInfo:i,txVersion:r,computeBudgetConfig:s,txTipConfig:a,feePayer:c}){let u=this.createTxBuilder(c),f=n!=null?n:vn(e,t).publicKey;return u.addInstruction({instructions:[ar(e,t,f,i)]}),u.addCustomComputeBudget(s),u.addTipInstruction(a),u.versionBuild({txVersion:r})}async claimPlatformFee({programId:e=ae,authProgramId:t,platformId:n,poolId:i,platformClaimFeeWallet:r,mintB:s,vaultB:a,mintBProgram:c=S.TOKEN_PROGRAM_ID,txVersion:u,computeBudgetConfig:f,txTipConfig:l,feePayer:T}){var h;let A=this.createTxBuilder(T);t=t!=null?t:Le(e).publicKey;let m=s,g=a;if(!m){let d=await this.scope.connection.getAccountInfo(i,{commitment:"processed"});d||this.logAndCreateError("cannot found pool:",i.toBase58());let x=xe.decode(d.data),k=await this.scope.connection.getAccountInfo(x.configId,{commitment:"processed"});k||this.logAndCreateError("cannot found config:",x.configId.toBase58()),m=Ge.decode(k.data).mintB,g=g!=null?g:x.vaultB}(!m||!g)&&this.logAndCreateError("cannot found mint info, mintB: ",m.toBase58(),", vaultB: ",(h=g==null?void 0:g.toBase58())!=null?h:"");let y=Be(this.scope.ownerPubKey,m,S.TOKEN_PROGRAM_ID).publicKey;return A.addInstruction({instructions:[(0,S.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,y,this.scope.ownerPubKey,m)]}),A.addInstruction({instructions:[qn(e,r,t,i,n,g,y,m,c)]}),A.addCustomComputeBudget(f),A.addTipInstruction(l),A.versionBuild({txVersion:u})}async claimAllPlatformFee({programId:e=ae,authProgramId:t,platformId:n,platformClaimFeeWallet:i,txVersion:r,computeBudgetConfig:s,txTipConfig:a,feePayer:c}){let u=this.createTxBuilder(c);return t=t!=null?t:Le(e).publicKey,(await this.scope.connection.getProgramAccounts(e,{filters:[{dataSize:xe.span},{memcmp:{offset:xe.offsetOf("platformId"),bytes:n.toString()}}]})).forEach(l=>{let T=xe.decode(l.account.data);if(T.platformFee.lte(new D.default(0)))return;let A=Be(this.scope.ownerPubKey,T.mintB,S.TOKEN_PROGRAM_ID).publicKey;u.addInstruction({instructions:[(0,S.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,A,this.scope.ownerPubKey,T.mintB)]}),u.addInstruction({instructions:[qn(e,i,t,l.pubkey,n,T.vaultB,A,T.mintB,S.TOKEN_PROGRAM_ID)]})}),u.addTipInstruction(a),r===0?u.sizeCheckBuildV0({computeBudgetConfig:s}):u.sizeCheckBuild({computeBudgetConfig:s})}async createVesting({programId:e=ae,poolId:t,beneficiary:n,shareAmount:i,txVersion:r,computeBudgetConfig:s,txTipConfig:a,feePayer:c}){let u=this.createTxBuilder(c),f=await this.getRpcPoolInfo({poolId:t});i.add(f.vestingSchedule.totalAllocatedShare).gt(f.vestingSchedule.totalLockedAmount)&&this.logAndCreateError("share amount exceed total locked amount");let l=Rt(e,t,n).publicKey;return u.addInstruction({instructions:[_n(e,this.scope.ownerPubKey,n,t,l,i)]}),u.addCustomComputeBudget(s),u.addTipInstruction(a),u.versionBuild({txVersion:r})}async createMultipleVesting({programId:e=ae,poolId:t,beneficiaryList:n,txVersion:i,computeBudgetConfig:r,feePayer:s}){let a=this.createTxBuilder(s);n.length===0&&this.logAndCreateError("beneficiaryList is null");let c=await this.getRpcPoolInfo({poolId:t});return n.reduce((f,l)=>f.add(l.shareAmount),c.vestingSchedule.totalAllocatedShare).gt(c.vestingSchedule.totalLockedAmount)&&this.logAndCreateError("share amount exceed total locked amount"),n.forEach(f=>{let l=Rt(e,t,f.wallet).publicKey;a.addInstruction({instructions:[_n(e,this.scope.ownerPubKey,f.wallet,t,l,f.shareAmount)]})}),i===0?a.sizeCheckBuildV0({computeBudgetConfig:r}):a.sizeCheckBuild({computeBudgetConfig:r})}async claimVesting({programId:e=ae,poolId:t,poolInfo:n,vestingRecord:i,txVersion:r,computeBudgetConfig:s,txTipConfig:a,feePayer:c}){let u=this.createTxBuilder(c),f=Le(e).publicKey,l=i||Rt(e,t,this.scope.ownerPubKey).publicKey,T=n;if(!T){let m=await this.scope.connection.getAccountInfo(t);m||this.logAndCreateError("pool not found"),T=xe.decode(m.data)}let A=Be(this.scope.ownerPubKey,T.mintA,S.TOKEN_PROGRAM_ID).publicKey;return u.addInstruction({instructions:[(0,S.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,A,this.scope.ownerPubKey,T.mintA)]}),u.addInstruction({instructions:[Vn(e,this.scope.ownerPubKey,f,t,l,A,T.vaultA,T.mintA,S.TOKEN_PROGRAM_ID)]}),u.addCustomComputeBudget(s),u.addTipInstruction(a),u.versionBuild({txVersion:r})}async claimMultiVesting({programId:e=ae,poolIdList:t,poolsInfo:n={},vestingRecords:i={},txVersion:r,computeBudgetConfig:s,feePayer:a}){let c=this.createTxBuilder(a),u=q({},n),f=Le(e).publicKey,l=t.filter(T=>!u[T.toBase58()]);if(l.length){let T=await this.getRpcPoolsInfo({poolIdList:l});u=q(q({},u),T.poolInfoMap)}return t.forEach(T=>{let A=T.toBase58(),m=u[A];m||this.logAndCreateError(`pool info not found: ${A}`);let g=i[A]||Rt(e,T,this.scope.ownerPubKey).publicKey,y=Be(this.scope.ownerPubKey,m.mintA,S.TOKEN_PROGRAM_ID).publicKey;c.addInstruction({instructions:[(0,S.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,y,this.scope.ownerPubKey,m.mintA)]}),c.addInstruction({instructions:[Vn(e,this.scope.ownerPubKey,f,T,g,y,m.vaultA,m.mintA,S.TOKEN_PROGRAM_ID)]})}),r===0?c.sizeCheckBuildV0({computeBudgetConfig:s}):c.sizeCheckBuild({computeBudgetConfig:s})}async claimVaultPlatformFee({programId:e=ae,platformId:t,mintB:n,mintBProgram:i=S.TOKEN_PROGRAM_ID,claimFeeWallet:r,txVersion:s,computeBudgetConfig:a,txTipConfig:c,feePayer:u}){let f=this.createTxBuilder(u),l=et(e,t,n).publicKey,T=Wn(e).publicKey,A=this.scope.account.getAssociatedTokenAccount(n,i);return f.addInstruction({instructions:[(0,S.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,A,this.scope.ownerPubKey,n,i),Gn(e,t,r!=null?r:this.scope.ownerPubKey,T,l,A,n,i)]}),f.addCustomComputeBudget(a),f.addTipInstruction(c),f.versionBuild({txVersion:s})}async claimMultipleVaultPlatformFee({programId:e=ae,platformList:t,unwrapSol:n=!0,txVersion:i,computeBudgetConfig:r,feePayer:s,associatedOnly:a=!0,checkCreateATAOwner:c=!1}){let u=this.createTxBuilder(s),f={};return t.forEach(async l=>{var y,h;let T=Wn(e).publicKey,A=et(e,l.id,l.mintB).publicKey,m=l.mintB.equals(S.NATIVE_MINT)&&n,g=f[l.mintB.toBase58()];if(!g){let{account:d,instructionParams:x}=await this.scope.account.getOrCreateTokenAccount({mint:l.mintB,owner:this.scope.ownerPubKey,createInfo:m?{payer:this.scope.ownerPubKey,amount:0}:void 0,skipCloseAccount:!m,notUseTokenAccount:m,associatedOnly:m?!1:a,checkCreateATAOwner:c});d&&(g=d),u.addInstruction(x||{}),g===void 0&&this.logAndCreateError(`cannot found platform ${l.id.toBase58()} mintB(${l.mintB.toBase58()}) token accounts`,"tokenAccounts",this.scope.account.tokenAccounts)}u.addInstruction({instructions:[Gn(e,l.id,(y=l.claimFeeWallet)!=null?y:this.scope.ownerPubKey,A,T,g,l.mintB,(h=l.mintBProgram)!=null?h:S.TOKEN_PROGRAM_ID)]})}),i===0?u.sizeCheckBuildV0({computeBudgetConfig:r}):u.sizeCheckBuild({computeBudgetConfig:r})}async claimCreatorFee({programId:e=ae,mintB:t,mintBProgram:n=S.TOKEN_PROGRAM_ID,txVersion:i,computeBudgetConfig:r,txTipConfig:s,feePayer:a}){let c=this.createTxBuilder(a),u=tt(e,this.scope.ownerPubKey,t).publicKey,f=Dn(e).publicKey,l=this.scope.account.getAssociatedTokenAccount(t,n);return c.addInstruction({instructions:[(0,S.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,l,this.scope.ownerPubKey,t,n),Un(e,this.scope.ownerPubKey,f,u,l,t,n)]}),c.addCustomComputeBudget(r),c.addTipInstruction(s),c.versionBuild({txVersion:i})}async claimMultipleCreatorFee({programId:e=ae,mintBList:t,txVersion:n,computeBudgetConfig:i,feePayer:r}){let s=this.createTxBuilder(r);return t.forEach(a=>{var A;let c=a.pubKey,u=(A=a.programId)!=null?A:S.TOKEN_PROGRAM_ID,f=tt(e,this.scope.ownerPubKey,c).publicKey,l=Dn(e).publicKey,T=this.scope.account.getAssociatedTokenAccount(c,u);s.addInstruction({instructions:[(0,S.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,T,this.scope.ownerPubKey,c,u),Un(e,this.scope.ownerPubKey,l,f,T,c,u)]})}),n==0?s.sizeCheckBuildV0({computeBudgetConfig:i}):s.sizeCheckBuild({computeBudgetConfig:i})}async getRpcPoolInfo({poolId:e}){return(await this.getRpcPoolsInfo({poolIdList:[e]})).poolInfoMap[e.toBase58()]}async getRpcPoolsInfo({poolIdList:e,config:t}){let n=await Me(this.scope.connection,e.map(c=>({pubkey:c})),t),i={},r=[];for(let c=0;c<e.length;c++){let u=n[c];if(u===null||!u.accountInfo)throw Error("fetch pool info error: "+e[c].toBase58());let f=xe.decode(u.accountInfo.data);i[e[c].toBase58()]=Q(q({},f),{poolId:u.accountInfo.owner}),r.push(f.configId)}let s=await Me(this.scope.connection,r.map(c=>({pubkey:c})),t),a={};for(let c=0;c<r.length;c++){let u=s[c];if(u===null||!u.accountInfo)throw Error("fetch config info error: "+r[c].toBase58());let f=Ge.decode(u.accountInfo.data);a[r[c].toBase58()]=Q(q({},f),{configId:u.accountInfo.owner})}return{poolInfoMap:Object.keys(i).reduce((c,u)=>Q(q({},c),{[u]:Q(q({},i[u]),{configInfo:a[i[u].configId.toBase58()]})}),{})}}};0&&(module.exports={LaunchpadPoolInitParam});
//# sourceMappingURL=launchpad.js.map