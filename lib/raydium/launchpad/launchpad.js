var or=Object.create;var dt=Object.defineProperty,sr=Object.defineProperties,ar=Object.getOwnPropertyDescriptor,ur=Object.getOwnPropertyDescriptors,cr=Object.getOwnPropertyNames,Ct=Object.getOwnPropertySymbols,lr=Object.getPrototypeOf,Jt=Object.prototype.hasOwnProperty,Jn=Object.prototype.propertyIsEnumerable;var Yn=(o,e,t)=>e in o?dt(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,_=(o,e)=>{for(var t in e||(e={}))Jt.call(e,t)&&Yn(o,t,e[t]);if(Ct)for(var t of Ct(e))Jn.call(e,t)&&Yn(o,t,e[t]);return o},j=(o,e)=>sr(o,ur(e));var qe=(o,e)=>{var t={};for(var n in o)Jt.call(o,n)&&e.indexOf(n)<0&&(t[n]=o[n]);if(o!=null&&Ct)for(var n of Ct(o))e.indexOf(n)<0&&Jn.call(o,n)&&(t[n]=o[n]);return t};var mr=(o,e)=>{for(var t in e)dt(o,t,{get:e[t],enumerable:!0})},$n=(o,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of cr(e))!Jt.call(o,i)&&i!==t&&dt(o,i,{get:()=>e[i],enumerable:!(n=ar(e,i))||n.enumerable});return o};var U=(o,e,t)=>(t=o!=null?or(lr(o)):{},$n(e||!o||!o.__esModule?dt(t,"default",{value:o,enumerable:!0}):t,o)),dr=o=>$n(dt({},"__esModule",{value:!0}),o);var Ao={};mr(Ao,{LaunchpadPoolInitParam:()=>_e,default:()=>jt});module.exports=dr(Ao);var pt=require("lodash");var $t=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:0,this.name=e.name}set level(e){this.logLevel=e}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let t=e.map(n=>typeof n=="object"?JSON.stringify(n):n).join(", ");throw new Error(t)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},ei={},pr={};function le(o){let e=(0,pt.get)(ei,o);if(!e){let t=(0,pt.get)(pr,o);e=new $t({name:o,logLevel:t}),(0,pt.set)(ei,o,e)}return e}var H=require("@solana/web3.js"),ki=U(require("axios"));var xe=require("@solana/web3.js");var Ai=require("@solana/web3.js");var Be=U(require("bn.js")),xr=U(require("decimal.js"));var oi=U(require("big.js")),Pr=U(require("bn.js"));var ti=U(require("toformat")),fr=ti.default,ft=fr;var bt=U(require("big.js")),ii=U(require("bn.js")),ri=U(require("decimal.js-light"));var Qe=U(require("bn.js"));var ni=9007199254740991;function Ce(o){let e=le("Raydium_parseBigNumberish");if(o instanceof Qe.default)return o;if(typeof o=="string"){if(o.match(/^-?[0-9]+$/))return new Qe.default(o);e.logWithError(`invalid BigNumberish string: ${o}`)}return typeof o=="number"?(o%1&&e.logWithError(`BigNumberish number underflow: ${o}`),(o>=ni||o<=-ni)&&e.logWithError(`BigNumberish number overflow: ${o}`),new Qe.default(String(o))):typeof o=="bigint"?new Qe.default(o.toString()):(e.error(`invalid BigNumberish value: ${o}`),new Qe.default(0))}var Nt=le("module/fraction"),en=ft(bt.default),yt=ft(ri.default),yr={[0]:yt.ROUND_DOWN,[1]:yt.ROUND_HALF_UP,[2]:yt.ROUND_UP},gr={[0]:bt.default.roundDown,[1]:bt.default.roundHalfUp,[2]:bt.default.roundUp},ee=class{constructor(e,t=new ii.default(1)){this.numerator=Ce(e),this.denominator=Ce(t)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new ee(this.denominator,this.numerator)}add(e){let t=e instanceof ee?e:new ee(Ce(e));return this.denominator.eq(t.denominator)?new ee(this.numerator.add(t.numerator),this.denominator):new ee(this.numerator.mul(t.denominator).add(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}sub(e){let t=e instanceof ee?e:new ee(Ce(e));return this.denominator.eq(t.denominator)?new ee(this.numerator.sub(t.numerator),this.denominator):new ee(this.numerator.mul(t.denominator).sub(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}mul(e){let t=e instanceof ee?e:new ee(Ce(e));return new ee(this.numerator.mul(t.numerator),this.denominator.mul(t.denominator))}div(e){let t=e instanceof ee?e:new ee(Ce(e));return new ee(this.numerator.mul(t.denominator),this.denominator.mul(t.numerator))}toSignificant(e,t={groupSeparator:""},n=1){Number.isInteger(e)||Nt.logWithError(`${e} is not an integer.`),e<=0&&Nt.logWithError(`${e} is not positive.`),yt.set({precision:e+1,rounding:yr[n]});let i=new yt(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return i.toFormat(i.decimalPlaces(),t)}toFixed(e,t={groupSeparator:""},n=1){return Number.isInteger(e)||Nt.logWithError(`${e} is not an integer.`),e<0&&Nt.logWithError(`${e} is negative.`),en.DP=e,en.RM=gr[n]||1,new en(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,t)}isZero(){return this.numerator.isZero()}};var qo=le("Raydium_amount"),Go=ft(oi.default);var si=require("@solana/web3.js"),tn=require("@solana/spl-token"),nn={chainId:101,address:si.PublicKey.default.toBase58(),programId:tn.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},Oe={chainId:101,address:"So11111111111111111111111111111111111111112",programId:tn.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};var Lt=require("@solana/web3.js");var Z=require("@solana/web3.js"),ai=require("@solana/spl-token");function rn({pubkey:o,isSigner:e=!1,isWritable:t=!0}){return{pubkey:o,isWritable:t,isSigner:e}}var Ho=[rn({pubkey:ai.TOKEN_PROGRAM_ID,isWritable:!1}),rn({pubkey:Z.SystemProgram.programId,isWritable:!1}),rn({pubkey:Z.SYSVAR_RENT_PUBKEY,isWritable:!1})];function ui({publicKey:o,transformSol:e}){let t=ci(o.toString());if(t instanceof Z.PublicKey)return e&&t.equals(gt)?Rt:t;if(e&&t.toString()===gt.toBase58())return Rt;if(typeof t=="string"){if(t===Z.PublicKey.default.toBase58())return Z.PublicKey.default;try{return new Z.PublicKey(t)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function ci(o){try{return new Z.PublicKey(o)}catch{return o}}var wr=new Z.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),kr=new Z.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),on=new Z.PublicKey("SysvarRent111111111111111111111111111111111"),jo=new Z.PublicKey("SysvarC1ock11111111111111111111111111111111"),Ye=new Z.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),Zo=new Z.PublicKey("Sysvar1nstructions1111111111111111111111111"),Qo=Z.SystemProgram.programId,Yo=new Z.PublicKey("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),Jo=new Z.PublicKey("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),$o=new Z.PublicKey("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),es=new Z.PublicKey("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),ts=new Z.PublicKey("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),ns=new Z.PublicKey("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),is=new Z.PublicKey("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),rs=new Z.PublicKey("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),os=new Z.PublicKey("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),ss=new Z.PublicKey("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),as=new Z.PublicKey("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),Rt=new Z.PublicKey("So11111111111111111111111111111111111111112"),gt=Z.PublicKey.default;var sn=class{constructor({mint:e,decimals:t,symbol:n,name:i,skipMint:r=!1,isToken2022:s=!1}){if(e===gt.toBase58()||e instanceof Lt.PublicKey&&gt.equals(e)){this.decimals=Oe.decimals,this.symbol=Oe.symbol,this.name=Oe.name,this.mint=new Lt.PublicKey(Oe.address),this.isToken2022=!1;return}this.decimals=t,this.symbol=n||e.toString().substring(0,6),this.name=i||e.toString().substring(0,6),this.mint=r?Lt.PublicKey.default:ui({publicKey:e}),this.isToken2022=s}equals(e){return this===e?!0:this.mint.equals(e.mint)}},Ee=sn;Ee.WSOL=new sn(j(_({},Oe),{mint:Oe.address}));var an=class{constructor({decimals:e,symbol:t="UNKNOWN",name:n="UNKNOWN"}){this.decimals=e,this.symbol=t,this.name=n}equals(e){return this===e}},Ft=an;Ft.SOL=new an(nn);var li=U(require("bn.js"));var gs=new ee(new li.default(100));var Bs=le("Raydium_price");var Br=require("@solana/web3.js"),hr=U(require("bn.js"));var Tr=new Be.default(0),ea=new Be.default(1),ta=new Be.default(2),na=new Be.default(3),ia=new Be.default(5),Ar=new Be.default(10),ra=new Be.default(100),oa=new Be.default(1e3),sa=new Be.default(1e4);function mi(o,e,t){return o.mul(e).add(t).sub(new Be.default(1)).div(t)}function ln(o,e=1,t=[]){let n=[...o];if(e<=0)return t;for(;n.length;)t.push(n.splice(0,e));return t}var bi=require("@solana/web3.js"),yi=require("@solana/spl-token");var me=require("@solana/web3.js");var Ge={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",ClmmLockPosition:"ClmmLockPosition",ClmmHarvestLockPosition:"ClmmHarvestLockPosition",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV4Withdraw:"FarmV4Withdraw",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut",CpmmLockLp:"CpmmLockLp",CpmmCollectLockFee:"CpmmCollectLockFee",TransferTip:"TransferTip"};var pi=require("@solana/spl-token"),di=le("Raydium_txUtil"),fi=1644;function Ot(o){let e=[],t=[];return o.microLamports&&(e.push(me.ComputeBudgetProgram.setComputeUnitPrice({microLamports:o.microLamports})),t.push(Ge.SetComputeUnitPrice)),o.units&&(e.push(me.ComputeBudgetProgram.setComputeUnitLimit({units:o.units})),t.push(Ge.SetComputeUnitLimit)),{instructions:e,instructionTypes:t}}async function Je(o,e){var n,i;let t=e!=null?e:"confirmed";return(i=await((n=o.getLatestBlockhash)==null?void 0:n.call(o,{commitment:t})))==null?void 0:i.blockhash}async function Et(o,e){return o.getSignatureStatuses([e]),new Promise((t,n)=>{let i=setTimeout(n,6e4);o.onSignature(e,r=>{if(clearTimeout(i),!r.err){t("");return}n(Object.assign(r.err,{txId:e}))},"confirmed")})}function Ir(o,e){o.length<1&&di.logWithError(`no instructions provided: ${o.toString()}`),e.length<1&&di.logWithError(`no signers provided:, ${e.toString()}`);let t=new me.Transaction;t.recentBlockhash="11111111111111111111111111111111",t.feePayer=e[0],t.add(...o);try{return Buffer.from(t.serialize({verifySignatures:!1})).toString("base64").length<fi}catch{return!1}}function de(o,e){let[t,n]=me.PublicKey.findProgramAddressSync(o,e);return{publicKey:t,nonce:n}}function Pt({instructions:o,payer:e,signers:t}){return Ir(o,[e,...t])}function At({instructions:o,payer:e,lookupTableAddressAccount:t,recentBlockhash:n=me.Keypair.generate().publicKey.toString()}){let r=new me.TransactionMessage({payerKey:e,recentBlockhash:n,instructions:o}).compileToV0Message(Object.values(t!=null?t:{}));try{return Buffer.from(new me.VersionedTransaction(r).serialize()).toString("base64").length<fi}catch{return!1}}var Sr=o=>Buffer.isBuffer(o)?o:o instanceof Uint8Array?Buffer.from(o.buffer,o.byteOffset,o.byteLength):Buffer.from(o),Kr=o=>{let e=o.serialize({requireAllSignatures:!1,verifySignatures:!1});o instanceof me.VersionedTransaction&&(e=Sr(e));try{return e instanceof Buffer?e.toString("base64"):Buffer.from(e).toString("base64")}catch{return e.toString("base64")}};function Ue(o){let e=[];return o.forEach(t=>{t instanceof me.Transaction&&(t.recentBlockhash||(t.recentBlockhash=pi.TOKEN_PROGRAM_ID.toBase58()),t.feePayer||(t.feePayer=me.Keypair.generate().publicKey)),e.push(Kr(t))}),console.log("simulate tx string:",e),e}function he(o,e,t){return de([o.toBuffer(),(t!=null?t:yi.TOKEN_PROGRAM_ID).toBuffer(),e.toBuffer()],new bi.PublicKey("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"))}var L=require("@solana/web3.js"),Ta=new L.PublicKey("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),Ba=new L.PublicKey("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),ha=new L.PublicKey("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),xa=new L.PublicKey("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),Ia=new L.PublicKey("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),Sa=new L.PublicKey("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),Ka=new L.PublicKey("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),Ca=new L.PublicKey("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),Na=new L.PublicKey("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),Ra=new L.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Cr=new L.PublicKey("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),Nr=new L.PublicKey("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),Rr=new L.PublicKey("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),La=new L.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Fa=new L.PublicKey("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),Ma=new L.PublicKey("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),Oa=new L.PublicKey("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),Ea=new L.PublicKey("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),va=new L.PublicKey("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),Da=new L.PublicKey("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),Wa=new L.PublicKey("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),Va=new L.PublicKey("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),_a=new L.PublicKey("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),qa=new L.PublicKey("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),Ga=new L.PublicKey("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),se=new L.PublicKey("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),Ua=new L.PublicKey("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),Xa=new L.PublicKey("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),za=new L.PublicKey("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),Ha=new L.PublicKey("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),ja=new L.PublicKey("6s1xP3hpbAfFoNtUNF8mfHsjr2Bd97JxFJRWLbL6aHuX");var Za={OPEN_BOOK_PROGRAM:new L.PublicKey("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),SERUM_PROGRAM_ID_V3:new L.PublicKey("Ray1111111111111111111111111111111111111111"),AMM_V4:new L.PublicKey("DRaya7Kj3aMWQSy19kSjvmuwq9docCHofyP9kanQGaav"),AMM_STABLE:new L.PublicKey("DRayDdXc1NZQ9C3hRWmoSf8zK4iapgMnjdNZWrfwsP8m"),CLMM_PROGRAM_ID:new L.PublicKey("DRayAUgENGQBKVaX8owNhgzkEDyoHTGVEGHVJT1E9pfH"),CLMM_LOCK_PROGRAM_ID:new L.PublicKey("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),CLMM_LOCK_AUTH_ID:new L.PublicKey("6Aoh8h2Lw2m5UGxYR8AdAL87jTWYeKoxM52mJRzfYwN"),CREATE_CPMM_POOL_PROGRAM:new L.PublicKey("DRaycpLY18LhpbydsBWbVJtxpNv9oXPgjRSfpF2bWpYb"),CREATE_CPMM_POOL_AUTH:new L.PublicKey("CXniRufdq5xL8t8jZAPxsPZDpuudwuJSPWnbcD5Y5Nxq"),CREATE_CPMM_POOL_FEE_ACC:new L.PublicKey("3oE58BKVt8KuYkGxx8zBojugnymWmBiyafWgMrnb6eYy"),LOCK_CPMM_PROGRAM:new L.PublicKey("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),LOCK_CPMM_AUTH:new L.PublicKey("7qWVV8UY2bRJfDLP4s37YzBPKUkVB46DStYJBpYbQzu3"),UTIL1216:L.PublicKey.default,Router:new L.PublicKey("DRaybByLpbUL57LJARs3j8BitTxVfzBg351EaMr5UTCd"),FARM_PROGRAM_ID_V3:new L.PublicKey("DRayWyrLmEW5KEeqs8kdTMMaBabapqagaBC7KWpGtJeZ"),FARM_PROGRAM_ID_V4:new L.PublicKey("Ray1111111111111111111111111111111111111111"),FARM_PROGRAM_ID_V5:new L.PublicKey("DRayiCGSZgku1GTK6rXD6mVDdingXy6APAH1R6R5L2LC"),FARM_PROGRAM_ID_V6:new L.PublicKey("DRayzbYakXs45ELHkzH6vC3fuhQqTAnv5A68gdFuvZyZ"),LAUNCHPAD_PROGRAM:new L.PublicKey("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),LAUNCHPAD_AUTH:new L.PublicKey("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),LAUNCHPAD_PLATFORM:new L.PublicKey("2Jx4KTDrVSdWNazuGpcA8n3ZLTRGGBDxAWhuKe2Xcj2a"),LAUNCHPAD_CONFIG:new L.PublicKey("7ZR4zD7PYfY2XxoG1Gxcy2EgEeGYrpxrwzPuwdUBssEt"),FEE_DESTINATION_ID:new L.PublicKey("9y8ENuuZ3b19quffx9hQvRVygG5ky6snHfRvGpuSfeJy"),MODEL_DATA_PUBKEY:new L.PublicKey("Ray1111111111111111111111111111111111111111")};var ae=U(require("bn.js")),wt=1e4;function mn(o,e){let{div:t,mod:n}=o.divmod(e);return n.gt(new ae.default(0))?t.add(new ae.default(1)):t}function Xe(o,e){if(o.isZero())return new ae.default(0);let t=o.div(e);return t.isZero()?new ae.default(1):o.mod(e).gt(new ae.default(0))?t.add(new ae.default(1)):t}function dn(o,e,t){if(e===void 0)return{amount:o,fee:void 0,expirationTime:void 0};let n=Math.floor(t/432e3),i=n<e.newerTransferFee.epoch?e.olderTransferFee:e.newerTransferFee,r=new ae.default(i.maximumFee.toString()),s=n<e.newerTransferFee.epoch?(Number(e.newerTransferFee.epoch)*432e3-t)*400/1e3:void 0,a=mn(o.mul(new ae.default(i.transferFeeBasisPoints)),new ae.default(wt)),c=a.gt(r)?r:a;return{amount:o,fee:c,expirationTime:s}}function pn(o,e,t){if(e===void 0)return{amount:o,fee:void 0,expirationTime:void 0};let n=Math.floor(t/432e3),i=n<e.newerTransferFee.epoch?e.olderTransferFee:e.newerTransferFee,r=new ae.default(i.maximumFee.toString()),s=n<e.newerTransferFee.epoch?(Number(e.newerTransferFee.epoch)*432e3-t)*400/1e3:void 0;if(i.transferFeeBasisPoints===wt){let a=new ae.default(i.maximumFee.toString());return{amount:o.add(a),fee:a,expirationTime:s}}else{let a=mn(o.mul(new ae.default(wt)),new ae.default(wt-i.transferFeeBasisPoints)),c=new ae.default(i.maximumFee.toString()),u=a.sub(o).gt(c)?o.add(c):a,d=mn(u.mul(new ae.default(i.transferFeeBasisPoints)),new ae.default(wt)),l=d.gt(r)?r:d;return{amount:u,fee:l,expirationTime:s}}}var gi=U(require("bn.js")),ze=new gi.default(1e6);var vt=require("@solana/spl-token"),fn=le("Raydium_accountInfo_util");async function kt(o,e,t){let{batchRequest:n,commitment:i="confirmed",chunkCount:r=100}=_({batchRequest:!1},t),s=ln(e,r),a=new Array(s.length).fill([]);if(n){let c=s.map(l=>{let w=o._buildArgs([l.map(g=>g.toBase58())],i,"base64");return{methodName:"getMultipleAccounts",args:w}}),u=ln(c,10);a=(await(await Promise.all(u.map(async l=>await o._rpcBatchRequest(l)))).flat()).map(l=>(l.error&&fn.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${l.error.message}`),l.result.value.map(w=>{if(w){let{data:g,executable:m,lamports:f,owner:y,rentEpoch:T}=w;return g.length!==2&&g[1]!=="base64"&&fn.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(g[0],"base64"),executable:m,lamports:f,owner:new Ai.PublicKey(y),rentEpoch:T}}return null})))}else try{a=await Promise.all(s.map(c=>o.getMultipleAccountsInfo(c,i)))}catch(c){c instanceof Error&&fn.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${c.message}`)}return a.flat()}async function Le(o,e,t){let n=await kt(o,e.map(i=>i.pubkey),t);return e.map((i,r)=>j(_({},i),{accountInfo:n[r]}))}async function bn({connection:o,address:e,cluster:t="mainnet"}){let n=await kt(o,[...new Set(e.map(r=>r.toString()))].map(r=>new xe.PublicKey(r))),i={};for(let r=0;r<e.length;r++){let s=n[r],a=e[r];if(!s)continue;let c=new xe.AddressLookupTableAccount({key:a,state:xe.AddressLookupTableAccount.deserialize(s.data)});i[a.toString()]=c,t==="devnet"?$e[a.toString()]=c:Dt[a.toString()]=c}return i}var Dt={AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU:new xe.AddressLookupTableAccount({key:new xe.PublicKey("AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU"),state:xe.AddressLookupTableAccount.deserialize(Buffer.from("AQAAAP//////////I1rcEwAAAAAvAQYwun9CU6c5Ikm2pAj+D9IEnCOR45nK+SFTGSdpd6J6AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbd9uHXZaGT2cvhRs7reawctIXtX1s3kTqM9YV+/wCpBt324e51j94YQl285GzN2rYa/E2DuQ0n/r35KNihi/wFSlNQ+F3IgtYUpVZyeIopbd8eq6vQpgZ4iEky9O72oAVKU1qZKSEGTSTocWDaOHx8NbXdvJK7geQfqEBBBUSNBqfVFxksXFEhjMlMPUrxf1ja7gibof1E49vZigAAAAAGp9UXGMd0yShWY5hpHV62i164o5tLbVxzVVshAAAAAIyXJY9OJInxuz0QKRSODYMLWhOZ2v8QhASOe9jb6fhZC3BlsePRfEU4nVJ/awTDzVi4bHMaoP21SbbRvAP4KUbIScv+6Yw2LHF/6K0ZjUPibbSWXCirYPGuuVl7zT789IUPLW4CpHr4JNCatp3ELXDLKMv6JJ+37le50lbBJ2LvBkX2T9y7AHdNGviJAqQNtlDUDCnauQRWybsLji6nPM8Qkw5asQRvCdB3MbX6IEBwytOrpM32l4jQygKG9TKgR0vZScQ2AsM/IHeQ7RajUkyhuZdc8SGiqQz/7H34torNR/Wir3sl0ruUrVxJWEZfUg+QLNAxxODdBi53/OP7Ioil1cqeBM9dtZC3FLov4yyxWRM/wcGStyJX/QfTnLBAHqkqWotPKVlShCVQqpP9W5W1rOao65IMk5QuQ2kMIOxzDMKAy2vjGSxQODgBz0QwGA+eP4ZjIjrIAQaXENv31QfLlOdXSRCkaybRniDHF4C8YcwhcvsqrOVuTP4B2Na+9wLdtrB31uz2rtlFI5kahdsnp/d1SrASDInYCtTYtdoke4kX+hoKWcEWM4Tle8pTUkUVv4BxS6fje/EzKBE4Qu/YsA/yfEEFGcr8Z57VKDw8uQzpiru7g4lvjnfapW62W030syevD8k07SGoxUHiuT/ai7gAHWWhDsVmg/C63ajgpkH7Sn3GdutArDTfyqOkdqv4/IPC/EFFy7mGkfDd2C57N5a/4jC+BbmJy7wQaSEZr0CQU88lPtUxIVvzGjC95b8Ooss2TqmkrayGKofkPMGQn7Ux+9lfwBSNfxwH8NgbpqC/7LNlV4I7nCvsXf3p+ohQk9NrAJb2KAFpUqEIJ9ZBV7BYDzHF/ORKYlgtvPnXjudZQ6CEo5OzUDaNIomTCCsvhD16TxJjsbgne1kGnQPCFSoaxUbq2V1bPMFQ3VYP6wDZ9bKStCFKx9A3tNbwZFC5ZGAN83MFK7XoTy+OmmcFEr6rLOjfSuTfPvHJkSVxW6Qllwkl67XcBi5v00u2gQsbu+38sp+rd5pA/LvyWj4P94ZGZwc1tE2P88xekCLcAwZGb+UhFzL/7K26csOb57yM5bvF9xJrLEObOkAAAAAn+HWRkdcPKyFFMnVwEoD7vnD0jCKFIU1sImubYCxNTSVzsKpaQX+fzNxrLAI3L14JQnJx/D6Uk2LADIHGqnGELzjEbkBDAlaM77NkXMPfqXNLSveCkWI7UEgNs31WEWB6XHSYI/v5DklHOb4QTtDOR804PVbi3fjloZeLR2F8d4FuZmMMO7ck3Fnkn2zEMG5gOmqsygb6PjTitArVl52NhcSznTxVnguaIJxiZkAnurDmn3MWR0PC2GLghp2KJqHCc6QQ85odeIjFHKOlRlJyeSXVJmL8vb1UgOzsbJPVP8p6zM4M3C1Sd7uWIHP33G42AP2Zg8ucn/n6meQjjD266JgCWdxZD6PXs9CsnIeL7SSG0/6lGb9xfP0ZcWkCXB/3hjxHYVXjra/GPOeXGk0fLLKjCbk+mgs2w6d2oCwimBipTzuoZ30GiI8ij8VRzD5CzMWtu2m21eDBIfjGAEo4pQeNNonKcqzV/cleX8ySZLOHsz8PtBCrLqF+VkLm9hOzIT+6i/nIf6keR4GWKMOD4AvqfpjHoD4DuhBpz8P28+DxkGrDXXr/nr20x291VPvcTU/b+b+o2kC9G0kcXeTlLjU6a2TQXWlZ4gBUdBl1jgT7mObSTpLblNiXZsLkbmVXZwvFKXua5cUKlWed/w30skmEUraTuQqtqr5fHZPW9n57EmeTif6LjHL2YJFZkQU+TrJmFzqzmF4/b8OwrPQAprl8mX3q4LUIdAS/a+11B6DWD1Xk2++Sn94dLC4xjkO4Wtlw8c4XuzciVbepHOmnoWzVu/0y3KCrLCSfQxQ3br8DJCoVzhgtPsS2nZZjsBGIZgnU0QpMv+2MnRsnKwdp1VsrCX84j/qvaZn4WhKunippgTbN2EUs0tPTP55Qfgj+nKmjtWW5IYs72FrEwJKYoNfsmqaF4o5pf4v9zgPwVwY/5I4XJKUL2L25m9kAQcW/K+H1RTFEUoj8Z4ajpOmAB/dG0COmCphVMW2CCMvnxhcGiSgPnpDuWu6qiJ7NG7ye5kvHgefgqPLeicspNJ5EpL3XiRNLM2tmJLI1awAwOyd6iHv0dCkMYRKaa6rcaZeYwmKCkckm0kM2JNmnmmAaBQQ7mwmIM0IMxX4f5W6j9PqZWcJxF7r17T/lQBAmcjoupRiJifbnXCNUv9GhpRF19WcBdeKbivRJVlGop6I2RS6lGImJ9udcI1S/0aGlEXX1ZwF14puK9ElWUainojZFYVHLHD6dIP2ESjqBzg3ol1/wB7+/ylGwd9LS7wSZ2A630CJSVKwH47K9P4bB8PEQP8BwjMFa7xQHOqZFP1XqaQ==","base64"))})},$e={},yn=async o=>{let e="EFhMuDw1PKEuckuFRW9PavNfTH4LKP5uKHgyXDmWpFCq";if($e[e])return $e;let t=new xe.PublicKey(e),n=await o.getAccountInfo(t);return n&&($e[e]=new xe.AddressLookupTableAccount({key:t,state:xe.AddressLookupTableAccount.deserialize(n.data)})),$e};var Wt=2e3,Vt=class{constructor(e){this.instructions=[];this.endInstructions=[];this.lookupTableAddress=[];this.signers=[];this.instructionTypes=[];this.endInstructionTypes=[];this.connection=e.connection,this.feePayer=e.feePayer,this.signAllTransactions=e.signAllTransactions,this.owner=e.owner,this.cluster=e.cluster,this.blockhashCommitment=e.blockhashCommitment,this.loopMultiTxStatus=!!e.loopMultiTxStatus}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers,instructionTypes:this.instructionTypes,endInstructionTypes:this.endInstructionTypes,lookupTableAddress:this.lookupTableAddress}}get allInstructions(){return[...this.instructions,...this.endInstructions]}async getComputeBudgetConfig(){var n;let e=(await ki.default.get(`https://solanacompass.com/api/fees?cacheFreshTime=${3e5}`)).data,{avg:t}=(n=e==null?void 0:e[15])!=null?n:{};if(!!t)return{units:6e5,microLamports:Math.min(Math.ceil(t*1e6/6e5),25e3)}}addCustomComputeBudget(e){if(e){let{instructions:t,instructionTypes:n}=Ot(e);return this.instructions.unshift(...t),this.instructionTypes.unshift(...n),!0}return!1}addTipInstruction(e){var t;return e?(this.endInstructions.push(H.SystemProgram.transfer({fromPubkey:(t=e.feePayer)!=null?t:this.feePayer,toPubkey:new H.PublicKey(e.address),lamports:BigInt(e.amount.toString())})),this.endInstructionTypes.push(Ge.TransferTip),!0):!1}async calComputeBudget({config:e,defaultIns:t}){try{let n=e||await this.getComputeBudgetConfig();if(this.addCustomComputeBudget(n))return;t&&this.instructions.unshift(...t)}catch{t&&this.instructions.unshift(...t)}}addInstruction({instructions:e=[],endInstructions:t=[],signers:n=[],instructionTypes:i=[],endInstructionTypes:r=[],lookupTableAddress:s=[]}){return this.instructions.push(...e),this.endInstructions.push(...t),this.signers.push(...n),this.instructionTypes.push(...i),this.endInstructionTypes.push(...r),this.lookupTableAddress.push(...s.filter(a=>a!==H.PublicKey.default.toString())),this}async versionBuild({txVersion:e,extInfo:t}){return e===0?await this.buildV0(_({},t||{})):this.build(t)}build(e){var n;let t=new H.Transaction;return this.allInstructions.length&&t.add(...this.allInstructions),t.feePayer=this.feePayer,((n=this.owner)==null?void 0:n.signer)&&!this.signers.some(i=>i.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer),{builder:this,transaction:t,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async i=>{var d;let{recentBlockHash:r,skipPreflight:s=!0,sendAndConfirm:a,notSendToRpc:c}=i||{},u=r!=null?r:await Je(this.connection,this.blockhashCommitment);if(t.recentBlockhash=u,this.signers.length&&t.sign(...this.signers),Ue([t]),(d=this.owner)!=null&&d.isKeyPair)return{txId:a?await(0,H.sendAndConfirmTransaction)(this.connection,t,this.signers.find(w=>w.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:s}):await this.connection.sendRawTransaction(t.serialize(),{skipPreflight:s}),signedTx:t};if(this.signAllTransactions){let l=await this.signAllTransactions([t]);if(this.signers.length)for(let w of l)try{w.sign(...this.signers)}catch{}return{txId:c?"":await this.connection.sendRawTransaction(l[0].serialize(),{skipPreflight:s}),signedTx:l[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:e||{}}}buildMultiTx(e){var u;let{extraPreBuildData:t=[],extInfo:n}=e,{transaction:i}=this.build(n),r=t.filter(d=>d.transaction.instructions.length>0),s=[i,...r.map(d=>d.transaction)],a=[this.signers,...r.map(d=>d.signers)],c=[...this.instructionTypes,...r.map(d=>d.instructionTypes).flat()];return(u=this.owner)!=null&&u.signer&&a.forEach(d=>{d.some(l=>l.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),{builder:this,transactions:s,signers:a,instructionTypes:c,execute:async d=>{var T;let{sequentially:l,onTxUpdate:w,skipTxCount:g=0,recentBlockHash:m,skipPreflight:f=!0}=d||{},y=m!=null?m:await Je(this.connection,this.blockhashCommitment);if((T=this.owner)!=null&&T.isKeyPair){if(l){let P=[],x=0;for(let k of s){if(++x,x<=g)continue;let b=await(0,H.sendAndConfirmTransaction)(this.connection,k,this.signers.find(A=>A.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:f});P.push(b)}return{txIds:P,signedTxs:s}}return{txIds:await await Promise.all(s.map(async P=>(P.recentBlockhash=y,await this.connection.sendRawTransaction(P.serialize(),{skipPreflight:f})))),signedTxs:s}}if(this.signAllTransactions){let P=s.map((k,b)=>(k.recentBlockhash=y,a[b].length&&k.sign(...a[b]),k));Ue(P);let x=await this.signAllTransactions(P);if(l){let k=0,b=[],A=async()=>{if(!x[k])return;let K=await this.connection.sendRawTransaction(x[k].serialize(),{skipPreflight:f});b.push({txId:K,status:"sent",signedTx:x[k]}),w==null||w([...b]),k++;let B=!1,C=null,N=null,h=G=>{C!==null&&clearInterval(C),N!==null&&this.connection.removeSignatureListener(N);let q=b.findIndex(O=>O.txId===K);if(q>-1){if(b[q].status==="error"||b[q].status==="success")return;b[q].status=G.err?"error":"success"}w==null||w([...b]),G.err||A()};this.loopMultiTxStatus&&(C=setInterval(async()=>{var G;if(B){clearInterval(C);return}try{let q=await this.connection.getTransaction(K,{commitment:"confirmed",maxSupportedTransactionVersion:0});q&&(B=!0,clearInterval(C),h({err:((G=q.meta)==null?void 0:G.err)||null}),console.log("tx status from getTransaction:",K))}catch(q){B=!0,clearInterval(C),console.error("getTransaction timeout:",q,K)}},Wt)),N=this.connection.onSignature(K,G=>{if(B){this.connection.removeSignatureListener(N);return}B=!0,h(G)},"confirmed"),this.connection.getSignatureStatus(K)};return await A(),{txIds:b.map(K=>K.txId),signedTxs:x}}else{let k=[];for(let b=0;b<x.length;b+=1){let A=await this.connection.sendRawTransaction(x[b].serialize(),{skipPreflight:f});k.push(A)}return{txIds:k,signedTxs:x}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:n||{}}}async versionMultiBuild({extraPreBuildData:e,txVersion:t,extInfo:n}){return t===0?await this.buildV0MultiTx({extraPreBuildData:e,buildProps:n||{}}):this.buildMultiTx({extraPreBuildData:e,extInfo:n})}async buildV0(e){var f;let m=e||{},{lookupTableCache:t={},lookupTableAddress:n=[],forerunCreate:i,recentBlockhash:r}=m,s=qe(m,["lookupTableCache","lookupTableAddress","forerunCreate","recentBlockhash"]),a=_(_({},this.cluster==="devnet"?await yn(this.connection):Dt),t),c=Array.from(new Set([...n,...this.lookupTableAddress])),u=[];for(let y of c)a[y]===void 0&&u.push(new H.PublicKey(y));let d=await bn({connection:this.connection,address:u});for(let[y,T]of Object.entries(d))a[y]=T;let l=i?H.PublicKey.default.toBase58():r!=null?r:await Je(this.connection,this.blockhashCommitment),w=new H.TransactionMessage({payerKey:this.feePayer,recentBlockhash:l,instructions:[...this.allInstructions]}).compileToV0Message(Object.values(a));((f=this.owner)==null?void 0:f.signer)&&!this.signers.some(y=>y.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer);let g=new H.VersionedTransaction(w);return g.sign(this.signers),{builder:this,transaction:g,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async y=>{var k;let{skipPreflight:T=!0,sendAndConfirm:P,notSendToRpc:x}=y||{};if(Ue([g]),(k=this.owner)!=null&&k.isKeyPair){let b=await this.connection.sendTransaction(g,{skipPreflight:T});return P&&await Et(this.connection,b),{txId:b,signedTx:g}}if(this.signAllTransactions){let b=await this.signAllTransactions([g]);if(this.signers.length)for(let A of b)try{A.sign(this.signers)}catch{}return{txId:x?"":await this.connection.sendTransaction(b[0],{skipPreflight:T}),signedTx:b[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:s||{}}}async buildV0MultiTx(e){var u;let{extraPreBuildData:t=[],buildProps:n}=e,{transaction:i}=await this.buildV0(n),r=t.filter(d=>d.builder.instructions.length>0),s=[i,...r.map(d=>d.transaction)],a=[this.signers,...r.map(d=>d.signers)],c=[...this.instructionTypes,...r.map(d=>d.instructionTypes).flat()];return(u=this.owner)!=null&&u.signer&&a.forEach(d=>{d.some(l=>l.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),s.forEach(async(d,l)=>{d.sign(a[l])}),{builder:this,transactions:s,signers:a,instructionTypes:c,buildProps:n,execute:async d=>{var f;let{sequentially:l,onTxUpdate:w,recentBlockHash:g,skipPreflight:m=!0}=d||{};if(g&&s.forEach(y=>y.message.recentBlockhash=g),Ue(s),(f=this.owner)!=null&&f.isKeyPair){if(l){let y=[];for(let T of s){let P=await this.connection.sendTransaction(T,{skipPreflight:m});await Et(this.connection,P),y.push(P)}return{txIds:y,signedTxs:s}}return{txIds:await Promise.all(s.map(async y=>await this.connection.sendTransaction(y,{skipPreflight:m}))),signedTxs:s}}if(this.signAllTransactions){let y=await this.signAllTransactions(s);if(l){let T=0,P=[],x=async()=>{if(!y[T])return;let k=await this.connection.sendTransaction(y[T],{skipPreflight:m});P.push({txId:k,status:"sent",signedTx:y[T]}),w==null||w([...P]),T++;let b=!1,A=null,K=null,B=C=>{A!==null&&clearInterval(A),K!==null&&this.connection.removeSignatureListener(K);let N=P.findIndex(h=>h.txId===k);if(N>-1){if(P[N].status==="error"||P[N].status==="success")return;P[N].status=C.err?"error":"success"}w==null||w([...P]),C.err||x()};this.loopMultiTxStatus&&(A=setInterval(async()=>{var C;if(b){clearInterval(A);return}try{let N=await this.connection.getTransaction(k,{commitment:"confirmed",maxSupportedTransactionVersion:0});N&&(b=!0,clearInterval(A),B({err:((C=N.meta)==null?void 0:C.err)||null}),console.log("tx status from getTransaction:",k))}catch(N){b=!0,clearInterval(A),console.error("getTransaction timeout:",N,k)}},Wt)),K=this.connection.onSignature(k,C=>{if(b){this.connection.removeSignatureListener(K);return}b=!0,B(C)},"confirmed"),this.connection.getSignatureStatus(k)};return x(),{txIds:[],signedTxs:y}}else{let T=[];for(let P=0;P<y.length;P+=1){let x=await this.connection.sendTransaction(y[P],{skipPreflight:m});T.push(x)}return{txIds:T,signedTxs:y}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:n||{}}}async sizeCheckBuild(e){var w;let l=e||{},{splitIns:t=[],computeBudgetConfig:n}=l,i=qe(l,["splitIns","computeBudgetConfig"]),r=n?Ot(n):{instructions:[],instructionTypes:[]},s=this.signers.reduce((g,m)=>j(_({},g),{[m.publicKey.toBase58()]:m}),{}),a=[],c=[],u=[],d=0;if(this.allInstructions.forEach(g=>{let m=[...u,g],f=n?[...r.instructions,...m]:m,T=[...new Set(m.map(P=>P.keys.filter(x=>x.isSigner).map(x=>x.pubkey.toString())).flat()).values()].map(P=>new H.PublicKey(P));if(g!==t[d]&&u.length<12&&(Pt({instructions:f,payer:this.feePayer,signers:T})||Pt({instructions:m,payer:this.feePayer,signers:T})))u.push(g);else{if(u.length===0)throw Error("item ins too big");d+=g===t[d]?1:0,Pt({instructions:n?[...r.instructions,...u]:[...u],payer:this.feePayer,signers:T})?a.push(new H.Transaction().add(...r.instructions,...u)):a.push(new H.Transaction().add(...u)),c.push(Array.from(new Set(u.map(P=>P.keys.filter(x=>x.isSigner).map(x=>x.pubkey.toString())).flat())).map(P=>s[P]).filter(P=>P!==void 0)),u=[g]}}),u.length>0){let m=[...new Set(u.map(f=>f.keys.filter(y=>y.isSigner).map(y=>y.pubkey.toString())).flat()).values()].map(f=>s[f]).filter(f=>f!==void 0);Pt({instructions:n?[...r.instructions,...u]:[...u],payer:this.feePayer,signers:m.map(f=>f.publicKey)})?a.push(new H.Transaction().add(...r.instructions,...u)):a.push(new H.Transaction().add(...u)),c.push(m)}return a.forEach(g=>g.feePayer=this.feePayer),(w=this.owner)!=null&&w.signer&&c.forEach(g=>{g.some(m=>m.publicKey.equals(this.owner.publicKey))||g.push(this.owner.signer)}),{builder:this,transactions:a,signers:c,instructionTypes:this.instructionTypes,execute:async g=>{var k;let{sequentially:m,onTxUpdate:f,skipTxCount:y=0,recentBlockHash:T,skipPreflight:P=!0}=g||{},x=T!=null?T:await Je(this.connection,this.blockhashCommitment);if(a.forEach(async(b,A)=>{b.recentBlockhash=x,c[A].length&&b.sign(...c[A])}),Ue(a),(k=this.owner)!=null&&k.isKeyPair){if(m){let b=0,A=[];for(let K of a){if(++b,b<=y){A.push("tx skipped");continue}let B=await(0,H.sendAndConfirmTransaction)(this.connection,K,this.signers.find(C=>C.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:P});A.push(B)}return{txIds:A,signedTxs:a}}return{txIds:await Promise.all(a.map(async b=>await this.connection.sendRawTransaction(b.serialize(),{skipPreflight:P}))),signedTxs:a}}if(this.signAllTransactions){let b=await this.signAllTransactions(a.slice(y,a.length)),A=[...a.slice(0,y),...b];if(m){let K=0,B=[],C=async()=>{if(!A[K])return;K<y&&(B.push({txId:"",status:"success",signedTx:A[K]}),f==null||f([...B]),K++,C());let N=await this.connection.sendRawTransaction(A[K].serialize(),{skipPreflight:P});B.push({txId:N,status:"sent",signedTx:A[K]}),f==null||f([...B]),K++;let h=!1,G=null,q=null,O=I=>{G!==null&&clearInterval(G),q!==null&&this.connection.removeSignatureListener(q);let V=B.findIndex(Y=>Y.txId===N);if(V>-1){if(B[V].status==="error"||B[V].status==="success")return;B[V].status=I.err?"error":"success"}f==null||f([...B]),I.err||C()};this.loopMultiTxStatus&&(G=setInterval(async()=>{var I;if(h){clearInterval(G);return}try{let V=await this.connection.getTransaction(N,{commitment:"confirmed",maxSupportedTransactionVersion:0});V&&(h=!0,clearInterval(G),O({err:((I=V.meta)==null?void 0:I.err)||null}),console.log("tx status from getTransaction:",N))}catch(V){h=!0,clearInterval(G),console.error("getTransaction timeout:",V,N)}},Wt)),q=this.connection.onSignature(N,I=>{if(h){this.connection.removeSignatureListener(q);return}h=!0,O(I)},"confirmed"),this.connection.getSignatureStatus(N)};return await C(),{txIds:B.map(N=>N.txId),signedTxs:A}}else{let K=[];for(let B=0;B<A.length;B+=1){let C=await this.connection.sendRawTransaction(A[B].serialize(),{skipPreflight:P});K.push(C)}return{txIds:K,signedTxs:A}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:i||{}}}async sizeCheckBuildV0(e){var x;let P=e||{},{computeBudgetConfig:t,splitIns:n=[],lookupTableCache:i={},lookupTableAddress:r=[]}=P,s=qe(P,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),a=_(_({},this.cluster==="devnet"?await yn(this.connection):Dt),i),c=Array.from(new Set([...this.lookupTableAddress,...r])),u=[];for(let k of c)a[k]===void 0&&u.push(new H.PublicKey(k));let d=await bn({connection:this.connection,address:u});for(let[k,b]of Object.entries(d))a[k]=b;let l=t?Ot(t):{instructions:[],instructionTypes:[]},w=await Je(this.connection,this.blockhashCommitment),g=this.signers.reduce((k,b)=>j(_({},k),{[b.publicKey.toBase58()]:b}),{}),m=[],f=[],y=[],T=0;if(this.allInstructions.forEach(k=>{let b=[...y,k],A=t?[...l.instructions,...b]:b;if(k!==n[T]&&y.length<12&&(At({instructions:A,payer:this.feePayer,lookupTableAddressAccount:a})||At({instructions:b,payer:this.feePayer,lookupTableAddressAccount:a})))y.push(k);else{if(y.length===0)throw Error("item ins too big");T+=k===n[T]?1:0;let K={};for(let B of[...new Set(c)])a[B]!==void 0&&(K[B]=a[B]);if(t&&At({instructions:[...l.instructions,...y],payer:this.feePayer,lookupTableAddressAccount:a,recentBlockhash:w})){let B=new H.TransactionMessage({payerKey:this.feePayer,recentBlockhash:w,instructions:[...l.instructions,...y]}).compileToV0Message(Object.values(a));m.push(new H.VersionedTransaction(B))}else{let B=new H.TransactionMessage({payerKey:this.feePayer,recentBlockhash:w,instructions:[...y]}).compileToV0Message(Object.values(a));m.push(new H.VersionedTransaction(B))}f.push(Array.from(new Set(y.map(B=>B.keys.filter(C=>C.isSigner).map(C=>C.pubkey.toString())).flat())).map(B=>g[B]).filter(B=>B!==void 0)),y=[k]}}),y.length>0){let b=[...new Set(y.map(A=>A.keys.filter(K=>K.isSigner).map(K=>K.pubkey.toString())).flat()).values()].map(A=>g[A]).filter(A=>A!==void 0);if(t&&At({instructions:[...l.instructions,...y],payer:this.feePayer,lookupTableAddressAccount:a,recentBlockhash:w})){let A=new H.TransactionMessage({payerKey:this.feePayer,recentBlockhash:w,instructions:[...l.instructions,...y]}).compileToV0Message(Object.values(a));m.push(new H.VersionedTransaction(A))}else{let A=new H.TransactionMessage({payerKey:this.feePayer,recentBlockhash:w,instructions:[...y]}).compileToV0Message(Object.values(a));m.push(new H.VersionedTransaction(A))}f.push(b)}return(x=this.owner)!=null&&x.signer&&f.forEach(k=>{k.some(b=>b.publicKey.equals(this.owner.publicKey))||k.push(this.owner.signer)}),m.forEach((k,b)=>{k.sign(f[b])}),{builder:this,transactions:m,buildProps:e,signers:f,instructionTypes:this.instructionTypes,execute:async k=>{var N;let{sequentially:b,onTxUpdate:A,skipTxCount:K=0,recentBlockHash:B,skipPreflight:C=!0}=k||{};if(m.map(async(h,G)=>{f[G].length&&h.sign(f[G]),B&&(h.message.recentBlockhash=B)}),Ue(m),(N=this.owner)!=null&&N.isKeyPair){if(b){let h=0,G=[];for(let q of m){if(++h,h<=K){console.log("skip tx: ",h),G.push("tx skipped");continue}let O=await this.connection.sendTransaction(q,{skipPreflight:C});await Et(this.connection,O),G.push(O)}return{txIds:G,signedTxs:m}}return{txIds:await Promise.all(m.map(async h=>await this.connection.sendTransaction(h,{skipPreflight:C}))),signedTxs:m}}if(this.signAllTransactions){let h=await this.signAllTransactions(m.slice(K,m.length)),G=[...m.slice(0,K),...h];if(b){let q=0,O=[],I=async()=>{if(!G[q])return;if(q<K){O.push({txId:"",status:"success",signedTx:G[q]}),A==null||A([...O]),q++,I();return}let V=await this.connection.sendTransaction(G[q],{skipPreflight:C});O.push({txId:V,status:"sent",signedTx:G[q]}),A==null||A([...O]),q++;let Y=!1,J=null,Q=null,ie=oe=>{J!==null&&clearInterval(J),Q!==null&&this.connection.removeSignatureListener(Q);let ne=O.findIndex(re=>re.txId===V);if(ne>-1){if(O[ne].status==="error"||O[ne].status==="success")return;O[ne].status=oe.err?"error":"success"}A==null||A([...O]),oe.err||I()};this.loopMultiTxStatus&&(J=setInterval(async()=>{var oe;if(Y){clearInterval(J);return}try{let ne=await this.connection.getTransaction(V,{commitment:"confirmed",maxSupportedTransactionVersion:0});ne&&(Y=!0,clearInterval(J),ie({err:((oe=ne.meta)==null?void 0:oe.err)||null}),console.log("tx status from getTransaction:",V))}catch(ne){Y=!0,clearInterval(J),console.error("getTransaction timeout:",ne,V)}},Wt)),Q=this.connection.onSignature(V,oe=>{if(Y){this.connection.removeSignatureListener(Q);return}Y=!0,ie(oe)},"confirmed"),this.connection.getSignatureStatus(V)};return I(),{txIds:[],signedTxs:G}}else{let q=[];for(let O=0;O<G.length;O+=1){let I=await this.connection.sendTransaction(G[O],{skipPreflight:C});q.push(I)}return{txIds:q,signedTxs:G}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:s||{}}}};var gn=(...o)=>o.map(e=>{try{return typeof e=="object"?JSON.stringify(e):e}catch{return e}}).join(", "),et=class{constructor({scope:e,moduleName:t}){this.disabled=!1;this.scope=e,this.logger=le(t)}createTxBuilder(e){return this.scope.checkOwner(),new Vt({connection:this.scope.connection,feePayer:e||this.scope.ownerPubKey,cluster:this.scope.cluster,owner:this.scope.owner,blockhashCommitment:this.scope.blockhashCommitment,loopMultiTxStatus:this.scope.loopMultiTxStatus,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}logDebug(...e){this.logger.debug(gn(e))}logInfo(...e){this.logger.info(gn(e))}logAndCreateError(...e){let t=gn(e);throw new Error(t)}checkDisabled(){(this.disabled||!this.scope)&&this.logAndCreateError("module not working")}};var co=require("@solana/web3.js"),lo=U(require("bn.js")),mo=U(require("decimal.js"));var Gt=require("@solana/spl-token");var Lr=require("@solana/web3.js"),Ti=require("@solana/spl-token");var qt=require("@solana/web3.js"),uo=U(require("bn.js"));var Nn=require("@solana/spl-token");var Ki=require("@solana/web3.js"),tt=U(require("bn.js"));var F=require("@solana/buffer-layout"),Pn=F.Layout,Bi=F.Structure;var An=F.UInt;var hi=F.u8,Fe=F.u16;var xi=F.u32;var Me=F.s32;var Ii=F.seq;var fe=F.blob;var Si=F.offset;var nt=class extends Pn{constructor(t,n,i){super(t,i);this.blob=fe(t),this.signed=n}decode(t,n=0){let i=new tt.default(this.blob.decode(t,n),10,"le");return this.signed?i.fromTwos(this.span*8).clone():i}encode(t,n,i=0){return typeof t=="number"&&(t=new tt.default(t)),this.signed&&(t=t.toTwos(this.span*8)),this.blob.encode(t.toArrayLike(Buffer,"le",this.span),n,i)}};function v(o){return new An(1,o)}function rt(o){return new An(4,o)}function p(o){return new nt(8,!1,o)}function te(o){return new nt(16,!1,o)}function Ci(o){return new nt(8,!0,o)}function Ni(o){return new nt(16,!0,o)}var it=class extends Pn{constructor(t,n,i,r){super(t.span,r);this.layout=t,this.decoder=n,this.encoder=i}decode(t,n){return this.decoder(this.layout.decode(t,n))}encode(t,n,i){return this.layout.encode(this.encoder(t),n,i)}getSpan(t,n){return this.layout.getSpan(t,n)}};function M(o){return new it(fe(32),e=>new Ki.PublicKey(e),e=>e.toBuffer(),o)}function kn(o){return new it(hi(),Fr,Mr,o)}function Fr(o){if(o===0)return!1;if(o===1)return!0;throw new Error("Invalid bool: "+o)}function Mr(o){return o?1:0}function Or(o){let e=xi("length"),t=D([e,fe(Si(e,-e.span),"data")]);return new it(t,({data:n})=>n,n=>({data:n}),o)}function be(o){return new it(Or(),e=>e.toString("utf-8"),e=>Buffer.from(e,"utf-8"),o)}var wn=class extends Bi{decode(e,t){return super.decode(e,t)}};function D(o,e,t){return new wn(o,e,t)}function X(o,e,t){let n,i=typeof e=="number"?e:(0,tt.isBN)(e)?e.toNumber():new Proxy(e,{get(r,s){if(!n){let a=Reflect.get(r,"count");n=(0,tt.isBN)(a)?a.toNumber():a,Reflect.set(r,"count",n)}return Reflect.get(r,s)},set(r,s,a){return s==="count"&&(n=a),Reflect.set(r,s,a)}});return Ii(o,i,t)}var Qr=U(require("bn.js")),Yr=U(require("decimal.js"));var ge=U(require("bn.js")),Tn=new ge.default(0),Ri=new ge.default(1),Li=new ge.default(-1),Ne=new ge.default(1).shln(64),Fi=new ge.default(1).shln(128),Bn=Ne.sub(Ri);var Er=Fi.subn(1),ot=-443636,Tt=-ot,hn=new ge.default("4295048016"),xn=new ge.default("79226673521066979257578248091"),nc=new ge.default("4295048017"),ic=new ge.default("79226673521066979257578248090");var vr=new ge.default(10).pow(new ge.default(6));var rc=new ge.default("18446744073700000000");var jr=U(require("bn.js")),Zr=U(require("decimal.js"));var lc=Buffer.from("amm_config","utf8"),Mi=Buffer.from("pool","utf8"),Oi=Buffer.from("pool_vault","utf8"),mc=Buffer.from("pool_reward_vault","utf8"),dc=Buffer.from("position","utf8"),pc=Buffer.from("tick_array","utf8"),fc=Buffer.from("operation","utf8"),bc=Buffer.from("pool_tick_array_bitmap_extension","utf8"),yc=Buffer.from("observation","utf8");function In(o){return de([Buffer.from("metadata","utf8"),Ye.toBuffer(),o.toBuffer()],Ye)}var gc=Buffer.from("locked_position","utf8");var Pc=Buffer.from("support_mint","utf8");var Gr=require("@solana/web3.js"),Ur=require("@solana/spl-token"),Xr=U(require("bn.js")),zr=U(require("decimal.js"));var Wr=U(require("bn.js")),Vr=U(require("decimal.js"));var Cn=14;var _t=60;var Jr=D([fe(8),v("bump"),Fe("index"),M(""),rt("protocolFeeRate"),rt("tradeFeeRate"),Fe("tickSpacing"),X(p(),8,"")]),$r=D([rt("blockTimestamp"),Ci("tickCumulative"),X(p(),4)]),Xi=D([fe(8),kn("initialized"),p("recentEpoch"),Fe("observationIndex"),M("poolId"),X($r,100,"observations"),X(p(),4)]),eo=D([v("rewardState"),p("openTime"),p("endTime"),p("lastUpdateTime"),te("emissionsPerSecondX64"),p("rewardTotalEmissioned"),p("rewardClaimed"),M("tokenMint"),M("tokenVault"),M("creator"),te("rewardGrowthGlobalX64")]),qi=D([fe(8),v("bump"),M("ammConfig"),M("creator"),M("mintA"),M("mintB"),M("vaultA"),M("vaultB"),M("observationId"),v("mintDecimalsA"),v("mintDecimalsB"),Fe("tickSpacing"),te("liquidity"),te("sqrtPriceX64"),Me("tickCurrent"),rt(),te("feeGrowthGlobalX64A"),te("feeGrowthGlobalX64B"),p("protocolFeesTokenA"),p("protocolFeesTokenB"),te("swapInAmountTokenA"),te("swapOutAmountTokenB"),te("swapInAmountTokenB"),te("swapOutAmountTokenA"),v("status"),X(v(),7,""),X(eo,3,"rewardInfos"),X(p(),16,"tickArrayBitmap"),p("totalFeesTokenA"),p("totalFeesClaimedTokenA"),p("totalFeesTokenB"),p("totalFeesClaimedTokenB"),p("fundFeesTokenA"),p("fundFeesTokenB"),p("startTime"),X(p(),15*4-3,"padding")]),to=D([te("growthInsideLastX64"),p("rewardAmountOwed")]),Gi=D([fe(8),v("bump"),M("nftMint"),M("poolId"),Me("tickLower"),Me("tickUpper"),te("liquidity"),te("feeGrowthInsideLastX64A"),te("feeGrowthInsideLastX64B"),p("tokenFeesOwedA"),p("tokenFeesOwedB"),X(to,3,"rewardInfos"),X(p(),8,"")]),Rl=D([fe(8),v("bump"),M("poolId"),Me("tickLowerIndex"),Me("tickUpperIndex"),te("liquidity"),te("feeGrowthInsideLastX64A"),te("feeGrowthInsideLastX64B"),p("tokenFeesOwedA"),p("tokenFeesOwedB"),X(te(),3,"rewardGrowthInside"),X(p(),8,"")]),no=D([Me("tick"),Ni("liquidityNet"),te("liquidityGross"),te("feeGrowthOutsideX64A"),te("feeGrowthOutsideX64B"),X(te(),3,"rewardGrowthsOutsideX64"),X(rt(),13,"")]),Wi=D([fe(8),M("poolId"),Me("startTickIndex"),X(no,_t,"ticks"),v("initializedTickCount"),X(v(),115,"")]),io=D([fe(329),X(M(),100,"whitelistMints")]),Hr=D([fe(8),M("poolId"),X(X(p(),8),Cn,"positiveTickArrayBitmap"),X(X(p(),8),Cn,"negativeTickArrayBitmap")]),Ll=D([p(),v("bump"),M("owner"),M("poolId"),M("positionId"),M("nftAccount"),X(p(),8)]),ro=D([fe(8),v("bump"),M("lockOwner"),M("poolId"),M("positionId"),M("nftAccount"),M("lockNftMint"),p("recentEpoch"),X(p(),8)]);Xi.span;var Ql=le("Raydium_Clmm");var po=Buffer.from("vault_auth_seed","utf8"),Um=Buffer.from("global_config","utf8"),fo=Buffer.from("pool_vesting","utf8"),bo=Buffer.from("platform_config","utf8"),yo=Buffer.from("platform_fee_vault_auth_seed","utf8"),go=Buffer.from("creator_fee_vault_auth_seed","utf8");function Re(o){return de([po],o)}function st(o,e,t){return de([Mi,e.toBuffer(),t.toBuffer()],o)}function Rn(o,e,t){return de([Oi,e.toBuffer(),t.toBuffer()],o)}function He(o){return de([Buffer.from("__event_authority","utf8")],o)}function Ln(o,e){return de([bo,e.toBuffer()],o)}function xt(o,e,t){return de([fo,e.toBuffer(),t.toBuffer()],o)}function je(o,e,t){return de([e.toBuffer(),t.toBuffer()],o)}function Fn(o){return de([yo],o)}function at(o,e,t){return de([e.toBuffer(),t.toBuffer()],o)}function zi(o){return de([go],o)}var $=require("@solana/web3.js"),Ie=require("@solana/spl-token"),ut=U(require("bn.js"));var Pe={initialize:Buffer.from([175,175,109,31,13,152,155,237]),buyExactIn:Buffer.from([250,234,13,123,213,156,19,236]),buyExactOut:Buffer.from([24,211,116,40,105,3,153,56]),sellExactIn:Buffer.from([149,39,222,155,211,124,152,26]),sellExactOut:Buffer.from([95,200,71,34,8,9,11,166]),createVestingAccount:Buffer.from([129,178,2,13,217,172,230,218]),claimVestedToken:Buffer.from([49,33,104,30,189,157,79,35]),createPlatformConfig:Buffer.from([176,90,196,175,253,113,220,20]),claimPlatformFee:Buffer.from([156,39,208,135,76,237,61,72]),updatePlaformConfig:Buffer.from([195,60,76,129,146,45,67,143]),initializeWithToken2022:Buffer.from([37,190,126,222,44,154,171,17]),claimPlatformFeeFromVault:Buffer.from([117,241,198,168,248,218,80,29]),claimCreatorFee:Buffer.from([26,97,138,203,132,171,141,252])};function Hi(o,e,t,n,i,r,s,a,c,u,d,l,w,g,m,f,y,T,P,x){let k=D([v("decimals"),be("name"),be("symbol"),be("uri")]),b=D([p("totalLockedAmount"),p("cliffPeriod"),p("unlockPeriod")]),A=D([v("index"),p("supply"),p("totalFundRaisingB"),v("migrateType")]),K=D([v("index"),p("supply"),p("totalSellA"),p("totalFundRaisingB"),v("migrateType")]),B=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!0,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!1},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:Ie.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:Ie.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:Ye,isSigner:!1,isWritable:!1},{pubkey:$.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:on,isSigner:!1,isWritable:!1},{pubkey:He(o).publicKey,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1}],C=Buffer.alloc(Buffer.from(g,"utf-8").length+Buffer.from(m,"utf-8").length+Buffer.from(f,"utf-8").length+4*3+1),N=Buffer.alloc(b.span),h=Buffer.alloc(y.type==="ConstantCurve"?K.span:A.span);return k.encode({decimals:w,name:g,symbol:m,uri:f},C),y.type==="ConstantCurve"?K.encode(j(_({index:0},y),{migrateType:y.migrateType==="amm"?0:1}),h):y.type==="FixedCurve"?A.encode(j(_({index:1},y),{migrateType:y.migrateType==="amm"?0:1}),h):y.type==="LinearCurve"&&A.encode(j(_({index:2},y),{migrateType:y.migrateType==="amm"?0:1}),h),b.encode({totalLockedAmount:T,cliffPeriod:P,unlockPeriod:x},N),new $.TransactionInstruction({keys:B,programId:o,data:Buffer.from([...Pe.initialize,...C,...h,...N])})}function ji(o,e,t,n,i,r,s,a,c,u,d,l,w,g,m,f,y,T,P,x){let k=D([v("decimals"),be("name"),be("symbol"),be("uri")]),b=D([p("totalLockedAmount"),p("cliffPeriod"),p("unlockPeriod"),v("transferFeeExtensionParamsOption"),D([Fe("transferFeeBasePoints"),p("maxinumFee")]).replicate("transferFeeExtensionParams")]),A=D([v("index"),p("supply"),p("totalFundRaisingB"),v("migrateType")]),K=D([v("index"),p("supply"),p("totalSellA"),p("totalFundRaisingB"),v("migrateType")]),B=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!0,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!1},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:Ie.TOKEN_2022_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:Ie.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:$.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:He(o).publicKey,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1}],C=Buffer.alloc(Buffer.from(w,"utf-8").length+Buffer.from(g,"utf-8").length+Buffer.from(m,"utf-8").length+4*3+1),N=Buffer.alloc(b.span),h=Buffer.alloc(f.type==="ConstantCurve"?K.span:A.span);return k.encode({decimals:l,name:w,symbol:g,uri:m},C),f.type==="ConstantCurve"?K.encode(j(_({index:0},f),{migrateType:f.migrateType==="amm"?0:1}),h):f.type==="FixedCurve"?A.encode(j(_({index:1},f),{migrateType:f.migrateType==="amm"?0:1}),h):f.type==="LinearCurve"&&A.encode(j(_({index:2},f),{migrateType:f.migrateType==="amm"?0:1}),h),b.encode({totalLockedAmount:y,cliffPeriod:T,unlockPeriod:P,transferFeeExtensionParamsOption:x?1:0,transferFeeExtensionParams:x!=null?x:{transferFeeBasePoints:0,maxinumFee:new ut.default(0)}},N),new $.TransactionInstruction({keys:B,programId:o,data:Buffer.from([...Pe.initializeWithToken2022,...C,...h,...N])})}function Zi(o,e,t,n,i,r,s,a,c,u,d,l,w,g,m,f,y,T,P,x){let k=D([p("amountB"),p("minAmountA"),p("shareFeeRate")]),b=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:w,isSigner:!1,isWritable:!1},{pubkey:g,isSigner:!1,isWritable:!1},{pubkey:He(o).publicKey,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1}];x&&b.push({pubkey:x,isSigner:!1,isWritable:!0}),b.push({pubkey:$.SystemProgram.programId,isSigner:!1,isWritable:!1}),b.push({pubkey:m,isSigner:!1,isWritable:!0}),b.push({pubkey:f,isSigner:!1,isWritable:!0});let A=Buffer.alloc(k.span);return k.encode({amountB:y,minAmountA:T,shareFeeRate:P!=null?P:new ut.default(0)},A),new $.TransactionInstruction({keys:b,programId:o,data:Buffer.from([...Pe.buyExactIn,...A])})}function Qi(o,e,t,n,i,r,s,a,c,u,d,l,w,g,m,f,y,T,P,x){let k=D([p("amountA"),p("maxAmountB"),p("shareFeeRate")]),b=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:w,isSigner:!1,isWritable:!1},{pubkey:g,isSigner:!1,isWritable:!1},{pubkey:He(o).publicKey,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1}];x&&b.push({pubkey:x,isSigner:!1,isWritable:!0}),b.push({pubkey:$.SystemProgram.programId,isSigner:!1,isWritable:!1}),b.push({pubkey:m,isSigner:!1,isWritable:!0}),b.push({pubkey:f,isSigner:!1,isWritable:!0});let A=Buffer.alloc(k.span);return k.encode({amountA:y,maxAmountB:T,shareFeeRate:P!=null?P:new ut.default(0)},A),new $.TransactionInstruction({keys:b,programId:o,data:Buffer.from([...Pe.buyExactOut,...A])})}function Yi(o,e,t,n,i,r,s,a,c,u,d,l,w,g,m,f,y,T,P,x){let k=D([p("amountA"),p("minAmountB"),p("shareFeeRate")]),b=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:w,isSigner:!1,isWritable:!1},{pubkey:g,isSigner:!1,isWritable:!1},{pubkey:He(o).publicKey,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1}];x&&b.push({pubkey:x,isSigner:!1,isWritable:!0}),b.push({pubkey:$.SystemProgram.programId,isSigner:!1,isWritable:!1}),b.push({pubkey:m,isSigner:!1,isWritable:!0}),b.push({pubkey:f,isSigner:!1,isWritable:!0});let A=Buffer.alloc(k.span);return k.encode({amountA:y,minAmountB:T,shareFeeRate:P!=null?P:new ut.default(0)},A),new $.TransactionInstruction({keys:b,programId:o,data:Buffer.from([...Pe.sellExactIn,...A])})}function Ji(o,e,t,n,i,r,s,a,c,u,d,l,w,g,m,f,y,T,P,x){let k=D([p("amountB"),p("maxAmountA"),p("shareFeeRate")]),b=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:w,isSigner:!1,isWritable:!1},{pubkey:g,isSigner:!1,isWritable:!1},{pubkey:He(o).publicKey,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1}];x&&b.push({pubkey:x,isSigner:!1,isWritable:!0}),b.push({pubkey:$.SystemProgram.programId,isSigner:!1,isWritable:!1}),b.push({pubkey:m,isSigner:!1,isWritable:!0}),b.push({pubkey:f,isSigner:!1,isWritable:!0});let A=Buffer.alloc(k.span);return k.encode({amountB:y,maxAmountA:T,shareFeeRate:P!=null?P:new ut.default(0)},A),new $.TransactionInstruction({keys:b,programId:o,data:Buffer.from([...Pe.sellExactOut,...A])})}function Mn(o,e,t,n,i,r,s,a,c){let u=D([]),d=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!1},{pubkey:$.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:Ie.ASSOCIATED_TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}],l=Buffer.alloc(u.span);return u.encode({},l),new $.TransactionInstruction({keys:d,programId:o,data:Buffer.from([...Pe.claimVestedToken,...l])})}function On(o,e,t,n,i,r){let s=D([p("shareAmount")]),a=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:$.SystemProgram.programId,isSigner:!1,isWritable:!1}],c=Buffer.alloc(s.span);return s.encode({shareAmount:r},c),new $.TransactionInstruction({keys:a,programId:o,data:Buffer.from([...Pe.createVestingAccount,...c])})}function En(o,e,t,n,i,r,s,a,c){let u=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:$.SystemProgram.programId,isSigner:!1,isWritable:!0},{pubkey:Ie.ASSOCIATED_TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!0}];return new $.TransactionInstruction({keys:u,programId:o,data:Pe.claimPlatformFee})}function $i(o,e,t,n,i,r,s,a,c,u,d,l,w){let g=D([p("platformScale"),p("creatorScale"),p("burnScale"),p("feeRate"),be("name"),be("web"),be("img"),p("creatorFeeRate")]),m=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:$.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!1}],f=Buffer.alloc(8*5+Buffer.from(d,"utf-8").length+Buffer.from(l,"utf-8").length+Buffer.from(w,"utf-8").length+4*3);return g.encode({platformScale:a.platformScale,creatorScale:a.creatorScale,burnScale:a.burnScale,feeRate:c,name:d,web:l,img:w,creatorFeeRate:u},f),new $.TransactionInstruction({keys:m,programId:o,data:Buffer.from([...Pe.createPlatformConfig,...f])})}function er(o,e,t,n){let i=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!0}],r;if(n.type==="updateClaimFeeWallet"){let s=D([v("index"),M("value")]);r=Buffer.alloc(s.span),s.encode({index:0,value:n.value},r)}else if(n.type==="updateLockNftWallet"){let s=D([v("index"),M("value")]);r=Buffer.alloc(s.span),s.encode({index:1,value:n.value},r)}else if(n.type==="migrateCpLockNftScale"){let s=D([v("index"),p("platformScale"),p("creatorScale"),p("burnScale")]);r=Buffer.alloc(s.span),s.encode(_({index:2},n.value),r)}else if(n.type==="updateFeeRate"){let s=D([v("index"),p("value")]);r=Buffer.alloc(s.span),s.encode({index:3,value:n.value},r)}else if(n.type==="updateImg"||n.type==="updateName"||n.type==="updateWeb"){let s=D([v("index"),be("value")]);r=Buffer.alloc(Buffer.from(n.value,"utf-8").length+4+1*1),n.type==="updateName"?s.encode({index:4,value:n.value},r):n.type==="updateWeb"?s.encode({index:5,value:n.value},r):n.type==="updateImg"&&s.encode({index:6,value:n.value},r)}else if(n.type==="updateCpConfigId"){i.push({pubkey:n.value,isSigner:!1,isWritable:!1});let s=D([v("index")]);r=Buffer.alloc(s.span),s.encode({index:7},r)}else if(n.type==="updateAll"){i.push({pubkey:n.value.cpConfigId,isSigner:!1,isWritable:!1});let s=D([v("index"),M("platformClaimFeeWallet"),M("platformLockNftWallet"),p("platformScale"),p("creatorScale"),p("burnScale"),p("feeRate"),be("name"),be("web"),be("img"),M("transferFeeExtensionAuth"),p("creatorFeeRate")]);r=Buffer.alloc(1+32+32+8*4+4*3+Buffer.from(n.value.name,"utf-8").length+Buffer.from(n.value.web,"utf-8").length+Buffer.from(n.value.img,"utf-8").length),s.encode({index:8,platformClaimFeeWallet:n.value.platformClaimFeeWallet,platformLockNftWallet:n.value.platformLockNftWallet,platformScale:n.value.migrateCpLockNftScale.platformScale,creatorScale:n.value.migrateCpLockNftScale.creatorScale,burnScale:n.value.migrateCpLockNftScale.burnScale,feeRate:n.value.feeRate,name:n.value.name,web:n.value.web,img:n.value.img,transferFeeExtensionAuth:n.value.transferFeeExtensionAuth,creatorFeeRate:n.value.creatorFeeRate},r)}else throw Error("updateInfo params type error");return new $.TransactionInstruction({keys:i,programId:o,data:Buffer.from([...Pe.updatePlaformConfig,...r])})}function vn(o,e,t,n,i,r,s,a){let c=[{pubkey:t,isSigner:!0,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:e,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:$.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:Ie.ASSOCIATED_TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}];return new $.TransactionInstruction({keys:c,programId:o,data:Pe.claimPlatformFeeFromVault})}function tr(o,e,t,n,i,r,s){let a=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:$.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:Ie.ASSOCIATED_TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}];return new $.TransactionInstruction({keys:a,programId:o,data:Pe.claimCreatorFee})}var S=require("@solana/spl-token"),E=U(require("bn.js")),Vn=require("@solana/web3.js");var ve=D([p(),p("epoch"),v("curveType"),Fe("index"),p("migrateFee"),p("tradeFeeRate"),p("maxShareFeeRate"),p("minSupplyA"),p("maxLockRate"),p("minSellRateA"),p("minMigrateRateA"),p("minFundRaisingB"),M("mintB"),M("protocolFeeOwner"),M("migrateFeeOwner"),M("migrateToAmmWallet"),M("migrateToCpmmWallet"),X(p(),16)]),Po=D([p("totalLockedAmount"),p("cliffPeriod"),p("unlockPeriod"),p("startTime"),p("totalAllocatedShare")]),Se=D([p(),p("epoch"),v("bump"),v("status"),v("mintDecimalsA"),v("mintDecimalsB"),v("migrateType"),p("supply"),p("totalSellA"),p("virtualA"),p("virtualB"),p("realA"),p("realB"),p("totalFundRaisingB"),p("protocolFee"),p("platformFee"),p("migrateFee"),Po.replicate("vestingSchedule"),M("configId"),M("platformId"),M("mintA"),M("mintB"),M("vaultA"),M("vaultB"),M("creator"),v("mintProgramFlag"),X(v(),63)]),$m=D([p(),p("epoch"),M("poolId"),M("beneficiary"),p("claimedAmount"),p("tokenShareAmount"),X(p(),8)]),ct=D([p(),p("epoch"),M("platformClaimFeeWallet"),M("platformLockNftWallet"),p("platformScale"),p("creatorScale"),p("burnScale"),p("feeRate"),X(v(),64,"name"),X(v(),256,"web"),X(v(),256,"img"),M("cpConfigId"),p("creatorFeeRate"),M("transferFeeExtensionAuth"),X(v(),184)]);var Ae=U(require("bn.js")),Wn=U(require("decimal.js"));var It=U(require("bn.js")),lt=U(require("decimal.js"));var De=class{static getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n}){throw Error()}static getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:i}){throw Error()}static getPoolPrice({poolInfo:e,decimalA:t,decimalB:n}){throw Error()}static getPoolEndPrice({supply:e,totalSell:t,totalLockedAmount:n,totalFundRaising:i,migrateFee:r,decimalA:s,decimalB:a}){throw Error()}static getPoolEndPriceReal({poolInfo:e,decimalA:t,decimalB:n}){throw Error()}static getInitParam({supply:e,totalFundRaising:t,totalSell:n,totalLockedAmount:i,migrateFee:r}){throw Error()}static buyExactIn({poolInfo:e,amount:t}){throw Error()}static buyExactOut({poolInfo:e,amount:t}){throw Error()}static sellExactIn({poolInfo:e,amount:t}){throw Error()}static sellExactOut({poolInfo:e,amount:t}){throw Error()}};var Ut=class extends De{static getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n}){return new lt.default(e.virtualB.toString()).div(e.virtualA.toString()).mul(10**(t-n))}static getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:i}){return new lt.default(t.toString()).div(e.toString()).mul(10**(n-i))}static getPoolPrice({poolInfo:e,decimalA:t,decimalB:n}){return new lt.default(e.virtualB.add(e.realB).toString()).div(e.virtualA.sub(e.realA).toString()).mul(10**(t-n))}static getPoolEndPrice({supply:e,totalSell:t,totalLockedAmount:n,totalFundRaising:i,migrateFee:r,decimalA:s,decimalB:a}){return new lt.default(i.sub(r).toString()).div(e.sub(t).sub(n).toString()).mul(10**(s-a))}static getPoolEndPriceReal({poolInfo:e,decimalA:t,decimalB:n}){let i=e.totalSellA.sub(e.realA),r=e.totalFundRaisingB.sub(e.realB);return new lt.default(e.virtualB.add(e.realB.add(r)).toString()).div(e.virtualA.sub(e.realA.add(i)).toString()).mul(10**(t-n))}static getInitParam({supply:e,totalFundRaising:t,totalSell:n,totalLockedAmount:i,migrateFee:r}){if(e.lte(n))throw Error("supply need gt total sell");let s=e.sub(n).sub(i);if(s.lte(new It.default(0)))throw Error("supplyMinusSellLocked <= 0");let a=t.sub(r);if(a.lte(new It.default(0)))throw Error("tfMinusMf <= 0");let c=a.mul(n).mul(n).div(s),u=a.mul(n).div(s).sub(t),d=c.div(u),l=t.mul(t).div(u);if(d.lt(new It.default(0))||l.lt(new It.default(0)))throw Error("invalid input 0");return{a:d,b:l,c:n}}static buyExactIn({poolInfo:e,amount:t}){return this.getAmountOut({amountIn:t,inputReserve:e.virtualB.add(e.realB),outputReserve:e.virtualA.sub(e.realA)})}static buyExactOut({poolInfo:e,amount:t}){return this.getAmountIn({amountOut:t,inputReserve:e.virtualB.add(e.realB),outputReserve:e.virtualA.sub(e.realA)})}static sellExactIn({poolInfo:e,amount:t}){return this.getAmountOut({amountIn:t,inputReserve:e.virtualA.sub(e.realA),outputReserve:e.virtualB.add(e.realB)})}static sellExactOut({poolInfo:e,amount:t}){return this.getAmountIn({amountOut:t,inputReserve:e.virtualA.sub(e.realA),outputReserve:e.virtualB.add(e.realB)})}static getAmountOut({amountIn:e,inputReserve:t,outputReserve:n}){let i=e.mul(n),r=t.add(e);return i.div(r)}static getAmountIn({amountOut:e,inputReserve:t,outputReserve:n}){let i=t.mul(e),r=n.sub(e);return Xe(i,r)}};var St=U(require("bn.js")),mt=U(require("decimal.js"));var Xt=class extends De{static getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n}){return new mt.default(e.virtualB.toString()).div(e.virtualA.toString()).mul(10**(t-n))}static getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:i}){return new mt.default(t.toString()).div(e.toString()).mul(10**(n-i))}static getPoolPrice({poolInfo:e,decimalA:t,decimalB:n}){return new mt.default(e.virtualB.toString()).div(e.virtualA.toString()).mul(10**(t-n))}static getPoolEndPrice({supply:e,totalSell:t,totalLockedAmount:n,totalFundRaising:i,migrateFee:r,decimalA:s,decimalB:a}){return new mt.default(i.sub(r).toString()).div(e.sub(t).sub(n).toString()).mul(10**(s-a))}static getPoolEndPriceReal({poolInfo:e,decimalA:t,decimalB:n}){let i=e.totalSellA.sub(e.realA),r=e.totalFundRaisingB.sub(e.realB);return new mt.default(e.virtualB.add(e.realB).add(r).toString()).div(e.virtualA.sub(e.realA).add(i).toString()).mul(10**(t-n))}static getInitParam({supply:e,totalFundRaising:t,totalSell:n,totalLockedAmount:i,migrateFee:r}){let s=e.sub(i);if(s.lte(new St.default(0)))throw Error("invalid input 1");let a=new St.default(2).mul(t).sub(r),u=t.mul(s).div(a);if(u.lt(new St.default(0))||t.lt(new St.default(0)))throw Error("invalid input 0");return{a:u,b:t,c:u}}static buyExactIn({poolInfo:e,amount:t}){return this.getAmountOut({amountIn:t,initInput:e.virtualB,initOutput:e.virtualA})}static buyExactOut({poolInfo:e,amount:t}){return this.getAmountIn({amountOut:t,initInput:e.virtualB,initOutput:e.virtualA})}static sellExactIn({poolInfo:e,amount:t}){return this.getAmountOut({amountIn:t,initInput:e.virtualA,initOutput:e.virtualB})}static sellExactOut({poolInfo:e,amount:t}){return this.getAmountIn({amountOut:t,initInput:e.virtualA,initOutput:e.virtualB})}static getAmountOut({amountIn:e,initInput:t,initOutput:n}){return n.mul(e).div(t)}static getAmountIn({amountOut:e,initInput:t,initOutput:n}){let i=t.mul(e);return Xe(i,n)}};var pe=U(require("bn.js")),We=U(require("decimal.js"));var Dn=U(require("bn.js")),zt=U(require("decimal.js")),Kt=class{static _multipler(e){return new zt.default(10).pow(e)}static getPrice({priceX64:e,decimalA:t,decimalB:n}){return new zt.default(e.toString()).div(this._Q64).mul(this._multipler(t)).div(this._multipler(n))}static getPriceX64({price:e,decimalA:t,decimalB:n}){let i=e.mul(this._multipler(n)).div(this._multipler(t));return new Dn.default(i.mul(this._Q64).toFixed(0))}};Kt._Q64=new zt.default(new Dn.default(1).shln(64).toString());var Ht=class extends De{static getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n}){return new We.default(0)}static getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:i}){return new We.default(0)}static getPoolPrice({poolInfo:e,decimalA:t,decimalB:n}){return new We.default(e.virtualA.mul(e.realA).toString()).div(Kt._Q64).mul(10**(t-n))}static getPoolEndPrice({supply:e,totalSell:t,totalLockedAmount:n,totalFundRaising:i,migrateFee:r,decimalA:s,decimalB:a}){return new We.default(i.sub(r).toString()).div(e.sub(t).sub(n).toString()).mul(10**(s-a))}static getPoolEndPriceReal({poolInfo:e,decimalA:t,decimalB:n}){let i=e.totalSellA.sub(e.realA),r=e.totalFundRaisingB.sub(e.realB);return new We.default(e.virtualB.add(e.realB).add(r).toString()).div(e.virtualA.sub(e.realA).add(i).toString()).mul(10**(t-n))}static getInitParam({supply:e,totalFundRaising:t,totalSell:n,totalLockedAmount:i,migrateFee:r}){let s=e.sub(i);if(s.lte(new pe.default(0)))throw Error("supplyMinusLocked need gt 0");let a=t.mul(new pe.default(3)).sub(r),u=t.mul(new pe.default(2)).mul(s).div(a),d=u.mul(u),l=t.mul(new pe.default(2)).mul(Ne).div(d);if(!l.gt(new pe.default(0)))throw Error("a need gt 0");if(!Bn.gt(l))throw Error("a need lt u64 max");if(l.lt(new pe.default(0))||u.lt(new pe.default(0)))throw Error("invalid input 0");return{a:l,b:new pe.default(0),c:u}}static buyExactIn({poolInfo:e,amount:t}){let n=e.realB.add(t),i=new pe.default(2).mul(n).mul(Ne).div(e.virtualA);return new pe.default(new We.default(i.toString()).sqrt().toFixed(0)).sub(e.realA)}static buyExactOut({poolInfo:e,amount:t}){let n=e.realA.add(t),i=n.mul(n);return Xe(e.virtualA.mul(i),new pe.default(2).mul(Ne)).sub(e.realB)}static sellExactIn({poolInfo:e,amount:t}){let n=e.realA.sub(t),i=n.mul(n),r=Xe(e.virtualA.mul(i),new pe.default(2).mul(Ne));return e.realB.sub(r)}static sellExactOut({poolInfo:e,amount:t}){let n=e.realB.sub(t),i=new pe.default(2).mul(n).mul(Ne).div(e.virtualA),r=new pe.default(new We.default(i.toString()).sqrt().toFixed(0));return e.realA.sub(r)}};var ke=class{static getPoolCurvePointByPoolInfo({curveType:e,pointCount:t,poolInfo:n}){return this.getPoolCurvePointByInit({curveType:e,pointCount:t,supply:n.supply,totalFundRaising:n.totalFundRaisingB,totalSell:n.totalSellA,totalLockedAmount:n.vestingSchedule.totalLockedAmount,migrateFee:n.migrateFee,decimalA:n.mintDecimalsA,decimalB:n.mintDecimalsB})}static getPoolCurvePointByInit({curveType:e,pointCount:t,supply:n,totalFundRaising:i,totalSell:r,totalLockedAmount:s,migrateFee:a,decimalA:c,decimalB:u}){if(t<3)throw Error("point count < 3");let d=this.getCurve(e),l=d.getInitParam({supply:n,totalFundRaising:i,totalSell:r,totalLockedAmount:s,migrateFee:a}),w=d.getPoolInitPriceByInit(j(_({},l),{decimalA:c,decimalB:u})),g=i.div(new Ae.default(t-1)),m=new Ae.default(0),f=[{price:w,totalSellSupply:0}],{a:y,b:T}=l,P=m,x=m;for(let k=1;k<t;k++){let b=k!==t-1?g:i.sub(x),A=this.buyExactIn({poolInfo:{virtualA:y,virtualB:T,realA:P,realB:x,totalFundRaisingB:i,totalSellA:r},amountB:b,protocolFeeRate:m,platformFeeRate:m,curveType:e,shareFeeRate:m,creatorFeeRate:m,transferFeeConfigA:void 0,slot:0});P=P.add(A.amountA.amount),x=x.add(A.amountB);let K=this.getPrice({poolInfo:{virtualA:y,virtualB:T,realA:P,realB:x},decimalA:c,decimalB:u,curveType:e});f.push({price:K,totalSellSupply:new Wn.default(P.toString()).div(10**c).toNumber()})}return f}static getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n,curveType:i}){return this.getCurve(i).getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n})}static getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:i,curveType:r}){return this.getCurve(r).getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:i})}static getPrice({poolInfo:e,curveType:t,decimalA:n,decimalB:i}){return this.getCurve(t).getPoolPrice({poolInfo:e,decimalA:n,decimalB:i})}static getEndPrice({poolInfo:e,curveType:t,decimalA:n,decimalB:i}){return this.getCurve(t).getPoolPrice({poolInfo:e,decimalA:n,decimalB:i})}static getPoolEndPriceReal({poolInfo:e,curveType:t,decimalA:n,decimalB:i}){return this.getCurve(t).getPoolEndPriceReal({poolInfo:e,decimalA:n,decimalB:i})}static checkParam({supply:e,totalFundRaising:t,totalSell:n,totalLockedAmount:i,decimals:r,config:s,migrateType:a}){if(Number(r)!==6)throw Error("decimals = 6");if(e.mul(s.maxLockRate).div(ze).lt(i))throw Error("total lock amount gte max lock amount");if(e.lt(s.minSupplyA.mul(new Ae.default(10**r))))throw Error("supply lt min supply");let u=e.mul(s.minSellRateA).div(ze);if(n.lt(u))throw Error("invalid input");if(t.lt(s.minFundRaisingB))throw Error("total fund raising lt min fund raising");let d=e.sub(n).sub(i),l=e.mul(s.minMigrateRateA).div(ze);if(d.lt(l))throw Error("migrate lt min migrate amoount");let w=e.sub(n).sub(i),g=new Ae.default(new Wn.default(w.mul(t).toString()).sqrt().toFixed(0));if(a==="amm"){let m=new Ae.default(10).pow(new Ae.default(r));if(g.lte(m))throw Error("check migrate lp error")}else if(a==="cpmm"){let m=new Ae.default(100);if(g.lte(m))throw Error("check migrate lp error")}else throw Error("migrate type error")}static buyExactIn({poolInfo:e,amountB:t,protocolFeeRate:n,platformFeeRate:i,curveType:r,shareFeeRate:s,creatorFeeRate:a,transferFeeConfigA:c,slot:u}){let d=this.totalFeeRate({protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a}),l=this.calculateFee({amount:t,feeRate:d}),w=t.sub(l),g=this.getCurve(r),m=g.buyExactIn({poolInfo:e,amount:w}),f=e.totalSellA.sub(e.realA),y,T,P;if(m.gt(f)){y=f;let k=g.buyExactOut({poolInfo:e,amount:y});T=this.calculatePreFee({postFeeAmount:k,feeRate:d}),P=T.sub(k)}else y=m,T=t,P=l;let x=this.splitFee({totalFee:P,protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a});return{amountA:dn(y,c,u),amountB:T,splitFee:x}}static buyExactOut({poolInfo:e,amountA:t,protocolFeeRate:n,platformFeeRate:i,curveType:r,shareFeeRate:s,creatorFeeRate:a,transferFeeConfigA:c,slot:u}){let d=e.totalSellA.sub(e.realA),l=pn(t,c,u),w=l.fee?l.amount.add(l.fee):l.amount;t.gt(d)&&(w=d);let m=this.getCurve(r).buyExactOut({poolInfo:e,amount:w}),f=this.totalFeeRate({protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a}),y=this.calculatePreFee({postFeeAmount:m,feeRate:f}),T=y.sub(m),P=this.splitFee({totalFee:T,protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a});return{amountA:l,amountB:y,splitFee:P}}static sellExactIn({poolInfo:e,amountA:t,protocolFeeRate:n,platformFeeRate:i,curveType:r,shareFeeRate:s,creatorFeeRate:a,transferFeeConfigA:c,slot:u}){let d=this.getCurve(r),l=dn(t,c,u),w=l.fee?l.amount.sub(l.fee):l.amount,g=d.sellExactIn({poolInfo:e,amount:w}),m=this.calculateFee({amount:g,feeRate:this.totalFeeRate({protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a})}),f=this.splitFee({totalFee:m,protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a});return{amountA:l,amountB:g.sub(m),splitFee:f}}static sellExactOut({poolInfo:e,amountB:t,protocolFeeRate:n,platformFeeRate:i,curveType:r,shareFeeRate:s,creatorFeeRate:a,transferFeeConfigA:c,slot:u}){let d=this.totalFeeRate({protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a}),l=this.calculatePreFee({postFeeAmount:t,feeRate:d});if(e.realB.lt(l))throw Error("Insufficient liquidity");let w=l.sub(t),m=ke.getCurve(r).sellExactOut({poolInfo:e,amount:l});if(m.gt(e.realA))throw Error();let f=this.splitFee({totalFee:w,protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a});return{amountA:pn(m,c,u),amountB:t,splitFee:f}}static splitFee({totalFee:e,protocolFeeRate:t,platformFeeRate:n,shareFeeRate:i,creatorFeeRate:r}){let s=this.totalFeeRate({protocolFeeRate:t,platformFeeRate:n,shareFeeRate:i,creatorFeeRate:r}),a=s.isZero()?new Ae.default(0):e.mul(n).div(s),c=s.isZero()?new Ae.default(0):e.mul(i).div(s),u=s.isZero()?new Ae.default(0):e.mul(r).div(s),d=e.sub(a).sub(c).sub(u);return{platformFee:a,shareFee:c,protocolFee:d,creatorFee:u}}static calculateFee({amount:e,feeRate:t}){return mi(e,t,ze)}static calculatePreFee({postFeeAmount:e,feeRate:t}){if(t.isZero())return e;let n=e.mul(ze),i=ze.sub(t);return n.add(i).sub(new Ae.default(1)).div(i)}static totalFeeRate({protocolFeeRate:e,platformFeeRate:t,shareFeeRate:n,creatorFeeRate:i}){if(e.add(t).add(n).add(i).gt(new Ae.default(1e6)))throw Error("total fee rate gt 1_000_000");return e.add(t).add(n).add(i)}static getCurve(e){switch(e){case 0:return Ut;case 1:return Xt;case 2:return Ht}throw Error("find curve error")}};var ye=U(require("decimal.js")),_e={initPriceX64:new E.default("515752397214619"),supply:new E.default(1e15),totalSellA:new E.default(7931e11),totalFundRaisingB:new E.default(85e9),totalLockedAmount:new E.default("0"),cliffPeriod:new E.default("0"),unlockPeriod:new E.default("0"),decimals:6,virtualA:new E.default("1073471847374405"),virtualB:new E.default("30050573465"),realA:new E.default(0),realB:new E.default(0),protocolFee:new E.default(0),platformId:new Vn.PublicKey("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),vestingSchedule:{totalLockedAmount:new E.default(0),cliffPeriod:new E.default(0),unlockPeriod:new E.default(0),startTime:new E.default(0),totalAllocatedShare:new E.default(0)}},Ve=new E.default(1e4),jt=class extends et{constructor(e){super(e)}async createLaunchpad(G){var q=G,{programId:e=se,authProgramId:t,platformId:n=_e.platformId,mintA:i,decimals:r=6,mintBDecimals:s=9,name:a,symbol:c,uri:u,migrateType:d,configId:l,snipers:w,configInfo:g,platformFeeRate:m,txVersion:f,computeBudgetConfig:y,txTipConfig:T,feePayer:P,buyAmount:x,minMintAAmount:k,slippage:b,associatedOnly:A=!0,checkCreateATAOwner:K=!1,extraSigners:B,token2022:C,transferFeeExtensionParams:N}=q,h=qe(q,["programId","authProgramId","platformId","mintA","decimals","mintBDecimals","name","symbol","uri","migrateType","configId","snipers","configInfo","platformFeeRate","txVersion","computeBudgetConfig","txTipConfig","feePayer","buyAmount","minMintAAmount","slippage","associatedOnly","checkCreateATAOwner","extraSigners","token2022","transferFeeExtensionParams"]);var _n,qn,Gn,Un,Xn,zn,Hn,jn,Zn,Qn;let O=this.createTxBuilder(P);t=t!=null?t:Re(e).publicKey,console.log("snipers: ",w),C=!!N,C&&(d="cpmm");let I=g;if(!I&&l){let Ke=await this.scope.connection.getAccountInfo(l);Ke&&(I=ve.decode(Ke.data))}I||this.logAndCreateError("config not found");let V=I.mintB,Y=I.curveType,{publicKey:J}=st(e,i,V),{publicKey:Q}=Rn(e,J,i),{publicKey:ie}=Rn(e,J,V),{publicKey:oe}=In(i);this.logDebug(`create token: ${i.toBase58()}, mintB: ${V.toBase58()}, decimals A:${r}/B:${s}, config:${l.toBase58()}`),c.length>10&&this.logAndCreateError("Symbol length should shorter than 11"),u||this.logAndCreateError("uri should not empty");let ne=(_n=h==null?void 0:h.supply)!=null?_n:_e.supply,re=(qn=h==null?void 0:h.totalSellA)!=null?qn:_e.totalSellA,z=(Gn=h==null?void 0:h.totalFundRaisingB)!=null?Gn:_e.totalFundRaisingB,W=(Un=h==null?void 0:h.totalLockedAmount)!=null?Un:new E.default(0),ue=m;if(!m){let Ke=await this.scope.connection.getAccountInfo(n);Ke||this.logAndCreateError("platform id not found:",n.toString()),ue=ct.decode(Ke.data).feeRate}let Ze=ke.getCurve(I.curveType).getInitParam({supply:ne,totalFundRaising:z,totalSell:re,totalLockedAmount:W,migrateFee:I.migrateFee}),Te={epoch:new E.default(896),bump:254,status:0,mintDecimalsA:r,mintDecimalsB:s,supply:ne,totalSellA:re,mintA:new Vn.PublicKey(i),mintB:V,virtualA:Ze.a,virtualB:Ze.b,realA:_e.realA,realB:_e.realB,migrateFee:I.migrateFee,migrateType:d==="amm"?0:1,protocolFee:_e.protocolFee,platformFee:ue,platformId:n,configId:l,vaultA:Q,vaultB:ie,creator:this.scope.ownerPubKey,totalFundRaisingB:z,vestingSchedule:{totalLockedAmount:W,cliffPeriod:new E.default(0),unlockPeriod:new E.default(0),startTime:new E.default(0),totalAllocatedShare:new E.default(0)},mintProgramFlag:C?1:0},nr=ke.getCurve(I.curveType),{c:ir}=nr.getInitParam({supply:Te.supply,totalFundRaising:Te.totalFundRaisingB,totalLockedAmount:W,totalSell:I.curveType===0?Te.totalSellA:new E.default(0),migrateFee:I.migrateFee});try{ke.checkParam({supply:Te.supply,totalFundRaising:Te.totalFundRaisingB,totalSell:ir,totalLockedAmount:W,decimals:Te.mintDecimalsA,config:I,migrateType:d}),this.logDebug("check init params success")}catch(Ke){this.logAndCreateError(`check create mint params failed, ${Ke.message}`)}O.addInstruction({instructions:[C?ji(e,P!=null?P:this.scope.ownerPubKey,this.scope.ownerPubKey,l,n,t,J,i,V,Q,ie,r,a,c,u||"https://",{type:Y===0?"ConstantCurve":Y===1?"FixedCurve":Y===2?"LinearCurve":"ConstantCurve",totalSellA:re,migrateType:d,supply:ne,totalFundRaisingB:z},W,(Xn=h==null?void 0:h.cliffPeriod)!=null?Xn:new E.default(0),(zn=h==null?void 0:h.unlockPeriod)!=null?zn:new E.default(0),N):Hi(e,P!=null?P:this.scope.ownerPubKey,this.scope.ownerPubKey,l,n,t,J,i,V,Q,ie,oe,r,a,c,u||"https://",{type:Y===0?"ConstantCurve":Y===1?"FixedCurve":Y===2?"LinearCurve":"ConstantCurve",totalSellA:re,migrateType:d,supply:ne,totalFundRaisingB:z},W,(Hn=h==null?void 0:h.cliffPeriod)!=null?Hn:new E.default(0),(jn=h==null?void 0:h.unlockPeriod)!=null?jn:new E.default(0))]});let Zt=C?await this.scope.connection.getEpochInfo():void 0,we=N?{epoch:BigInt((Zt==null?void 0:Zt.epoch)||0),maximumFee:BigInt((Zn=N==null?void 0:N.maxinumFee.toString())!=null?Zn:0),transferFeeBasisPoints:(Qn=N==null?void 0:N.transferFeeBasePoints)!=null?Qn:0}:void 0,Qt={amountA:{amount:new E.default(0),fee:void 0,expirationTime:void 0},amountB:new E.default(0),splitFee:{platformFee:new E.default(0),shareFee:new E.default(0),protocolFee:new E.default(0),creatorFee:new E.default(0)}},Yt;if(B!=null&&B.length&&O.addInstruction({signers:B}),!h.createOnly){let{builder:Ke,extInfo:rr}=await this.buyToken({programId:e,authProgramId:t,mintAProgram:C?S.TOKEN_2022_PROGRAM_ID:void 0,mintA:i,mintB:V,poolInfo:Te,buyAmount:x,minMintAAmount:k,shareFeeRate:h.shareFeeRate,shareFeeReceiver:h.shareFeeReceiver,configInfo:I,platformFeeRate:ue,slippage:b,associatedOnly:A,checkCreateATAOwner:K,skipCheckMintA:!we,transferFeeConfigA:we?{transferFeeConfigAuthority:t,withdrawWithheldAuthority:t,withheldAmount:BigInt(0),olderTransferFee:we,newerTransferFee:we}:void 0}),{builder:wo,extInfo:ko}=await this.buyToken({programId:e,authProgramId:t,mintAProgram:C?S.TOKEN_2022_PROGRAM_ID:void 0,mintA:i,mintB:V,poolInfo:Te,buyAmount:x,minMintAAmount:k,shareFeeRate:h.shareFeeRate,shareFeeReceiver:h.shareFeeReceiver,configInfo:I,platformFeeRate:ue,slippage:b,associatedOnly:A,checkCreateATAOwner:K,skipCheckMintA:!we,transferFeeConfigA:we?{transferFeeConfigAuthority:t,withdrawWithheldAuthority:t,withheldAmount:BigInt(0),olderTransferFee:we,newerTransferFee:we}:void 0}),{builder:To,extInfo:Bo}=await this.buyToken({programId:e,authProgramId:t,mintAProgram:C?S.TOKEN_2022_PROGRAM_ID:void 0,mintA:i,mintB:V,poolInfo:Te,buyAmount:x,minMintAAmount:k,shareFeeRate:h.shareFeeRate,shareFeeReceiver:h.shareFeeReceiver,configInfo:I,platformFeeRate:ue,slippage:b,associatedOnly:A,checkCreateATAOwner:K,skipCheckMintA:!we,transferFeeConfigA:we?{transferFeeConfigAuthority:t,withdrawWithheldAuthority:t,withheldAmount:BigInt(0),olderTransferFee:we,newerTransferFee:we}:void 0});O.addInstruction(_({},Ke.AllTxData)),Qt=_({},rr),Yt=(this.scope.cluster==="devnet"||f===1)&&h.shareFeeReceiver?[Ke.allInstructions[0]]:void 0}return O.addTipInstruction(T),f===0?O.sizeCheckBuildV0({computeBudgetConfig:y,swapInfo:Qt,splitIns:Yt,address:j(_({},Te),{poolId:J})}):O.sizeCheckBuild({computeBudgetConfig:y,swapInfo:Qt,splitIns:Yt,address:j(_({},Te),{poolId:J})})}async buyToken({programId:e=se,authProgramId:t,mintA:n,mintAProgram:i=S.TOKEN_PROGRAM_ID,mintB:r=S.NATIVE_MINT,poolInfo:s,configInfo:a,platformFeeRate:c,txVersion:u,computeBudgetConfig:d,txTipConfig:l,feePayer:w,buyAmount:g,minMintAAmount:m,slippage:f,shareFeeRate:y=new E.default(0),shareFeeReceiver:T,associatedOnly:P=!0,checkCreateATAOwner:x=!1,transferFeeConfigA:k,skipCheckMintA:b=!1}){var z,W,ue;g.lte(new E.default(0))&&this.logAndCreateError("buy amount should gt 0:",g.toString());let A=this.createTxBuilder(w),{publicKey:K}=st(e,n,r);t=t!=null?t:Re(e).publicKey;let B=k;if(!b)if(B)i=S.TOKEN_2022_PROGRAM_ID;else{let ce=await this.scope.connection.getAccountInfo(n);if(ce&&ce.owner.equals(S.TOKEN_2022_PROGRAM_ID)){i=ce.owner;let Ze=(0,S.unpackMint)(n,ce,i);B=(0,S.getTransferFeeConfig)(Ze)||void 0}}let C=this.scope.account.getAssociatedTokenAccount(n,i),N=null,h=r.equals(S.NATIVE_MINT);A.addInstruction({instructions:[(0,S.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,C,this.scope.ownerPubKey,n,i)]});let{account:G,instructionParams:q}=await this.scope.account.getOrCreateTokenAccount({mint:r,owner:this.scope.ownerPubKey,createInfo:h?{payer:this.scope.ownerPubKey,amount:g}:void 0,skipCloseAccount:!h,notUseTokenAccount:h,associatedOnly:h?!1:P,checkCreateATAOwner:x});G&&(N=G),A.addInstruction(q||{}),N===void 0&&this.logAndCreateError(`cannot found mintB(${r.toBase58()}) token accounts`,"tokenAccounts",this.scope.account.tokenAccounts);let O=s;if(!O){let ce=await this.scope.connection.getAccountInfo(K,{commitment:"processed"});ce||this.logAndCreateError("cannot found pool:",K.toBase58()),O=Se.decode(ce.data)}let I=a,V=await Le(this.scope.connection,[I?void 0:O.configId,O.platformId].filter(Boolean).map(ce=>({pubkey:ce})));if(!I){let ce=V.find(Ze=>Ze.pubkey.equals(O.configId));(!ce||!ce.accountInfo)&&this.logAndCreateError("config not found: ",O.configId.toBase58()),I=ve.decode(ce.accountInfo.data)}let Y=V.find(ce=>ce.pubkey.equals(O.platformId));(!Y||!Y.accountInfo)&&this.logAndCreateError("platform info not found: ",O.configId.toBase58());let J=ct.decode(Y.accountInfo.data);c=c||J.feeRate;let Q=ke.buyExactIn({poolInfo:O,amountB:g,protocolFeeRate:I.tradeFeeRate,platformFeeRate:c,curveType:I.curveType,shareFeeRate:y,creatorFeeRate:J.creatorFeeRate,transferFeeConfigA:B,slot:await this.scope.connection.getSlot()}),ie=new ye.default(Q.amountA.amount.toString()).sub((W=(z=Q.amountA.fee)==null?void 0:z.toString())!=null?W:0),oe=f?new ye.default(Ve.sub(f).toNumber()/Ve.toNumber()).clampedTo(0,1):new ye.default(1),ne=m!=null?m:f?new E.default(ie.mul(oe).toFixed(0)):Q.amountA.amount.sub((ue=Q.amountA.fee)!=null?ue:new E.default(0));Q.amountB.lt(g)&&console.log(`maximum ${n.toBase58()} amount can buy is ${Q.amountA.toString()}, input ${r.toBase58()} amount: ${Q.amountB.toString()}`);let re=T?he(T,r,S.TOKEN_PROGRAM_ID).publicKey:void 0;return re&&A.addInstruction({instructions:[(0,S.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,re,T,r)]}),A.addInstruction({instructions:[Zi(e,this.scope.ownerPubKey,t,O.configId,O.platformId,K,C,N,O.vaultA,O.vaultB,n,r,i,S.TOKEN_PROGRAM_ID,je(e,O.platformId,r).publicKey,at(e,O.creator,r).publicKey,Q.amountB.lt(g)?Q.amountB:g,ne,y,re)]}),A.addCustomComputeBudget(d),A.addTipInstruction(l),A.versionBuild({txVersion:u,extInfo:j(_({},Q),{decimalOutAmount:ie,minDecimalOutAmount:new ye.default(ne.toString())})})}async buyTokenExactOut({programId:e=se,authProgramId:t,mintA:n,mintAProgram:i=S.TOKEN_PROGRAM_ID,mintB:r=S.NATIVE_MINT,poolInfo:s,configInfo:a,transferFeeConfigA:c,platformFeeRate:u,txVersion:d,computeBudgetConfig:l,txTipConfig:w,feePayer:g,maxBuyAmount:m,outAmount:f,slippage:y,shareFeeRate:T=new E.default(0),shareFeeReceiver:P,associatedOnly:x=!0,checkCreateATAOwner:k=!1,skipCheckMintA:b=!1}){f.lte(new E.default(0))&&this.logAndCreateError("out amount should gt 0:",f.toString());let A=this.createTxBuilder(g),{publicKey:K}=st(e,n,r);t=t!=null?t:Re(e).publicKey;let B=s;if(!B){let z=await this.scope.connection.getAccountInfo(K,{commitment:"processed"});z||this.logAndCreateError("cannot found pool:",K.toBase58()),B=Se.decode(z.data)}let C=a,N=await Le(this.scope.connection,[C?void 0:B.configId,B.platformId].filter(Boolean).map(z=>({pubkey:z})));if(!C){let z=N.find(W=>W.pubkey.equals(B.configId));(!z||!z.accountInfo)&&this.logAndCreateError("config not found: ",B.configId.toBase58()),C=ve.decode(z.accountInfo.data)}let h=N.find(z=>z.pubkey.equals(B.platformId));(!h||!h.accountInfo)&&this.logAndCreateError("platform info not found: ",B.configId.toBase58());let G=ct.decode(h.accountInfo.data);u=u||G.feeRate;let q=c;if(!b)if(q)i=S.TOKEN_2022_PROGRAM_ID;else{let z=await this.scope.connection.getAccountInfo(n);if(z&&z.owner.equals(S.TOKEN_2022_PROGRAM_ID)){i=z.owner;let W=(0,S.unpackMint)(n,z,i);q=(0,S.getTransferFeeConfig)(W)||void 0}}let O=ke.buyExactOut({poolInfo:B,amountA:f,protocolFeeRate:C.tradeFeeRate,platformFeeRate:u,curveType:C.curveType,shareFeeRate:T,creatorFeeRate:G.creatorFeeRate,transferFeeConfigA:q,slot:await this.scope.connection.getSlot()}),I=new ye.default(O.amountB.toString()),V=y?new ye.default(Ve.add(y).toNumber()/Ve.toNumber()).clampedTo(0,Number.MIN_SAFE_INTEGER):new ye.default(1),Y=(m!=null?m:y)?new E.default(I.mul(V).toFixed(0)):O.amountB,J=this.scope.account.getAssociatedTokenAccount(n,i),Q=null,ie=r.equals(S.NATIVE_MINT);A.addInstruction({instructions:[(0,S.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,J,this.scope.ownerPubKey,n,i)]});let{account:oe,instructionParams:ne}=await this.scope.account.getOrCreateTokenAccount({mint:r,owner:this.scope.ownerPubKey,createInfo:ie?{payer:this.scope.ownerPubKey,amount:O.amountB}:void 0,skipCloseAccount:!ie,notUseTokenAccount:ie,associatedOnly:ie?!1:x,checkCreateATAOwner:k});oe&&(Q=oe),A.addInstruction(ne||{}),Q===void 0&&this.logAndCreateError(`cannot found mintB(${r.toBase58()}) token accounts`,"tokenAccounts",this.scope.account.tokenAccounts);let re=P?he(P,r,S.TOKEN_PROGRAM_ID).publicKey:void 0;return re&&A.addInstruction({instructions:[(0,S.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,re,P,r)]}),A.addInstruction({instructions:[Qi(e,this.scope.ownerPubKey,t,B.configId,B.platformId,K,J,Q,B.vaultA,B.vaultB,n,r,i,S.TOKEN_PROGRAM_ID,je(e,B.platformId,r).publicKey,at(e,B.creator,r).publicKey,f,Y,T,re)]}),A.addCustomComputeBudget(l),A.addTipInstruction(w),A.versionBuild({txVersion:d,extInfo:{maxSpentAmount:Y,outAmount:f}})}async sellToken({programId:e=se,authProgramId:t,mintAProgram:n=S.TOKEN_PROGRAM_ID,mintA:i,mintB:r=S.NATIVE_MINT,poolInfo:s,configInfo:a,platformFeeRate:c,txVersion:u,computeBudgetConfig:d,txTipConfig:l,feePayer:w,sellAmount:g,minAmountB:m,slippage:f,shareFeeRate:y=new E.default(0),shareFeeReceiver:T,associatedOnly:P=!0,checkCreateATAOwner:x=!1,skipCheckMintA:k=!1}){t=t!=null?t:Re(e).publicKey;let b=this.createTxBuilder(w);g.lte(new E.default(0))&&this.logAndCreateError("sell amount should be gt 0");let{publicKey:A}=st(e,i,r),K;if(!k){let W=await this.scope.connection.getAccountInfo(i);if(W&&W.owner.equals(S.TOKEN_2022_PROGRAM_ID)){n=W.owner;let ue=(0,S.unpackMint)(i,W,n);K=(0,S.getTransferFeeConfig)(ue)||void 0}}let B=null,C=null,N=r.equals(S.NATIVE_MINT),{account:h,instructionParams:G}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:n,mint:i,owner:this.scope.ownerPubKey,createInfo:void 0,skipCloseAccount:!0,notUseTokenAccount:!1,associatedOnly:P,checkCreateATAOwner:x});h&&(B=h),b.addInstruction(G||{}),B===void 0&&this.logAndCreateError("cannot found mintA token accounts","tokenAccounts",this.scope.account.tokenAccounts);let{account:q,instructionParams:O}=await this.scope.account.getOrCreateTokenAccount({mint:r,owner:this.scope.ownerPubKey,createInfo:N?{payer:this.scope.ownerPubKey,amount:0}:void 0,skipCloseAccount:!N,notUseTokenAccount:N,associatedOnly:N?!1:P,checkCreateATAOwner:x});q&&(C=q),b.addInstruction(O||{}),C===void 0&&this.logAndCreateError("cannot found mintB token accounts","tokenAccounts",this.scope.account.tokenAccounts);let I=s;if(!I){let W=await this.scope.connection.getAccountInfo(A,{commitment:"processed"});W||this.logAndCreateError("cannot found pool",A.toBase58()),I=Se.decode(W.data)}let V=a,Y=await Le(this.scope.connection,[V?void 0:I.configId,I.platformId].filter(Boolean).map(W=>({pubkey:W})));if(!V){let W=Y.find(ue=>ue.pubkey.equals(I.configId));(!W||!W.accountInfo)&&this.logAndCreateError("config not found: ",I.configId.toBase58()),V=ve.decode(W.accountInfo.data)}let J=Y.find(W=>W.pubkey.equals(I.platformId));(!J||!J.accountInfo)&&this.logAndCreateError("platform info not found: ",I.configId.toBase58());let Q=ct.decode(J.accountInfo.data);c=c||Q.feeRate;let ie=ke.sellExactIn({poolInfo:I,amountA:g,protocolFeeRate:V.tradeFeeRate,platformFeeRate:c,curveType:V.curveType,shareFeeRate:y,creatorFeeRate:Q.creatorFeeRate,transferFeeConfigA:K,slot:await this.scope.connection.getSlot()}),oe=new ye.default(ie.amountB.toString()),ne=f?new ye.default(Ve.sub(f).toNumber()/Ve.toNumber()).clampedTo(0,1):new ye.default(1),re=m!=null?m:f?new E.default(oe.mul(ne).toFixed(0)):ie.amountB;re.lte(new E.default(0))&&this.logAndCreateError(`out ${r.toBase58()} amount should be gt 0`);let z=T?he(T,r,S.TOKEN_PROGRAM_ID).publicKey:void 0;return z&&b.addInstruction({instructions:[(0,S.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,z,T,r)]}),b.addInstruction({instructions:[Yi(e,this.scope.ownerPubKey,t,I.configId,I.platformId,A,B,C,I.vaultA,I.vaultB,i,r,n,S.TOKEN_PROGRAM_ID,je(e,I.platformId,r).publicKey,at(e,I.creator,r).publicKey,ie.amountA.amount.lt(g)?ie.amountA.amount:g,re,y,z)]}),b.addCustomComputeBudget(d),b.addTipInstruction(l),b.versionBuild({txVersion:u,extInfo:{outAmount:re}})}async sellTokenExactOut({programId:e=se,authProgramId:t,mintAProgram:n=S.TOKEN_PROGRAM_ID,mintA:i,mintB:r=S.NATIVE_MINT,poolInfo:s,configInfo:a,platformFeeRate:c,txVersion:u,computeBudgetConfig:d,txTipConfig:l,feePayer:w,inAmount:g,maxSellAmount:m,slippage:f,shareFeeRate:y=new E.default(0),shareFeeReceiver:T,associatedOnly:P=!0,checkCreateATAOwner:x=!1,skipCheckMintA:k=!1}){t=t!=null?t:Re(e).publicKey;let b=this.createTxBuilder(w);m!=null&&m.lte(new E.default(0))&&this.logAndCreateError("max sell amount should be gt 0");let{publicKey:A}=st(e,i,r),K;if(!k){let W=await this.scope.connection.getAccountInfo(i);if(W&&W.owner.equals(S.TOKEN_2022_PROGRAM_ID)){n=W.owner;let ue=(0,S.unpackMint)(i,W,n);K=(0,S.getTransferFeeConfig)(ue)||void 0}}let B=null,C=null,N=r.equals(S.NATIVE_MINT),{account:h,instructionParams:G}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:n,mint:i,owner:this.scope.ownerPubKey,createInfo:void 0,skipCloseAccount:!0,notUseTokenAccount:!1,associatedOnly:P,checkCreateATAOwner:x});h&&(B=h),b.addInstruction(G||{}),B===void 0&&this.logAndCreateError("cannot found mintA token accounts","tokenAccounts",this.scope.account.tokenAccounts);let{account:q,instructionParams:O}=await this.scope.account.getOrCreateTokenAccount({mint:r,owner:this.scope.ownerPubKey,createInfo:N?{payer:this.scope.ownerPubKey,amount:0}:void 0,skipCloseAccount:!N,notUseTokenAccount:N,associatedOnly:N?!1:P,checkCreateATAOwner:x});q&&(C=q),b.addInstruction(O||{}),C===void 0&&this.logAndCreateError("cannot found mintB token accounts","tokenAccounts",this.scope.account.tokenAccounts);let I=s;if(!I){let W=await this.scope.connection.getAccountInfo(A,{commitment:"processed"});W||this.logAndCreateError("cannot found pool",A.toBase58()),I=Se.decode(W.data)}let V=a,Y=await Le(this.scope.connection,[V?void 0:I.configId,I.platformId].filter(Boolean).map(W=>({pubkey:W})));if(!V){let W=Y.find(ue=>ue.pubkey.equals(I.configId));(!W||!W.accountInfo)&&this.logAndCreateError("config not found: ",I.configId.toBase58()),V=ve.decode(W.accountInfo.data)}let J=Y.find(W=>W.pubkey.equals(I.platformId));(!J||!J.accountInfo)&&this.logAndCreateError("platform info not found: ",I.configId.toBase58());let Q=ct.decode(J.accountInfo.data);c=c||Q.feeRate;let ie=ke.sellExactOut({poolInfo:I,amountB:g,protocolFeeRate:V.tradeFeeRate,platformFeeRate:c,curveType:V.curveType,shareFeeRate:y,creatorFeeRate:Q.creatorFeeRate,transferFeeConfigA:K,slot:await this.scope.connection.getSlot()}),oe=new ye.default(ie.amountA.amount.toString()),ne=f?new ye.default(Ve.add(f).toNumber()/Ve.toNumber()).clampedTo(0,Number.MAX_SAFE_INTEGER):new ye.default(1),re=(m!=null?m:f)?new E.default(oe.mul(ne).toFixed(0)):ie.amountA.amount,z=T?he(T,r,S.TOKEN_PROGRAM_ID).publicKey:void 0;return z&&b.addInstruction({instructions:[(0,S.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,z,T,r)]}),b.addInstruction({instructions:[Ji(e,this.scope.ownerPubKey,t,I.configId,I.platformId,A,B,C,I.vaultA,I.vaultB,i,r,n,S.TOKEN_PROGRAM_ID,je(e,I.platformId,r).publicKey,at(e,I.creator,r).publicKey,g,re,y,z)]}),b.addCustomComputeBudget(d),b.addTipInstruction(l),b.versionBuild({txVersion:u,extInfo:{maxSellAmount:re}})}async createPlatformConfig({programId:e=se,platformAdmin:t,platformClaimFeeWallet:n,platformLockNftWallet:i,cpConfigId:r,migrateCpLockNftScale:s,transferFeeExtensionAuth:a,creatorFeeRate:c,feeRate:u,name:d,web:l,img:w,txVersion:g,computeBudgetConfig:m,txTipConfig:f,feePayer:y}){let T=this.createTxBuilder(y),{publicKey:P}=Ln(e,t);return T.addInstruction({instructions:[$i(e,t,n,i,P,r,a,s,u,c,d,l,w)]}),T.addCustomComputeBudget(m),T.addTipInstruction(f),T.versionBuild({txVersion:g,extInfo:{platformId:P}})}async updatePlatformConfig({programId:e=se,platformAdmin:t,platformId:n,updateInfo:i,txVersion:r,computeBudgetConfig:s,txTipConfig:a,feePayer:c}){let u=this.createTxBuilder(c),d=n!=null?n:Ln(e,t).publicKey;return u.addInstruction({instructions:[er(e,t,d,i)]}),u.addCustomComputeBudget(s),u.addTipInstruction(a),u.versionBuild({txVersion:r})}async claimPlatformFee({programId:e=se,authProgramId:t,platformId:n,poolId:i,platformClaimFeeWallet:r,mintB:s,vaultB:a,mintBProgram:c=S.TOKEN_PROGRAM_ID,txVersion:u,computeBudgetConfig:d,txTipConfig:l,feePayer:w}){var T;let g=this.createTxBuilder(w);t=t!=null?t:Re(e).publicKey;let m=s,f=a;if(!m){let P=await this.scope.connection.getAccountInfo(i,{commitment:"processed"});P||this.logAndCreateError("cannot found pool:",i.toBase58());let x=Se.decode(P.data),k=await this.scope.connection.getAccountInfo(x.configId,{commitment:"processed"});k||this.logAndCreateError("cannot found config:",x.configId.toBase58()),m=ve.decode(k.data).mintB,f=f!=null?f:x.vaultB}(!m||!f)&&this.logAndCreateError("cannot found mint info, mintB: ",m.toBase58(),", vaultB: ",(T=f==null?void 0:f.toBase58())!=null?T:"");let y=he(this.scope.ownerPubKey,m,S.TOKEN_PROGRAM_ID).publicKey;return g.addInstruction({instructions:[(0,S.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,y,this.scope.ownerPubKey,m)]}),g.addInstruction({instructions:[En(e,r,t,i,n,f,y,m,c)]}),g.addCustomComputeBudget(d),g.addTipInstruction(l),g.versionBuild({txVersion:u})}async claimAllPlatformFee({programId:e=se,authProgramId:t,platformId:n,platformClaimFeeWallet:i,txVersion:r,computeBudgetConfig:s,txTipConfig:a,feePayer:c}){let u=this.createTxBuilder(c);return t=t!=null?t:Re(e).publicKey,(await this.scope.connection.getProgramAccounts(e,{filters:[{dataSize:Se.span},{memcmp:{offset:Se.offsetOf("platformId"),bytes:n.toString()}}]})).forEach(l=>{let w=Se.decode(l.account.data);if(w.platformFee.lte(new E.default(0)))return;let g=he(this.scope.ownerPubKey,w.mintB,S.TOKEN_PROGRAM_ID).publicKey;u.addInstruction({instructions:[(0,S.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,g,this.scope.ownerPubKey,w.mintB)]}),u.addInstruction({instructions:[En(e,i,t,l.pubkey,n,w.vaultB,g,w.mintB,S.TOKEN_PROGRAM_ID)]})}),u.addTipInstruction(a),r===0?u.sizeCheckBuildV0({computeBudgetConfig:s}):u.sizeCheckBuild({computeBudgetConfig:s})}async createVesting({programId:e=se,poolId:t,beneficiary:n,shareAmount:i,txVersion:r,computeBudgetConfig:s,txTipConfig:a,feePayer:c}){let u=this.createTxBuilder(c),d=await this.getRpcPoolInfo({poolId:t});i.add(d.vestingSchedule.totalAllocatedShare).gt(d.vestingSchedule.totalLockedAmount)&&this.logAndCreateError("share amount exceed total locked amount");let l=xt(e,t,n).publicKey;return u.addInstruction({instructions:[On(e,this.scope.ownerPubKey,n,t,l,i)]}),u.addCustomComputeBudget(s),u.addTipInstruction(a),u.versionBuild({txVersion:r})}async createMultipleVesting({programId:e=se,poolId:t,beneficiaryList:n,txVersion:i,computeBudgetConfig:r,feePayer:s}){let a=this.createTxBuilder(s);n.length===0&&this.logAndCreateError("beneficiaryList is null");let c=await this.getRpcPoolInfo({poolId:t});return n.reduce((d,l)=>d.add(l.shareAmount),c.vestingSchedule.totalAllocatedShare).gt(c.vestingSchedule.totalLockedAmount)&&this.logAndCreateError("share amount exceed total locked amount"),n.forEach(d=>{let l=xt(e,t,d.wallet).publicKey;a.addInstruction({instructions:[On(e,this.scope.ownerPubKey,d.wallet,t,l,d.shareAmount)]})}),i===0?a.sizeCheckBuildV0({computeBudgetConfig:r}):a.sizeCheckBuild({computeBudgetConfig:r})}async claimVesting({programId:e=se,poolId:t,poolInfo:n,vestingRecord:i,txVersion:r,computeBudgetConfig:s,txTipConfig:a,feePayer:c}){let u=this.createTxBuilder(c),d=Re(e).publicKey,l=i||xt(e,t,this.scope.ownerPubKey).publicKey,w=n;if(!w){let m=await this.scope.connection.getAccountInfo(t);m||this.logAndCreateError("pool not found"),w=Se.decode(m.data)}let g=he(this.scope.ownerPubKey,w.mintA,S.TOKEN_PROGRAM_ID).publicKey;return u.addInstruction({instructions:[(0,S.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,g,this.scope.ownerPubKey,w.mintA)]}),u.addInstruction({instructions:[Mn(e,this.scope.ownerPubKey,d,t,l,g,w.vaultA,w.mintA,S.TOKEN_PROGRAM_ID)]}),u.addCustomComputeBudget(s),u.addTipInstruction(a),u.versionBuild({txVersion:r})}async claimMultiVesting({programId:e=se,poolIdList:t,poolsInfo:n={},vestingRecords:i={},txVersion:r,computeBudgetConfig:s,feePayer:a}){let c=this.createTxBuilder(a),u=_({},n),d=Re(e).publicKey,l=t.filter(w=>!u[w.toBase58()]);if(l.length){let w=await this.getRpcPoolsInfo({poolIdList:l});u=_(_({},u),w.poolInfoMap)}return t.forEach(w=>{let g=w.toBase58(),m=u[g];m||this.logAndCreateError(`pool info not found: ${g}`);let f=i[g]||xt(e,w,this.scope.ownerPubKey).publicKey,y=he(this.scope.ownerPubKey,m.mintA,S.TOKEN_PROGRAM_ID).publicKey;c.addInstruction({instructions:[(0,S.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,y,this.scope.ownerPubKey,m.mintA)]}),c.addInstruction({instructions:[Mn(e,this.scope.ownerPubKey,d,w,f,y,m.vaultA,m.mintA,S.TOKEN_PROGRAM_ID)]})}),r===0?c.sizeCheckBuildV0({computeBudgetConfig:s}):c.sizeCheckBuild({computeBudgetConfig:s})}async claimVaultPlatformFee({programId:e=se,platformId:t,mintB:n,mintBProgram:i=S.TOKEN_PROGRAM_ID,claimFeeWallet:r,txVersion:s,computeBudgetConfig:a,txTipConfig:c,feePayer:u}){let d=this.createTxBuilder(u),l=je(e,t,n).publicKey,w=Fn(e).publicKey,g=this.scope.account.getAssociatedTokenAccount(n,i);return d.addInstruction({instructions:[(0,S.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,g,this.scope.ownerPubKey,n,i),vn(e,t,r!=null?r:this.scope.ownerPubKey,w,l,g,n,i)]}),d.addCustomComputeBudget(a),d.addTipInstruction(c),d.versionBuild({txVersion:s})}async claimMultipleVaultPlatformFee({programId:e=se,platformList:t,unwrapSol:n=!0,txVersion:i,computeBudgetConfig:r,feePayer:s,associatedOnly:a=!0,checkCreateATAOwner:c=!1}){let u=this.createTxBuilder(s),d={};return t.forEach(async l=>{var y,T;let w=Fn(e).publicKey,g=je(e,l.id,l.mintB).publicKey,m=l.mintB.equals(S.NATIVE_MINT)&&n,f=d[l.mintB.toBase58()];if(!f){let{account:P,instructionParams:x}=await this.scope.account.getOrCreateTokenAccount({mint:l.mintB,owner:this.scope.ownerPubKey,createInfo:m?{payer:this.scope.ownerPubKey,amount:0}:void 0,skipCloseAccount:!m,notUseTokenAccount:m,associatedOnly:m?!1:a,checkCreateATAOwner:c});P&&(f=P),u.addInstruction(x||{}),f===void 0&&this.logAndCreateError(`cannot found platform ${l.id.toBase58()} mintB(${l.mintB.toBase58()}) token accounts`,"tokenAccounts",this.scope.account.tokenAccounts)}u.addInstruction({instructions:[vn(e,l.id,(y=l.claimFeeWallet)!=null?y:this.scope.ownerPubKey,g,w,f,l.mintB,(T=l.mintBProgram)!=null?T:S.TOKEN_PROGRAM_ID)]})}),i===0?u.sizeCheckBuildV0({computeBudgetConfig:r}):u.sizeCheckBuild({computeBudgetConfig:r})}async claimCreatorFee({programId:e=se,mintB:t,mintBProgram:n=S.TOKEN_PROGRAM_ID,txVersion:i,computeBudgetConfig:r,txTipConfig:s,feePayer:a}){let c=this.createTxBuilder(a),u=at(e,this.scope.ownerPubKey,t).publicKey,d=zi(e).publicKey,l=this.scope.account.getAssociatedTokenAccount(t,n);return c.addInstruction({instructions:[(0,S.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,l,this.scope.ownerPubKey,t,n),tr(e,this.scope.ownerPubKey,d,u,l,t,n)]}),c.addCustomComputeBudget(r),c.addTipInstruction(s),c.versionBuild({txVersion:i})}async getRpcPoolInfo({poolId:e}){return(await this.getRpcPoolsInfo({poolIdList:[e]})).poolInfoMap[e.toBase58()]}async getRpcPoolsInfo({poolIdList:e,config:t}){let n=await Le(this.scope.connection,e.map(c=>({pubkey:c})),t),i={},r=[];for(let c=0;c<e.length;c++){let u=n[c];if(u===null||!u.accountInfo)throw Error("fetch pool info error: "+e[c].toBase58());let d=Se.decode(u.accountInfo.data);i[e[c].toBase58()]=j(_({},d),{poolId:u.accountInfo.owner}),r.push(d.configId)}let s=await Le(this.scope.connection,r.map(c=>({pubkey:c})),t),a={};for(let c=0;c<r.length;c++){let u=s[c];if(u===null||!u.accountInfo)throw Error("fetch config info error: "+r[c].toBase58());let d=ve.decode(u.accountInfo.data);a[r[c].toBase58()]=j(_({},d),{configId:u.accountInfo.owner})}return{poolInfoMap:Object.keys(i).reduce((c,u)=>j(_({},c),{[u]:j(_({},i[u]),{configInfo:a[i[u].configId.toBase58()]})}),{})}}};0&&(module.exports={LaunchpadPoolInitParam});
//# sourceMappingURL=launchpad.js.map