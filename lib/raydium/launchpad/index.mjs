var on=Object.defineProperty,sn=Object.defineProperties;var an=Object.getOwnPropertyDescriptors;var yt=Object.getOwnPropertySymbols;var cn=Object.prototype.hasOwnProperty,un=Object.prototype.propertyIsEnumerable;var gt=(i,e,t)=>e in i?on(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,F=(i,e)=>{for(var t in e||(e={}))cn.call(e,t)&&gt(i,t,e[t]);if(yt)for(var t of yt(e))un.call(e,t)&&gt(i,t,e[t]);return i},O=(i,e)=>sn(i,an(e));import{SystemProgram as z,TransactionInstruction as G}from"@solana/web3.js";import{ASSOCIATED_TOKEN_PROGRAM_ID as Oe,TOKEN_2022_PROGRAM_ID as Ci,TOKEN_PROGRAM_ID as bt}from"@solana/spl-token";import Be from"bn.js";import{PublicKey as Tn}from"@solana/web3.js";import Bt,{isBN as ht}from"bn.js";import{bits as Qi,BitStructure as Zi,blob as ln,Blob as Ji,cstr as $i,f32 as er,f32be as tr,f64 as nr,f64be as ir,greedy as rr,Layout as mn,ns64 as or,ns64be as sr,nu64 as ar,nu64be as cr,offset as dn,s16 as ur,s16be as lr,s24 as mr,s24be as dr,s32 as pn,s32be as pr,s40 as fr,s40be as br,s48 as yr,s48be as gr,s8 as Pr,seq as fn,struct as Ar,Structure as bn,u16 as yn,u16be as Tr,u24 as wr,u24be as kr,u32 as gn,u32be as Br,u40 as hr,u40be as xr,u48 as Ir,u48be as Sr,u8 as Pn,UInt as An,union as Kr,Union as Cr,unionLayoutDiscriminator as Nr,utf8 as Lr}from"@solana/buffer-layout";var Ge=mn,Pt=bn;var Ue=An;var At=Pn,J=yn;var Tt=gn;var $=pn;var wt=fn;var W=ln;var kt=dn;var ce=class extends Ge{constructor(t,n,r){super(t,r);this.blob=W(t),this.signed=n}decode(t,n=0){let r=new Bt(this.blob.decode(t,n),10,"le");return this.signed?r.fromTwos(this.span*8).clone():r}encode(t,n,r=0){return typeof t=="number"&&(t=new Bt(t)),this.signed&&(t=t.toTwos(this.span*8)),this.blob.encode(t.toArrayLike(Buffer,"le",this.span),n,r)}};function y(i){return new Ue(1,i)}function le(i){return new Ue(4,i)}function o(i){return new ce(8,!1,i)}function C(i){return new ce(16,!1,i)}function xt(i){return new ce(8,!0,i)}function It(i){return new ce(16,!0,i)}var ue=class extends Ge{constructor(t,n,r,s){super(t.span,s);this.layout=t,this.decoder=n,this.encoder=r}decode(t,n){return this.decoder(this.layout.decode(t,n))}encode(t,n,r){return this.layout.encode(this.encoder(t),n,r)}getSpan(t,n){return this.layout.getSpan(t,n)}};function d(i){return new ue(W(32),e=>new Tn(e),e=>e.toBuffer(),i)}function ze(i){return new ue(At(),wn,kn,i)}function wn(i){if(i===0)return!1;if(i===1)return!0;throw new Error("Invalid bool: "+i)}function kn(i){return i?1:0}function Bn(i){let e=Tt("length"),t=g([e,W(kt(e,-e.span),"data")]);return new ue(t,({data:n})=>n,n=>({data:n}),i)}function V(i){return new ue(Bn(),e=>e.toString("utf-8"),e=>Buffer.from(e,"utf-8"),i)}var Xe=class extends Pt{decode(e,t){return super.decode(e,t)}};function g(i,e,t){return new Xe(i,e,t)}function w(i,e,t){let n,r=typeof e=="number"?e:ht(e)?e.toNumber():new Proxy(e,{get(s,a){if(!n){let c=Reflect.get(s,"count");n=ht(c)?c.toNumber():c,Reflect.set(s,"count",n)}return Reflect.get(s,a)},set(s,a,c){return a==="count"&&(n=c),Reflect.set(s,a,c)}});return wt(i,r,t)}import{PublicKey as jr}from"@solana/web3.js";import{get as St,set as hn}from"lodash";var He=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:0,this.name=e.name}set level(e){this.logLevel=e}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let t=e.map(n=>typeof n=="object"?JSON.stringify(n):n).join(", ");throw new Error(t)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},Kt={},xn={};function D(i){let e=St(Kt,i);if(!e){let t=St(xn,i);e=new He({name:i,logLevel:t}),hn(Kt,i,e)}return e}import{MINT_SIZE as Jr,TOKEN_PROGRAM_ID as $r,getTransferFeeConfig as eo,unpackMint as to}from"@solana/spl-token";var no=D("Raydium_accountInfo_util");import Y from"bn.js";import Xs from"decimal.js";import Fn from"big.js";import wo from"bn.js";import In from"toformat";var Sn=In,be=Sn;import Ne from"big.js";import Cn from"bn.js";import Nn from"decimal.js-light";import ye from"bn.js";var Nt=9007199254740991;function j(i){let e=D("Raydium_parseBigNumberish");if(i instanceof ye)return i;if(typeof i=="string"){if(i.match(/^-?[0-9]+$/))return new ye(i);e.logWithError(`invalid BigNumberish string: ${i}`)}return typeof i=="number"?(i%1&&e.logWithError(`BigNumberish number underflow: ${i}`),(i>=Nt||i<=-Nt)&&e.logWithError(`BigNumberish number overflow: ${i}`),new ye(String(i))):typeof i=="bigint"?new ye(i.toString()):(e.error(`invalid BigNumberish value: ${i}`),new ye(0))}var Ce=D("module/fraction"),je=be(Ne),ge=be(Nn),Ln={[0]:ge.ROUND_DOWN,[1]:ge.ROUND_HALF_UP,[2]:ge.ROUND_UP},Rn={[0]:Ne.roundDown,[1]:Ne.roundHalfUp,[2]:Ne.roundUp},K=class{constructor(e,t=new Cn(1)){this.numerator=j(e),this.denominator=j(t)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new K(this.denominator,this.numerator)}add(e){let t=e instanceof K?e:new K(j(e));return this.denominator.eq(t.denominator)?new K(this.numerator.add(t.numerator),this.denominator):new K(this.numerator.mul(t.denominator).add(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}sub(e){let t=e instanceof K?e:new K(j(e));return this.denominator.eq(t.denominator)?new K(this.numerator.sub(t.numerator),this.denominator):new K(this.numerator.mul(t.denominator).sub(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}mul(e){let t=e instanceof K?e:new K(j(e));return new K(this.numerator.mul(t.numerator),this.denominator.mul(t.denominator))}div(e){let t=e instanceof K?e:new K(j(e));return new K(this.numerator.mul(t.denominator),this.denominator.mul(t.numerator))}toSignificant(e,t={groupSeparator:""},n=1){Number.isInteger(e)||Ce.logWithError(`${e} is not an integer.`),e<=0&&Ce.logWithError(`${e} is not positive.`),ge.set({precision:e+1,rounding:Ln[n]});let r=new ge(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return r.toFormat(r.decimalPlaces(),t)}toFixed(e,t={groupSeparator:""},n=1){return Number.isInteger(e)||Ce.logWithError(`${e} is not an integer.`),e<0&&Ce.logWithError(`${e} is negative.`),je.DP=e,je.RM=Rn[n]||1,new je(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,t)}isZero(){return this.numerator.isZero()}};var No=D("Raydium_amount"),Lo=be(Fn);import{PublicKey as On}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Lt}from"@solana/spl-token";var Ye={chainId:101,address:On.default.toBase58(),programId:Lt.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},ee={chainId:101,address:"So11111111111111111111111111111111111111112",programId:Lt.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};import{PublicKey as Je}from"@solana/web3.js";import{PublicKey as N,SystemProgram as Rt,SYSVAR_RENT_PUBKEY as En}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as vn}from"@solana/spl-token";function Qe({pubkey:i,isSigner:e=!1,isWritable:t=!0}){return{pubkey:i,isWritable:t,isSigner:e}}var Wo=[Qe({pubkey:vn,isWritable:!1}),Qe({pubkey:Rt.programId,isWritable:!1}),Qe({pubkey:En,isWritable:!1})];function Ft({publicKey:i,transformSol:e}){let t=Mt(i.toString());if(t instanceof N)return e&&t.equals(Pe)?Ke:t;if(e&&t.toString()===Pe.toBase58())return Ke;if(typeof t=="string"){if(t===N.default.toBase58())return N.default;try{return new N(t)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function Mt(i){try{return new N(i)}catch{return i}}var Dn=new N("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),Wn=new N("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),Ze=new N("SysvarRent111111111111111111111111111111111"),Vo=new N("SysvarC1ock11111111111111111111111111111111"),Le=new N("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),_o=new N("Sysvar1nstructions1111111111111111111111111"),qo=Rt.programId,Go=new N("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),Uo=new N("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),Xo=new N("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),zo=new N("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),Ho=new N("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),jo=new N("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),Yo=new N("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),Qo=new N("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),Zo=new N("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),Jo=new N("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),$o=new N("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),Ke=new N("So11111111111111111111111111111111111111112"),Pe=N.default;var $e=class{constructor({mint:e,decimals:t,symbol:n,name:r,skipMint:s=!1,isToken2022:a=!1}){if(e===Pe.toBase58()||e instanceof Je&&Pe.equals(e)){this.decimals=ee.decimals,this.symbol=ee.symbol,this.name=ee.name,this.mint=new Je(ee.address),this.isToken2022=!1;return}this.decimals=t,this.symbol=n||e.toString().substring(0,6),this.name=r||e.toString().substring(0,6),this.mint=s?Je.default:Ft({publicKey:e}),this.isToken2022=a}equals(e){return this===e?!0:this.mint.equals(e.mint)}},te=$e;te.WSOL=new $e(O(F({},ee),{mint:ee.address}));var et=class{constructor({decimals:e,symbol:t="UNKNOWN",name:n="UNKNOWN"}){this.decimals=e,this.symbol=t,this.name=n}equals(e){return this===e}},Re=et;Re.SOL=new et(Ye);import Vn from"bn.js";var ms=new K(new Vn(100));var gs=D("Raydium_price");import{PublicKey as Ms}from"@solana/web3.js";import Es from"bn.js";var _n=new Y(0),ta=new Y(1),na=new Y(2),ia=new Y(3),ra=new Y(5),Mn=new Y(10),oa=new Y(100),sa=new Y(1e3),aa=new Y(1e4);function Ot(i,e,t){return i.mul(e).add(t).sub(new Y(1)).div(t)}import{PublicKey as La}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Fa}from"@solana/spl-token";import{ComputeBudgetProgram as ba,Keypair as Pa,PublicKey as qn,Transaction as Ta,TransactionMessage as ka,VersionedTransaction as Ba}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Sa}from"@solana/spl-token";var Ka=D("Raydium_txUtil");function _(i,e){let[t,n]=qn.findProgramAddressSync(i,e);return{publicKey:t,nonce:n}}import{PublicKey as m}from"@solana/web3.js";var va=new m("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),Da=new m("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),Wa=new m("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),Va=new m("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),_a=new m("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),qa=new m("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),Ga=new m("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),Ua=new m("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),Xa=new m("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),za=new m("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Gn=new m("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),Un=new m("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),Xn=new m("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),Ha=new m("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),ja=new m("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),Ya=new m("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),Qa=new m("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),Za=new m("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),Ja=new m("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),$a=new m("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),ec=new m("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),tc=new m("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),nc=new m("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),ic=new m("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),rc=new m("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),zn=new m("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),oc=new m("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),sc=new m("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),ac=new m("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),cc=new m("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),uc=new m("6s1xP3hpbAfFoNtUNF8mfHsjr2Bd97JxFJRWLbL6aHuX");var lc={OPEN_BOOK_PROGRAM:new m("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),SERUM_PROGRAM_ID_V3:new m("Ray1111111111111111111111111111111111111111"),AMM_V4:new m("DRaya7Kj3aMWQSy19kSjvmuwq9docCHofyP9kanQGaav"),AMM_STABLE:new m("DRayDdXc1NZQ9C3hRWmoSf8zK4iapgMnjdNZWrfwsP8m"),CLMM_PROGRAM_ID:new m("DRayAUgENGQBKVaX8owNhgzkEDyoHTGVEGHVJT1E9pfH"),CLMM_LOCK_PROGRAM_ID:new m("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),CLMM_LOCK_AUTH_ID:new m("6Aoh8h2Lw2m5UGxYR8AdAL87jTWYeKoxM52mJRzfYwN"),CREATE_CPMM_POOL_PROGRAM:new m("DRaycpLY18LhpbydsBWbVJtxpNv9oXPgjRSfpF2bWpYb"),CREATE_CPMM_POOL_AUTH:new m("CXniRufdq5xL8t8jZAPxsPZDpuudwuJSPWnbcD5Y5Nxq"),CREATE_CPMM_POOL_FEE_ACC:new m("3oE58BKVt8KuYkGxx8zBojugnymWmBiyafWgMrnb6eYy"),LOCK_CPMM_PROGRAM:new m("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),LOCK_CPMM_AUTH:new m("7qWVV8UY2bRJfDLP4s37YzBPKUkVB46DStYJBpYbQzu3"),UTIL1216:m.default,Router:new m("DRaybByLpbUL57LJARs3j8BitTxVfzBg351EaMr5UTCd"),FARM_PROGRAM_ID_V3:new m("DRayWyrLmEW5KEeqs8kdTMMaBabapqagaBC7KWpGtJeZ"),FARM_PROGRAM_ID_V4:new m("Ray1111111111111111111111111111111111111111"),FARM_PROGRAM_ID_V5:new m("DRayiCGSZgku1GTK6rXD6mVDdingXy6APAH1R6R5L2LC"),FARM_PROGRAM_ID_V6:new m("DRayzbYakXs45ELHkzH6vC3fuhQqTAnv5A68gdFuvZyZ"),LAUNCHPAD_PROGRAM:new m("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),LAUNCHPAD_AUTH:new m("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),LAUNCHPAD_PLATFORM:new m("2Jx4KTDrVSdWNazuGpcA8n3ZLTRGGBDxAWhuKe2Xcj2a"),LAUNCHPAD_CONFIG:new m("7ZR4zD7PYfY2XxoG1Gxcy2EgEeGYrpxrwzPuwdUBssEt"),FEE_DESTINATION_ID:new m("9y8ENuuZ3b19quffx9hQvRVygG5ky6snHfRvGpuSfeJy"),MODEL_DATA_PUBKEY:new m("Ray1111111111111111111111111111111111111111")};import v from"bn.js";var Ae=1e4;function rt(i,e){let{div:t,mod:n}=i.divmod(e);return n.gt(new v(0))?t.add(new v(1)):t}function re(i,e){if(i.isZero())return new v(0);let t=i.div(e);return t.isZero()?new v(1):i.mod(e).gt(new v(0))?t.add(new v(1)):t}function ot(i,e,t){if(e===void 0)return{amount:i,fee:void 0,expirationTime:void 0};let n=Math.floor(t/432e3),r=n<e.newerTransferFee.epoch?e.olderTransferFee:e.newerTransferFee,s=new v(r.maximumFee.toString()),a=n<e.newerTransferFee.epoch?(Number(e.newerTransferFee.epoch)*432e3-t)*400/1e3:void 0,c=rt(i.mul(new v(r.transferFeeBasisPoints)),new v(Ae)),b=c.gt(s)?s:c;return{amount:i,fee:b,expirationTime:a}}function st(i,e,t){if(e===void 0)return{amount:i,fee:void 0,expirationTime:void 0};let n=Math.floor(t/432e3),r=n<e.newerTransferFee.epoch?e.olderTransferFee:e.newerTransferFee,s=new v(r.maximumFee.toString()),a=n<e.newerTransferFee.epoch?(Number(e.newerTransferFee.epoch)*432e3-t)*400/1e3:void 0;if(r.transferFeeBasisPoints===Ae){let c=new v(r.maximumFee.toString());return{amount:i.add(c),fee:c,expirationTime:a}}else{let c=rt(i.mul(new v(Ae)),new v(Ae-r.transferFeeBasisPoints)),b=new v(r.maximumFee.toString()),f=c.sub(i).gt(b)?i.add(b):c,P=rt(f.mul(new v(r.transferFeeBasisPoints)),new v(Ae)),p=P.gt(s)?s:P;return{amount:f,fee:p,expirationTime:a}}}import{PublicKey as Hn,AddressLookupTableAccount as Et}from"@solana/web3.js";var jn={AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU:new Et({key:new Hn("AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU"),state:Et.deserialize(Buffer.from("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","base64"))})};import{PublicKey as Cc,sendAndConfirmTransaction as Nc,SystemProgram as Fc,Transaction as Mc,TransactionMessage as Ec,VersionedTransaction as vc}from"@solana/web3.js";import Wc from"axios";import Yn from"bn.js";var oe=new Yn(1e6);import{PublicKey as pd}from"@solana/web3.js";import bd from"bn.js";import gd from"decimal.js";import{AccountLayout as Td,createAssociatedTokenAccountIdempotentInstruction as wd,TOKEN_2022_PROGRAM_ID as kd,TOKEN_PROGRAM_ID as Bd}from"@solana/spl-token";import{PublicKey as fu}from"@solana/web3.js";import{MintLayout as yu,TOKEN_PROGRAM_ID as Pu}from"@solana/spl-token";import{Keypair as vm,PublicKey as Dm,SystemProgram as Vm,TransactionInstruction as _m}from"@solana/web3.js";import Gm from"bn.js";import{ASSOCIATED_TOKEN_PROGRAM_ID as zm,TOKEN_2022_PROGRAM_ID as Hm,TOKEN_PROGRAM_ID as jm}from"@solana/spl-token";import ym from"bn.js";import Pm from"decimal.js";import X from"bn.js";var at=new X(0),Vt=new X(1),_t=new X(-1),Q=new X(1).shln(64),qt=new X(1).shln(128),ct=Q.sub(Vt);var Qn=qt.subn(1),me=-443636,Te=-me,ut=new X("4295048016"),lt=new X("79226673521066979257578248091"),Ru=new X("4295048017"),Fu=new X("79226673521066979257578248090");var Zn=new X(10).pow(new X(6));var Mu=new X("18446744073700000000");import tm from"bn.js";import im from"decimal.js";function mt(i){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,i,!1),new Uint8Array(e)}var Vu=Buffer.from("amm_config","utf8"),Gt=Buffer.from("pool","utf8"),Ut=Buffer.from("pool_vault","utf8"),_u=Buffer.from("pool_reward_vault","utf8"),qu=Buffer.from("position","utf8"),Gu=Buffer.from("tick_array","utf8"),Uu=Buffer.from("operation","utf8"),Xu=Buffer.from("pool_tick_array_bitmap_extension","utf8"),zu=Buffer.from("observation","utf8");var Hu=Buffer.from("locked_position","utf8");var ju=Buffer.from("support_mint","utf8");import{PublicKey as Kl}from"@solana/web3.js";import{TOKEN_2022_PROGRAM_ID as Nl}from"@solana/spl-token";import Rl from"bn.js";import Ml from"decimal.js";import Zu from"bn.js";import $u from"decimal.js";var ft=14;var Me=60;var ti=g([W(8),y("bump"),J("index"),d(""),le("protocolFeeRate"),le("tradeFeeRate"),J("tickSpacing"),w(o(),8,"")]),ni=g([le("blockTimestamp"),xt("tickCumulative"),w(o(),4)]),tn=g([W(8),ze("initialized"),o("recentEpoch"),J("observationIndex"),d("poolId"),w(ni,100,"observations"),w(o(),4)]),ii=g([y("rewardState"),o("openTime"),o("endTime"),o("lastUpdateTime"),C("emissionsPerSecondX64"),o("rewardTotalEmissioned"),o("rewardClaimed"),d("tokenMint"),d("tokenVault"),d("creator"),C("rewardGrowthGlobalX64")]),Jt=g([W(8),y("bump"),d("ammConfig"),d("creator"),d("mintA"),d("mintB"),d("vaultA"),d("vaultB"),d("observationId"),y("mintDecimalsA"),y("mintDecimalsB"),J("tickSpacing"),C("liquidity"),C("sqrtPriceX64"),$("tickCurrent"),le(),C("feeGrowthGlobalX64A"),C("feeGrowthGlobalX64B"),o("protocolFeesTokenA"),o("protocolFeesTokenB"),C("swapInAmountTokenA"),C("swapOutAmountTokenB"),C("swapInAmountTokenB"),C("swapOutAmountTokenA"),y("status"),w(y(),7,""),w(ii,3,"rewardInfos"),w(o(),16,"tickArrayBitmap"),o("totalFeesTokenA"),o("totalFeesClaimedTokenA"),o("totalFeesTokenB"),o("totalFeesClaimedTokenB"),o("fundFeesTokenA"),o("fundFeesTokenB"),o("startTime"),w(o(),15*4-3,"padding")]),ri=g([C("growthInsideLastX64"),o("rewardAmountOwed")]),$t=g([W(8),y("bump"),d("nftMint"),d("poolId"),$("tickLower"),$("tickUpper"),C("liquidity"),C("feeGrowthInsideLastX64A"),C("feeGrowthInsideLastX64B"),o("tokenFeesOwedA"),o("tokenFeesOwedB"),w(ri,3,"rewardInfos"),w(o(),8,"")]),Sm=g([W(8),y("bump"),d("poolId"),$("tickLowerIndex"),$("tickUpperIndex"),C("liquidity"),C("feeGrowthInsideLastX64A"),C("feeGrowthInsideLastX64B"),o("tokenFeesOwedA"),o("tokenFeesOwedB"),w(C(),3,"rewardGrowthInside"),w(o(),8,"")]),oi=g([$("tick"),It("liquidityNet"),C("liquidityGross"),C("feeGrowthOutsideX64A"),C("feeGrowthOutsideX64B"),w(C(),3,"rewardGrowthsOutsideX64"),w(le(),13,"")]),jt=g([W(8),d("poolId"),$("startTickIndex"),w(oi,Me,"ticks"),y("initializedTickCount"),w(y(),115,"")]),si=g([W(329),w(d(),100,"whitelistMints")]),ei=g([W(8),d("poolId"),w(w(o(),8),ft,"positiveTickArrayBitmap"),w(w(o(),8),ft,"negativeTickArrayBitmap")]),Km=g([o(),y("bump"),d("owner"),d("poolId"),d("positionId"),d("nftAccount"),w(o(),8)]),ai=g([W(8),y("bump"),d("lockOwner"),d("poolId"),d("positionId"),d("nftAccount"),d("lockNftMint"),o("recentEpoch"),w(o(),8)]);tn.span;var id=D("Raydium_Clmm");var pi=Buffer.from("vault_auth_seed","utf8"),fi=Buffer.from("global_config","utf8"),bi=Buffer.from("pool_vesting","utf8"),yi=Buffer.from("platform_config","utf8"),gi=Buffer.from("platform_fee_vault_auth_seed","utf8"),Pi=Buffer.from("creator_fee_vault_auth_seed","utf8");function Ai(i){return _([pi],i)}function cp(i,e,t,n){return _([fi,e.toBuffer(),ki(t),mt(n)],i)}function Ti(i,e,t){return _([Gt,e.toBuffer(),t.toBuffer()],i)}function wi(i,e,t){return _([Ut,e.toBuffer(),t.toBuffer()],i)}function se(i){return _([Buffer.from("__event_authority","utf8")],i)}function ki(i){let e=new ArrayBuffer(1);return new DataView(e).setUint8(0,i),new Uint8Array(e)}function Bi(i,e){return _([yi,e.toBuffer()],i)}function hi(i,e,t){return _([bi,e.toBuffer(),t.toBuffer()],i)}function xi(i,e,t){return _([e.toBuffer(),t.toBuffer()],i)}function Ii(i){return _([gi],i)}function Si(i,e,t){return _([e.toBuffer(),t.toBuffer()],i)}function Ki(i){return _([Pi],i)}var U={initialize:Buffer.from([175,175,109,31,13,152,155,237]),buyExactIn:Buffer.from([250,234,13,123,213,156,19,236]),buyExactOut:Buffer.from([24,211,116,40,105,3,153,56]),sellExactIn:Buffer.from([149,39,222,155,211,124,152,26]),sellExactOut:Buffer.from([95,200,71,34,8,9,11,166]),createVestingAccount:Buffer.from([129,178,2,13,217,172,230,218]),claimVestedToken:Buffer.from([49,33,104,30,189,157,79,35]),createPlatformConfig:Buffer.from([176,90,196,175,253,113,220,20]),claimPlatformFee:Buffer.from([156,39,208,135,76,237,61,72]),updatePlaformConfig:Buffer.from([195,60,76,129,146,45,67,143]),initializeWithToken2022:Buffer.from([37,190,126,222,44,154,171,17]),claimPlatformFeeFromVault:Buffer.from([117,241,198,168,248,218,80,29]),claimCreatorFee:Buffer.from([26,97,138,203,132,171,141,252])};function Ni(i,e,t,n,r,s,a,c,b,f,P,p,x,I,A,T,k,M,B,S){let L=g([y("decimals"),V("name"),V("symbol"),V("uri")]),h=g([o("totalLockedAmount"),o("cliffPeriod"),o("unlockPeriod")]),R=g([y("index"),o("supply"),o("totalFundRaisingB"),y("migrateType")]),ie=g([y("index"),o("supply"),o("totalSellA"),o("totalFundRaisingB"),y("migrateType")]),qe=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!0,isWritable:!0},{pubkey:b,isSigner:!1,isWritable:!1},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:P,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:bt,isSigner:!1,isWritable:!1},{pubkey:bt,isSigner:!1,isWritable:!1},{pubkey:Le,isSigner:!1,isWritable:!1},{pubkey:z.programId,isSigner:!1,isWritable:!1},{pubkey:Ze,isSigner:!1,isWritable:!1},{pubkey:se(i).publicKey,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1}],pe=Buffer.alloc(Buffer.from(I,"utf-8").length+Buffer.from(A,"utf-8").length+Buffer.from(T,"utf-8").length+4*3+1),fe=Buffer.alloc(h.span),Z=Buffer.alloc(k.type==="ConstantCurve"?ie.span:R.span);return L.encode({decimals:x,name:I,symbol:A,uri:T},pe),k.type==="ConstantCurve"?ie.encode(O(F({index:0},k),{migrateType:k.migrateType==="amm"?0:1}),Z):k.type==="FixedCurve"?R.encode(O(F({index:1},k),{migrateType:k.migrateType==="amm"?0:1}),Z):k.type==="LinearCurve"&&R.encode(O(F({index:2},k),{migrateType:k.migrateType==="amm"?0:1}),Z),h.encode({totalLockedAmount:M,cliffPeriod:B,unlockPeriod:S},fe),new G({keys:qe,programId:i,data:Buffer.from([...U.initialize,...pe,...Z,...fe])})}function Li(i,e,t,n,r,s,a,c,b,f,P,p,x,I,A,T,k,M,B,S){let L=g([y("decimals"),V("name"),V("symbol"),V("uri")]),h=g([o("totalLockedAmount"),o("cliffPeriod"),o("unlockPeriod"),y("transferFeeExtensionParamsOption"),g([J("transferFeeBasePoints"),o("maxinumFee")]).replicate("transferFeeExtensionParams")]),R=g([y("index"),o("supply"),o("totalFundRaisingB"),y("migrateType")]),ie=g([y("index"),o("supply"),o("totalSellA"),o("totalFundRaisingB"),y("migrateType")]),qe=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!0,isWritable:!0},{pubkey:b,isSigner:!1,isWritable:!1},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:P,isSigner:!1,isWritable:!0},{pubkey:Ci,isSigner:!1,isWritable:!1},{pubkey:bt,isSigner:!1,isWritable:!1},{pubkey:z.programId,isSigner:!1,isWritable:!1},{pubkey:se(i).publicKey,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1}],pe=Buffer.alloc(Buffer.from(x,"utf-8").length+Buffer.from(I,"utf-8").length+Buffer.from(A,"utf-8").length+4*3+1),fe=Buffer.alloc(h.span),Z=Buffer.alloc(T.type==="ConstantCurve"?ie.span:R.span);return L.encode({decimals:p,name:x,symbol:I,uri:A},pe),T.type==="ConstantCurve"?ie.encode(O(F({index:0},T),{migrateType:T.migrateType==="amm"?0:1}),Z):T.type==="FixedCurve"?R.encode(O(F({index:1},T),{migrateType:T.migrateType==="amm"?0:1}),Z):T.type==="LinearCurve"&&R.encode(O(F({index:2},T),{migrateType:T.migrateType==="amm"?0:1}),Z),h.encode({totalLockedAmount:k,cliffPeriod:M,unlockPeriod:B,transferFeeExtensionParamsOption:S?1:0,transferFeeExtensionParams:S!=null?S:{transferFeeBasePoints:0,maxinumFee:new Be(0)}},fe),new G({keys:qe,programId:i,data:Buffer.from([...U.initializeWithToken2022,...pe,...Z,...fe])})}function Ri(i,e,t,n,r,s,a,c,b,f,P,p,x,I,A,T,k,M,B,S){let L=g([o("amountB"),o("minAmountA"),o("shareFeeRate")]),h=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:b,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:P,isSigner:!1,isWritable:!1},{pubkey:p,isSigner:!1,isWritable:!1},{pubkey:x,isSigner:!1,isWritable:!1},{pubkey:I,isSigner:!1,isWritable:!1},{pubkey:se(i).publicKey,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1}];S&&h.push({pubkey:S,isSigner:!1,isWritable:!0}),h.push({pubkey:z.programId,isSigner:!1,isWritable:!1}),h.push({pubkey:A,isSigner:!1,isWritable:!0}),h.push({pubkey:T,isSigner:!1,isWritable:!0});let R=Buffer.alloc(L.span);return L.encode({amountB:k,minAmountA:M,shareFeeRate:B!=null?B:new Be(0)},R),new G({keys:h,programId:i,data:Buffer.from([...U.buyExactIn,...R])})}function Fi(i,e,t,n,r,s,a,c,b,f,P,p,x,I,A,T,k,M,B,S){let L=g([o("amountA"),o("maxAmountB"),o("shareFeeRate")]),h=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:b,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:P,isSigner:!1,isWritable:!1},{pubkey:p,isSigner:!1,isWritable:!1},{pubkey:x,isSigner:!1,isWritable:!1},{pubkey:I,isSigner:!1,isWritable:!1},{pubkey:se(i).publicKey,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1}];S&&h.push({pubkey:S,isSigner:!1,isWritable:!0}),h.push({pubkey:z.programId,isSigner:!1,isWritable:!1}),h.push({pubkey:A,isSigner:!1,isWritable:!0}),h.push({pubkey:T,isSigner:!1,isWritable:!0});let R=Buffer.alloc(L.span);return L.encode({amountA:k,maxAmountB:M,shareFeeRate:B!=null?B:new Be(0)},R),new G({keys:h,programId:i,data:Buffer.from([...U.buyExactOut,...R])})}function Mi(i,e,t,n,r,s,a,c,b,f,P,p,x,I,A,T,k,M,B,S){let L=g([o("amountA"),o("minAmountB"),o("shareFeeRate")]),h=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:b,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:P,isSigner:!1,isWritable:!1},{pubkey:p,isSigner:!1,isWritable:!1},{pubkey:x,isSigner:!1,isWritable:!1},{pubkey:I,isSigner:!1,isWritable:!1},{pubkey:se(i).publicKey,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1}];S&&h.push({pubkey:S,isSigner:!1,isWritable:!0}),h.push({pubkey:z.programId,isSigner:!1,isWritable:!1}),h.push({pubkey:A,isSigner:!1,isWritable:!0}),h.push({pubkey:T,isSigner:!1,isWritable:!0});let R=Buffer.alloc(L.span);return L.encode({amountA:k,minAmountB:M,shareFeeRate:B!=null?B:new Be(0)},R),new G({keys:h,programId:i,data:Buffer.from([...U.sellExactIn,...R])})}function Oi(i,e,t,n,r,s,a,c,b,f,P,p,x,I,A,T,k,M,B,S){let L=g([o("amountB"),o("maxAmountA"),o("shareFeeRate")]),h=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:b,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:P,isSigner:!1,isWritable:!1},{pubkey:p,isSigner:!1,isWritable:!1},{pubkey:x,isSigner:!1,isWritable:!1},{pubkey:I,isSigner:!1,isWritable:!1},{pubkey:se(i).publicKey,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1}];S&&h.push({pubkey:S,isSigner:!1,isWritable:!0}),h.push({pubkey:z.programId,isSigner:!1,isWritable:!1}),h.push({pubkey:A,isSigner:!1,isWritable:!0}),h.push({pubkey:T,isSigner:!1,isWritable:!0});let R=Buffer.alloc(L.span);return L.encode({amountB:k,maxAmountA:M,shareFeeRate:B!=null?B:new Be(0)},R),new G({keys:h,programId:i,data:Buffer.from([...U.sellExactOut,...R])})}function Ei(i,e,t,n,r,s,a,c,b){let f=g([]),P=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!1},{pubkey:b,isSigner:!1,isWritable:!1},{pubkey:z.programId,isSigner:!1,isWritable:!1},{pubkey:Oe,isSigner:!1,isWritable:!1}],p=Buffer.alloc(f.span);return f.encode({},p),new G({keys:P,programId:i,data:Buffer.from([...U.claimVestedToken,...p])})}function vi(i,e,t,n,r,s){let a=g([o("shareAmount")]),c=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:z.programId,isSigner:!1,isWritable:!1}],b=Buffer.alloc(a.span);return a.encode({shareAmount:s},b),new G({keys:c,programId:i,data:Buffer.from([...U.createVestingAccount,...b])})}function Di(i,e,t,n,r,s,a,c,b){let f=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:b,isSigner:!1,isWritable:!0},{pubkey:z.programId,isSigner:!1,isWritable:!0},{pubkey:Oe,isSigner:!1,isWritable:!0}];return new G({keys:f,programId:i,data:U.claimPlatformFee})}function Wi(i,e,t,n,r,s,a,c,b,f,P,p,x){let I=g([o("platformScale"),o("creatorScale"),o("burnScale"),o("feeRate"),V("name"),V("web"),V("img"),o("creatorFeeRate")]),A=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:z.programId,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!1}],T=Buffer.alloc(8*5+Buffer.from(P,"utf-8").length+Buffer.from(p,"utf-8").length+Buffer.from(x,"utf-8").length+4*3);return I.encode({platformScale:c.platformScale,creatorScale:c.creatorScale,burnScale:c.burnScale,feeRate:b,name:P,web:p,img:x,creatorFeeRate:f},T),new G({keys:A,programId:i,data:Buffer.from([...U.createPlatformConfig,...T])})}function Vi(i,e,t,n){let r=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!0}],s;if(n.type==="updateClaimFeeWallet"){let a=g([y("index"),d("value")]);s=Buffer.alloc(a.span),a.encode({index:0,value:n.value},s)}else if(n.type==="updateLockNftWallet"){let a=g([y("index"),d("value")]);s=Buffer.alloc(a.span),a.encode({index:1,value:n.value},s)}else if(n.type==="migrateCpLockNftScale"){let a=g([y("index"),o("platformScale"),o("creatorScale"),o("burnScale")]);s=Buffer.alloc(a.span),a.encode(F({index:2},n.value),s)}else if(n.type==="updateFeeRate"){let a=g([y("index"),o("value")]);s=Buffer.alloc(a.span),a.encode({index:3,value:n.value},s)}else if(n.type==="updateImg"||n.type==="updateName"||n.type==="updateWeb"){let a=g([y("index"),V("value")]);s=Buffer.alloc(Buffer.from(n.value,"utf-8").length+4+1*1),n.type==="updateName"?a.encode({index:4,value:n.value},s):n.type==="updateWeb"?a.encode({index:5,value:n.value},s):n.type==="updateImg"&&a.encode({index:6,value:n.value},s)}else if(n.type==="updateCpConfigId"){r.push({pubkey:n.value,isSigner:!1,isWritable:!1});let a=g([y("index")]);s=Buffer.alloc(a.span),a.encode({index:7},s)}else if(n.type==="updateAll"){r.push({pubkey:n.value.cpConfigId,isSigner:!1,isWritable:!1});let a=g([y("index"),d("platformClaimFeeWallet"),d("platformLockNftWallet"),o("platformScale"),o("creatorScale"),o("burnScale"),o("feeRate"),V("name"),V("web"),V("img"),d("transferFeeExtensionAuth"),o("creatorFeeRate")]);s=Buffer.alloc(1+32+32+8*4+4*3+Buffer.from(n.value.name,"utf-8").length+Buffer.from(n.value.web,"utf-8").length+Buffer.from(n.value.img,"utf-8").length),a.encode({index:8,platformClaimFeeWallet:n.value.platformClaimFeeWallet,platformLockNftWallet:n.value.platformLockNftWallet,platformScale:n.value.migrateCpLockNftScale.platformScale,creatorScale:n.value.migrateCpLockNftScale.creatorScale,burnScale:n.value.migrateCpLockNftScale.burnScale,feeRate:n.value.feeRate,name:n.value.name,web:n.value.web,img:n.value.img,transferFeeExtensionAuth:n.value.transferFeeExtensionAuth,creatorFeeRate:n.value.creatorFeeRate},s)}else throw Error("updateInfo params type error");return new G({keys:r,programId:i,data:Buffer.from([...U.updatePlaformConfig,...s])})}function _i(i,e,t,n,r,s,a,c){let b=[{pubkey:t,isSigner:!0,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:e,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!1},{pubkey:z.programId,isSigner:!1,isWritable:!1},{pubkey:Oe,isSigner:!1,isWritable:!1}];return new G({keys:b,programId:i,data:U.claimPlatformFeeFromVault})}function qi(i,e,t,n,r,s,a){let c=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:z.programId,isSigner:!1,isWritable:!1},{pubkey:Oe,isSigner:!1,isWritable:!1}];return new G({keys:c,programId:i,data:U.claimCreatorFee})}var Gi=g([o(),o("epoch"),y("curveType"),J("index"),o("migrateFee"),o("tradeFeeRate"),o("maxShareFeeRate"),o("minSupplyA"),o("maxLockRate"),o("minSellRateA"),o("minMigrateRateA"),o("minFundRaisingB"),d("mintB"),d("protocolFeeOwner"),d("migrateFeeOwner"),d("migrateToAmmWallet"),d("migrateToCpmmWallet"),w(o(),16)]),Ui=g([o("totalLockedAmount"),o("cliffPeriod"),o("unlockPeriod"),o("startTime"),o("totalAllocatedShare")]),Xi=g([o(),o("epoch"),y("bump"),y("status"),y("mintDecimalsA"),y("mintDecimalsB"),y("migrateType"),o("supply"),o("totalSellA"),o("virtualA"),o("virtualB"),o("realA"),o("realB"),o("totalFundRaisingB"),o("protocolFee"),o("platformFee"),o("migrateFee"),Ui.replicate("vestingSchedule"),d("configId"),d("platformId"),d("mintA"),d("mintB"),d("vaultA"),d("vaultB"),d("creator"),y("mintProgramFlag"),w(y(),63)]),Tp=g([o(),o("epoch"),d("poolId"),d("beneficiary"),o("claimedAmount"),o("tokenShareAmount"),w(o(),8)]),zi=g([o(),o("epoch"),d("platformClaimFeeWallet"),d("platformLockNftWallet"),o("platformScale"),o("creatorScale"),o("burnScale"),o("feeRate"),w(y(),64,"name"),w(y(),256,"web"),w(y(),256,"img"),d("cpConfigId"),o("creatorFeeRate"),d("transferFeeExtensionAuth"),w(y(),184)]);import Ee from"bn.js";import he from"decimal.js";var ne=class{static getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n}){throw Error()}static getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:r}){throw Error()}static getPoolPrice({poolInfo:e,decimalA:t,decimalB:n}){throw Error()}static getPoolEndPrice({supply:e,totalSell:t,totalLockedAmount:n,totalFundRaising:r,migrateFee:s,decimalA:a,decimalB:c}){throw Error()}static getPoolEndPriceReal({poolInfo:e,decimalA:t,decimalB:n}){throw Error()}static getInitParam({supply:e,totalFundRaising:t,totalSell:n,totalLockedAmount:r,migrateFee:s}){throw Error()}static buyExactIn({poolInfo:e,amount:t}){throw Error()}static buyExactOut({poolInfo:e,amount:t}){throw Error()}static sellExactIn({poolInfo:e,amount:t}){throw Error()}static sellExactOut({poolInfo:e,amount:t}){throw Error()}};var ve=class extends ne{static getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n}){return new he(e.virtualB.toString()).div(e.virtualA.toString()).mul(10**(t-n))}static getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:r}){return new he(t.toString()).div(e.toString()).mul(10**(n-r))}static getPoolPrice({poolInfo:e,decimalA:t,decimalB:n}){return new he(e.virtualB.add(e.realB).toString()).div(e.virtualA.sub(e.realA).toString()).mul(10**(t-n))}static getPoolEndPrice({supply:e,totalSell:t,totalLockedAmount:n,totalFundRaising:r,migrateFee:s,decimalA:a,decimalB:c}){return new he(r.sub(s).toString()).div(e.sub(t).sub(n).toString()).mul(10**(a-c))}static getPoolEndPriceReal({poolInfo:e,decimalA:t,decimalB:n}){let r=e.totalSellA.sub(e.realA),s=e.totalFundRaisingB.sub(e.realB);return new he(e.virtualB.add(e.realB.add(s)).toString()).div(e.virtualA.sub(e.realA.add(r)).toString()).mul(10**(t-n))}static getInitParam({supply:e,totalFundRaising:t,totalSell:n,totalLockedAmount:r,migrateFee:s}){if(e.lte(n))throw Error("supply need gt total sell");let a=e.sub(n).sub(r);if(a.lte(new Ee(0)))throw Error("supplyMinusSellLocked <= 0");let c=t.sub(s);if(c.lte(new Ee(0)))throw Error("tfMinusMf <= 0");let b=c.mul(n).mul(n).div(a),f=c.mul(n).div(a).sub(t),P=b.div(f),p=t.mul(t).div(f);if(P.lt(new Ee(0))||p.lt(new Ee(0)))throw Error("invalid input 0");return{a:P,b:p,c:n}}static buyExactIn({poolInfo:e,amount:t}){return this.getAmountOut({amountIn:t,inputReserve:e.virtualB.add(e.realB),outputReserve:e.virtualA.sub(e.realA)})}static buyExactOut({poolInfo:e,amount:t}){return this.getAmountIn({amountOut:t,inputReserve:e.virtualB.add(e.realB),outputReserve:e.virtualA.sub(e.realA)})}static sellExactIn({poolInfo:e,amount:t}){return this.getAmountOut({amountIn:t,inputReserve:e.virtualA.sub(e.realA),outputReserve:e.virtualB.add(e.realB)})}static sellExactOut({poolInfo:e,amount:t}){return this.getAmountIn({amountOut:t,inputReserve:e.virtualA.sub(e.realA),outputReserve:e.virtualB.add(e.realB)})}static getAmountOut({amountIn:e,inputReserve:t,outputReserve:n}){let r=e.mul(n),s=t.add(e);return r.div(s)}static getAmountIn({amountOut:e,inputReserve:t,outputReserve:n}){let r=t.mul(e),s=n.sub(e);return re(r,s)}};import H from"bn.js";import rn from"decimal.js";import De from"bn.js";import xe from"decimal.js";var We=class extends ne{static getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n}){return new xe(e.virtualB.toString()).div(e.virtualA.toString()).mul(10**(t-n))}static getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:r}){return new xe(t.toString()).div(e.toString()).mul(10**(n-r))}static getPoolPrice({poolInfo:e,decimalA:t,decimalB:n}){return new xe(e.virtualB.toString()).div(e.virtualA.toString()).mul(10**(t-n))}static getPoolEndPrice({supply:e,totalSell:t,totalLockedAmount:n,totalFundRaising:r,migrateFee:s,decimalA:a,decimalB:c}){return new xe(r.sub(s).toString()).div(e.sub(t).sub(n).toString()).mul(10**(a-c))}static getPoolEndPriceReal({poolInfo:e,decimalA:t,decimalB:n}){let r=e.totalSellA.sub(e.realA),s=e.totalFundRaisingB.sub(e.realB);return new xe(e.virtualB.add(e.realB).add(s).toString()).div(e.virtualA.sub(e.realA).add(r).toString()).mul(10**(t-n))}static getInitParam({supply:e,totalFundRaising:t,totalSell:n,totalLockedAmount:r,migrateFee:s}){let a=e.sub(r);if(a.lte(new De(0)))throw Error("invalid input 1");let c=new De(2).mul(t).sub(s),f=t.mul(a).div(c);if(f.lt(new De(0))||t.lt(new De(0)))throw Error("invalid input 0");return{a:f,b:t,c:f}}static buyExactIn({poolInfo:e,amount:t}){return this.getAmountOut({amountIn:t,initInput:e.virtualB,initOutput:e.virtualA})}static buyExactOut({poolInfo:e,amount:t}){return this.getAmountIn({amountOut:t,initInput:e.virtualB,initOutput:e.virtualA})}static sellExactIn({poolInfo:e,amount:t}){return this.getAmountOut({amountIn:t,initInput:e.virtualA,initOutput:e.virtualB})}static sellExactOut({poolInfo:e,amount:t}){return this.getAmountIn({amountOut:t,initInput:e.virtualA,initOutput:e.virtualB})}static getAmountOut({amountIn:e,initInput:t,initOutput:n}){return n.mul(e).div(t)}static getAmountIn({amountOut:e,initInput:t,initOutput:n}){let r=t.mul(e);return re(r,n)}};import q from"bn.js";import ae from"decimal.js";import de from"bn.js";import Ve from"decimal.js";var Ie=class{static _multipler(e){return new Ve(10).pow(e)}static getPrice({priceX64:e,decimalA:t,decimalB:n}){return new Ve(e.toString()).div(this._Q64).mul(this._multipler(t)).div(this._multipler(n))}static getPriceX64({price:e,decimalA:t,decimalB:n}){let r=e.mul(this._multipler(n)).div(this._multipler(t));return new de(r.mul(this._Q64).toFixed(0))}};Ie._Q64=new Ve(new de(1).shln(64).toString());function vp({supply:i,totalFundRaisingB:e,totalLockedAmount:t,totalSellA:n,migrateType:r,decimalsA:s}){let a=i.sub(n).sub(t),c=new de(new Ve(a.mul(e).toString()).sqrt().toFixed(0));if(r==="amm"){if(c.gt(new de(10).pow(new de(s))))return!0}else if(r==="cpmm"){if(c.gt(new de(100)))return!0}else throw Error("migrate type error");return!1}var _e=class extends ne{static getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n}){return new ae(0)}static getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:r}){return new ae(0)}static getPoolPrice({poolInfo:e,decimalA:t,decimalB:n}){return new ae(e.virtualA.mul(e.realA).toString()).div(Ie._Q64).mul(10**(t-n))}static getPoolEndPrice({supply:e,totalSell:t,totalLockedAmount:n,totalFundRaising:r,migrateFee:s,decimalA:a,decimalB:c}){return new ae(r.sub(s).toString()).div(e.sub(t).sub(n).toString()).mul(10**(a-c))}static getPoolEndPriceReal({poolInfo:e,decimalA:t,decimalB:n}){let r=e.totalSellA.sub(e.realA),s=e.totalFundRaisingB.sub(e.realB);return new ae(e.virtualB.add(e.realB).add(s).toString()).div(e.virtualA.sub(e.realA).add(r).toString()).mul(10**(t-n))}static getInitParam({supply:e,totalFundRaising:t,totalSell:n,totalLockedAmount:r,migrateFee:s}){let a=e.sub(r);if(a.lte(new q(0)))throw Error("supplyMinusLocked need gt 0");let c=t.mul(new q(3)).sub(s),f=t.mul(new q(2)).mul(a).div(c),P=f.mul(f),p=t.mul(new q(2)).mul(Q).div(P);if(!p.gt(new q(0)))throw Error("a need gt 0");if(!ct.gt(p))throw Error("a need lt u64 max");if(p.lt(new q(0))||f.lt(new q(0)))throw Error("invalid input 0");return{a:p,b:new q(0),c:f}}static buyExactIn({poolInfo:e,amount:t}){let n=e.realB.add(t),r=new q(2).mul(n).mul(Q).div(e.virtualA);return new q(new ae(r.toString()).sqrt().toFixed(0)).sub(e.realA)}static buyExactOut({poolInfo:e,amount:t}){let n=e.realA.add(t),r=n.mul(n);return re(e.virtualA.mul(r),new q(2).mul(Q)).sub(e.realB)}static sellExactIn({poolInfo:e,amount:t}){let n=e.realA.sub(t),r=n.mul(n),s=re(e.virtualA.mul(r),new q(2).mul(Q));return e.realB.sub(s)}static sellExactOut({poolInfo:e,amount:t}){let n=e.realB.sub(t),r=new q(2).mul(n).mul(Q).div(e.virtualA),s=new q(new ae(r.toString()).sqrt().toFixed(0));return e.realA.sub(s)}};var Se=class{static getPoolCurvePointByPoolInfo({curveType:e,pointCount:t,poolInfo:n}){return this.getPoolCurvePointByInit({curveType:e,pointCount:t,supply:n.supply,totalFundRaising:n.totalFundRaisingB,totalSell:n.totalSellA,totalLockedAmount:n.vestingSchedule.totalLockedAmount,migrateFee:n.migrateFee,decimalA:n.mintDecimalsA,decimalB:n.mintDecimalsB})}static getPoolCurvePointByInit({curveType:e,pointCount:t,supply:n,totalFundRaising:r,totalSell:s,totalLockedAmount:a,migrateFee:c,decimalA:b,decimalB:f}){if(t<3)throw Error("point count < 3");let P=this.getCurve(e),p=P.getInitParam({supply:n,totalFundRaising:r,totalSell:s,totalLockedAmount:a,migrateFee:c}),x=P.getPoolInitPriceByInit(O(F({},p),{decimalA:b,decimalB:f})),I=r.div(new H(t-1)),A=new H(0),T=[{price:x,totalSellSupply:0}],{a:k,b:M}=p,B=A,S=A;for(let L=1;L<t;L++){let h=L!==t-1?I:r.sub(S),R=this.buyExactIn({poolInfo:{virtualA:k,virtualB:M,realA:B,realB:S,totalFundRaisingB:r,totalSellA:s},amountB:h,protocolFeeRate:A,platformFeeRate:A,curveType:e,shareFeeRate:A,creatorFeeRate:A,transferFeeConfigA:void 0,slot:0});B=B.add(R.amountA.amount),S=S.add(R.amountB);let ie=this.getPrice({poolInfo:{virtualA:k,virtualB:M,realA:B,realB:S},decimalA:b,decimalB:f,curveType:e});T.push({price:ie,totalSellSupply:new rn(B.toString()).div(10**b).toNumber()})}return T}static getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n,curveType:r}){return this.getCurve(r).getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n})}static getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:r,curveType:s}){return this.getCurve(s).getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:r})}static getPrice({poolInfo:e,curveType:t,decimalA:n,decimalB:r}){return this.getCurve(t).getPoolPrice({poolInfo:e,decimalA:n,decimalB:r})}static getEndPrice({poolInfo:e,curveType:t,decimalA:n,decimalB:r}){return this.getCurve(t).getPoolPrice({poolInfo:e,decimalA:n,decimalB:r})}static getPoolEndPriceReal({poolInfo:e,curveType:t,decimalA:n,decimalB:r}){return this.getCurve(t).getPoolEndPriceReal({poolInfo:e,decimalA:n,decimalB:r})}static checkParam({supply:e,totalFundRaising:t,totalSell:n,totalLockedAmount:r,decimals:s,config:a,migrateType:c}){if(Number(s)!==6)throw Error("decimals = 6");if(e.mul(a.maxLockRate).div(oe).lt(r))throw Error("total lock amount gte max lock amount");if(e.lt(a.minSupplyA.mul(new H(10**s))))throw Error("supply lt min supply");let f=e.mul(a.minSellRateA).div(oe);if(n.lt(f))throw Error("invalid input");if(t.lt(a.minFundRaisingB))throw Error("total fund raising lt min fund raising");let P=e.sub(n).sub(r),p=e.mul(a.minMigrateRateA).div(oe);if(P.lt(p))throw Error("migrate lt min migrate amoount");let x=e.sub(n).sub(r),I=new H(new rn(x.mul(t).toString()).sqrt().toFixed(0));if(c==="amm"){let A=new H(10).pow(new H(s));if(I.lte(A))throw Error("check migrate lp error")}else if(c==="cpmm"){let A=new H(100);if(I.lte(A))throw Error("check migrate lp error")}else throw Error("migrate type error")}static buyExactIn({poolInfo:e,amountB:t,protocolFeeRate:n,platformFeeRate:r,curveType:s,shareFeeRate:a,creatorFeeRate:c,transferFeeConfigA:b,slot:f}){let P=this.totalFeeRate({protocolFeeRate:n,platformFeeRate:r,shareFeeRate:a,creatorFeeRate:c}),p=this.calculateFee({amount:t,feeRate:P}),x=t.sub(p),I=this.getCurve(s),A=I.buyExactIn({poolInfo:e,amount:x}),T=e.totalSellA.sub(e.realA),k,M,B;if(A.gt(T)){k=T;let L=I.buyExactOut({poolInfo:e,amount:k});M=this.calculatePreFee({postFeeAmount:L,feeRate:P}),B=M.sub(L)}else k=A,M=t,B=p;let S=this.splitFee({totalFee:B,protocolFeeRate:n,platformFeeRate:r,shareFeeRate:a,creatorFeeRate:c});return{amountA:ot(k,b,f),amountB:M,splitFee:S}}static buyExactOut({poolInfo:e,amountA:t,protocolFeeRate:n,platformFeeRate:r,curveType:s,shareFeeRate:a,creatorFeeRate:c,transferFeeConfigA:b,slot:f}){let P=e.totalSellA.sub(e.realA),p=st(t,b,f),x=p.fee?p.amount.add(p.fee):p.amount;t.gt(P)&&(x=P);let A=this.getCurve(s).buyExactOut({poolInfo:e,amount:x}),T=this.totalFeeRate({protocolFeeRate:n,platformFeeRate:r,shareFeeRate:a,creatorFeeRate:c}),k=this.calculatePreFee({postFeeAmount:A,feeRate:T}),M=k.sub(A),B=this.splitFee({totalFee:M,protocolFeeRate:n,platformFeeRate:r,shareFeeRate:a,creatorFeeRate:c});return{amountA:p,amountB:k,splitFee:B}}static sellExactIn({poolInfo:e,amountA:t,protocolFeeRate:n,platformFeeRate:r,curveType:s,shareFeeRate:a,creatorFeeRate:c,transferFeeConfigA:b,slot:f}){let P=this.getCurve(s),p=ot(t,b,f),x=p.fee?p.amount.sub(p.fee):p.amount,I=P.sellExactIn({poolInfo:e,amount:x}),A=this.calculateFee({amount:I,feeRate:this.totalFeeRate({protocolFeeRate:n,platformFeeRate:r,shareFeeRate:a,creatorFeeRate:c})}),T=this.splitFee({totalFee:A,protocolFeeRate:n,platformFeeRate:r,shareFeeRate:a,creatorFeeRate:c});return{amountA:p,amountB:I.sub(A),splitFee:T}}static sellExactOut({poolInfo:e,amountB:t,protocolFeeRate:n,platformFeeRate:r,curveType:s,shareFeeRate:a,creatorFeeRate:c,transferFeeConfigA:b,slot:f}){let P=this.totalFeeRate({protocolFeeRate:n,platformFeeRate:r,shareFeeRate:a,creatorFeeRate:c}),p=this.calculatePreFee({postFeeAmount:t,feeRate:P});if(e.realB.lt(p))throw Error("Insufficient liquidity");let x=p.sub(t),A=Se.getCurve(s).sellExactOut({poolInfo:e,amount:p});if(A.gt(e.realA))throw Error();let T=this.splitFee({totalFee:x,protocolFeeRate:n,platformFeeRate:r,shareFeeRate:a,creatorFeeRate:c});return{amountA:st(A,b,f),amountB:t,splitFee:T}}static splitFee({totalFee:e,protocolFeeRate:t,platformFeeRate:n,shareFeeRate:r,creatorFeeRate:s}){let a=this.totalFeeRate({protocolFeeRate:t,platformFeeRate:n,shareFeeRate:r,creatorFeeRate:s}),c=a.isZero()?new H(0):e.mul(n).div(a),b=a.isZero()?new H(0):e.mul(r).div(a),f=a.isZero()?new H(0):e.mul(s).div(a),P=e.sub(c).sub(b).sub(f);return{platformFee:c,shareFee:b,protocolFee:P,creatorFee:f}}static calculateFee({amount:e,feeRate:t}){return Ot(e,t,oe)}static calculatePreFee({postFeeAmount:e,feeRate:t}){if(t.isZero())return e;let n=e.mul(oe),r=oe.sub(t);return n.add(r).sub(new H(1)).div(r)}static totalFeeRate({protocolFeeRate:e,platformFeeRate:t,shareFeeRate:n,creatorFeeRate:r}){if(e.add(t).add(n).add(r).gt(new H(1e6)))throw Error("total fee rate gt 1_000_000");return e.add(t).add(n).add(r)}static getCurve(e){switch(e){case 0:return ve;case 1:return We;case 2:return _e}throw Error("find curve error")}};import{NATIVE_MINT as mf,TOKEN_2022_PROGRAM_ID as df,TOKEN_PROGRAM_ID as pf,createAssociatedTokenAccountIdempotentInstruction as bf,getTransferFeeConfig as yf,unpackMint as gf}from"@solana/spl-token";import E from"bn.js";import{PublicKey as Hi}from"@solana/web3.js";import Sf from"decimal.js";var Kf={initPriceX64:new E("515752397214619"),supply:new E(1e15),totalSellA:new E(7931e11),totalFundRaisingB:new E(85e9),totalLockedAmount:new E("0"),cliffPeriod:new E("0"),unlockPeriod:new E("0"),decimals:6,virtualA:new E("1073471847374405"),virtualB:new E("30050573465"),realA:new E(0),realB:new E(0),protocolFee:new E(0),platformId:new Hi("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),vestingSchedule:{totalLockedAmount:new E(0),cliffPeriod:new E(0),unlockPeriod:new E(0),startTime:new E(0),totalAllocatedShare:new E(0)}},Cf=new E(1e4);export{pi as AUTH_SEED,fi as CONFIG_SEED,Pi as CREATOR_FEE_VAULT_AUTH_SEED,Se as Curve,ne as CurveBase,We as FixedPriceCurve,ve as LaunchConstantProductCurve,Gi as LaunchpadConfig,Xi as LaunchpadPool,Kf as LaunchpadPoolInitParam,Tp as LaunchpadVesting,_e as LinearPriceCurve,Ie as MathLaunch,gi as PLATFORM_FEE_VAULT_AUTH_SEED,yi as PLATFORM_SEED,bi as POOL_VESTING_SEED,zi as PlatformConfig,Ui as VestingSchedule,U as anchorDataBuf,Ri as buyExactInInstruction,Fi as buyExactOutInstruction,vp as checkPoolToAmm,qi as claimCreatorFee,Di as claimPlatformFee,_i as claimPlatformFeeFromVault,Ei as claimVestedToken,Wi as createPlatformConfig,vi as createVestingAccount,se as getPdaCpiEvent,Ki as getPdaCreatorFeeVaultAuth,Si as getPdaCreatorVault,Ai as getPdaLaunchpadAuth,cp as getPdaLaunchpadConfigId,Ti as getPdaLaunchpadPoolId,wi as getPdaLaunchpadVaultId,Ii as getPdaPlatformFeeVaultAuth,Bi as getPdaPlatformId,xi as getPdaPlatformVault,hi as getPdaVestId,Ni as initialize,Li as initializeWithToken2022,Mi as sellExactInInstruction,Oi as sellExactOut,ki as u8ToBytes,Vi as updatePlatformConfig};
//# sourceMappingURL=index.mjs.map