var ar=Object.defineProperty,ur=Object.defineProperties;var cr=Object.getOwnPropertyDescriptors;var Ft=Object.getOwnPropertySymbols;var ri=Object.prototype.hasOwnProperty,oi=Object.prototype.propertyIsEnumerable;var ii=(o,e,t)=>e in o?ar(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,_=(o,e)=>{for(var t in e||(e={}))ri.call(e,t)&&ii(o,t,e[t]);if(Ft)for(var t of Ft(e))oi.call(e,t)&&ii(o,t,e[t]);return o},Y=(o,e)=>ur(o,cr(e));var We=(o,e)=>{var t={};for(var n in o)ri.call(o,n)&&e.indexOf(n)<0&&(t[n]=o[n]);if(o!=null&&Ft)for(var n of Ft(o))e.indexOf(n)<0&&oi.call(o,n)&&(t[n]=o[n]);return t};import{get as si,set as lr}from"lodash";var $t=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:0,this.name=e.name}set level(e){this.logLevel=e}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let t=e.map(n=>typeof n=="object"?JSON.stringify(n):n).join(", ");throw new Error(t)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},ai={},mr={};function oe(o){let e=si(ai,o);if(!e){let t=si(mr,o);e=new $t({name:o,logLevel:t}),lr(ai,o,e)}return e}import{PublicKey as Qe,sendAndConfirmTransaction as gn,SystemProgram as _r,Transaction as Bt,TransactionMessage as Le,VersionedTransaction as Fe}from"@solana/web3.js";import qr from"axios";import{PublicKey as bn,AddressLookupTableAccount as st}from"@solana/web3.js";import{PublicKey as Vr}from"@solana/web3.js";import Ie from"bn.js";import pa from"decimal.js";import Ar from"big.js";import Qo from"bn.js";import dr from"toformat";var pr=dr,ft=pr;import Ot from"big.js";import br from"bn.js";import yr from"decimal.js-light";import bt from"bn.js";var ui=9007199254740991;function xe(o){let e=oe("Raydium_parseBigNumberish");if(o instanceof bt)return o;if(typeof o=="string"){if(o.match(/^-?[0-9]+$/))return new bt(o);e.logWithError(`invalid BigNumberish string: ${o}`)}return typeof o=="number"?(o%1&&e.logWithError(`BigNumberish number underflow: ${o}`),(o>=ui||o<=-ui)&&e.logWithError(`BigNumberish number overflow: ${o}`),new bt(String(o))):typeof o=="bigint"?new bt(o.toString()):(e.error(`invalid BigNumberish value: ${o}`),new bt(0))}var Mt=oe("module/fraction"),en=ft(Ot),yt=ft(yr),gr={[0]:yt.ROUND_DOWN,[1]:yt.ROUND_HALF_UP,[2]:yt.ROUND_UP},Pr={[0]:Ot.roundDown,[1]:Ot.roundHalfUp,[2]:Ot.roundUp},ee=class{constructor(e,t=new br(1)){this.numerator=xe(e),this.denominator=xe(t)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new ee(this.denominator,this.numerator)}add(e){let t=e instanceof ee?e:new ee(xe(e));return this.denominator.eq(t.denominator)?new ee(this.numerator.add(t.numerator),this.denominator):new ee(this.numerator.mul(t.denominator).add(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}sub(e){let t=e instanceof ee?e:new ee(xe(e));return this.denominator.eq(t.denominator)?new ee(this.numerator.sub(t.numerator),this.denominator):new ee(this.numerator.mul(t.denominator).sub(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}mul(e){let t=e instanceof ee?e:new ee(xe(e));return new ee(this.numerator.mul(t.numerator),this.denominator.mul(t.denominator))}div(e){let t=e instanceof ee?e:new ee(xe(e));return new ee(this.numerator.mul(t.denominator),this.denominator.mul(t.numerator))}toSignificant(e,t={groupSeparator:""},n=1){Number.isInteger(e)||Mt.logWithError(`${e} is not an integer.`),e<=0&&Mt.logWithError(`${e} is not positive.`),yt.set({precision:e+1,rounding:gr[n]});let i=new yt(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return i.toFormat(i.decimalPlaces(),t)}toFixed(e,t={groupSeparator:""},n=1){return Number.isInteger(e)||Mt.logWithError(`${e} is not an integer.`),e<0&&Mt.logWithError(`${e} is negative.`),en.DP=e,en.RM=Pr[n]||1,new en(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,t)}isZero(){return this.numerator.isZero()}};var ss=oe("Raydium_amount"),as=ft(Ar);import{PublicKey as kr}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as ci}from"@solana/spl-token";var tn={chainId:101,address:kr.default.toBase58(),programId:ci.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},De={chainId:101,address:"So11111111111111111111111111111111111111112",programId:ci.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};import{PublicKey as on}from"@solana/web3.js";import{PublicKey as te,SystemProgram as li,SYSVAR_RENT_PUBKEY as wr}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Br}from"@solana/spl-token";function nn({pubkey:o,isSigner:e=!1,isWritable:t=!0}){return{pubkey:o,isWritable:t,isSigner:e}}var bs=[nn({pubkey:Br,isWritable:!1}),nn({pubkey:li.programId,isWritable:!1}),nn({pubkey:wr,isWritable:!1})];function mi({publicKey:o,transformSol:e}){let t=di(o.toString());if(t instanceof te)return e&&t.equals(gt)?Et:t;if(e&&t.toString()===gt.toBase58())return Et;if(typeof t=="string"){if(t===te.default.toBase58())return te.default;try{return new te(t)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function di(o){try{return new te(o)}catch{return o}}var hr=new te("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),xr=new te("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),rn=new te("SysvarRent111111111111111111111111111111111"),ys=new te("SysvarC1ock11111111111111111111111111111111"),rt=new te("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),gs=new te("Sysvar1nstructions1111111111111111111111111"),Ps=li.programId,As=new te("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),Ts=new te("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),ks=new te("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),ws=new te("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),Bs=new te("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),hs=new te("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),xs=new te("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),Is=new te("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),Ss=new te("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),Ks=new te("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),Cs=new te("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),Et=new te("So11111111111111111111111111111111111111112"),gt=te.default;var sn=class{constructor({mint:e,decimals:t,symbol:n,name:i,skipMint:r=!1,isToken2022:s=!1}){if(e===gt.toBase58()||e instanceof on&&gt.equals(e)){this.decimals=De.decimals,this.symbol=De.symbol,this.name=De.name,this.mint=new on(De.address),this.isToken2022=!1;return}this.decimals=t,this.symbol=n||e.toString().substring(0,6),this.name=i||e.toString().substring(0,6),this.mint=r?on.default:mi({publicKey:e}),this.isToken2022=s}equals(e){return this===e?!0:this.mint.equals(e.mint)}},Ve=sn;Ve.WSOL=new sn(Y(_({},De),{mint:De.address}));var an=class{constructor({decimals:e,symbol:t="UNKNOWN",name:n="UNKNOWN"}){this.decimals=e,this.symbol=t,this.name=n}equals(e){return this===e}},vt=an;vt.SOL=new an(tn);import Ir from"bn.js";var _s=new ee(new Ir(100));var Hs=oe("Raydium_price");var Sr=new Ie(0),wa=new Ie(1),Ba=new Ie(2),ha=new Ie(3),xa=new Ie(5),Tr=new Ie(10),Ia=new Ie(100),Sa=new Ie(1e3),Ka=new Ie(1e4);function pi(o,e,t){return o.mul(e).add(t).sub(new Ie(1)).div(t)}function ln(o,e=1,t=[]){let n=[...o];if(e<=0)return t;for(;n.length;)t.push(n.splice(0,e));return t}var Se=class{constructor(e){this._owner=e}get publicKey(){return Se.isKeyPair(this._owner)?this._owner.publicKey:this._owner}get signer(){return Se.isKeyPair(this._owner)?this._owner:void 0}get isKeyPair(){return Se.isKeyPair(this._owner)}get isPublicKey(){return Se.isPublicKey(this._owner)}static isKeyPair(e){return e.secretKey!==void 0}static isPublicKey(e){return!Se.isKeyPair(e)}};import{PublicKey as Mr}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Or}from"@solana/spl-token";import{ComputeBudgetProgram as fi,Keypair as yi,PublicKey as Kr,Transaction as gi,TransactionMessage as Cr,VersionedTransaction as Pi}from"@solana/web3.js";var He={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",ClmmLockPosition:"ClmmLockPosition",ClmmHarvestLockPosition:"ClmmHarvestLockPosition",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV4Withdraw:"FarmV4Withdraw",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut",CpmmLockLp:"CpmmLockLp",CpmmCollectLockFee:"CpmmCollectLockFee",TransferTip:"TransferTip"};import{TOKEN_PROGRAM_ID as Nr}from"@solana/spl-token";var bi=oe("Raydium_txUtil"),Ai=1644;function Pt(o){let e=[],t=[];return o.microLamports&&(e.push(fi.setComputeUnitPrice({microLamports:o.microLamports})),t.push(He.SetComputeUnitPrice)),o.units&&(e.push(fi.setComputeUnitLimit({units:o.units})),t.push(He.SetComputeUnitLimit)),{instructions:e,instructionTypes:t}}async function Ye(o,e){var n,i;let t=e!=null?e:"confirmed";return(i=await((n=o.getLatestBlockhash)==null?void 0:n.call(o,{commitment:t})))==null?void 0:i.blockhash}async function At(o,e){return o.getSignatureStatuses([e]),new Promise((t,n)=>{let i=setTimeout(n,6e4);o.onSignature(e,r=>{if(clearTimeout(i),!r.err){t("");return}n(Object.assign(r.err,{txId:e}))},"confirmed")})}function Rr(o,e){o.length<1&&bi.logWithError(`no instructions provided: ${o.toString()}`),e.length<1&&bi.logWithError(`no signers provided:, ${e.toString()}`);let t=new gi;t.recentBlockhash="11111111111111111111111111111111",t.feePayer=e[0],t.add(...o);try{return Buffer.from(t.serialize({verifySignatures:!1})).toString("base64").length<Ai}catch{return!1}}function ue(o,e){let[t,n]=Kr.findProgramAddressSync(o,e);return{publicKey:t,nonce:n}}function Tt({instructions:o,payer:e,signers:t}){return Rr(o,[e,...t])}function Ne({instructions:o,payer:e,lookupTableAddressAccount:t,recentBlockhash:n=yi.generate().publicKey.toString()}){let r=new Cr({payerKey:e,recentBlockhash:n,instructions:o}).compileToV0Message(Object.values(t!=null?t:{}));try{return Buffer.from(new Pi(r).serialize()).toString("base64").length<Ai}catch{return!1}}var Lr=o=>Buffer.isBuffer(o)?o:o instanceof Uint8Array?Buffer.from(o.buffer,o.byteOffset,o.byteLength):Buffer.from(o),Fr=o=>{let e=o.serialize({requireAllSignatures:!1,verifySignatures:!1});o instanceof Pi&&(e=Lr(e));try{return e instanceof Buffer?e.toString("base64"):Buffer.from(e).toString("base64")}catch{return e.toString("base64")}};function _e(o){let e=[];return o.forEach(t=>{t instanceof gi&&(t.recentBlockhash||(t.recentBlockhash=Nr.toBase58()),t.feePayer||(t.feePayer=yi.generate().publicKey)),e.push(Fr(t))}),console.log("simulate tx string:",e),e}function ke(o,e,t){return ue([o.toBuffer(),(t!=null?t:Or).toBuffer(),e.toBuffer()],new Mr("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"))}import{PublicKey as O}from"@solana/web3.js";var ja=new O("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),Za=new O("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),Qa=new O("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),Ja=new O("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),$a=new O("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),eu=new O("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),tu=new O("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),nu=new O("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),iu=new O("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),ru=new O("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Er=new O("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),vr=new O("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),Wr=new O("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),ou=new O("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),su=new O("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),au=new O("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),uu=new O("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),cu=new O("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),lu=new O("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),mu=new O("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),du=new O("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),pu=new O("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),fu=new O("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),bu=new O("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),yu=new O("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),re=new O("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),gu=new O("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),Pu=new O("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),Au=new O("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),Tu=new O("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),ku=new O("6s1xP3hpbAfFoNtUNF8mfHsjr2Bd97JxFJRWLbL6aHuX");var wu={OPEN_BOOK_PROGRAM:new O("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),SERUM_PROGRAM_ID_V3:new O("Ray1111111111111111111111111111111111111111"),AMM_V4:new O("DRaya7Kj3aMWQSy19kSjvmuwq9docCHofyP9kanQGaav"),AMM_STABLE:new O("DRayDdXc1NZQ9C3hRWmoSf8zK4iapgMnjdNZWrfwsP8m"),CLMM_PROGRAM_ID:new O("DRayAUgENGQBKVaX8owNhgzkEDyoHTGVEGHVJT1E9pfH"),CLMM_LOCK_PROGRAM_ID:new O("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),CLMM_LOCK_AUTH_ID:new O("6Aoh8h2Lw2m5UGxYR8AdAL87jTWYeKoxM52mJRzfYwN"),CREATE_CPMM_POOL_PROGRAM:new O("DRaycpLY18LhpbydsBWbVJtxpNv9oXPgjRSfpF2bWpYb"),CREATE_CPMM_POOL_AUTH:new O("CXniRufdq5xL8t8jZAPxsPZDpuudwuJSPWnbcD5Y5Nxq"),CREATE_CPMM_POOL_FEE_ACC:new O("3oE58BKVt8KuYkGxx8zBojugnymWmBiyafWgMrnb6eYy"),LOCK_CPMM_PROGRAM:new O("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),LOCK_CPMM_AUTH:new O("7qWVV8UY2bRJfDLP4s37YzBPKUkVB46DStYJBpYbQzu3"),UTIL1216:O.default,Router:new O("DRaybByLpbUL57LJARs3j8BitTxVfzBg351EaMr5UTCd"),FARM_PROGRAM_ID_V3:new O("DRayWyrLmEW5KEeqs8kdTMMaBabapqagaBC7KWpGtJeZ"),FARM_PROGRAM_ID_V4:new O("Ray1111111111111111111111111111111111111111"),FARM_PROGRAM_ID_V5:new O("DRayiCGSZgku1GTK6rXD6mVDdingXy6APAH1R6R5L2LC"),FARM_PROGRAM_ID_V6:new O("DRayzbYakXs45ELHkzH6vC3fuhQqTAnv5A68gdFuvZyZ"),LAUNCHPAD_PROGRAM:new O("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),LAUNCHPAD_AUTH:new O("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),LAUNCHPAD_PLATFORM:new O("2Jx4KTDrVSdWNazuGpcA8n3ZLTRGGBDxAWhuKe2Xcj2a"),LAUNCHPAD_CONFIG:new O("7ZR4zD7PYfY2XxoG1Gxcy2EgEeGYrpxrwzPuwdUBssEt"),FEE_DESTINATION_ID:new O("9y8ENuuZ3b19quffx9hQvRVygG5ky6snHfRvGpuSfeJy"),MODEL_DATA_PUBKEY:new O("Ray1111111111111111111111111111111111111111")};import se from"bn.js";var kt=1e4;function mn(o,e){let{div:t,mod:n}=o.divmod(e);return n.gt(new se(0))?t.add(new se(1)):t}function je(o,e){if(o.isZero())return new se(0);let t=o.div(e);return t.isZero()?new se(1):o.mod(e).gt(new se(0))?t.add(new se(1)):t}function dn(o,e,t){if(e===void 0)return{amount:o,fee:void 0,expirationTime:void 0};let n=Math.floor(t/432e3),i=n<e.newerTransferFee.epoch?e.olderTransferFee:e.newerTransferFee,r=new se(i.maximumFee.toString()),s=n<e.newerTransferFee.epoch?(Number(e.newerTransferFee.epoch)*432e3-t)*400/1e3:void 0,a=mn(o.mul(new se(i.transferFeeBasisPoints)),new se(kt)),c=a.gt(r)?r:a;return{amount:o,fee:c,expirationTime:s}}function pn(o,e,t){if(e===void 0)return{amount:o,fee:void 0,expirationTime:void 0};let n=Math.floor(t/432e3),i=n<e.newerTransferFee.epoch?e.olderTransferFee:e.newerTransferFee,r=new se(i.maximumFee.toString()),s=n<e.newerTransferFee.epoch?(Number(e.newerTransferFee.epoch)*432e3-t)*400/1e3:void 0;if(i.transferFeeBasisPoints===kt){let a=new se(i.maximumFee.toString());return{amount:o.add(a),fee:a,expirationTime:s}}else{let a=mn(o.mul(new se(kt)),new se(kt-i.transferFeeBasisPoints)),c=new se(i.maximumFee.toString()),u=a.sub(o).gt(c)?o.add(c):a,p=mn(u.mul(new se(i.transferFeeBasisPoints)),new se(kt)),m=p.gt(r)?r:p;return{amount:u,fee:m,expirationTime:s}}}import{PublicKey as Su}from"@solana/web3.js";import Cu from"bn.js";import Dr from"bn.js";var Ze=new Dr(1e6);import{MINT_SIZE as ac,TOKEN_PROGRAM_ID as uc,getTransferFeeConfig as cc,unpackMint as lc}from"@solana/spl-token";var fn=oe("Raydium_accountInfo_util");async function wt(o,e,t){let{batchRequest:n,commitment:i="confirmed",chunkCount:r=100}=_({batchRequest:!1},t),s=ln(e,r),a=new Array(s.length).fill([]);if(n){let c=s.map(m=>{let T=o._buildArgs([m.map(A=>A.toBase58())],i,"base64");return{methodName:"getMultipleAccounts",args:T}}),u=ln(c,10);a=(await(await Promise.all(u.map(async m=>await o._rpcBatchRequest(m)))).flat()).map(m=>(m.error&&fn.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${m.error.message}`),m.result.value.map(T=>{if(T){let{data:A,executable:l,lamports:y,owner:b,rentEpoch:h}=T;return A.length!==2&&A[1]!=="base64"&&fn.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(A[0],"base64"),executable:l,lamports:y,owner:new Vr(b),rentEpoch:h}}return null})))}else try{a=await Promise.all(s.map(c=>o.getMultipleAccountsInfo(c,i)))}catch(c){c instanceof Error&&fn.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${c.message}`)}return a.flat()}async function Re(o,e,t){let n=await wt(o,e.map(i=>i.pubkey),t);return e.map((i,r)=>Y(_({},i),{accountInfo:n[r]}))}async function Dt({connection:o,address:e,cluster:t="mainnet"}){let n=await wt(o,[...new Set(e.map(r=>r.toString()))].map(r=>new bn(r))),i={};for(let r=0;r<e.length;r++){let s=n[r],a=e[r];if(!s)continue;let c=new st({key:a,state:st.deserialize(s.data)});i[a.toString()]=c,t==="devnet"?ot[a.toString()]=c:qe[a.toString()]=c}return i}var qe={},yn=async o=>{let e="AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU";if(qe[e])return qe;let t=new bn(e),n=await o.getAccountInfo(t);return n&&(qe[e]=new st({key:t,state:st.deserialize(n.data)})),qe},ot={},Vt=async o=>{let e="EFhMuDw1PKEuckuFRW9PavNfTH4LKP5uKHgyXDmWpFCq";if(ot[e])return ot;let t=new bn(e),n=await o.getAccountInfo(t);return n&&(ot[e]=new st({key:t,state:st.deserialize(n.data)})),ot};var ht=2e3,xt=class{constructor(e){this.instructions=[];this.endInstructions=[];this.lookupTableAddress=[];this.signers=[];this.instructionTypes=[];this.endInstructionTypes=[];this.connection=e.connection,this.feePayer=e.feePayer,this.signAllTransactions=e.signAllTransactions,this.owner=e.owner,this.cluster=e.cluster,this.blockhashCommitment=e.blockhashCommitment,this.loopMultiTxStatus=!!e.loopMultiTxStatus}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers,instructionTypes:this.instructionTypes,endInstructionTypes:this.endInstructionTypes,lookupTableAddress:this.lookupTableAddress}}get allInstructions(){return[...this.instructions,...this.endInstructions]}async getComputeBudgetConfig(){var n;let e=(await qr.get(`https://solanacompass.com/api/fees?cacheFreshTime=${3e5}`)).data,{avg:t}=(n=e==null?void 0:e[15])!=null?n:{};if(!!t)return{units:6e5,microLamports:Math.min(Math.ceil(t*1e6/6e5),25e3)}}addCustomComputeBudget(e){if(e){let{instructions:t,instructionTypes:n}=Pt(e);return this.instructions.unshift(...t),this.instructionTypes.unshift(...n),!0}return!1}addTipInstruction(e){var t;return e?(this.endInstructions.push(_r.transfer({fromPubkey:(t=e.feePayer)!=null?t:this.feePayer,toPubkey:new Qe(e.address),lamports:BigInt(e.amount.toString())})),this.endInstructionTypes.push(He.TransferTip),!0):!1}async calComputeBudget({config:e,defaultIns:t}){try{let n=e||await this.getComputeBudgetConfig();if(this.addCustomComputeBudget(n))return;t&&this.instructions.unshift(...t)}catch{t&&this.instructions.unshift(...t)}}addInstruction({instructions:e=[],endInstructions:t=[],signers:n=[],instructionTypes:i=[],endInstructionTypes:r=[],lookupTableAddress:s=[]}){return this.instructions.push(...e),this.endInstructions.push(...t),this.signers.push(...n),this.instructionTypes.push(...i),this.endInstructionTypes.push(...r),this.lookupTableAddress.push(...s.filter(a=>a!==Qe.default.toString())),this}async versionBuild({txVersion:e,extInfo:t}){return e===0?await this.buildV0(_({},t||{})):this.build(t)}build(e){var n;let t=new Bt;return this.allInstructions.length&&t.add(...this.allInstructions),t.feePayer=this.feePayer,((n=this.owner)==null?void 0:n.signer)&&!this.signers.some(i=>i.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer),{builder:this,transaction:t,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async i=>{var p;let{recentBlockHash:r,skipPreflight:s=!0,sendAndConfirm:a,notSendToRpc:c}=i||{},u=r!=null?r:await Ye(this.connection,this.blockhashCommitment);if(t.recentBlockhash=u,this.signers.length&&t.sign(...this.signers),_e([t]),(p=this.owner)!=null&&p.isKeyPair)return{txId:a?await gn(this.connection,t,this.signers.find(T=>T.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:s}):await this.connection.sendRawTransaction(t.serialize(),{skipPreflight:s}),signedTx:t};if(this.signAllTransactions){let m=await this.signAllTransactions([t]);if(this.signers.length)for(let T of m)try{T.sign(...this.signers)}catch{}return{txId:c?"":await this.connection.sendRawTransaction(m[0].serialize(),{skipPreflight:s}),signedTx:m[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:e||{}}}buildMultiTx(e){var u;let{extraPreBuildData:t=[],extInfo:n}=e,{transaction:i}=this.build(n),r=t.filter(p=>p.transaction.instructions.length>0),s=[i,...r.map(p=>p.transaction)],a=[this.signers,...r.map(p=>p.signers)],c=[...this.instructionTypes,...r.map(p=>p.instructionTypes).flat()];return(u=this.owner)!=null&&u.signer&&a.forEach(p=>{p.some(m=>m.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),{builder:this,transactions:s,signers:a,instructionTypes:c,execute:async p=>{var h;let{sequentially:m,onTxUpdate:T,skipTxCount:A=0,recentBlockHash:l,skipPreflight:y=!0}=p||{},b=l!=null?l:await Ye(this.connection,this.blockhashCommitment);if((h=this.owner)!=null&&h.isKeyPair){if(m){let g=[],x=0;for(let k of s){if(++x,x<=A)continue;let d=await gn(this.connection,k,this.signers.find(P=>P.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:y});g.push(d)}return{txIds:g,signedTxs:s}}return{txIds:await await Promise.all(s.map(async g=>(g.recentBlockhash=b,await this.connection.sendRawTransaction(g.serialize(),{skipPreflight:y})))),signedTxs:s}}if(this.signAllTransactions){let g=s.map((k,d)=>(k.recentBlockhash=b,a[d].length&&k.sign(...a[d]),k));_e(g);let x=await this.signAllTransactions(g);if(m){let k=0,d=[],P=async()=>{if(!x[k])return;let I=await this.connection.sendRawTransaction(x[k].serialize(),{skipPreflight:y});d.push({txId:I,status:"sent",signedTx:x[k]}),T==null||T([...d]),k++;let w=!1,S=null,C=null,F=B=>{S!==null&&clearInterval(S),C!==null&&this.connection.removeSignatureListener(C);let M=d.findIndex(K=>K.txId===I);if(M>-1){if(d[M].status==="error"||d[M].status==="success")return;d[M].status=B.err?"error":"success"}T==null||T([...d]),B.err||P()};this.loopMultiTxStatus&&(S=setInterval(async()=>{var B;if(w){clearInterval(S);return}try{let M=await this.connection.getTransaction(I,{commitment:"confirmed",maxSupportedTransactionVersion:0});M&&(w=!0,clearInterval(S),F({err:((B=M.meta)==null?void 0:B.err)||null}),console.log("tx status from getTransaction:",I))}catch(M){w=!0,clearInterval(S),console.error("getTransaction timeout:",M,I)}},ht)),C=this.connection.onSignature(I,B=>{if(w){this.connection.removeSignatureListener(C);return}w=!0,F(B)},"confirmed"),this.connection.getSignatureStatus(I)};return await P(),{txIds:d.map(I=>I.txId),signedTxs:x}}else{let k=[];for(let d=0;d<x.length;d+=1){let P=await this.connection.sendRawTransaction(x[d].serialize(),{skipPreflight:y});k.push(P)}return{txIds:k,signedTxs:x}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:n||{}}}async versionMultiBuild({extraPreBuildData:e,txVersion:t,extInfo:n}){return t===0?await this.buildV0MultiTx({extraPreBuildData:e,buildProps:n||{}}):this.buildMultiTx({extraPreBuildData:e,extInfo:n})}async buildV0(e){var y;let l=e||{},{lookupTableCache:t={},lookupTableAddress:n=[],forerunCreate:i,recentBlockhash:r}=l,s=We(l,["lookupTableCache","lookupTableAddress","forerunCreate","recentBlockhash"]),a=_(_({},this.cluster==="devnet"?await Vt(this.connection):await yn(this.connection)),t),c=Array.from(new Set([...n,...this.lookupTableAddress])),u=[];for(let b of c)a[b]===void 0&&u.push(new Qe(b));let p=await Dt({connection:this.connection,address:u});for(let[b,h]of Object.entries(p))a[b]=h;let m=i?Qe.default.toBase58():r!=null?r:await Ye(this.connection,this.blockhashCommitment),T=new Le({payerKey:this.feePayer,recentBlockhash:m,instructions:[...this.allInstructions]}).compileToV0Message(Object.values(a));((y=this.owner)==null?void 0:y.signer)&&!this.signers.some(b=>b.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer);let A=new Fe(T);return A.sign(this.signers),{builder:this,transaction:A,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async b=>{var k;let{skipPreflight:h=!0,sendAndConfirm:g,notSendToRpc:x}=b||{};if(_e([A]),(k=this.owner)!=null&&k.isKeyPair){let d=await this.connection.sendTransaction(A,{skipPreflight:h});return g&&await At(this.connection,d),{txId:d,signedTx:A}}if(this.signAllTransactions){let d=await this.signAllTransactions([A]);if(this.signers.length)for(let P of d)try{P.sign(this.signers)}catch{}return{txId:x?"":await this.connection.sendTransaction(d[0],{skipPreflight:h}),signedTx:d[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:s||{}}}async buildV0MultiTx(e){var u;let{extraPreBuildData:t=[],buildProps:n}=e,{transaction:i}=await this.buildV0(n),r=t.filter(p=>p.builder.instructions.length>0),s=[i,...r.map(p=>p.transaction)],a=[this.signers,...r.map(p=>p.signers)],c=[...this.instructionTypes,...r.map(p=>p.instructionTypes).flat()];return(u=this.owner)!=null&&u.signer&&a.forEach(p=>{p.some(m=>m.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),s.forEach(async(p,m)=>{p.sign(a[m])}),{builder:this,transactions:s,signers:a,instructionTypes:c,buildProps:n,execute:async p=>{var y;let{sequentially:m,onTxUpdate:T,recentBlockHash:A,skipPreflight:l=!0}=p||{};if(A&&s.forEach(b=>b.message.recentBlockhash=A),_e(s),(y=this.owner)!=null&&y.isKeyPair){if(m){let b=[];for(let h of s){let g=await this.connection.sendTransaction(h,{skipPreflight:l});await At(this.connection,g),b.push(g)}return{txIds:b,signedTxs:s}}return{txIds:await Promise.all(s.map(async b=>await this.connection.sendTransaction(b,{skipPreflight:l}))),signedTxs:s}}if(this.signAllTransactions){let b=await this.signAllTransactions(s);if(m){let h=0,g=[],x=async()=>{if(!b[h])return;let k=await this.connection.sendTransaction(b[h],{skipPreflight:l});g.push({txId:k,status:"sent",signedTx:b[h]}),T==null||T([...g]),h++;let d=!1,P=null,I=null,w=S=>{P!==null&&clearInterval(P),I!==null&&this.connection.removeSignatureListener(I);let C=g.findIndex(F=>F.txId===k);if(C>-1){if(g[C].status==="error"||g[C].status==="success")return;g[C].status=S.err?"error":"success"}T==null||T([...g]),S.err||x()};this.loopMultiTxStatus&&(P=setInterval(async()=>{var S;if(d){clearInterval(P);return}try{let C=await this.connection.getTransaction(k,{commitment:"confirmed",maxSupportedTransactionVersion:0});C&&(d=!0,clearInterval(P),w({err:((S=C.meta)==null?void 0:S.err)||null}),console.log("tx status from getTransaction:",k))}catch(C){d=!0,clearInterval(P),console.error("getTransaction timeout:",C,k)}},ht)),I=this.connection.onSignature(k,S=>{if(d){this.connection.removeSignatureListener(I);return}d=!0,w(S)},"confirmed"),this.connection.getSignatureStatus(k)};return x(),{txIds:[],signedTxs:b}}else{let h=[];for(let g=0;g<b.length;g+=1){let x=await this.connection.sendTransaction(b[g],{skipPreflight:l});h.push(x)}return{txIds:h,signedTxs:b}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:n||{}}}async sizeCheckBuild(e){var T;let m=e||{},{splitIns:t=[],computeBudgetConfig:n}=m,i=We(m,["splitIns","computeBudgetConfig"]),r=n?Pt(n):{instructions:[],instructionTypes:[]},s=this.signers.reduce((A,l)=>Y(_({},A),{[l.publicKey.toBase58()]:l}),{}),a=[],c=[],u=[],p=0;if(this.allInstructions.forEach(A=>{let l=[...u,A],y=n?[...r.instructions,...l]:l,h=[...new Set(l.map(g=>g.keys.filter(x=>x.isSigner).map(x=>x.pubkey.toString())).flat()).values()].map(g=>new Qe(g));if(A!==t[p]&&u.length<12&&(Tt({instructions:y,payer:this.feePayer,signers:h})||Tt({instructions:l,payer:this.feePayer,signers:h})))u.push(A);else{if(u.length===0)throw Error("item ins too big");p+=A===t[p]?1:0,Tt({instructions:n?[...r.instructions,...u]:[...u],payer:this.feePayer,signers:h})?a.push(new Bt().add(...r.instructions,...u)):a.push(new Bt().add(...u)),c.push(Array.from(new Set(u.map(g=>g.keys.filter(x=>x.isSigner).map(x=>x.pubkey.toString())).flat())).map(g=>s[g]).filter(g=>g!==void 0)),u=[A]}}),u.length>0){let l=[...new Set(u.map(y=>y.keys.filter(b=>b.isSigner).map(b=>b.pubkey.toString())).flat()).values()].map(y=>s[y]).filter(y=>y!==void 0);Tt({instructions:n?[...r.instructions,...u]:[...u],payer:this.feePayer,signers:l.map(y=>y.publicKey)})?a.push(new Bt().add(...r.instructions,...u)):a.push(new Bt().add(...u)),c.push(l)}return a.forEach(A=>A.feePayer=this.feePayer),(T=this.owner)!=null&&T.signer&&c.forEach(A=>{A.some(l=>l.publicKey.equals(this.owner.publicKey))||A.push(this.owner.signer)}),{builder:this,transactions:a,signers:c,instructionTypes:this.instructionTypes,execute:async A=>{var k;let{sequentially:l,onTxUpdate:y,skipTxCount:b=0,recentBlockHash:h,skipPreflight:g=!0}=A||{},x=h!=null?h:await Ye(this.connection,this.blockhashCommitment);if(a.forEach(async(d,P)=>{d.recentBlockhash=x,c[P].length&&d.sign(...c[P])}),_e(a),(k=this.owner)!=null&&k.isKeyPair){if(l){let d=0,P=[];for(let I of a){if(++d,d<=b){P.push("tx skipped");continue}let w=await gn(this.connection,I,this.signers.find(S=>S.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:g});P.push(w)}return{txIds:P,signedTxs:a}}return{txIds:await Promise.all(a.map(async d=>await this.connection.sendRawTransaction(d.serialize(),{skipPreflight:g}))),signedTxs:a}}if(this.signAllTransactions){let d=await this.signAllTransactions(a.slice(b,a.length)),P=[...a.slice(0,b),...d];if(l){let I=0,w=[],S=async()=>{if(!P[I])return;I<b&&(w.push({txId:"",status:"success",signedTx:P[I]}),y==null||y([...w]),I++,S());let C=await this.connection.sendRawTransaction(P[I].serialize(),{skipPreflight:g});w.push({txId:C,status:"sent",signedTx:P[I]}),y==null||y([...w]),I++;let F=!1,B=null,M=null,K=N=>{B!==null&&clearInterval(B),M!==null&&this.connection.removeSignatureListener(M);let V=w.findIndex(G=>G.txId===C);if(V>-1){if(w[V].status==="error"||w[V].status==="success")return;w[V].status=N.err?"error":"success"}y==null||y([...w]),N.err||S()};this.loopMultiTxStatus&&(B=setInterval(async()=>{var N;if(F){clearInterval(B);return}try{let V=await this.connection.getTransaction(C,{commitment:"confirmed",maxSupportedTransactionVersion:0});V&&(F=!0,clearInterval(B),K({err:((N=V.meta)==null?void 0:N.err)||null}),console.log("tx status from getTransaction:",C))}catch(V){F=!0,clearInterval(B),console.error("getTransaction timeout:",V,C)}},ht)),M=this.connection.onSignature(C,N=>{if(F){this.connection.removeSignatureListener(M);return}F=!0,K(N)},"confirmed"),this.connection.getSignatureStatus(C)};return await S(),{txIds:w.map(C=>C.txId),signedTxs:P}}else{let I=[];for(let w=0;w<P.length;w+=1){let S=await this.connection.sendRawTransaction(P[w].serialize(),{skipPreflight:g});I.push(S)}return{txIds:I,signedTxs:P}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:i||{}}}async sizeCheckBuildV0(e){var x;let g=e||{},{computeBudgetConfig:t,splitIns:n=[],lookupTableCache:i={},lookupTableAddress:r=[]}=g,s=We(g,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),a=_(_({},this.cluster==="devnet"?await Vt(this.connection):qe),i),c=Array.from(new Set([...this.lookupTableAddress,...r])),u=[];for(let k of c)a[k]===void 0&&u.push(new Qe(k));let p=await Dt({connection:this.connection,address:u});for(let[k,d]of Object.entries(p))a[k]=d;let m=t?Pt(t):{instructions:[],instructionTypes:[]},T=await Ye(this.connection,this.blockhashCommitment),A=this.signers.reduce((k,d)=>Y(_({},k),{[d.publicKey.toBase58()]:d}),{}),l=[],y=[],b=[],h=0;if(this.allInstructions.forEach(k=>{let d=[...b,k],P=t?[...m.instructions,...d]:d;if(k!==n[h]&&b.length<12&&(Ne({instructions:P,payer:this.feePayer,lookupTableAddressAccount:a})||Ne({instructions:d,payer:this.feePayer,lookupTableAddressAccount:a})))b.push(k);else{if(b.length===0)throw Error("item ins too big");h+=k===n[h]?1:0;let I={};for(let w of[...new Set(c)])a[w]!==void 0&&(I[w]=a[w]);if(t&&Ne({instructions:[...m.instructions,...b],payer:this.feePayer,lookupTableAddressAccount:a,recentBlockhash:T})){let w=new Le({payerKey:this.feePayer,recentBlockhash:T,instructions:[...m.instructions,...b]}).compileToV0Message(Object.values(a));l.push(new Fe(w))}else{let w=new Le({payerKey:this.feePayer,recentBlockhash:T,instructions:[...b]}).compileToV0Message(Object.values(a));l.push(new Fe(w))}y.push(Array.from(new Set(b.map(w=>w.keys.filter(S=>S.isSigner).map(S=>S.pubkey.toString())).flat())).map(w=>A[w]).filter(w=>w!==void 0)),b=[k]}}),b.length>0){let d=[...new Set(b.map(P=>P.keys.filter(I=>I.isSigner).map(I=>I.pubkey.toString())).flat()).values()].map(P=>A[P]).filter(P=>P!==void 0);if(t&&Ne({instructions:[...m.instructions,...b],payer:this.feePayer,lookupTableAddressAccount:a,recentBlockhash:T})){let P=new Le({payerKey:this.feePayer,recentBlockhash:T,instructions:[...m.instructions,...b]}).compileToV0Message(Object.values(a));l.push(new Fe(P))}else{let P=new Le({payerKey:this.feePayer,recentBlockhash:T,instructions:[...b]}).compileToV0Message(Object.values(a));l.push(new Fe(P))}y.push(d)}return(x=this.owner)!=null&&x.signer&&y.forEach(k=>{k.some(d=>d.publicKey.equals(this.owner.publicKey))||k.push(this.owner.signer)}),l.forEach((k,d)=>{k.sign(y[d])}),{builder:this,transactions:l,buildProps:e,signers:y,blockHash:T,instructionTypes:this.instructionTypes,execute:async k=>{var C;let{sequentially:d,onTxUpdate:P,skipTxCount:I=0,recentBlockHash:w,skipPreflight:S=!0}=k||{};if(l.map(async(F,B)=>{y[B].length&&F.sign(y[B]),w&&(F.message.recentBlockhash=w)}),_e(l),(C=this.owner)!=null&&C.isKeyPair){if(d){let F=0,B=[];for(let M of l){if(++F,F<=I){console.log("skip tx: ",F),B.push("tx skipped");continue}let K=await this.connection.sendTransaction(M,{skipPreflight:S});await At(this.connection,K),B.push(K)}return{txIds:B,signedTxs:l}}return{txIds:await Promise.all(l.map(async F=>await this.connection.sendTransaction(F,{skipPreflight:S}))),signedTxs:l}}if(this.signAllTransactions){let F=await this.signAllTransactions(l.slice(I,l.length)),B=[...l.slice(0,I),...F];if(d){let M=0,K=[],N=async()=>{if(!B[M])return;if(M<I){K.push({txId:"",status:"success",signedTx:B[M]}),P==null||P([...K]),M++,N();return}let V=await this.connection.sendTransaction(B[M],{skipPreflight:S});K.push({txId:V,status:"sent",signedTx:B[M]}),P==null||P([...K]),M++;let G=!1,X=null,U=null,Z=Q=>{X!==null&&clearInterval(X),U!==null&&this.connection.removeSignatureListener(U);let H=K.findIndex(ie=>ie.txId===V);if(H>-1){if(K[H].status==="error"||K[H].status==="success")return;K[H].status=Q.err?"error":"success"}P==null||P([...K]),Q.err||N()};this.loopMultiTxStatus&&(X=setInterval(async()=>{var Q;if(G){clearInterval(X);return}try{let H=await this.connection.getTransaction(V,{commitment:"confirmed",maxSupportedTransactionVersion:0});H&&(G=!0,clearInterval(X),Z({err:((Q=H.meta)==null?void 0:Q.err)||null}),console.log("tx status from getTransaction:",V))}catch(H){G=!0,clearInterval(X),console.error("getTransaction timeout:",H,V)}},ht)),U=this.connection.onSignature(V,Q=>{if(G){this.connection.removeSignatureListener(U);return}G=!0,Z(Q)},"confirmed"),this.connection.getSignatureStatus(V)};return N(),{txIds:[],signedTxs:B}}else{let M=[];for(let K=0;K<B.length;K+=1){let N=await this.connection.sendTransaction(B[K],{skipPreflight:S});M.push(N)}return{txIds:M,signedTxs:B}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:s||{}}}async buildSniperTransaction(e){var x;let g=e||{},{computeBudgetConfig:t,splitIns:n=[],lookupTableCache:i={},lookupTableAddress:r=[]}=g,s=We(g,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),a=_(_({},this.cluster==="devnet"?await Vt(this.connection):await yn(this.connection)),i),c=Array.from(new Set([...this.lookupTableAddress,...r])),u=[];for(let k of c)a[k]===void 0&&u.push(new Qe(k));let p=await Dt({connection:this.connection,address:u});for(let[k,d]of Object.entries(p))a[k]=d;let m=t?Pt(t):{instructions:[],instructionTypes:[]},T=await Ye(this.connection,this.blockhashCommitment),A=this.signers.reduce((k,d)=>Y(_({},k),{[d.publicKey.toBase58()]:d}),{}),l=[],y=[],b=[],h=0;if(this.allInstructions.forEach(k=>{let d=[...b,k],P=t?[...m.instructions,...d]:d;if(k!==n[h]&&b.length<12&&(Ne({instructions:P,payer:this.feePayer,lookupTableAddressAccount:a})||Ne({instructions:d,payer:this.feePayer,lookupTableAddressAccount:a})))b.push(k);else{if(b.length===0)throw Error("item ins too big");h+=k===n[h]?1:0;let I={};for(let w of[...new Set(c)])a[w]!==void 0&&(I[w]=a[w]);if(t&&Ne({instructions:[...m.instructions,...b],payer:this.feePayer,lookupTableAddressAccount:a,recentBlockhash:T})){let w=new Le({payerKey:this.feePayer,recentBlockhash:T,instructions:[...m.instructions,...b]}).compileToV0Message(Object.values(a));l.push(new Fe(w))}else{let w=new Le({payerKey:this.feePayer,recentBlockhash:T,instructions:[...b]}).compileToV0Message(Object.values(a));l.push(new Fe(w))}y.push(Array.from(new Set(b.map(w=>w.keys.filter(S=>S.isSigner).map(S=>S.pubkey.toString())).flat())).map(w=>A[w]).filter(w=>w!==void 0)),b=[k]}}),b.length>0){let d=[...new Set(b.map(P=>P.keys.filter(I=>I.isSigner).map(I=>I.pubkey.toString())).flat()).values()].map(P=>A[P]).filter(P=>P!==void 0);if(t&&Ne({instructions:[...m.instructions,...b],payer:this.feePayer,lookupTableAddressAccount:a,recentBlockhash:T})){let P=new Le({payerKey:this.feePayer,recentBlockhash:T,instructions:[...m.instructions,...b]}).compileToV0Message(Object.values(a));l.push(new Fe(P))}else{let P=new Le({payerKey:this.feePayer,recentBlockhash:T,instructions:[...b]}).compileToV0Message(Object.values(a));l.push(new Fe(P))}y.push(d)}return(x=this.owner)!=null&&x.signer&&y.forEach(k=>{k.some(d=>d.publicKey.equals(this.owner.publicKey))||k.push(this.owner.signer)}),l.forEach((k,d)=>{k.sign(y[d])}),{builder:this,transactions:l,buildProps:e,signers:y,instructionTypes:this.instructionTypes,execute:async k=>{var C;let{sequentially:d,onTxUpdate:P,skipTxCount:I=0,recentBlockHash:w,skipPreflight:S=!0}=k||{};if(l.map(async(F,B)=>{y[B].length&&F.sign(y[B]),w&&(F.message.recentBlockhash=w)}),_e(l),(C=this.owner)!=null&&C.isKeyPair){if(d){let F=0,B=[];for(let M of l){if(++F,F<=I){console.log("skip tx: ",F),B.push("tx skipped");continue}let K=await this.connection.sendTransaction(M,{skipPreflight:S});await At(this.connection,K),B.push(K)}return{txIds:B,signedTxs:l}}return{txIds:await Promise.all(l.map(async F=>await this.connection.sendTransaction(F,{skipPreflight:S}))),signedTxs:l}}if(this.signAllTransactions){let F=await this.signAllTransactions(l.slice(I,l.length)),B=[...l.slice(0,I),...F];if(d){let M=0,K=[],N=async()=>{if(!B[M])return;if(M<I){K.push({txId:"",status:"success",signedTx:B[M]}),P==null||P([...K]),M++,N();return}let V=await this.connection.sendTransaction(B[M],{skipPreflight:S});K.push({txId:V,status:"sent",signedTx:B[M]}),P==null||P([...K]),M++;let G=!1,X=null,U=null,Z=Q=>{X!==null&&clearInterval(X),U!==null&&this.connection.removeSignatureListener(U);let H=K.findIndex(ie=>ie.txId===V);if(H>-1){if(K[H].status==="error"||K[H].status==="success")return;K[H].status=Q.err?"error":"success"}P==null||P([...K]),Q.err||N()};this.loopMultiTxStatus&&(X=setInterval(async()=>{var Q;if(G){clearInterval(X);return}try{let H=await this.connection.getTransaction(V,{commitment:"confirmed",maxSupportedTransactionVersion:0});H&&(G=!0,clearInterval(X),Z({err:((Q=H.meta)==null?void 0:Q.err)||null}),console.log("tx status from getTransaction:",V))}catch(H){G=!0,clearInterval(X),console.error("getTransaction timeout:",H,V)}},ht)),U=this.connection.onSignature(V,Q=>{if(G){this.connection.removeSignatureListener(U);return}G=!0,Z(Q)},"confirmed"),this.connection.getSignatureStatus(V)};return N(),{txIds:[],signedTxs:B}}else{let M=[];for(let K=0;K<B.length;K+=1){let N=await this.connection.sendTransaction(B[K],{skipPreflight:S});M.push(N)}return{txIds:M,signedTxs:B}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:s||{}}}};var Pn=(...o)=>o.map(e=>{try{return typeof e=="object"?JSON.stringify(e):e}catch{return e}}).join(", "),at=class{constructor({scope:e,moduleName:t}){this.disabled=!1;this.scope=e,this.logger=oe(t)}createTxBuilder(e){return this.scope.checkOwner(),new xt({connection:this.scope.connection,feePayer:e||this.scope.ownerPubKey,cluster:this.scope.cluster,owner:this.scope.owner,blockhashCommitment:this.scope.blockhashCommitment,loopMultiTxStatus:this.scope.loopMultiTxStatus,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}createSniperTxBuilder(e,t){let n=new Se(e);return new xt({connection:this.scope.connection,feePayer:t,cluster:this.scope.cluster,owner:n,blockhashCommitment:this.scope.blockhashCommitment,loopMultiTxStatus:this.scope.loopMultiTxStatus,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}logDebug(...e){this.logger.debug(Pn(e))}logInfo(...e){this.logger.info(Pn(e))}logAndCreateError(...e){let t=Pn(e);throw new Error(t)}checkDisabled(){(this.disabled||!this.scope)&&this.logAndCreateError("module not working")}};import{PublicKey as Bp}from"@solana/web3.js";import xp from"bn.js";import Sp from"decimal.js";import{AccountLayout as Np,createAssociatedTokenAccountIdempotentInstruction as Rp,TOKEN_2022_PROGRAM_ID as Lp,TOKEN_PROGRAM_ID as Fp}from"@solana/spl-token";import{PublicKey as vc}from"@solana/web3.js";import{MintLayout as Dc,TOKEN_PROGRAM_ID as _c}from"@solana/spl-token";import{Keypair as Hd,PublicKey as Yd,SystemProgram as Zd,TransactionInstruction as Qd}from"@solana/web3.js";import $d from"bn.js";import{ASSOCIATED_TOKEN_PROGRAM_ID as np,TOKEN_2022_PROGRAM_ID as ip,TOKEN_PROGRAM_ID as rp}from"@solana/spl-token";import{PublicKey as $r}from"@solana/web3.js";import xi,{isBN as Ii}from"bn.js";import{bits as Yc,BitStructure as jc,blob as Gr,Blob as Zc,cstr as Qc,f32 as Jc,f32be as $c,f64 as el,f64be as tl,greedy as nl,Layout as Ur,ns64 as il,ns64be as rl,nu64 as ol,nu64be as sl,offset as Xr,s16 as al,s16be as ul,s24 as cl,s24be as ll,s32 as zr,s32be as ml,s40 as dl,s40be as pl,s48 as fl,s48be as bl,s8 as yl,seq as Hr,struct as gl,Structure as Yr,u16 as jr,u16be as Pl,u24 as Al,u24be as Tl,u32 as Zr,u32be as kl,u40 as wl,u40be as Bl,u48 as hl,u48be as xl,u8 as Qr,UInt as Jr,union as Il,Union as Sl,unionLayoutDiscriminator as Kl,utf8 as Cl}from"@solana/buffer-layout";var An=Ur,wi=Yr;var Tn=Jr;var Bi=Qr,Me=jr;var kn=Zr;var Oe=zr;var hi=Hr;var ce=Gr;var wn=Xr;var ut=class extends An{constructor(t,n,i){super(t,i);this.blob=ce(t),this.signed=n}decode(t,n=0){let i=new xi(this.blob.decode(t,n),10,"le");return this.signed?i.fromTwos(this.span*8).clone():i}encode(t,n,i=0){return typeof t=="number"&&(t=new xi(t)),this.signed&&(t=t.toTwos(this.span*8)),this.blob.encode(t.toArrayLike(Buffer,"le",this.span),n,i)}};function v(o){return new Tn(1,o)}function ct(o){return new Tn(4,o)}function f(o){return new ut(8,!1,o)}function ne(o){return new ut(16,!1,o)}function Si(o){return new ut(8,!0,o)}function Ki(o){return new ut(16,!0,o)}var Je=class extends An{constructor(t,n,i,r){super(t.span,r);this.layout=t,this.decoder=n,this.encoder=i}decode(t,n){return this.decoder(this.layout.decode(t,n))}encode(t,n,i){return this.layout.encode(this.encoder(t),n,i)}getSpan(t,n){return this.layout.getSpan(t,n)}};function E(o){return new Je(ce(32),e=>new $r(e),e=>e.toBuffer(),o)}function hn(o){return new Je(Bi(),eo,to,o)}function eo(o){if(o===0)return!1;if(o===1)return!0;throw new Error("Invalid bool: "+o)}function to(o){return o?1:0}function Ci(o,e){let t=kn("length"),n=W([t,z(o,wn(t,-t.span),"values")]);return new Je(n,({values:i})=>i,i=>({values:i}),e)}function no(o){let e=kn("length"),t=W([e,ce(wn(e,-e.span),"data")]);return new Je(t,({data:n})=>n,n=>({data:n}),o)}function le(o){return new Je(no(),e=>e.toString("utf-8"),e=>Buffer.from(e,"utf-8"),o)}var Bn=class extends wi{decode(e,t){return super.decode(e,t)}};function W(o,e,t){return new Bn(o,e,t)}function z(o,e,t){let n,i=typeof e=="number"?e:Ii(e)?e.toNumber():new Proxy(e,{get(r,s){if(!n){let a=Reflect.get(r,"count");n=Ii(a)?a.toNumber():a,Reflect.set(r,"count",n)}return Reflect.get(r,s)},set(r,s,a){return s==="count"&&(n=a),Reflect.set(r,s,a)}});return hi(o,i,t)}import Id from"bn.js";import Kd from"decimal.js";import ye from"bn.js";var xn=new ye(0),Ni=new ye(1),Ri=new ye(-1),Ke=new ye(1).shln(64),Li=new ye(1).shln(128),In=Ke.sub(Ni);var io=Li.subn(1),lt=-443636,It=-lt,Sn=new ye("4295048016"),Kn=new ye("79226673521066979257578248091"),_l=new ye("4295048017"),ql=new ye("79226673521066979257578248090");var ro=new ye(10).pow(new ye(6));var Gl=new ye("18446744073700000000");import md from"bn.js";import pd from"decimal.js";var jl=Buffer.from("amm_config","utf8"),Fi=Buffer.from("pool","utf8"),Mi=Buffer.from("pool_vault","utf8"),Zl=Buffer.from("pool_reward_vault","utf8"),Ql=Buffer.from("position","utf8"),Jl=Buffer.from("tick_array","utf8"),$l=Buffer.from("operation","utf8"),em=Buffer.from("pool_tick_array_bitmap_extension","utf8"),tm=Buffer.from("observation","utf8");function Cn(o){return ue([Buffer.from("metadata","utf8"),rt.toBuffer(),o.toBuffer()],rt)}var nm=Buffer.from("locked_position","utf8");var im=Buffer.from("support_mint","utf8");import{PublicKey as vm}from"@solana/web3.js";import{TOKEN_2022_PROGRAM_ID as Dm}from"@solana/spl-token";import _m from"bn.js";import Gm from"decimal.js";import sm from"bn.js";import um from"decimal.js";var Ln=14;var _t=60;var co=W([ce(8),v("bump"),Me("index"),E(""),ct("protocolFeeRate"),ct("tradeFeeRate"),Me("tickSpacing"),z(f(),8,"")]),lo=W([ct("blockTimestamp"),Si("tickCumulative"),z(f(),4)]),Ui=W([ce(8),hn("initialized"),f("recentEpoch"),Me("observationIndex"),E("poolId"),z(lo,100,"observations"),z(f(),4)]),mo=W([v("rewardState"),f("openTime"),f("endTime"),f("lastUpdateTime"),ne("emissionsPerSecondX64"),f("rewardTotalEmissioned"),f("rewardClaimed"),E("tokenMint"),E("tokenVault"),E("creator"),ne("rewardGrowthGlobalX64")]),_i=W([ce(8),v("bump"),E("ammConfig"),E("creator"),E("mintA"),E("mintB"),E("vaultA"),E("vaultB"),E("observationId"),v("mintDecimalsA"),v("mintDecimalsB"),Me("tickSpacing"),ne("liquidity"),ne("sqrtPriceX64"),Oe("tickCurrent"),ct(),ne("feeGrowthGlobalX64A"),ne("feeGrowthGlobalX64B"),f("protocolFeesTokenA"),f("protocolFeesTokenB"),ne("swapInAmountTokenA"),ne("swapOutAmountTokenB"),ne("swapInAmountTokenB"),ne("swapOutAmountTokenA"),v("status"),z(v(),7,""),z(mo,3,"rewardInfos"),z(f(),16,"tickArrayBitmap"),f("totalFeesTokenA"),f("totalFeesClaimedTokenA"),f("totalFeesTokenB"),f("totalFeesClaimedTokenB"),f("fundFeesTokenA"),f("fundFeesTokenB"),f("startTime"),z(f(),15*4-3,"padding")]),po=W([ne("growthInsideLastX64"),f("rewardAmountOwed")]),qi=W([ce(8),v("bump"),E("nftMint"),E("poolId"),Oe("tickLower"),Oe("tickUpper"),ne("liquidity"),ne("feeGrowthInsideLastX64A"),ne("feeGrowthInsideLastX64B"),f("tokenFeesOwedA"),f("tokenFeesOwedB"),z(po,3,"rewardInfos"),z(f(),8,"")]),vd=W([ce(8),v("bump"),E("poolId"),Oe("tickLowerIndex"),Oe("tickUpperIndex"),ne("liquidity"),ne("feeGrowthInsideLastX64A"),ne("feeGrowthInsideLastX64B"),f("tokenFeesOwedA"),f("tokenFeesOwedB"),z(ne(),3,"rewardGrowthInside"),z(f(),8,"")]),fo=W([Oe("tick"),Ki("liquidityNet"),ne("liquidityGross"),ne("feeGrowthOutsideX64A"),ne("feeGrowthOutsideX64B"),z(ne(),3,"rewardGrowthsOutsideX64"),z(ct(),13,"")]),Wi=W([ce(8),E("poolId"),Oe("startTickIndex"),z(fo,_t,"ticks"),v("initializedTickCount"),z(v(),115,"")]),bo=W([ce(329),z(E(),100,"whitelistMints")]),uo=W([ce(8),E("poolId"),z(z(f(),8),Ln,"positiveTickArrayBitmap"),z(z(f(),8),Ln,"negativeTickArrayBitmap")]),Wd=W([f(),v("bump"),E("owner"),E("poolId"),E("positionId"),E("nftAccount"),z(f(),8)]),yo=W([ce(8),v("bump"),E("lockOwner"),E("poolId"),E("positionId"),E("nftAccount"),E("lockNftMint"),f("recentEpoch"),z(f(),8)]);Ui.span;var pp=oe("Raydium_Clmm");var To=Buffer.from("vault_auth_seed","utf8"),Af=Buffer.from("global_config","utf8"),ko=Buffer.from("pool_vesting","utf8"),wo=Buffer.from("platform_config","utf8"),Bo=Buffer.from("platform_fee_vault_auth_seed","utf8"),ho=Buffer.from("creator_fee_vault_auth_seed","utf8");function Ce(o){return ue([To],o)}function mt(o,e,t){return ue([Fi,e.toBuffer(),t.toBuffer()],o)}function Fn(o,e,t){return ue([Mi,e.toBuffer(),t.toBuffer()],o)}function $e(o){return ue([Buffer.from("__event_authority","utf8")],o)}function Mn(o,e){return ue([wo,e.toBuffer()],o)}function Ct(o,e,t){return ue([ko,e.toBuffer(),t.toBuffer()],o)}function et(o,e,t){return ue([e.toBuffer(),t.toBuffer()],o)}function On(o){return ue([Bo],o)}function tt(o,e,t){return ue([e.toBuffer(),t.toBuffer()],o)}function En(o){return ue([ho],o)}import{ASSOCIATED_TOKEN_PROGRAM_ID as qt,TOKEN_2022_PROGRAM_ID as So,TOKEN_PROGRAM_ID as vn}from"@solana/spl-token";import{SystemProgram as ge,TransactionInstruction as pe}from"@solana/web3.js";import pt from"bn.js";var Ge=W([f(),f("epoch"),v("curveType"),Me("index"),f("migrateFee"),f("tradeFeeRate"),f("maxShareFeeRate"),f("minSupplyA"),f("maxLockRate"),f("minSellRateA"),f("minMigrateRateA"),f("minFundRaisingB"),E("mintB"),E("protocolFeeOwner"),E("migrateFeeOwner"),E("migrateToAmmWallet"),E("migrateToCpmmWallet"),z(f(),16)]),xo=W([f("totalLockedAmount"),f("cliffPeriod"),f("unlockPeriod"),f("startTime"),f("totalAllocatedShare")]),we=W([f(),f("epoch"),v("bump"),v("status"),v("mintDecimalsA"),v("mintDecimalsB"),v("migrateType"),f("supply"),f("totalSellA"),f("virtualA"),f("virtualB"),f("realA"),f("realB"),f("totalFundRaisingB"),f("protocolFee"),f("platformFee"),f("migrateFee"),xo.replicate("vestingSchedule"),E("configId"),E("platformId"),E("mintA"),E("mintB"),E("vaultA"),E("vaultB"),E("creator"),v("mintProgramFlag"),v("cpmmCreatorFeeOn"),z(v(),62)]),wf=W([f(),f("epoch"),E("poolId"),E("beneficiary"),f("claimedAmount"),f("tokenShareAmount"),z(f(),8)]),Xi=W([v("migrateType"),v("migrateCpmmFeeOn"),f("supply"),f("totalSellA"),f("totalFundRaisingB"),f("totalLockedAmount"),f("cliffPeriod"),f("unlockPeriod")]),Io=W([f("epoch"),v("index"),E("configId"),Xi.replicate("bondingCurveParam"),z(f(),50)]),dt=W([f(),f("epoch"),E("platformClaimFeeWallet"),E("platformLockNftWallet"),f("platformScale"),f("creatorScale"),f("burnScale"),f("feeRate"),z(v(),64,"name"),z(v(),256,"web"),z(v(),256,"img"),E("cpConfigId"),f("creatorFeeRate"),E("transferFeeExtensionAuth"),z(v(),180),Ci(Io,"platformCurve")]);var fe={initialize:Buffer.from([175,175,109,31,13,152,155,237]),initializeV2:Buffer.from([67,153,175,39,218,16,38,32]),buyExactIn:Buffer.from([250,234,13,123,213,156,19,236]),buyExactOut:Buffer.from([24,211,116,40,105,3,153,56]),sellExactIn:Buffer.from([149,39,222,155,211,124,152,26]),sellExactOut:Buffer.from([95,200,71,34,8,9,11,166]),createVestingAccount:Buffer.from([129,178,2,13,217,172,230,218]),claimVestedToken:Buffer.from([49,33,104,30,189,157,79,35]),createPlatformConfig:Buffer.from([176,90,196,175,253,113,220,20]),claimPlatformFee:Buffer.from([156,39,208,135,76,237,61,72]),updatePlaformConfig:Buffer.from([195,60,76,129,146,45,67,143]),initializeWithToken2022:Buffer.from([37,190,126,222,44,154,171,17]),claimPlatformFeeFromVault:Buffer.from([117,241,198,168,248,218,80,29]),claimCreatorFee:Buffer.from([26,97,138,203,132,171,141,252]),updatePlatformCurveParam:Buffer.from([138,144,138,250,220,128,4,57]),removePlatformCurveParam:Buffer.from([27,30,62,169,93,224,24,145])};function zi(o,e,t,n,i,r,s,a,c,u,p,m,T,A,l,y,b,h,g,x,k){let d=W([v("decimals"),le("name"),le("symbol"),le("uri")]),P=W([f("totalLockedAmount"),f("cliffPeriod"),f("unlockPeriod"),v("cpmmCreatorFeeOn")]),I=W([v("index"),f("supply"),f("totalFundRaisingB"),v("migrateType")]),w=W([v("index"),f("supply"),f("totalSellA"),f("totalFundRaisingB"),v("migrateType")]),S=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!0,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!1},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:vn,isSigner:!1,isWritable:!1},{pubkey:vn,isSigner:!1,isWritable:!1},{pubkey:rt,isSigner:!1,isWritable:!1},{pubkey:ge.programId,isSigner:!1,isWritable:!1},{pubkey:rn,isSigner:!1,isWritable:!1},{pubkey:$e(o).publicKey,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1}],C=Buffer.alloc(Buffer.from(A,"utf-8").length+Buffer.from(l,"utf-8").length+Buffer.from(y,"utf-8").length+4*3+1),F=Buffer.alloc(P.span),B=Buffer.alloc(b.type==="ConstantCurve"?w.span:I.span);return d.encode({decimals:T,name:A,symbol:l,uri:y},C),b.type==="ConstantCurve"?w.encode(Y(_({index:0},b),{migrateType:b.migrateType==="amm"?0:1}),B):b.type==="FixedCurve"?I.encode(Y(_({index:1},b),{migrateType:b.migrateType==="amm"?0:1}),B):b.type==="LinearCurve"&&I.encode(Y(_({index:2},b),{migrateType:b.migrateType==="amm"?0:1}),B),P.encode({totalLockedAmount:h,cliffPeriod:g,unlockPeriod:x,cpmmCreatorFeeOn:k},F),new pe({keys:S,programId:o,data:Buffer.from([...fe.initializeV2,...C,...B,...F])})}function Hi(o,e,t,n,i,r,s,a,c,u,p,m,T,A,l,y,b,h,g,x,k){let d=W([v("decimals"),le("name"),le("symbol"),le("uri")]),P=W([f("totalLockedAmount"),f("cliffPeriod"),f("unlockPeriod"),v("cpmmCreatorFeeOn"),v("transferFeeExtensionParamsOption"),W([Me("transferFeeBasePoints"),f("maxinumFee")]).replicate("transferFeeExtensionParams")]),I=W([v("index"),f("supply"),f("totalFundRaisingB"),v("migrateType")]),w=W([v("index"),f("supply"),f("totalSellA"),f("totalFundRaisingB"),v("migrateType")]),S=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!0,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!1},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:So,isSigner:!1,isWritable:!1},{pubkey:vn,isSigner:!1,isWritable:!1},{pubkey:ge.programId,isSigner:!1,isWritable:!1},{pubkey:$e(o).publicKey,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1}],C=Buffer.alloc(Buffer.from(T,"utf-8").length+Buffer.from(A,"utf-8").length+Buffer.from(l,"utf-8").length+4*3+1),F=Buffer.alloc(P.span),B=Buffer.alloc(y.type==="ConstantCurve"?w.span:I.span);return d.encode({decimals:m,name:T,symbol:A,uri:l},C),y.type==="ConstantCurve"?w.encode(Y(_({index:0},y),{migrateType:y.migrateType==="amm"?0:1}),B):y.type==="FixedCurve"?I.encode(Y(_({index:1},y),{migrateType:y.migrateType==="amm"?0:1}),B):y.type==="LinearCurve"&&I.encode(Y(_({index:2},y),{migrateType:y.migrateType==="amm"?0:1}),B),P.encode({totalLockedAmount:b,cliffPeriod:h,unlockPeriod:g,cpmmCreatorFeeOn:x,transferFeeExtensionParamsOption:k?1:0,transferFeeExtensionParams:k!=null?k:{transferFeeBasePoints:0,maxinumFee:new pt(0)}},F),new pe({keys:S,programId:o,data:Buffer.from([...fe.initializeWithToken2022,...C,...B,...F])})}function Yi(o,e,t,n,i,r,s,a,c,u,p,m,T,A,l,y,b,h,g,x){let k=W([f("amountB"),f("minAmountA"),f("shareFeeRate")]),d=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:T,isSigner:!1,isWritable:!1},{pubkey:A,isSigner:!1,isWritable:!1},{pubkey:$e(o).publicKey,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1}];x&&d.push({pubkey:x,isSigner:!1,isWritable:!0}),d.push({pubkey:ge.programId,isSigner:!1,isWritable:!1}),d.push({pubkey:l,isSigner:!1,isWritable:!0}),d.push({pubkey:y,isSigner:!1,isWritable:!0});let P=Buffer.alloc(k.span);return k.encode({amountB:b,minAmountA:h,shareFeeRate:g!=null?g:new pt(0)},P),new pe({keys:d,programId:o,data:Buffer.from([...fe.buyExactIn,...P])})}function ji(o,e,t,n,i,r,s,a,c,u,p,m,T,A,l,y,b,h,g,x){let k=W([f("amountA"),f("maxAmountB"),f("shareFeeRate")]),d=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:T,isSigner:!1,isWritable:!1},{pubkey:A,isSigner:!1,isWritable:!1},{pubkey:$e(o).publicKey,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1}];x&&d.push({pubkey:x,isSigner:!1,isWritable:!0}),d.push({pubkey:ge.programId,isSigner:!1,isWritable:!1}),d.push({pubkey:l,isSigner:!1,isWritable:!0}),d.push({pubkey:y,isSigner:!1,isWritable:!0});let P=Buffer.alloc(k.span);return k.encode({amountA:b,maxAmountB:h,shareFeeRate:g!=null?g:new pt(0)},P),new pe({keys:d,programId:o,data:Buffer.from([...fe.buyExactOut,...P])})}function Zi(o,e,t,n,i,r,s,a,c,u,p,m,T,A,l,y,b,h,g,x){let k=W([f("amountA"),f("minAmountB"),f("shareFeeRate")]),d=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:T,isSigner:!1,isWritable:!1},{pubkey:A,isSigner:!1,isWritable:!1},{pubkey:$e(o).publicKey,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1}];x&&d.push({pubkey:x,isSigner:!1,isWritable:!0}),d.push({pubkey:ge.programId,isSigner:!1,isWritable:!1}),d.push({pubkey:l,isSigner:!1,isWritable:!0}),d.push({pubkey:y,isSigner:!1,isWritable:!0});let P=Buffer.alloc(k.span);return k.encode({amountA:b,minAmountB:h,shareFeeRate:g!=null?g:new pt(0)},P),new pe({keys:d,programId:o,data:Buffer.from([...fe.sellExactIn,...P])})}function Qi(o,e,t,n,i,r,s,a,c,u,p,m,T,A,l,y,b,h,g,x){let k=W([f("amountB"),f("maxAmountA"),f("shareFeeRate")]),d=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:T,isSigner:!1,isWritable:!1},{pubkey:A,isSigner:!1,isWritable:!1},{pubkey:$e(o).publicKey,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1}];x&&d.push({pubkey:x,isSigner:!1,isWritable:!0}),d.push({pubkey:ge.programId,isSigner:!1,isWritable:!1}),d.push({pubkey:l,isSigner:!1,isWritable:!0}),d.push({pubkey:y,isSigner:!1,isWritable:!0});let P=Buffer.alloc(k.span);return k.encode({amountB:b,maxAmountA:h,shareFeeRate:g!=null?g:new pt(0)},P),new pe({keys:d,programId:o,data:Buffer.from([...fe.sellExactOut,...P])})}function Wn(o,e,t,n,i,r,s,a,c){let u=W([]),p=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!1},{pubkey:ge.programId,isSigner:!1,isWritable:!1},{pubkey:qt,isSigner:!1,isWritable:!1}],m=Buffer.alloc(u.span);return u.encode({},m),new pe({keys:p,programId:o,data:Buffer.from([...fe.claimVestedToken,...m])})}function Dn(o,e,t,n,i,r){let s=W([f("shareAmount")]),a=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:ge.programId,isSigner:!1,isWritable:!1}],c=Buffer.alloc(s.span);return s.encode({shareAmount:r},c),new pe({keys:a,programId:o,data:Buffer.from([...fe.createVestingAccount,...c])})}function Vn(o,e,t,n,i,r,s,a,c){let u=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:ge.programId,isSigner:!1,isWritable:!0},{pubkey:qt,isSigner:!1,isWritable:!0}];return new pe({keys:u,programId:o,data:fe.claimPlatformFee})}function Ji(o,e,t,n,i,r,s,a,c,u,p,m,T){let A=W([f("platformScale"),f("creatorScale"),f("burnScale"),f("feeRate"),le("name"),le("web"),le("img"),f("creatorFeeRate")]),l=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:ge.programId,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!1}],y=Buffer.alloc(8*5+Buffer.from(p,"utf-8").length+Buffer.from(m,"utf-8").length+Buffer.from(T,"utf-8").length+4*3);return A.encode({platformScale:a.platformScale,creatorScale:a.creatorScale,burnScale:a.burnScale,feeRate:c,name:p,web:m,img:T,creatorFeeRate:u},y),new pe({keys:l,programId:o,data:Buffer.from([...fe.createPlatformConfig,...y])})}function $i(o,e,t,n){let i=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!0}],r;if(n.type==="updateClaimFeeWallet"){let s=W([v("index"),E("value")]);r=Buffer.alloc(s.span),s.encode({index:0,value:n.value},r)}else if(n.type==="updateLockNftWallet"){let s=W([v("index"),E("value")]);r=Buffer.alloc(s.span),s.encode({index:1,value:n.value},r)}else if(n.type==="migrateCpLockNftScale"){let s=W([v("index"),f("platformScale"),f("creatorScale"),f("burnScale")]);r=Buffer.alloc(s.span),s.encode(_({index:2},n.value),r)}else if(n.type==="updateFeeRate"){let s=W([v("index"),f("value")]);r=Buffer.alloc(s.span),s.encode({index:3,value:n.value},r)}else if(n.type==="updateImg"||n.type==="updateName"||n.type==="updateWeb"){let s=W([v("index"),le("value")]);r=Buffer.alloc(Buffer.from(n.value,"utf-8").length+4+1*1),n.type==="updateName"?s.encode({index:4,value:n.value},r):n.type==="updateWeb"?s.encode({index:5,value:n.value},r):n.type==="updateImg"&&s.encode({index:6,value:n.value},r)}else if(n.type==="updateCpConfigId"){i.push({pubkey:n.value,isSigner:!1,isWritable:!1});let s=W([v("index")]);r=Buffer.alloc(s.span),s.encode({index:7},r)}else if(n.type==="updateAll"){i.push({pubkey:n.value.cpConfigId,isSigner:!1,isWritable:!1});let s=W([v("index"),E("platformClaimFeeWallet"),E("platformLockNftWallet"),f("platformScale"),f("creatorScale"),f("burnScale"),f("feeRate"),le("name"),le("web"),le("img"),E("transferFeeExtensionAuth"),f("creatorFeeRate")]);r=Buffer.alloc(1+32+32+8*4+4*3+Buffer.from(n.value.name,"utf-8").length+Buffer.from(n.value.web,"utf-8").length+Buffer.from(n.value.img,"utf-8").length+32+8),s.encode({index:8,platformClaimFeeWallet:n.value.platformClaimFeeWallet,platformLockNftWallet:n.value.platformLockNftWallet,platformScale:n.value.migrateCpLockNftScale.platformScale,creatorScale:n.value.migrateCpLockNftScale.creatorScale,burnScale:n.value.migrateCpLockNftScale.burnScale,feeRate:n.value.feeRate,name:n.value.name,web:n.value.web,img:n.value.img,transferFeeExtensionAuth:n.value.transferFeeExtensionAuth,creatorFeeRate:n.value.creatorFeeRate},r)}else throw Error("updateInfo params type error");return new pe({keys:i,programId:o,data:Buffer.from([...fe.updatePlaformConfig,...r])})}function _n(o,e,t,n,i,r,s,a){let c=[{pubkey:t,isSigner:!0,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:e,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:ge.programId,isSigner:!1,isWritable:!1},{pubkey:qt,isSigner:!1,isWritable:!1}];return new pe({keys:c,programId:o,data:fe.claimPlatformFeeFromVault})}function qn(o,e,t,n,i,r,s){let a=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:ge.programId,isSigner:!1,isWritable:!1},{pubkey:qt,isSigner:!1,isWritable:!1}];return new pe({keys:a,programId:o,data:fe.claimCreatorFee})}var Mf=new pt("18446744073709551615");import{NATIVE_MINT as Ee,TOKEN_2022_PROGRAM_ID as Xe,TOKEN_PROGRAM_ID as J,createAssociatedTokenAccountIdempotentInstruction as de,createSyncNativeInstruction as Ko,getTransferFeeConfig as Yt,unpackMint as jt}from"@solana/spl-token";import D from"bn.js";import{PublicKey as nr,SystemProgram as Co}from"@solana/web3.js";import Pe from"bn.js";import tr from"decimal.js";import Gt from"bn.js";import Nt from"decimal.js";var Ue=class{static getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n}){throw Error()}static getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:i}){throw Error()}static getPoolPrice({poolInfo:e,decimalA:t,decimalB:n}){throw Error()}static getPoolEndPrice({supply:e,totalSell:t,totalLockedAmount:n,totalFundRaising:i,migrateFee:r,decimalA:s,decimalB:a}){throw Error()}static getPoolEndPriceReal({poolInfo:e,decimalA:t,decimalB:n}){throw Error()}static getInitParam({supply:e,totalFundRaising:t,totalSell:n,totalLockedAmount:i,migrateFee:r}){throw Error()}static buyExactIn({poolInfo:e,amount:t}){throw Error()}static buyExactOut({poolInfo:e,amount:t}){throw Error()}static sellExactIn({poolInfo:e,amount:t}){throw Error()}static sellExactOut({poolInfo:e,amount:t}){throw Error()}};var Ut=class extends Ue{static getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n}){return new Nt(e.virtualB.toString()).div(e.virtualA.toString()).mul(10**(t-n))}static getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:i}){return new Nt(t.toString()).div(e.toString()).mul(10**(n-i))}static getPoolPrice({poolInfo:e,decimalA:t,decimalB:n}){return new Nt(e.virtualB.add(e.realB).toString()).div(e.virtualA.sub(e.realA).toString()).mul(10**(t-n))}static getPoolEndPrice({supply:e,totalSell:t,totalLockedAmount:n,totalFundRaising:i,migrateFee:r,decimalA:s,decimalB:a}){return new Nt(i.sub(r).toString()).div(e.sub(t).sub(n).toString()).mul(10**(s-a))}static getPoolEndPriceReal({poolInfo:e,decimalA:t,decimalB:n}){let i=e.totalSellA.sub(e.realA),r=e.totalFundRaisingB.sub(e.realB);return new Nt(e.virtualB.add(e.realB.add(r)).toString()).div(e.virtualA.sub(e.realA.add(i)).toString()).mul(10**(t-n))}static getInitParam({supply:e,totalFundRaising:t,totalSell:n,totalLockedAmount:i,migrateFee:r}){if(e.lte(n))throw Error("supply need gt total sell");let s=e.sub(n).sub(i);if(s.lte(new Gt(0)))throw Error("supplyMinusSellLocked <= 0");let a=t.sub(r);if(a.lte(new Gt(0)))throw Error("tfMinusMf <= 0");let c=a.mul(n).mul(n).div(s),u=a.mul(n).div(s).sub(t),p=c.div(u),m=t.mul(t).div(u);if(p.lt(new Gt(0))||m.lt(new Gt(0)))throw Error("invalid input 0");return{a:p,b:m,c:n}}static buyExactIn({poolInfo:e,amount:t}){return this.getAmountOut({amountIn:t,inputReserve:e.virtualB.add(e.realB),outputReserve:e.virtualA.sub(e.realA)})}static buyExactOut({poolInfo:e,amount:t}){return this.getAmountIn({amountOut:t,inputReserve:e.virtualB.add(e.realB),outputReserve:e.virtualA.sub(e.realA)})}static sellExactIn({poolInfo:e,amount:t}){return this.getAmountOut({amountIn:t,inputReserve:e.virtualA.sub(e.realA),outputReserve:e.virtualB.add(e.realB)})}static sellExactOut({poolInfo:e,amount:t}){return this.getAmountIn({amountOut:t,inputReserve:e.virtualA.sub(e.realA),outputReserve:e.virtualB.add(e.realB)})}static getAmountOut({amountIn:e,inputReserve:t,outputReserve:n}){let i=e.mul(n),r=t.add(e);return i.div(r)}static getAmountIn({amountOut:e,inputReserve:t,outputReserve:n}){let i=t.mul(e),r=n.sub(e);return je(i,r)}};import Xt from"bn.js";import Rt from"decimal.js";var zt=class extends Ue{static getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n}){return new Rt(e.virtualB.toString()).div(e.virtualA.toString()).mul(10**(t-n))}static getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:i}){return new Rt(t.toString()).div(e.toString()).mul(10**(n-i))}static getPoolPrice({poolInfo:e,decimalA:t,decimalB:n}){return new Rt(e.virtualB.toString()).div(e.virtualA.toString()).mul(10**(t-n))}static getPoolEndPrice({supply:e,totalSell:t,totalLockedAmount:n,totalFundRaising:i,migrateFee:r,decimalA:s,decimalB:a}){return new Rt(i.sub(r).toString()).div(e.sub(t).sub(n).toString()).mul(10**(s-a))}static getPoolEndPriceReal({poolInfo:e,decimalA:t,decimalB:n}){let i=e.totalSellA.sub(e.realA),r=e.totalFundRaisingB.sub(e.realB);return new Rt(e.virtualB.add(e.realB).add(r).toString()).div(e.virtualA.sub(e.realA).add(i).toString()).mul(10**(t-n))}static getInitParam({supply:e,totalFundRaising:t,totalSell:n,totalLockedAmount:i,migrateFee:r}){let s=e.sub(i);if(s.lte(new Xt(0)))throw Error("invalid input 1");let a=new Xt(2).mul(t).sub(r),u=t.mul(s).div(a);if(u.lt(new Xt(0))||t.lt(new Xt(0)))throw Error("invalid input 0");return{a:u,b:t,c:u}}static buyExactIn({poolInfo:e,amount:t}){return this.getAmountOut({amountIn:t,initInput:e.virtualB,initOutput:e.virtualA})}static buyExactOut({poolInfo:e,amount:t}){return this.getAmountIn({amountOut:t,initInput:e.virtualB,initOutput:e.virtualA})}static sellExactIn({poolInfo:e,amount:t}){return this.getAmountOut({amountIn:t,initInput:e.virtualA,initOutput:e.virtualB})}static sellExactOut({poolInfo:e,amount:t}){return this.getAmountIn({amountOut:t,initInput:e.virtualA,initOutput:e.virtualB})}static getAmountOut({amountIn:e,initInput:t,initOutput:n}){return n.mul(e).div(t)}static getAmountIn({amountOut:e,initInput:t,initOutput:n}){let i=t.mul(e);return je(i,n)}};import me from"bn.js";import nt from"decimal.js";import er from"bn.js";import Gn from"decimal.js";var Lt=class{static _multipler(e){return new Gn(10).pow(e)}static getPrice({priceX64:e,decimalA:t,decimalB:n}){return new Gn(e.toString()).div(this._Q64).mul(this._multipler(t)).div(this._multipler(n))}static getPriceX64({price:e,decimalA:t,decimalB:n}){let i=e.mul(this._multipler(n)).div(this._multipler(t));return new er(i.mul(this._Q64).toFixed(0))}};Lt._Q64=new Gn(new er(1).shln(64).toString());var Ht=class extends Ue{static getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n}){return new nt(0)}static getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:i}){return new nt(0)}static getPoolPrice({poolInfo:e,decimalA:t,decimalB:n}){return new nt(e.virtualA.mul(e.realA).toString()).div(Lt._Q64).mul(10**(t-n))}static getPoolEndPrice({supply:e,totalSell:t,totalLockedAmount:n,totalFundRaising:i,migrateFee:r,decimalA:s,decimalB:a}){return new nt(i.sub(r).toString()).div(e.sub(t).sub(n).toString()).mul(10**(s-a))}static getPoolEndPriceReal({poolInfo:e,decimalA:t,decimalB:n}){let i=e.totalSellA.sub(e.realA),r=e.totalFundRaisingB.sub(e.realB);return new nt(e.virtualB.add(e.realB).add(r).toString()).div(e.virtualA.sub(e.realA).add(i).toString()).mul(10**(t-n))}static getInitParam({supply:e,totalFundRaising:t,totalSell:n,totalLockedAmount:i,migrateFee:r}){let s=e.sub(i);if(s.lte(new me(0)))throw Error("supplyMinusLocked need gt 0");let a=t.mul(new me(3)).sub(r),u=t.mul(new me(2)).mul(s).div(a),p=u.mul(u),m=t.mul(new me(2)).mul(Ke).div(p);if(!m.gt(new me(0)))throw Error("a need gt 0");if(!In.gt(m))throw Error("a need lt u64 max");if(m.lt(new me(0))||u.lt(new me(0)))throw Error("invalid input 0");return{a:m,b:new me(0),c:u}}static buyExactIn({poolInfo:e,amount:t}){let n=e.realB.add(t),i=new me(2).mul(n).mul(Ke).div(e.virtualA);return new me(new nt(i.toString()).sqrt().toFixed(0)).sub(e.realA)}static buyExactOut({poolInfo:e,amount:t}){let n=e.realA.add(t),i=n.mul(n);return je(e.virtualA.mul(i),new me(2).mul(Ke)).sub(e.realB)}static sellExactIn({poolInfo:e,amount:t}){let n=e.realA.sub(t),i=n.mul(n),r=je(e.virtualA.mul(i),new me(2).mul(Ke));return e.realB.sub(r)}static sellExactOut({poolInfo:e,amount:t}){let n=e.realB.sub(t),i=new me(2).mul(n).mul(Ke).div(e.virtualA),r=new me(new nt(i.toString()).sqrt().toFixed(0));return e.realA.sub(r)}};var Ae=class{static getPoolCurvePointByPoolInfo({curveType:e,pointCount:t,poolInfo:n}){return this.getPoolCurvePointByInit({curveType:e,pointCount:t,supply:n.supply,totalFundRaising:n.totalFundRaisingB,totalSell:n.totalSellA,totalLockedAmount:n.vestingSchedule.totalLockedAmount,migrateFee:n.migrateFee,decimalA:n.mintDecimalsA,decimalB:n.mintDecimalsB})}static getPoolCurvePointByInit({curveType:e,pointCount:t,supply:n,totalFundRaising:i,totalSell:r,totalLockedAmount:s,migrateFee:a,decimalA:c,decimalB:u}){if(t<3)throw Error("point count < 3");let p=this.getCurve(e),m=p.getInitParam({supply:n,totalFundRaising:i,totalSell:r,totalLockedAmount:s,migrateFee:a}),T=p.getPoolInitPriceByInit(Y(_({},m),{decimalA:c,decimalB:u})),A=i.div(new Pe(t-1)),l=new Pe(0),y=[{price:T,totalSellSupply:0}],{a:b,b:h}=m,g=l,x=l;for(let k=1;k<t;k++){let d=k!==t-1?A:i.sub(x),P=this.buyExactIn({poolInfo:{virtualA:b,virtualB:h,realA:g,realB:x,totalFundRaisingB:i,totalSellA:r},amountB:d,protocolFeeRate:l,platformFeeRate:l,curveType:e,shareFeeRate:l,creatorFeeRate:l,transferFeeConfigA:void 0,slot:0});g=g.add(P.amountA.amount),x=x.add(P.amountB);let I=this.getPrice({poolInfo:{virtualA:b,virtualB:h,realA:g,realB:x},decimalA:c,decimalB:u,curveType:e});y.push({price:I,totalSellSupply:new tr(g.toString()).div(10**c).toNumber()})}return y}static getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n,curveType:i}){return this.getCurve(i).getPoolInitPriceByPool({poolInfo:e,decimalA:t,decimalB:n})}static getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:i,curveType:r}){return this.getCurve(r).getPoolInitPriceByInit({a:e,b:t,decimalA:n,decimalB:i})}static getPrice({poolInfo:e,curveType:t,decimalA:n,decimalB:i}){return this.getCurve(t).getPoolPrice({poolInfo:e,decimalA:n,decimalB:i})}static getEndPrice({poolInfo:e,curveType:t,decimalA:n,decimalB:i}){return this.getCurve(t).getPoolPrice({poolInfo:e,decimalA:n,decimalB:i})}static getPoolEndPriceReal({poolInfo:e,curveType:t,decimalA:n,decimalB:i}){return this.getCurve(t).getPoolEndPriceReal({poolInfo:e,decimalA:n,decimalB:i})}static checkParam({supply:e,totalFundRaising:t,totalSell:n,totalLockedAmount:i,decimals:r,config:s,migrateType:a}){if(Number(r)!==6)throw Error("decimals = 6");if(e.mul(s.maxLockRate).div(Ze).lt(i))throw Error("total lock amount gte max lock amount");if(e.lt(s.minSupplyA.mul(new Pe(10**r))))throw Error("supply lt min supply");let u=e.mul(s.minSellRateA).div(Ze);if(n.lt(u))throw Error("invalid input");if(t.lt(s.minFundRaisingB))throw Error("total fund raising lt min fund raising");let p=e.sub(n).sub(i),m=e.mul(s.minMigrateRateA).div(Ze);if(p.lt(m))throw Error("migrate lt min migrate amoount");let T=e.sub(n).sub(i),A=new Pe(new tr(T.mul(t).toString()).sqrt().toFixed(0));if(a==="amm"){let l=new Pe(10).pow(new Pe(r));if(A.lte(l))throw Error("check migrate lp error")}else if(a==="cpmm"){let l=new Pe(100);if(A.lte(l))throw Error("check migrate lp error")}else throw Error("migrate type error")}static buyExactIn({poolInfo:e,amountB:t,protocolFeeRate:n,platformFeeRate:i,curveType:r,shareFeeRate:s,creatorFeeRate:a,transferFeeConfigA:c,slot:u}){let p=this.totalFeeRate({protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a}),m=this.calculateFee({amount:t,feeRate:p}),T=t.sub(m),A=this.getCurve(r),l=A.buyExactIn({poolInfo:e,amount:T}),y=e.totalSellA.sub(e.realA),b,h,g;if(l.gt(y)){b=y;let k=A.buyExactOut({poolInfo:e,amount:b});h=this.calculatePreFee({postFeeAmount:k,feeRate:p}),g=h.sub(k)}else b=l,h=t,g=m;let x=this.splitFee({totalFee:g,protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a});return{amountA:dn(b,c,u),amountB:h,splitFee:x}}static buyExactOut({poolInfo:e,amountA:t,protocolFeeRate:n,platformFeeRate:i,curveType:r,shareFeeRate:s,creatorFeeRate:a,transferFeeConfigA:c,slot:u}){let p=e.totalSellA.sub(e.realA),m=pn(t,c,u),T=m.fee?m.amount.add(m.fee):m.amount;t.gt(p)&&(T=p);let l=this.getCurve(r).buyExactOut({poolInfo:e,amount:T}),y=this.totalFeeRate({protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a}),b=this.calculatePreFee({postFeeAmount:l,feeRate:y}),h=b.sub(l),g=this.splitFee({totalFee:h,protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a});return{amountA:m,amountB:b,splitFee:g}}static sellExactIn({poolInfo:e,amountA:t,protocolFeeRate:n,platformFeeRate:i,curveType:r,shareFeeRate:s,creatorFeeRate:a,transferFeeConfigA:c,slot:u}){let p=this.getCurve(r),m=dn(t,c,u),T=m.fee?m.amount.sub(m.fee):m.amount,A=p.sellExactIn({poolInfo:e,amount:T}),l=this.calculateFee({amount:A,feeRate:this.totalFeeRate({protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a})}),y=this.splitFee({totalFee:l,protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a});return{amountA:m,amountB:A.sub(l),splitFee:y}}static sellExactOut({poolInfo:e,amountB:t,protocolFeeRate:n,platformFeeRate:i,curveType:r,shareFeeRate:s,creatorFeeRate:a,transferFeeConfigA:c,slot:u}){let p=this.totalFeeRate({protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a}),m=this.calculatePreFee({postFeeAmount:t,feeRate:p});if(e.realB.lt(m))throw Error("Insufficient liquidity");let T=m.sub(t),l=Ae.getCurve(r).sellExactOut({poolInfo:e,amount:m});if(l.gt(e.realA))throw Error();let y=this.splitFee({totalFee:T,protocolFeeRate:n,platformFeeRate:i,shareFeeRate:s,creatorFeeRate:a});return{amountA:pn(l,c,u),amountB:t,splitFee:y}}static splitFee({totalFee:e,protocolFeeRate:t,platformFeeRate:n,shareFeeRate:i,creatorFeeRate:r}){let s=this.totalFeeRate({protocolFeeRate:t,platformFeeRate:n,shareFeeRate:i,creatorFeeRate:r}),a=s.isZero()?new Pe(0):e.mul(n).div(s),c=s.isZero()?new Pe(0):e.mul(i).div(s),u=s.isZero()?new Pe(0):e.mul(r).div(s),p=e.sub(a).sub(c).sub(u);return{platformFee:a,shareFee:c,protocolFee:p,creatorFee:u}}static calculateFee({amount:e,feeRate:t}){return pi(e,t,Ze)}static calculatePreFee({postFeeAmount:e,feeRate:t}){if(t.isZero())return e;let n=e.mul(Ze),i=Ze.sub(t);return n.add(i).sub(new Pe(1)).div(i)}static totalFeeRate({protocolFeeRate:e,platformFeeRate:t,shareFeeRate:n,creatorFeeRate:i}){if(e.add(t).add(n).add(i).gt(new Pe(1e6)))throw Error("total fee rate gt 1_000_000");return e.add(t).add(n).add(i)}static getCurve(e){switch(e){case 0:return Ut;case 1:return zt;case 2:return Ht}throw Error("find curve error")}};import be from"decimal.js";var it={initPriceX64:new D("515752397214619"),supply:new D(1e15),totalSellA:new D(7931e11),totalFundRaisingB:new D(85e9),totalLockedAmount:new D("0"),cliffPeriod:new D("0"),unlockPeriod:new D("0"),decimals:6,virtualA:new D("1073471847374405"),virtualB:new D("30050573465"),realA:new D(0),realB:new D(0),protocolFee:new D(0),platformId:new nr("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),vestingSchedule:{totalLockedAmount:new D(0),cliffPeriod:new D(0),unlockPeriod:new D(0),startTime:new D(0),totalAllocatedShare:new D(0)}},ze=new D(1e4),Un=class extends at{constructor(e){super(e)}async sayHello(){console.log("hello")}async createLaunchpad(M){var K=M,{programId:e=re,authProgramId:t,platformId:n=it.platformId,mintA:i,decimals:r=6,mintBDecimals:s=9,name:a,symbol:c,uri:u,migrateType:p,configId:m,snipers:T,configInfo:A,platformFeeRate:l,txVersion:y,computeBudgetConfig:b,txTipConfig:h,feePayer:g,buyAmount:x,minMintAAmount:k,slippage:d,associatedOnly:P=!0,checkCreateATAOwner:I=!1,extraSigners:w,token2022:S,transferFeeExtensionParams:C,creatorFeeOn:F=0}=K,B=We(K,["programId","authProgramId","platformId","mintA","decimals","mintBDecimals","name","symbol","uri","migrateType","configId","snipers","configInfo","platformFeeRate","txVersion","computeBudgetConfig","txTipConfig","feePayer","buyAmount","minMintAAmount","slippage","associatedOnly","checkCreateATAOwner","extraSigners","token2022","transferFeeExtensionParams","creatorFeeOn"]);var zn,Hn,Yn,jn,Zn,Qn,Jn,$n,ei,ti;let N=[],V=this.createTxBuilder(g);t=t!=null?t:Ce(e).publicKey,S=!!C,S&&(p="cpmm");let G=A;if(!G&&m){let Te=await this.scope.connection.getAccountInfo(m);Te&&(G=Ge.decode(Te.data))}G||this.logAndCreateError("config not found");let X=G.mintB,U=G.curveType,{publicKey:Z}=mt(e,i,X),{publicKey:Q}=Fn(e,Z,i),{publicKey:H}=Fn(e,Z,X),{publicKey:ie}=Cn(i);this.logDebug(`create token: ${i.toBase58()}, mintB: ${X.toBase58()}, decimals A:${r}/B:${s}, config:${m.toBase58()}`),c.length>10&&this.logAndCreateError("Symbol length should shorter than 11"),u||this.logAndCreateError("uri should not empty");let j=(zn=B==null?void 0:B.supply)!=null?zn:it.supply,q=(Hn=B==null?void 0:B.totalSellA)!=null?Hn:it.totalSellA,ae=(Yn=B==null?void 0:B.totalFundRaisingB)!=null?Yn:it.totalFundRaisingB,$=(jn=B==null?void 0:B.totalLockedAmount)!=null?jn:new D(0),Be=l;if(!l){let Te=await this.scope.connection.getAccountInfo(n);Te||this.logAndCreateError("platform id not found:",n.toString()),Be=dt.decode(Te.data).feeRate}let Xn=Ae.getCurve(G.curveType).getInitParam({supply:j,totalFundRaising:ae,totalSell:q,totalLockedAmount:$,migrateFee:G.migrateFee}),he={epoch:new D(896),bump:254,status:0,mintDecimalsA:r,mintDecimalsB:s,supply:j,totalSellA:q,mintA:new nr(i),mintB:X,virtualA:Xn.a,virtualB:Xn.b,realA:it.realA,realB:it.realB,migrateFee:G.migrateFee,migrateType:p==="amm"?0:1,protocolFee:it.protocolFee,platformFee:Be,platformId:n,configId:m,vaultA:Q,vaultB:H,creator:this.scope.ownerPubKey,totalFundRaisingB:ae,vestingSchedule:{totalLockedAmount:$,cliffPeriod:new D(0),unlockPeriod:new D(0),startTime:new D(0),totalAllocatedShare:new D(0)},mintProgramFlag:S?1:0,cpmmCreatorFeeOn:F},ir=Ae.getCurve(G.curveType),{c:rr}=ir.getInitParam({supply:he.supply,totalFundRaising:he.totalFundRaisingB,totalLockedAmount:$,totalSell:G.curveType===0?he.totalSellA:new D(0),migrateFee:G.migrateFee});try{Ae.checkParam({supply:he.supply,totalFundRaising:he.totalFundRaisingB,totalSell:rr,totalLockedAmount:$,decimals:he.mintDecimalsA,config:G,migrateType:p}),this.logDebug("check init params success")}catch(Te){this.logAndCreateError(`check create mint params failed, ${Te.message}`)}V.addInstruction({instructions:[S?Hi(e,g!=null?g:this.scope.ownerPubKey,this.scope.ownerPubKey,m,n,t,Z,i,X,Q,H,r,a,c,u||"https://",{type:U===0?"ConstantCurve":U===1?"FixedCurve":U===2?"LinearCurve":"ConstantCurve",totalSellA:q,migrateType:p,supply:j,totalFundRaisingB:ae},$,(Zn=B==null?void 0:B.cliffPeriod)!=null?Zn:new D(0),(Qn=B==null?void 0:B.unlockPeriod)!=null?Qn:new D(0),F,C):zi(e,g!=null?g:this.scope.ownerPubKey,this.scope.ownerPubKey,m,n,t,Z,i,X,Q,H,ie,r,a,c,u||"https://",{type:U===0?"ConstantCurve":U===1?"FixedCurve":U===2?"LinearCurve":"ConstantCurve",totalSellA:q,migrateType:p,supply:j,totalFundRaisingB:ae},$,(Jn=B==null?void 0:B.cliffPeriod)!=null?Jn:new D(0),($n=B==null?void 0:B.unlockPeriod)!=null?$n:new D(0),F)]});let Zt=S?await this.scope.connection.getEpochInfo():void 0,ve=C?{epoch:BigInt((Zt==null?void 0:Zt.epoch)||0),maximumFee:BigInt((ei=C==null?void 0:C.maxinumFee.toString())!=null?ei:0),transferFeeBasisPoints:(ti=C==null?void 0:C.transferFeeBasePoints)!=null?ti:0}:void 0,Qt={amountA:{amount:new D(0),fee:void 0,expirationTime:void 0},amountB:new D(0),splitFee:{platformFee:new D(0),shareFee:new D(0),protocolFee:new D(0),creatorFee:new D(0)}},Jt;if(w!=null&&w.length&&V.addInstruction({signers:w}),!B.createOnly){let{builder:Te,extInfo:or}=await this.buyToken({programId:e,authProgramId:t,mintAProgram:S?Xe:void 0,mintA:i,mintB:X,poolInfo:he,buyAmount:x,minMintAAmount:k,shareFeeRate:B.shareFeeRate,shareFeeReceiver:B.shareFeeReceiver,configInfo:G,platformFeeRate:Be,slippage:d,txTipConfig:h,associatedOnly:P,checkCreateATAOwner:I,skipCheckMintA:!ve,transferFeeConfigA:ve?{transferFeeConfigAuthority:t,withdrawWithheldAuthority:t,withheldAmount:BigInt(0),olderTransferFee:ve,newerTransferFee:ve}:void 0,fromCreate:!0});console.log("PREPARING SNIPER TRANSACTIONS");for(let ni of T){let{builder:sr,extInfo:Lo}=await this.buyToken({programId:e,authProgramId:t,mintAProgram:S?Xe:void 0,mintA:i,mintB:X,poolInfo:he,buyAmount:ni.amount,minMintAAmount:k,shareFeeRate:B.shareFeeRate,shareFeeReceiver:B.shareFeeReceiver,configInfo:G,platformFeeRate:Be,slippage:d,sniper:ni,associatedOnly:P,checkCreateATAOwner:I,skipCheckMintA:!ve,transferFeeConfigA:ve?{transferFeeConfigAuthority:t,withdrawWithheldAuthority:t,withheldAmount:BigInt(0),olderTransferFee:ve,newerTransferFee:ve}:void 0,fromCreate:!0});N.push(Y(_({},sr.AllTxData),{blockHash:this.scope.blockhashCommitment}))}V.addInstruction(_({},Te.AllTxData)),Qt=_({},or),Jt=(this.scope.cluster==="devnet"||y===1)&&B.shareFeeReceiver?[Te.allInstructions[0]]:void 0}return V.addTipInstruction(h),y===0?(console.log("VERSION V0"),{tx:await V.sizeCheckBuildV0({computeBudgetConfig:b,swapInfo:Qt,splitIns:Jt,address:Y(_({},he),{poolId:Z})}),txs:N}):(console.log("VERSION PLAIN"),{tx:await V.sizeCheckBuild({computeBudgetConfig:b,swapInfo:Qt,splitIns:Jt,address:Y(_({},he),{poolId:Z})}),txs:N})}async buyToken({programId:e=re,authProgramId:t,mintA:n,mintAProgram:i=J,mintB:r=Ee,poolInfo:s,configInfo:a,platformFeeRate:c,txVersion:u,computeBudgetConfig:p,txTipConfig:m,feePayer:T,buyAmount:A,minMintAAmount:l,slippage:y,shareFeeRate:b=new D(0),shareFeeReceiver:h,sniper:g,associatedOnly:x=!0,checkCreateATAOwner:k=!1,fromCreate:d=!1,transferFeeConfigA:P,skipCheckMintA:I=!1}){var j,q,ae;A.lte(new D(0))&&this.logAndCreateError("buy amount should gt 0:",A.toString());let w=g?this.createSniperTxBuilder(g.owner,g.owner.publicKey):this.createTxBuilder(T),{publicKey:S}=mt(e,n,r);t=t!=null?t:Ce(e).publicKey;let C=P;if(!I)if(C)i=Xe;else{let $=await this.scope.connection.getAccountInfo(n);if($&&$.owner.equals(Xe)){i=$.owner;let Be=jt(n,$,i);C=Yt(Be)||void 0}}let F=g?this.scope.account.getAssociatedTokenAccountByOwner(g.owner.publicKey,n,i):this.scope.account.getAssociatedTokenAccount(n,i),B=d?this.scope.account.getAssociatedTokenAccount(r,J):null,M=r.equals(Ee);if(console.log("userTokenAccountA: ",F),console.log("mintAProgram: ",i),w.addInstruction({instructions:[de((g==null?void 0:g.owner.publicKey)||this.scope.ownerPubKey,F,(g==null?void 0:g.owner.publicKey)||this.scope.ownerPubKey,n,i),...d?[de(this.scope.ownerPubKey,B,this.scope.ownerPubKey,r,J),Co.transfer({fromPubkey:this.scope.ownerPubKey,toPubkey:B,lamports:BigInt(A.toString())}),Ko(B)]:[]]}),!d){let{account:$,instructionParams:Be}=await this.scope.account.getOrCreateTokenAccount({mint:r,owner:this.scope.ownerPubKey,createInfo:M?{payer:this.scope.ownerPubKey,amount:A}:void 0,skipCloseAccount:!M,notUseTokenAccount:M,associatedOnly:M?!1:x,checkCreateATAOwner:k});$&&(B=$),w.addInstruction(Be||{})}B===void 0&&this.logAndCreateError(`cannot found mintB(${r.toBase58()}) token accounts`,"tokenAccounts",this.scope.account.tokenAccounts);let K=s;if(!K){let $=await this.scope.connection.getAccountInfo(S,{commitment:"processed"});$||this.logAndCreateError("cannot found pool:",S.toBase58()),K=we.decode($.data)}let N=a,V=await Re(this.scope.connection,[N?void 0:K.configId,K.platformId].filter(Boolean).map($=>({pubkey:$})));if(!N){let $=V.find(Be=>Be.pubkey.equals(K.configId));(!$||!$.accountInfo)&&this.logAndCreateError("config not found: ",K.configId.toBase58()),N=Ge.decode($.accountInfo.data)}let G=V.find($=>$.pubkey.equals(K.platformId));(!G||!G.accountInfo)&&this.logAndCreateError("platform info not found: ",K.configId.toBase58());let X=dt.decode(G.accountInfo.data);c=c||X.feeRate;let U=Ae.buyExactIn({poolInfo:K,amountB:A,protocolFeeRate:N.tradeFeeRate,platformFeeRate:c,curveType:N.curveType,shareFeeRate:b,creatorFeeRate:X.creatorFeeRate,transferFeeConfigA:C,slot:await this.scope.connection.getSlot()}),Z=new be(U.amountA.amount.toString()).sub((q=(j=U.amountA.fee)==null?void 0:j.toString())!=null?q:0),Q=y?new be(ze.sub(y).toNumber()/ze.toNumber()).clampedTo(0,1):new be(1),H=l!=null?l:y?new D(Z.mul(Q).toFixed(0)):U.amountA.amount.sub((ae=U.amountA.fee)!=null?ae:new D(0));U.amountB.lt(A)&&console.log(`maximum ${n.toBase58()} amount can buy is ${U.amountA.toString()}, input ${r.toBase58()} amount: ${U.amountB.toString()}`);let ie=h?ke(h,r,J).publicKey:void 0;return ie&&w.addInstruction({instructions:[de((g==null?void 0:g.owner.publicKey)||this.scope.ownerPubKey,ie,h,r)]}),w.addInstruction({instructions:[Yi(e,(g==null?void 0:g.owner.publicKey)||this.scope.ownerPubKey,t,K.configId,K.platformId,S,F,B,K.vaultA,K.vaultB,n,r,i,J,et(e,K.platformId,r).publicKey,tt(e,K.creator,r).publicKey,U.amountB.lt(A)?U.amountB:A,H,b,ie)]}),w.addCustomComputeBudget(p),w.addTipInstruction(m),w.versionBuild({txVersion:u,extInfo:Y(_({},U),{decimalOutAmount:Z,minDecimalOutAmount:new be(H.toString())})})}async buyTokenExactOut({programId:e=re,authProgramId:t,mintA:n,mintAProgram:i=J,mintB:r=Ee,poolInfo:s,configInfo:a,transferFeeConfigA:c,platformFeeRate:u,txVersion:p,computeBudgetConfig:m,txTipConfig:T,feePayer:A,maxBuyAmount:l,outAmount:y,slippage:b,shareFeeRate:h=new D(0),shareFeeReceiver:g,associatedOnly:x=!0,checkCreateATAOwner:k=!1,skipCheckMintA:d=!1}){y.lte(new D(0))&&this.logAndCreateError("out amount should gt 0:",y.toString());let P=this.createTxBuilder(A),{publicKey:I}=mt(e,n,r);t=t!=null?t:Ce(e).publicKey;let w=s;if(!w){let j=await this.scope.connection.getAccountInfo(I,{commitment:"processed"});j||this.logAndCreateError("cannot found pool:",I.toBase58()),w=we.decode(j.data)}let S=a,C=await Re(this.scope.connection,[S?void 0:w.configId,w.platformId].filter(Boolean).map(j=>({pubkey:j})));if(!S){let j=C.find(q=>q.pubkey.equals(w.configId));(!j||!j.accountInfo)&&this.logAndCreateError("config not found: ",w.configId.toBase58()),S=Ge.decode(j.accountInfo.data)}let F=C.find(j=>j.pubkey.equals(w.platformId));(!F||!F.accountInfo)&&this.logAndCreateError("platform info not found: ",w.configId.toBase58());let B=dt.decode(F.accountInfo.data);u=u||B.feeRate;let M=c;if(!d)if(M)i=Xe;else{let j=await this.scope.connection.getAccountInfo(n);if(j&&j.owner.equals(Xe)){i=j.owner;let q=jt(n,j,i);M=Yt(q)||void 0}}let K=Ae.buyExactOut({poolInfo:w,amountA:y,protocolFeeRate:S.tradeFeeRate,platformFeeRate:u,curveType:S.curveType,shareFeeRate:h,creatorFeeRate:B.creatorFeeRate,transferFeeConfigA:M,slot:await this.scope.connection.getSlot()}),N=new be(K.amountB.toString()),V=b?new be(ze.add(b).toNumber()/ze.toNumber()).clampedTo(0,Number.MIN_SAFE_INTEGER):new be(1),G=(l!=null?l:b)?new D(N.mul(V).toFixed(0)):K.amountB,X=this.scope.account.getAssociatedTokenAccount(n,i),U=null,Z=r.equals(Ee);P.addInstruction({instructions:[de(this.scope.ownerPubKey,X,this.scope.ownerPubKey,n,i)]});let{account:Q,instructionParams:H}=await this.scope.account.getOrCreateTokenAccount({mint:r,owner:this.scope.ownerPubKey,createInfo:Z?{payer:this.scope.ownerPubKey,amount:K.amountB}:void 0,skipCloseAccount:!Z,notUseTokenAccount:Z,associatedOnly:Z?!1:x,checkCreateATAOwner:k});Q&&(U=Q),P.addInstruction(H||{}),U===void 0&&this.logAndCreateError(`cannot found mintB(${r.toBase58()}) token accounts`,"tokenAccounts",this.scope.account.tokenAccounts);let ie=g?ke(g,r,J).publicKey:void 0;return ie&&P.addInstruction({instructions:[de(this.scope.ownerPubKey,ie,g,r)]}),P.addInstruction({instructions:[ji(e,this.scope.ownerPubKey,t,w.configId,w.platformId,I,X,U,w.vaultA,w.vaultB,n,r,i,J,et(e,w.platformId,r).publicKey,tt(e,w.creator,r).publicKey,y,G,h,ie)]}),P.addCustomComputeBudget(m),P.addTipInstruction(T),P.versionBuild({txVersion:p,extInfo:{maxSpentAmount:G,outAmount:y}})}async sellToken({programId:e=re,authProgramId:t,mintAProgram:n=J,mintA:i,mintB:r=Ee,poolInfo:s,configInfo:a,platformFeeRate:c,txVersion:u,computeBudgetConfig:p,txTipConfig:m,feePayer:T,sellAmount:A,minAmountB:l,slippage:y,shareFeeRate:b=new D(0),shareFeeReceiver:h,associatedOnly:g=!0,checkCreateATAOwner:x=!1,skipCheckMintA:k=!1}){t=t!=null?t:Ce(e).publicKey;let d=this.createTxBuilder(T);A.lte(new D(0))&&this.logAndCreateError("sell amount should be gt 0");let{publicKey:P}=mt(e,i,r),I;if(!k){let q=await this.scope.connection.getAccountInfo(i);if(q&&q.owner.equals(Xe)){n=q.owner;let ae=jt(i,q,n);I=Yt(ae)||void 0}}let w=null,S=null,C=r.equals(Ee),{account:F,instructionParams:B}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:n,mint:i,owner:this.scope.ownerPubKey,createInfo:void 0,skipCloseAccount:!0,notUseTokenAccount:!1,associatedOnly:g,checkCreateATAOwner:x});F&&(w=F),d.addInstruction(B||{}),w===void 0&&this.logAndCreateError("cannot found mintA token accounts","tokenAccounts",this.scope.account.tokenAccounts);let{account:M,instructionParams:K}=await this.scope.account.getOrCreateTokenAccount({mint:r,owner:this.scope.ownerPubKey,createInfo:C?{payer:this.scope.ownerPubKey,amount:0}:void 0,skipCloseAccount:!C,notUseTokenAccount:C,associatedOnly:C?!1:g,checkCreateATAOwner:x});M&&(S=M),d.addInstruction(K||{}),S===void 0&&this.logAndCreateError("cannot found mintB token accounts","tokenAccounts",this.scope.account.tokenAccounts);let N=s;if(!N){let q=await this.scope.connection.getAccountInfo(P,{commitment:"processed"});q||this.logAndCreateError("cannot found pool",P.toBase58()),N=we.decode(q.data)}let V=a,G=await Re(this.scope.connection,[V?void 0:N.configId,N.platformId].filter(Boolean).map(q=>({pubkey:q})));if(!V){let q=G.find(ae=>ae.pubkey.equals(N.configId));(!q||!q.accountInfo)&&this.logAndCreateError("config not found: ",N.configId.toBase58()),V=Ge.decode(q.accountInfo.data)}let X=G.find(q=>q.pubkey.equals(N.platformId));(!X||!X.accountInfo)&&this.logAndCreateError("platform info not found: ",N.configId.toBase58());let U=dt.decode(X.accountInfo.data);c=c||U.feeRate;let Z=Ae.sellExactIn({poolInfo:N,amountA:A,protocolFeeRate:V.tradeFeeRate,platformFeeRate:c,curveType:V.curveType,shareFeeRate:b,creatorFeeRate:U.creatorFeeRate,transferFeeConfigA:I,slot:await this.scope.connection.getSlot()}),Q=new be(Z.amountB.toString()),H=y?new be(ze.sub(y).toNumber()/ze.toNumber()).clampedTo(0,1):new be(1),ie=l!=null?l:y?new D(Q.mul(H).toFixed(0)):Z.amountB;ie.lte(new D(0))&&this.logAndCreateError(`out ${r.toBase58()} amount should be gt 0`);let j=h?ke(h,r,J).publicKey:void 0;return j&&d.addInstruction({instructions:[de(this.scope.ownerPubKey,j,h,r)]}),d.addInstruction({instructions:[Zi(e,this.scope.ownerPubKey,t,N.configId,N.platformId,P,w,S,N.vaultA,N.vaultB,i,r,n,J,et(e,N.platformId,r).publicKey,tt(e,N.creator,r).publicKey,Z.amountA.amount.lt(A)?Z.amountA.amount:A,ie,b,j)]}),d.addCustomComputeBudget(p),d.addTipInstruction(m),d.versionBuild({txVersion:u,extInfo:{outAmount:ie}})}async sellTokenExactOut({programId:e=re,authProgramId:t,mintAProgram:n=J,mintA:i,mintB:r=Ee,poolInfo:s,configInfo:a,platformFeeRate:c,txVersion:u,computeBudgetConfig:p,txTipConfig:m,feePayer:T,inAmount:A,maxSellAmount:l,slippage:y,shareFeeRate:b=new D(0),shareFeeReceiver:h,associatedOnly:g=!0,checkCreateATAOwner:x=!1,skipCheckMintA:k=!1}){t=t!=null?t:Ce(e).publicKey;let d=this.createTxBuilder(T);l!=null&&l.lte(new D(0))&&this.logAndCreateError("max sell amount should be gt 0");let{publicKey:P}=mt(e,i,r),I;if(!k){let q=await this.scope.connection.getAccountInfo(i);if(q&&q.owner.equals(Xe)){n=q.owner;let ae=jt(i,q,n);I=Yt(ae)||void 0}}let w=null,S=null,C=r.equals(Ee),{account:F,instructionParams:B}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:n,mint:i,owner:this.scope.ownerPubKey,createInfo:void 0,skipCloseAccount:!0,notUseTokenAccount:!1,associatedOnly:g,checkCreateATAOwner:x});F&&(w=F),d.addInstruction(B||{}),w===void 0&&this.logAndCreateError("cannot found mintA token accounts","tokenAccounts",this.scope.account.tokenAccounts);let{account:M,instructionParams:K}=await this.scope.account.getOrCreateTokenAccount({mint:r,owner:this.scope.ownerPubKey,createInfo:C?{payer:this.scope.ownerPubKey,amount:0}:void 0,skipCloseAccount:!C,notUseTokenAccount:C,associatedOnly:C?!1:g,checkCreateATAOwner:x});M&&(S=M),d.addInstruction(K||{}),S===void 0&&this.logAndCreateError("cannot found mintB token accounts","tokenAccounts",this.scope.account.tokenAccounts);let N=s;if(!N){let q=await this.scope.connection.getAccountInfo(P,{commitment:"processed"});q||this.logAndCreateError("cannot found pool",P.toBase58()),N=we.decode(q.data)}let V=a,G=await Re(this.scope.connection,[V?void 0:N.configId,N.platformId].filter(Boolean).map(q=>({pubkey:q})));if(!V){let q=G.find(ae=>ae.pubkey.equals(N.configId));(!q||!q.accountInfo)&&this.logAndCreateError("config not found: ",N.configId.toBase58()),V=Ge.decode(q.accountInfo.data)}let X=G.find(q=>q.pubkey.equals(N.platformId));(!X||!X.accountInfo)&&this.logAndCreateError("platform info not found: ",N.configId.toBase58());let U=dt.decode(X.accountInfo.data);c=c||U.feeRate;let Z=Ae.sellExactOut({poolInfo:N,amountB:A,protocolFeeRate:V.tradeFeeRate,platformFeeRate:c,curveType:V.curveType,shareFeeRate:b,creatorFeeRate:U.creatorFeeRate,transferFeeConfigA:I,slot:await this.scope.connection.getSlot()}),Q=new be(Z.amountA.amount.toString()),H=y?new be(ze.add(y).toNumber()/ze.toNumber()).clampedTo(0,Number.MAX_SAFE_INTEGER):new be(1),ie=(l!=null?l:y)?new D(Q.mul(H).toFixed(0)):Z.amountA.amount,j=h?ke(h,r,J).publicKey:void 0;return j&&d.addInstruction({instructions:[de(this.scope.ownerPubKey,j,h,r)]}),d.addInstruction({instructions:[Qi(e,this.scope.ownerPubKey,t,N.configId,N.platformId,P,w,S,N.vaultA,N.vaultB,i,r,n,J,et(e,N.platformId,r).publicKey,tt(e,N.creator,r).publicKey,A,ie,b,j)]}),d.addCustomComputeBudget(p),d.addTipInstruction(m),d.versionBuild({txVersion:u,extInfo:{maxSellAmount:ie}})}async createPlatformConfig({programId:e=re,platformAdmin:t,platformClaimFeeWallet:n,platformLockNftWallet:i,cpConfigId:r,migrateCpLockNftScale:s,transferFeeExtensionAuth:a,creatorFeeRate:c,feeRate:u,name:p,web:m,img:T,txVersion:A,computeBudgetConfig:l,txTipConfig:y,feePayer:b}){let h=this.createTxBuilder(b),{publicKey:g}=Mn(e,t);return h.addInstruction({instructions:[Ji(e,t,n,i,g,r,a,s,u,c,p,m,T)]}),h.addCustomComputeBudget(l),h.addTipInstruction(y),h.versionBuild({txVersion:A,extInfo:{platformId:g}})}async updatePlatformConfig({programId:e=re,platformAdmin:t,platformId:n,updateInfo:i,txVersion:r,computeBudgetConfig:s,txTipConfig:a,feePayer:c}){let u=this.createTxBuilder(c),p=n!=null?n:Mn(e,t).publicKey;return u.addInstruction({instructions:[$i(e,t,p,i)]}),u.addCustomComputeBudget(s),u.addTipInstruction(a),u.versionBuild({txVersion:r})}async claimPlatformFee({programId:e=re,authProgramId:t,platformId:n,poolId:i,platformClaimFeeWallet:r,mintB:s,vaultB:a,mintBProgram:c=J,txVersion:u,computeBudgetConfig:p,txTipConfig:m,feePayer:T}){var h;let A=this.createTxBuilder(T);t=t!=null?t:Ce(e).publicKey;let l=s,y=a;if(!l){let g=await this.scope.connection.getAccountInfo(i,{commitment:"processed"});g||this.logAndCreateError("cannot found pool:",i.toBase58());let x=we.decode(g.data),k=await this.scope.connection.getAccountInfo(x.configId,{commitment:"processed"});k||this.logAndCreateError("cannot found config:",x.configId.toBase58()),l=Ge.decode(k.data).mintB,y=y!=null?y:x.vaultB}(!l||!y)&&this.logAndCreateError("cannot found mint info, mintB: ",l.toBase58(),", vaultB: ",(h=y==null?void 0:y.toBase58())!=null?h:"");let b=ke(this.scope.ownerPubKey,l,J).publicKey;return A.addInstruction({instructions:[de(this.scope.ownerPubKey,b,this.scope.ownerPubKey,l)]}),A.addInstruction({instructions:[Vn(e,r,t,i,n,y,b,l,c)]}),A.addCustomComputeBudget(p),A.addTipInstruction(m),A.versionBuild({txVersion:u})}async claimAllPlatformFee({programId:e=re,authProgramId:t,platformId:n,platformClaimFeeWallet:i,txVersion:r,computeBudgetConfig:s,txTipConfig:a,feePayer:c}){let u=this.createTxBuilder(c);return t=t!=null?t:Ce(e).publicKey,(await this.scope.connection.getProgramAccounts(e,{filters:[{dataSize:we.span},{memcmp:{offset:we.offsetOf("platformId"),bytes:n.toString()}}]})).forEach(m=>{let T=we.decode(m.account.data);if(T.platformFee.lte(new D(0)))return;let A=ke(this.scope.ownerPubKey,T.mintB,J).publicKey;u.addInstruction({instructions:[de(this.scope.ownerPubKey,A,this.scope.ownerPubKey,T.mintB)]}),u.addInstruction({instructions:[Vn(e,i,t,m.pubkey,n,T.vaultB,A,T.mintB,J)]})}),u.addTipInstruction(a),r===0?u.sizeCheckBuildV0({computeBudgetConfig:s}):u.sizeCheckBuild({computeBudgetConfig:s})}async createVesting({programId:e=re,poolId:t,beneficiary:n,shareAmount:i,txVersion:r,computeBudgetConfig:s,txTipConfig:a,feePayer:c}){let u=this.createTxBuilder(c),p=await this.getRpcPoolInfo({poolId:t});i.add(p.vestingSchedule.totalAllocatedShare).gt(p.vestingSchedule.totalLockedAmount)&&this.logAndCreateError("share amount exceed total locked amount");let m=Ct(e,t,n).publicKey;return u.addInstruction({instructions:[Dn(e,this.scope.ownerPubKey,n,t,m,i)]}),u.addCustomComputeBudget(s),u.addTipInstruction(a),u.versionBuild({txVersion:r})}async createMultipleVesting({programId:e=re,poolId:t,beneficiaryList:n,txVersion:i,computeBudgetConfig:r,feePayer:s}){let a=this.createTxBuilder(s);n.length===0&&this.logAndCreateError("beneficiaryList is null");let c=await this.getRpcPoolInfo({poolId:t});return n.reduce((p,m)=>p.add(m.shareAmount),c.vestingSchedule.totalAllocatedShare).gt(c.vestingSchedule.totalLockedAmount)&&this.logAndCreateError("share amount exceed total locked amount"),n.forEach(p=>{let m=Ct(e,t,p.wallet).publicKey;a.addInstruction({instructions:[Dn(e,this.scope.ownerPubKey,p.wallet,t,m,p.shareAmount)]})}),i===0?a.sizeCheckBuildV0({computeBudgetConfig:r}):a.sizeCheckBuild({computeBudgetConfig:r})}async claimVesting({programId:e=re,poolId:t,poolInfo:n,vestingRecord:i,txVersion:r,computeBudgetConfig:s,txTipConfig:a,feePayer:c}){let u=this.createTxBuilder(c),p=Ce(e).publicKey,m=i||Ct(e,t,this.scope.ownerPubKey).publicKey,T=n;if(!T){let l=await this.scope.connection.getAccountInfo(t);l||this.logAndCreateError("pool not found"),T=we.decode(l.data)}let A=ke(this.scope.ownerPubKey,T.mintA,J).publicKey;return u.addInstruction({instructions:[de(this.scope.ownerPubKey,A,this.scope.ownerPubKey,T.mintA)]}),u.addInstruction({instructions:[Wn(e,this.scope.ownerPubKey,p,t,m,A,T.vaultA,T.mintA,J)]}),u.addCustomComputeBudget(s),u.addTipInstruction(a),u.versionBuild({txVersion:r})}async claimMultiVesting({programId:e=re,poolIdList:t,poolsInfo:n={},vestingRecords:i={},txVersion:r,computeBudgetConfig:s,feePayer:a}){let c=this.createTxBuilder(a),u=_({},n),p=Ce(e).publicKey,m=t.filter(T=>!u[T.toBase58()]);if(m.length){let T=await this.getRpcPoolsInfo({poolIdList:m});u=_(_({},u),T.poolInfoMap)}return t.forEach(T=>{let A=T.toBase58(),l=u[A];l||this.logAndCreateError(`pool info not found: ${A}`);let y=i[A]||Ct(e,T,this.scope.ownerPubKey).publicKey,b=ke(this.scope.ownerPubKey,l.mintA,J).publicKey;c.addInstruction({instructions:[de(this.scope.ownerPubKey,b,this.scope.ownerPubKey,l.mintA)]}),c.addInstruction({instructions:[Wn(e,this.scope.ownerPubKey,p,T,y,b,l.vaultA,l.mintA,J)]})}),r===0?c.sizeCheckBuildV0({computeBudgetConfig:s}):c.sizeCheckBuild({computeBudgetConfig:s})}async claimVaultPlatformFee({programId:e=re,platformId:t,mintB:n,mintBProgram:i=J,claimFeeWallet:r,txVersion:s,computeBudgetConfig:a,txTipConfig:c,feePayer:u}){let p=this.createTxBuilder(u),m=et(e,t,n).publicKey,T=On(e).publicKey,A=this.scope.account.getAssociatedTokenAccount(n,i);return p.addInstruction({instructions:[de(this.scope.ownerPubKey,A,this.scope.ownerPubKey,n,i),_n(e,t,r!=null?r:this.scope.ownerPubKey,T,m,A,n,i)]}),p.addCustomComputeBudget(a),p.addTipInstruction(c),p.versionBuild({txVersion:s})}async claimMultipleVaultPlatformFee({programId:e=re,platformList:t,unwrapSol:n=!0,txVersion:i,computeBudgetConfig:r,feePayer:s,associatedOnly:a=!0,checkCreateATAOwner:c=!1}){let u=this.createTxBuilder(s),p={};return t.forEach(async m=>{var b,h;let T=On(e).publicKey,A=et(e,m.id,m.mintB).publicKey,l=m.mintB.equals(Ee)&&n,y=p[m.mintB.toBase58()];if(!y){let{account:g,instructionParams:x}=await this.scope.account.getOrCreateTokenAccount({mint:m.mintB,owner:this.scope.ownerPubKey,createInfo:l?{payer:this.scope.ownerPubKey,amount:0}:void 0,skipCloseAccount:!l,notUseTokenAccount:l,associatedOnly:l?!1:a,checkCreateATAOwner:c});g&&(y=g),u.addInstruction(x||{}),y===void 0&&this.logAndCreateError(`cannot found platform ${m.id.toBase58()} mintB(${m.mintB.toBase58()}) token accounts`,"tokenAccounts",this.scope.account.tokenAccounts)}u.addInstruction({instructions:[_n(e,m.id,(b=m.claimFeeWallet)!=null?b:this.scope.ownerPubKey,A,T,y,m.mintB,(h=m.mintBProgram)!=null?h:J)]})}),i===0?u.sizeCheckBuildV0({computeBudgetConfig:r}):u.sizeCheckBuild({computeBudgetConfig:r})}async claimCreatorFee({programId:e=re,mintB:t,mintBProgram:n=J,txVersion:i,computeBudgetConfig:r,txTipConfig:s,feePayer:a}){let c=this.createTxBuilder(a),u=tt(e,this.scope.ownerPubKey,t).publicKey,p=En(e).publicKey,m=this.scope.account.getAssociatedTokenAccount(t,n);return c.addInstruction({instructions:[de(this.scope.ownerPubKey,m,this.scope.ownerPubKey,t,n),qn(e,this.scope.ownerPubKey,p,u,m,t,n)]}),c.addCustomComputeBudget(r),c.addTipInstruction(s),c.versionBuild({txVersion:i})}async claimMultipleCreatorFee({programId:e=re,mintBList:t,txVersion:n,computeBudgetConfig:i,feePayer:r}){let s=this.createTxBuilder(r);return t.forEach(a=>{var A;let c=a.pubKey,u=(A=a.programId)!=null?A:J,p=tt(e,this.scope.ownerPubKey,c).publicKey,m=En(e).publicKey,T=this.scope.account.getAssociatedTokenAccount(c,u);s.addInstruction({instructions:[de(this.scope.ownerPubKey,T,this.scope.ownerPubKey,c,u),qn(e,this.scope.ownerPubKey,m,p,T,c,u)]})}),n==0?s.sizeCheckBuildV0({computeBudgetConfig:i}):s.sizeCheckBuild({computeBudgetConfig:i})}async getRpcPoolInfo({poolId:e}){return(await this.getRpcPoolsInfo({poolIdList:[e]})).poolInfoMap[e.toBase58()]}async getRpcPoolsInfo({poolIdList:e,config:t}){let n=await Re(this.scope.connection,e.map(c=>({pubkey:c})),t),i={},r=[];for(let c=0;c<e.length;c++){let u=n[c];if(u===null||!u.accountInfo)throw Error("fetch pool info error: "+e[c].toBase58());let p=we.decode(u.accountInfo.data);i[e[c].toBase58()]=Y(_({},p),{poolId:u.accountInfo.owner}),r.push(p.configId)}let s=await Re(this.scope.connection,r.map(c=>({pubkey:c})),t),a={};for(let c=0;c<r.length;c++){let u=s[c];if(u===null||!u.accountInfo)throw Error("fetch config info error: "+r[c].toBase58());let p=Ge.decode(u.accountInfo.data);a[r[c].toBase58()]=Y(_({},p),{configId:u.accountInfo.owner})}return{poolInfoMap:Object.keys(i).reduce((c,u)=>Y(_({},c),{[u]:Y(_({},i[u]),{configInfo:a[i[u].configId.toBase58()]})}),{})}}};export{it as LaunchpadPoolInitParam,Un as default};
//# sourceMappingURL=launchpad.mjs.map