var yi=Object.create;var ze=Object.defineProperty,gi=Object.defineProperties,Pi=Object.getOwnPropertyDescriptor,Ai=Object.getOwnPropertyDescriptors,wi=Object.getOwnPropertyNames,pt=Object.getOwnPropertySymbols,ki=Object.getPrototypeOf,vt=Object.prototype.hasOwnProperty,yn=Object.prototype.propertyIsEnumerable;var bn=(n,t,e)=>t in n?ze(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,V=(n,t)=>{for(var e in t||(t={}))vt.call(t,e)&&bn(n,e,t[e]);if(pt)for(var e of pt(t))yn.call(t,e)&&bn(n,e,t[e]);return n},X=(n,t)=>gi(n,Ai(t));var ge=(n,t)=>{var e={};for(var i in n)vt.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&pt)for(var i of pt(n))t.indexOf(i)<0&&yn.call(n,i)&&(e[i]=n[i]);return e};var Ti=(n,t)=>{for(var e in t)ze(n,e,{get:t[e],enumerable:!0})},gn=(n,t,e,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of wi(t))!vt.call(n,o)&&o!==e&&ze(n,o,{get:()=>t[o],enumerable:!(i=Pi(t,o))||i.enumerable});return n};var _=(n,t,e)=>(e=n!=null?yi(ki(n)):{},gn(t||!n||!n.__esModule?ze(e,"default",{value:n,enumerable:!0}):e,n)),hi=n=>gn(ze({},"__esModule",{value:!0}),n);var Rr={};Ti(Rr,{default:()=>Et});module.exports=hi(Rr);var T=require("@solana/web3.js"),Y=require("@solana/spl-token");var ye=_(require("bn.js")),Wi=_(require("decimal.js"));var Vn=_(require("big.js")),vi=_(require("bn.js"));var He=require("lodash");var Vt=class{constructor(t){this.logLevel=t.logLevel!==void 0?t.logLevel:0,this.name=t.name}set level(t){this.logLevel=t}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(t){return t<=this.logLevel}error(...t){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...t),this):this}logWithError(...t){let e=t.map(i=>typeof i=="object"?JSON.stringify(i):i).join(", ");throw new Error(e)}warning(...t){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...t),this):this}info(...t){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...t),this):this}debug(...t){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...t),this):this}},Pn={},Bi={};function ee(n){let t=(0,He.get)(Pn,n);if(!t){let e=(0,He.get)(Bi,n);t=new Vt({name:n,logLevel:e}),(0,He.set)(Pn,n,t)}return t}var qt=require("@solana/web3.js");var Be=require("@solana/spl-token"),Wt=ee("Raydium_accountInfo_util");async function Ze(n,t,e){let{batchRequest:i,commitment:o="confirmed",chunkCount:s=100}=V({batchRequest:!1},e),a=_t(t,s),r=new Array(a.length).fill([]);if(i){let d=a.map(l=>{let b=n._buildArgs([l.map(c=>c.toBase58())],o,"base64");return{methodName:"getMultipleAccounts",args:b}}),g=_t(d,10);r=(await(await Promise.all(g.map(async l=>await n._rpcBatchRequest(l)))).flat()).map(l=>(l.error&&Wt.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${l.error.message}`),l.result.value.map(b=>{if(b){let{data:c,executable:p,lamports:P,owner:u,rentEpoch:h}=b;return c.length!==2&&c[1]!=="base64"&&Wt.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(c[0],"base64"),executable:p,lamports:P,owner:new qt.PublicKey(u),rentEpoch:h}}return null})))}else try{r=await Promise.all(a.map(d=>n.getMultipleAccountsInfo(d,o)))}catch(d){d instanceof Error&&Wt.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${d.message}`)}return r.flat()}async function Ce(n,t,e){let i=await Ze(n,t.map(o=>o.pubkey),e);return t.map((o,s)=>X(V({},o),{accountInfo:i[s]}))}async function Gt({connection:n,mints:t,config:e}){var s,a,r;if(t.length===0)return{};let i=await Ce(n,t.map(d=>({pubkey:je(d)})),e),o={};for(let d of i){if(!d.accountInfo||d.accountInfo.data.length<Be.MINT_SIZE){console.log("invalid mint account",d.pubkey.toBase58());continue}let g=(0,Be.unpackMint)(d.pubkey,d.accountInfo,(s=d.accountInfo)==null?void 0:s.owner);o[d.pubkey.toString()]=X(V({},g),{programId:((a=d.accountInfo)==null?void 0:a.owner)||Be.TOKEN_PROGRAM_ID,feeConfig:(r=(0,Be.getTransferFeeConfig)(g))!=null?r:void 0})}return o[qt.PublicKey.default.toBase58()]=o[ae.toBase58()],o}var Oe=_(require("bn.js"));var An=9007199254740991;function Pe(n){let t=ee("Raydium_parseBigNumberish");if(n instanceof Oe.default)return n;if(typeof n=="string"){if(n.match(/^-?[0-9]+$/))return new Oe.default(n);t.logWithError(`invalid BigNumberish string: ${n}`)}return typeof n=="number"?(n%1&&t.logWithError(`BigNumberish number underflow: ${n}`),(n>=An||n<=-An)&&t.logWithError(`BigNumberish number overflow: ${n}`),new Oe.default(String(n))):typeof n=="bigint"?new Oe.default(n.toString()):(t.error(`invalid BigNumberish value: ${n}`),new Oe.default(0))}var wn=require("@solana/web3.js"),Ut=require("@solana/spl-token"),Xt={chainId:101,address:wn.PublicKey.default.toBase58(),programId:Ut.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},xe={chainId:101,address:"So11111111111111111111111111111111111111112",programId:Ut.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};var yt=require("@solana/web3.js");var q=require("@solana/web3.js"),kn=require("@solana/spl-token");function zt({pubkey:n,isSigner:t=!1,isWritable:e=!0}){return{pubkey:n,isWritable:e,isSigner:t}}var Xr=[zt({pubkey:kn.TOKEN_PROGRAM_ID,isWritable:!1}),zt({pubkey:q.SystemProgram.programId,isWritable:!1}),zt({pubkey:q.SYSVAR_RENT_PUBKEY,isWritable:!1})];function Ht({publicKey:n,transformSol:t}){let e=Tn(n.toString());if(e instanceof q.PublicKey)return t&&e.equals(Ye)?ae:e;if(t&&e.toString()===Ye.toBase58())return ae;if(typeof e=="string"){if(e===q.PublicKey.default.toBase58())return q.PublicKey.default;try{return new q.PublicKey(e)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function Tn(n){try{return new q.PublicKey(n)}catch{return n}}var xi=new q.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),ft=new q.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),bt=new q.PublicKey("SysvarRent111111111111111111111111111111111"),zr=new q.PublicKey("SysvarC1ock11111111111111111111111111111111"),Fe=new q.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),Hr=new q.PublicKey("Sysvar1nstructions1111111111111111111111111"),hn=q.SystemProgram.programId,Zr=new q.PublicKey("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),jr=new q.PublicKey("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),Yr=new q.PublicKey("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),Qr=new q.PublicKey("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),Jr=new q.PublicKey("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),$r=new q.PublicKey("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),eo=new q.PublicKey("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),to=new q.PublicKey("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),no=new q.PublicKey("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),io=new q.PublicKey("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),ro=new q.PublicKey("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),ae=new q.PublicKey("So11111111111111111111111111111111111111112"),Ye=q.PublicKey.default;function je(n){return Ht({publicKey:n,transformSol:!0})}var Zt=class{constructor({mint:t,decimals:e,symbol:i,name:o,skipMint:s=!1,isToken2022:a=!1}){if(t===Ye.toBase58()||t instanceof yt.PublicKey&&Ye.equals(t)){this.decimals=xe.decimals,this.symbol=xe.symbol,this.name=xe.name,this.mint=new yt.PublicKey(xe.address),this.isToken2022=!1;return}this.decimals=e,this.symbol=i||t.toString().substring(0,6),this.name=o||t.toString().substring(0,6),this.mint=s?yt.PublicKey.default:Ht({publicKey:t}),this.isToken2022=a}equals(t){return this===t?!0:this.mint.equals(t.mint)}},Ie=Zt;Ie.WSOL=new Zt(X(V({},xe),{mint:xe.address}));var jt=class{constructor({decimals:t,symbol:e="UNKNOWN",name:i="UNKNOWN"}){this.decimals=t,this.symbol=e,this.name=i}equals(t){return this===t}},gt=jt;gt.SOL=new jt(Xt);var Bn=_(require("toformat")),Ii=Bn.default,Qe=Ii;var Je=_(require("big.js")),xn=_(require("bn.js")),In=_(require("decimal.js-light"));var Pt=ee("module/fraction"),Yt=Qe(Je.default),$e=Qe(In.default),Ci={[0]:$e.ROUND_DOWN,[1]:$e.ROUND_HALF_UP,[2]:$e.ROUND_UP},Ki={[0]:Je.default.roundDown,[1]:Je.default.roundHalfUp,[2]:Je.default.roundUp},z=class{constructor(t,e=new xn.default(1)){this.numerator=Pe(t),this.denominator=Pe(e)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new z(this.denominator,this.numerator)}add(t){let e=t instanceof z?t:new z(Pe(t));return this.denominator.eq(e.denominator)?new z(this.numerator.add(e.numerator),this.denominator):new z(this.numerator.mul(e.denominator).add(e.numerator.mul(this.denominator)),this.denominator.mul(e.denominator))}sub(t){let e=t instanceof z?t:new z(Pe(t));return this.denominator.eq(e.denominator)?new z(this.numerator.sub(e.numerator),this.denominator):new z(this.numerator.mul(e.denominator).sub(e.numerator.mul(this.denominator)),this.denominator.mul(e.denominator))}mul(t){let e=t instanceof z?t:new z(Pe(t));return new z(this.numerator.mul(e.numerator),this.denominator.mul(e.denominator))}div(t){let e=t instanceof z?t:new z(Pe(t));return new z(this.numerator.mul(e.denominator),this.denominator.mul(e.numerator))}toSignificant(t,e={groupSeparator:""},i=1){Number.isInteger(t)||Pt.logWithError(`${t} is not an integer.`),t<=0&&Pt.logWithError(`${t} is not positive.`),$e.set({precision:t+1,rounding:Ci[i]});let o=new $e(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(t);return o.toFormat(o.decimalPlaces(),e)}toFixed(t,e={groupSeparator:""},i=1){return Number.isInteger(t)||Pt.logWithError(`${t} is not an integer.`),t<0&&Pt.logWithError(`${t} is negative.`),Yt.DP=t,Yt.RM=Ki[i]||1,new Yt(this.numerator.toString()).div(this.denominator.toString()).toFormat(t,e)}isZero(){return this.numerator.isZero()}};var Cn=_(require("bn.js"));var Sn=new z(new Cn.default(100)),me=class extends z{toSignificant(t=5,e,i){return this.mul(Sn).toSignificant(t,e,i)}toFixed(t=2,e,i){return this.mul(Sn).toFixed(t,e,i)}};var Io=ee("Raydium_price");function _t(n,t=1,e=[]){let i=[...n];if(t<=0)return e;for(;i.length;)e.push(i.splice(0,t));return e}var Ae=class{constructor(t){this._owner=t}get publicKey(){return Ae.isKeyPair(this._owner)?this._owner.publicKey:this._owner}get signer(){return Ae.isKeyPair(this._owner)?this._owner:void 0}get isKeyPair(){return Ae.isKeyPair(this._owner)}get isPublicKey(){return Ae.isPublicKey(this._owner)}static isKeyPair(t){return t.secretKey!==void 0}static isPublicKey(t){return!Ae.isKeyPair(t)}};var Nn=require("@solana/web3.js"),Mn=require("@solana/spl-token");var ie=require("@solana/web3.js");var ne={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",ClmmLockPosition:"ClmmLockPosition",ClmmHarvestLockPosition:"ClmmHarvestLockPosition",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV4Withdraw:"FarmV4Withdraw",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut",CpmmLockLp:"CpmmLockLp",CpmmCollectLockFee:"CpmmCollectLockFee",TransferTip:"TransferTip"};var Ln=require("@solana/spl-token"),Kn=ee("Raydium_txUtil"),Rn=1644;function et(n){let t=[],e=[];return n.microLamports&&(t.push(ie.ComputeBudgetProgram.setComputeUnitPrice({microLamports:n.microLamports})),e.push(ne.SetComputeUnitPrice)),n.units&&(t.push(ie.ComputeBudgetProgram.setComputeUnitLimit({units:n.units})),e.push(ne.SetComputeUnitLimit)),{instructions:t,instructionTypes:e}}async function Ke(n,t){var i,o;let e=t!=null?t:"confirmed";return(o=await((i=n.getLatestBlockhash)==null?void 0:i.call(n,{commitment:e})))==null?void 0:o.blockhash}async function tt(n,t){return n.getSignatureStatuses([t]),new Promise((e,i)=>{let o=setTimeout(i,6e4);n.onSignature(t,s=>{if(clearTimeout(o),!s.err){e("");return}i(Object.assign(s.err,{txId:t}))},"confirmed")})}function Li(n,t){n.length<1&&Kn.logWithError(`no instructions provided: ${n.toString()}`),t.length<1&&Kn.logWithError(`no signers provided:, ${t.toString()}`);let e=new ie.Transaction;e.recentBlockhash="11111111111111111111111111111111",e.feePayer=t[0],e.add(...n);try{return Buffer.from(e.serialize({verifySignatures:!1})).toString("base64").length<Rn}catch{return!1}}function fe(n,t){let[e,i]=ie.PublicKey.findProgramAddressSync(n,t);return{publicKey:e,nonce:i}}function nt({instructions:n,payer:t,signers:e}){return Li(n,[t,...e])}function ke({instructions:n,payer:t,lookupTableAddressAccount:e,recentBlockhash:i=ie.Keypair.generate().publicKey.toString()}){let s=new ie.TransactionMessage({payerKey:t,recentBlockhash:i,instructions:n}).compileToV0Message(Object.values(e!=null?e:{}));try{return Buffer.from(new ie.VersionedTransaction(s).serialize()).toString("base64").length<Rn}catch{return!1}}var Ri=n=>Buffer.isBuffer(n)?n:n instanceof Uint8Array?Buffer.from(n.buffer,n.byteOffset,n.byteLength):Buffer.from(n),Ni=n=>{let t=n.serialize({requireAllSignatures:!1,verifySignatures:!1});n instanceof ie.VersionedTransaction&&(t=Ri(t));try{return t instanceof Buffer?t.toString("base64"):Buffer.from(t).toString("base64")}catch{return t.toString("base64")}};function Se(n){let t=[];return n.forEach(e=>{e instanceof ie.Transaction&&(e.recentBlockhash||(e.recentBlockhash=Ln.TOKEN_PROGRAM_ID.toBase58()),e.feePayer||(e.feePayer=ie.Keypair.generate().publicKey)),t.push(Ni(e))}),console.log("simulate tx string:",t),t}function de(n,t,e){return fe([n.toBuffer(),(e!=null?e:Mn.TOKEN_PROGRAM_ID).toBuffer(),t.toBuffer()],new Nn.PublicKey("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"))}var N=require("@solana/web3.js"),ts=new N.PublicKey("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),ns=new N.PublicKey("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),is=new N.PublicKey("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),rs=new N.PublicKey("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),os=new N.PublicKey("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),ss=new N.PublicKey("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),as=new N.PublicKey("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),cs=new N.PublicKey("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),us=new N.PublicKey("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),ls=new N.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Mi=new N.PublicKey("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),Oi=new N.PublicKey("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),Fi=new N.PublicKey("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),ms=new N.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),ds=new N.PublicKey("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),ps=new N.PublicKey("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),fs=new N.PublicKey("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),bs=new N.PublicKey("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),ys=new N.PublicKey("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),gs=new N.PublicKey("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),On=new N.PublicKey("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),Fn=new N.PublicKey("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),Ps=new N.PublicKey("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),wt=new N.PublicKey("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),kt=new N.PublicKey("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),As=new N.PublicKey("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),ws=new N.PublicKey("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),ks=new N.PublicKey("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),Ts=new N.PublicKey("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),hs=new N.PublicKey("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),Bs=new N.PublicKey("6s1xP3hpbAfFoNtUNF8mfHsjr2Bd97JxFJRWLbL6aHuX");var xs={OPEN_BOOK_PROGRAM:new N.PublicKey("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),SERUM_PROGRAM_ID_V3:new N.PublicKey("Ray1111111111111111111111111111111111111111"),AMM_V4:new N.PublicKey("DRaya7Kj3aMWQSy19kSjvmuwq9docCHofyP9kanQGaav"),AMM_STABLE:new N.PublicKey("DRayDdXc1NZQ9C3hRWmoSf8zK4iapgMnjdNZWrfwsP8m"),CLMM_PROGRAM_ID:new N.PublicKey("DRayAUgENGQBKVaX8owNhgzkEDyoHTGVEGHVJT1E9pfH"),CLMM_LOCK_PROGRAM_ID:new N.PublicKey("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),CLMM_LOCK_AUTH_ID:new N.PublicKey("6Aoh8h2Lw2m5UGxYR8AdAL87jTWYeKoxM52mJRzfYwN"),CREATE_CPMM_POOL_PROGRAM:new N.PublicKey("DRaycpLY18LhpbydsBWbVJtxpNv9oXPgjRSfpF2bWpYb"),CREATE_CPMM_POOL_AUTH:new N.PublicKey("CXniRufdq5xL8t8jZAPxsPZDpuudwuJSPWnbcD5Y5Nxq"),CREATE_CPMM_POOL_FEE_ACC:new N.PublicKey("3oE58BKVt8KuYkGxx8zBojugnymWmBiyafWgMrnb6eYy"),LOCK_CPMM_PROGRAM:new N.PublicKey("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),LOCK_CPMM_AUTH:new N.PublicKey("7qWVV8UY2bRJfDLP4s37YzBPKUkVB46DStYJBpYbQzu3"),UTIL1216:N.PublicKey.default,Router:new N.PublicKey("DRaybByLpbUL57LJARs3j8BitTxVfzBg351EaMr5UTCd"),FARM_PROGRAM_ID_V3:new N.PublicKey("DRayWyrLmEW5KEeqs8kdTMMaBabapqagaBC7KWpGtJeZ"),FARM_PROGRAM_ID_V4:new N.PublicKey("Ray1111111111111111111111111111111111111111"),FARM_PROGRAM_ID_V5:new N.PublicKey("DRayiCGSZgku1GTK6rXD6mVDdingXy6APAH1R6R5L2LC"),FARM_PROGRAM_ID_V6:new N.PublicKey("DRayzbYakXs45ELHkzH6vC3fuhQqTAnv5A68gdFuvZyZ"),LAUNCHPAD_PROGRAM:new N.PublicKey("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),LAUNCHPAD_AUTH:new N.PublicKey("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),LAUNCHPAD_PLATFORM:new N.PublicKey("2Jx4KTDrVSdWNazuGpcA8n3ZLTRGGBDxAWhuKe2Xcj2a"),LAUNCHPAD_CONFIG:new N.PublicKey("7ZR4zD7PYfY2XxoG1Gxcy2EgEeGYrpxrwzPuwdUBssEt"),FEE_DESTINATION_ID:new N.PublicKey("9y8ENuuZ3b19quffx9hQvRVygG5ky6snHfRvGpuSfeJy"),MODEL_DATA_PUBKEY:new N.PublicKey("Ray1111111111111111111111111111111111111111")};var pe=_(require("bn.js")),it=1e4;function we(n,t,e,i){if(t===void 0)return{amount:n,fee:void 0,expirationTime:void 0};let o=X(V({},t),{olderTransferFee:{epoch:BigInt(t.olderTransferFee.epoch),maximumFee:BigInt(t.olderTransferFee.maximumFee),transferFeeBasisPoints:t.olderTransferFee.transferFeeBasisPoints},newerTransferFee:{epoch:BigInt(t.newerTransferFee.epoch),maximumFee:BigInt(t.newerTransferFee.maximumFee),transferFeeBasisPoints:t.newerTransferFee.transferFeeBasisPoints}}),s=e.epoch<o.newerTransferFee.epoch?o.olderTransferFee:o.newerTransferFee,a=new pe.default(s.maximumFee.toString()),r=e.epoch<o.newerTransferFee.epoch?(Number(o.newerTransferFee.epoch)*e.slotsInEpoch-e.absoluteSlot)*400/1e3:void 0;if(i)if(s.transferFeeBasisPoints===it){let d=new pe.default(s.maximumFee.toString());return{amount:n.add(d),fee:d,expirationTime:r}}else{let d=Ee(n.mul(new pe.default(it)),new pe.default(it-s.transferFeeBasisPoints)),g=new pe.default(s.maximumFee.toString()),A=d.sub(n).gt(g)?n.add(g):d,l=Ee(A.mul(new pe.default(s.transferFeeBasisPoints)),new pe.default(it)),b=l.gt(a)?a:l;return{amount:A,fee:b,expirationTime:r}}else{let d=Ee(n.mul(new pe.default(s.transferFeeBasisPoints)),new pe.default(it)),g=d.gt(a)?a:d;return{amount:n,fee:g,expirationTime:r}}}function Ee(n,t){let{div:e,mod:i}=n.divmod(t);return i.gt(new pe.default(0))?e.add(new pe.default(1)):e}var be=require("@solana/web3.js");async function Tt({connection:n,address:t,cluster:e="mainnet"}){let i=await Ze(n,[...new Set(t.map(s=>s.toString()))].map(s=>new be.PublicKey(s))),o={};for(let s=0;s<t.length;s++){let a=i[s],r=t[s];if(!a)continue;let d=new be.AddressLookupTableAccount({key:r,state:be.AddressLookupTableAccount.deserialize(a.data)});o[r.toString()]=d,e==="devnet"?De[r.toString()]=d:rt[r.toString()]=d}return o}var rt={AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU:new be.AddressLookupTableAccount({key:new be.PublicKey("AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU"),state:be.AddressLookupTableAccount.deserialize(Buffer.from("AQAAAP//////////I1rcEwAAAAAvAQYwun9CU6c5Ikm2pAj+D9IEnCOR45nK+SFTGSdpd6J6AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbd9uHXZaGT2cvhRs7reawctIXtX1s3kTqM9YV+/wCpBt324e51j94YQl285GzN2rYa/E2DuQ0n/r35KNihi/wFSlNQ+F3IgtYUpVZyeIopbd8eq6vQpgZ4iEky9O72oAVKU1qZKSEGTSTocWDaOHx8NbXdvJK7geQfqEBBBUSNBqfVFxksXFEhjMlMPUrxf1ja7gibof1E49vZigAAAAAGp9UXGMd0yShWY5hpHV62i164o5tLbVxzVVshAAAAAIyXJY9OJInxuz0QKRSODYMLWhOZ2v8QhASOe9jb6fhZC3BlsePRfEU4nVJ/awTDzVi4bHMaoP21SbbRvAP4KUbIScv+6Yw2LHF/6K0ZjUPibbSWXCirYPGuuVl7zT789IUPLW4CpHr4JNCatp3ELXDLKMv6JJ+37le50lbBJ2LvBkX2T9y7AHdNGviJAqQNtlDUDCnauQRWybsLji6nPM8Qkw5asQRvCdB3MbX6IEBwytOrpM32l4jQygKG9TKgR0vZScQ2AsM/IHeQ7RajUkyhuZdc8SGiqQz/7H34torNR/Wir3sl0ruUrVxJWEZfUg+QLNAxxODdBi53/OP7Ioil1cqeBM9dtZC3FLov4yyxWRM/wcGStyJX/QfTnLBAHqkqWotPKVlShCVQqpP9W5W1rOao65IMk5QuQ2kMIOxzDMKAy2vjGSxQODgBz0QwGA+eP4ZjIjrIAQaXENv31QfLlOdXSRCkaybRniDHF4C8YcwhcvsqrOVuTP4B2Na+9wLdtrB31uz2rtlFI5kahdsnp/d1SrASDInYCtTYtdoke4kX+hoKWcEWM4Tle8pTUkUVv4BxS6fje/EzKBE4Qu/YsA/yfEEFGcr8Z57VKDw8uQzpiru7g4lvjnfapW62W030syevD8k07SGoxUHiuT/ai7gAHWWhDsVmg/C63ajgpkH7Sn3GdutArDTfyqOkdqv4/IPC/EFFy7mGkfDd2C57N5a/4jC+BbmJy7wQaSEZr0CQU88lPtUxIVvzGjC95b8Ooss2TqmkrayGKofkPMGQn7Ux+9lfwBSNfxwH8NgbpqC/7LNlV4I7nCvsXf3p+ohQk9NrAJb2KAFpUqEIJ9ZBV7BYDzHF/ORKYlgtvPnXjudZQ6CEo5OzUDaNIomTCCsvhD16TxJjsbgne1kGnQPCFSoaxUbq2V1bPMFQ3VYP6wDZ9bKStCFKx9A3tNbwZFC5ZGAN83MFK7XoTy+OmmcFEr6rLOjfSuTfPvHJkSVxW6Qllwkl67XcBi5v00u2gQsbu+38sp+rd5pA/LvyWj4P94ZGZwc1tE2P88xekCLcAwZGb+UhFzL/7K26csOb57yM5bvF9xJrLEObOkAAAAAn+HWRkdcPKyFFMnVwEoD7vnD0jCKFIU1sImubYCxNTSVzsKpaQX+fzNxrLAI3L14JQnJx/D6Uk2LADIHGqnGELzjEbkBDAlaM77NkXMPfqXNLSveCkWI7UEgNs31WEWB6XHSYI/v5DklHOb4QTtDOR804PVbi3fjloZeLR2F8d4FuZmMMO7ck3Fnkn2zEMG5gOmqsygb6PjTitArVl52NhcSznTxVnguaIJxiZkAnurDmn3MWR0PC2GLghp2KJqHCc6QQ85odeIjFHKOlRlJyeSXVJmL8vb1UgOzsbJPVP8p6zM4M3C1Sd7uWIHP33G42AP2Zg8ucn/n6meQjjD266JgCWdxZD6PXs9CsnIeL7SSG0/6lGb9xfP0ZcWkCXB/3hjxHYVXjra/GPOeXGk0fLLKjCbk+mgs2w6d2oCwimBipTzuoZ30GiI8ij8VRzD5CzMWtu2m21eDBIfjGAEo4pQeNNonKcqzV/cleX8ySZLOHsz8PtBCrLqF+VkLm9hOzIT+6i/nIf6keR4GWKMOD4AvqfpjHoD4DuhBpz8P28+DxkGrDXXr/nr20x291VPvcTU/b+b+o2kC9G0kcXeTlLjU6a2TQXWlZ4gBUdBl1jgT7mObSTpLblNiXZsLkbmVXZwvFKXua5cUKlWed/w30skmEUraTuQqtqr5fHZPW9n57EmeTif6LjHL2YJFZkQU+TrJmFzqzmF4/b8OwrPQAprl8mX3q4LUIdAS/a+11B6DWD1Xk2++Sn94dLC4xjkO4Wtlw8c4XuzciVbepHOmnoWzVu/0y3KCrLCSfQxQ3br8DJCoVzhgtPsS2nZZjsBGIZgnU0QpMv+2MnRsnKwdp1VsrCX84j/qvaZn4WhKunippgTbN2EUs0tPTP55Qfgj+nKmjtWW5IYs72FrEwJKYoNfsmqaF4o5pf4v9zgPwVwY/5I4XJKUL2L25m9kAQcW/K+H1RTFEUoj8Z4ajpOmAB/dG0COmCphVMW2CCMvnxhcGiSgPnpDuWu6qiJ7NG7ye5kvHgefgqPLeicspNJ5EpL3XiRNLM2tmJLI1awAwOyd6iHv0dCkMYRKaa6rcaZeYwmKCkckm0kM2JNmnmmAaBQQ7mwmIM0IMxX4f5W6j9PqZWcJxF7r17T/lQBAmcjoupRiJifbnXCNUv9GhpRF19WcBdeKbivRJVlGop6I2RS6lGImJ9udcI1S/0aGlEXX1ZwF14puK9ElWUainojZFYVHLHD6dIP2ESjqBzg3ol1/wB7+/ylGwd9LS7wSZ2A630CJSVKwH47K9P4bB8PEQP8BwjMFa7xQHOqZFP1XqaQ==","base64"))})},De={},ht=async n=>{let t="EFhMuDw1PKEuckuFRW9PavNfTH4LKP5uKHgyXDmWpFCq";if(De[t])return De;let e=new be.PublicKey(t),i=await n.getAccountInfo(e);return i&&(De[t]=new be.AddressLookupTableAccount({key:e,state:be.AddressLookupTableAccount.deserialize(i.data)})),De};var D=require("@solana/web3.js"),Dn=_(require("axios"));var ot=2e3,st=class{constructor(t){this.instructions=[];this.endInstructions=[];this.lookupTableAddress=[];this.signers=[];this.instructionTypes=[];this.endInstructionTypes=[];this.connection=t.connection,this.feePayer=t.feePayer,this.signAllTransactions=t.signAllTransactions,this.owner=t.owner,this.cluster=t.cluster,this.blockhashCommitment=t.blockhashCommitment,this.loopMultiTxStatus=!!t.loopMultiTxStatus}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers,instructionTypes:this.instructionTypes,endInstructionTypes:this.endInstructionTypes,lookupTableAddress:this.lookupTableAddress}}get allInstructions(){return[...this.instructions,...this.endInstructions]}async getComputeBudgetConfig(){var i;let t=(await Dn.default.get(`https://solanacompass.com/api/fees?cacheFreshTime=${3e5}`)).data,{avg:e}=(i=t==null?void 0:t[15])!=null?i:{};if(!!e)return{units:6e5,microLamports:Math.min(Math.ceil(e*1e6/6e5),25e3)}}addCustomComputeBudget(t){if(t){let{instructions:e,instructionTypes:i}=et(t);return this.instructions.unshift(...e),this.instructionTypes.unshift(...i),!0}return!1}addTipInstruction(t){var e;return t?(this.endInstructions.push(D.SystemProgram.transfer({fromPubkey:(e=t.feePayer)!=null?e:this.feePayer,toPubkey:new D.PublicKey(t.address),lamports:BigInt(t.amount.toString())})),this.endInstructionTypes.push(ne.TransferTip),!0):!1}async calComputeBudget({config:t,defaultIns:e}){try{let i=t||await this.getComputeBudgetConfig();if(this.addCustomComputeBudget(i))return;e&&this.instructions.unshift(...e)}catch{e&&this.instructions.unshift(...e)}}addInstruction({instructions:t=[],endInstructions:e=[],signers:i=[],instructionTypes:o=[],endInstructionTypes:s=[],lookupTableAddress:a=[]}){return this.instructions.push(...t),this.endInstructions.push(...e),this.signers.push(...i),this.instructionTypes.push(...o),this.endInstructionTypes.push(...s),this.lookupTableAddress.push(...a.filter(r=>r!==D.PublicKey.default.toString())),this}async versionBuild({txVersion:t,extInfo:e}){return t===0?await this.buildV0(V({},e||{})):this.build(e)}build(t){var i;let e=new D.Transaction;return this.allInstructions.length&&e.add(...this.allInstructions),e.feePayer=this.feePayer,((i=this.owner)==null?void 0:i.signer)&&!this.signers.some(o=>o.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer),{builder:this,transaction:e,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async o=>{var A;let{recentBlockHash:s,skipPreflight:a=!0,sendAndConfirm:r,notSendToRpc:d}=o||{},g=s!=null?s:await Ke(this.connection,this.blockhashCommitment);if(e.recentBlockhash=g,this.signers.length&&e.sign(...this.signers),Se([e]),(A=this.owner)!=null&&A.isKeyPair)return{txId:r?await(0,D.sendAndConfirmTransaction)(this.connection,e,this.signers.find(b=>b.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:a}):await this.connection.sendRawTransaction(e.serialize(),{skipPreflight:a}),signedTx:e};if(this.signAllTransactions){let l=await this.signAllTransactions([e]);if(this.signers.length)for(let b of l)try{b.sign(...this.signers)}catch{}return{txId:d?"":await this.connection.sendRawTransaction(l[0].serialize(),{skipPreflight:a}),signedTx:l[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:t||{}}}buildMultiTx(t){var g;let{extraPreBuildData:e=[],extInfo:i}=t,{transaction:o}=this.build(i),s=e.filter(A=>A.transaction.instructions.length>0),a=[o,...s.map(A=>A.transaction)],r=[this.signers,...s.map(A=>A.signers)],d=[...this.instructionTypes,...s.map(A=>A.instructionTypes).flat()];return(g=this.owner)!=null&&g.signer&&r.forEach(A=>{A.some(l=>l.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),{builder:this,transactions:a,signers:r,instructionTypes:d,execute:async A=>{var h;let{sequentially:l,onTxUpdate:b,skipTxCount:c=0,recentBlockHash:p,skipPreflight:P=!0}=A||{},u=p!=null?p:await Ke(this.connection,this.blockhashCommitment);if((h=this.owner)!=null&&h.isKeyPair){if(l){let w=[],x=0;for(let m of a){if(++x,x<=c)continue;let f=await(0,D.sendAndConfirmTransaction)(this.connection,m,this.signers.find(y=>y.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:P});w.push(f)}return{txIds:w,signedTxs:a}}return{txIds:await await Promise.all(a.map(async w=>(w.recentBlockhash=u,await this.connection.sendRawTransaction(w.serialize(),{skipPreflight:P})))),signedTxs:a}}if(this.signAllTransactions){let w=a.map((m,f)=>(m.recentBlockhash=u,r[f].length&&m.sign(...r[f]),m));Se(w);let x=await this.signAllTransactions(w);if(l){let m=0,f=[],y=async()=>{if(!x[m])return;let B=await this.connection.sendRawTransaction(x[m].serialize(),{skipPreflight:P});f.push({txId:B,status:"sent",signedTx:x[m]}),b==null||b([...f]),m++;let k=!1,K=null,L=null,C=I=>{K!==null&&clearInterval(K),L!==null&&this.connection.removeSignatureListener(L);let M=f.findIndex(F=>F.txId===B);if(M>-1){if(f[M].status==="error"||f[M].status==="success")return;f[M].status=I.err?"error":"success"}b==null||b([...f]),I.err||y()};this.loopMultiTxStatus&&(K=setInterval(async()=>{var I;if(k){clearInterval(K);return}try{let M=await this.connection.getTransaction(B,{commitment:"confirmed",maxSupportedTransactionVersion:0});M&&(k=!0,clearInterval(K),C({err:((I=M.meta)==null?void 0:I.err)||null}),console.log("tx status from getTransaction:",B))}catch(M){k=!0,clearInterval(K),console.error("getTransaction timeout:",M,B)}},ot)),L=this.connection.onSignature(B,I=>{if(k){this.connection.removeSignatureListener(L);return}k=!0,C(I)},"confirmed"),this.connection.getSignatureStatus(B)};return await y(),{txIds:f.map(B=>B.txId),signedTxs:x}}else{let m=[];for(let f=0;f<x.length;f+=1){let y=await this.connection.sendRawTransaction(x[f].serialize(),{skipPreflight:P});m.push(y)}return{txIds:m,signedTxs:x}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:i||{}}}async versionMultiBuild({extraPreBuildData:t,txVersion:e,extInfo:i}){return e===0?await this.buildV0MultiTx({extraPreBuildData:t,buildProps:i||{}}):this.buildMultiTx({extraPreBuildData:t,extInfo:i})}async buildV0(t){var P;let p=t||{},{lookupTableCache:e={},lookupTableAddress:i=[],forerunCreate:o,recentBlockhash:s}=p,a=ge(p,["lookupTableCache","lookupTableAddress","forerunCreate","recentBlockhash"]),r=V(V({},this.cluster==="devnet"?await ht(this.connection):rt),e),d=Array.from(new Set([...i,...this.lookupTableAddress])),g=[];for(let u of d)r[u]===void 0&&g.push(new D.PublicKey(u));let A=await Tt({connection:this.connection,address:g});for(let[u,h]of Object.entries(A))r[u]=h;let l=o?D.PublicKey.default.toBase58():s!=null?s:await Ke(this.connection,this.blockhashCommitment),b=new D.TransactionMessage({payerKey:this.feePayer,recentBlockhash:l,instructions:[...this.allInstructions]}).compileToV0Message(Object.values(r));((P=this.owner)==null?void 0:P.signer)&&!this.signers.some(u=>u.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer);let c=new D.VersionedTransaction(b);return c.sign(this.signers),{builder:this,transaction:c,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async u=>{var m;let{skipPreflight:h=!0,sendAndConfirm:w,notSendToRpc:x}=u||{};if(Se([c]),(m=this.owner)!=null&&m.isKeyPair){let f=await this.connection.sendTransaction(c,{skipPreflight:h});return w&&await tt(this.connection,f),{txId:f,signedTx:c}}if(this.signAllTransactions){let f=await this.signAllTransactions([c]);if(this.signers.length)for(let y of f)try{y.sign(this.signers)}catch{}return{txId:x?"":await this.connection.sendTransaction(f[0],{skipPreflight:h}),signedTx:f[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:a||{}}}async buildV0MultiTx(t){var g;let{extraPreBuildData:e=[],buildProps:i}=t,{transaction:o}=await this.buildV0(i),s=e.filter(A=>A.builder.instructions.length>0),a=[o,...s.map(A=>A.transaction)],r=[this.signers,...s.map(A=>A.signers)],d=[...this.instructionTypes,...s.map(A=>A.instructionTypes).flat()];return(g=this.owner)!=null&&g.signer&&r.forEach(A=>{A.some(l=>l.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),a.forEach(async(A,l)=>{A.sign(r[l])}),{builder:this,transactions:a,signers:r,instructionTypes:d,buildProps:i,execute:async A=>{var P;let{sequentially:l,onTxUpdate:b,recentBlockHash:c,skipPreflight:p=!0}=A||{};if(c&&a.forEach(u=>u.message.recentBlockhash=c),Se(a),(P=this.owner)!=null&&P.isKeyPair){if(l){let u=[];for(let h of a){let w=await this.connection.sendTransaction(h,{skipPreflight:p});await tt(this.connection,w),u.push(w)}return{txIds:u,signedTxs:a}}return{txIds:await Promise.all(a.map(async u=>await this.connection.sendTransaction(u,{skipPreflight:p}))),signedTxs:a}}if(this.signAllTransactions){let u=await this.signAllTransactions(a);if(l){let h=0,w=[],x=async()=>{if(!u[h])return;let m=await this.connection.sendTransaction(u[h],{skipPreflight:p});w.push({txId:m,status:"sent",signedTx:u[h]}),b==null||b([...w]),h++;let f=!1,y=null,B=null,k=K=>{y!==null&&clearInterval(y),B!==null&&this.connection.removeSignatureListener(B);let L=w.findIndex(C=>C.txId===m);if(L>-1){if(w[L].status==="error"||w[L].status==="success")return;w[L].status=K.err?"error":"success"}b==null||b([...w]),K.err||x()};this.loopMultiTxStatus&&(y=setInterval(async()=>{var K;if(f){clearInterval(y);return}try{let L=await this.connection.getTransaction(m,{commitment:"confirmed",maxSupportedTransactionVersion:0});L&&(f=!0,clearInterval(y),k({err:((K=L.meta)==null?void 0:K.err)||null}),console.log("tx status from getTransaction:",m))}catch(L){f=!0,clearInterval(y),console.error("getTransaction timeout:",L,m)}},ot)),B=this.connection.onSignature(m,K=>{if(f){this.connection.removeSignatureListener(B);return}f=!0,k(K)},"confirmed"),this.connection.getSignatureStatus(m)};return x(),{txIds:[],signedTxs:u}}else{let h=[];for(let w=0;w<u.length;w+=1){let x=await this.connection.sendTransaction(u[w],{skipPreflight:p});h.push(x)}return{txIds:h,signedTxs:u}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:i||{}}}async sizeCheckBuild(t){var b;let l=t||{},{splitIns:e=[],computeBudgetConfig:i}=l,o=ge(l,["splitIns","computeBudgetConfig"]),s=i?et(i):{instructions:[],instructionTypes:[]},a=this.signers.reduce((c,p)=>X(V({},c),{[p.publicKey.toBase58()]:p}),{}),r=[],d=[],g=[],A=0;if(this.allInstructions.forEach(c=>{let p=[...g,c],P=i?[...s.instructions,...p]:p,h=[...new Set(p.map(w=>w.keys.filter(x=>x.isSigner).map(x=>x.pubkey.toString())).flat()).values()].map(w=>new D.PublicKey(w));if(c!==e[A]&&g.length<12&&(nt({instructions:P,payer:this.feePayer,signers:h})||nt({instructions:p,payer:this.feePayer,signers:h})))g.push(c);else{if(g.length===0)throw Error("item ins too big");A+=c===e[A]?1:0,nt({instructions:i?[...s.instructions,...g]:[...g],payer:this.feePayer,signers:h})?r.push(new D.Transaction().add(...s.instructions,...g)):r.push(new D.Transaction().add(...g)),d.push(Array.from(new Set(g.map(w=>w.keys.filter(x=>x.isSigner).map(x=>x.pubkey.toString())).flat())).map(w=>a[w]).filter(w=>w!==void 0)),g=[c]}}),g.length>0){let p=[...new Set(g.map(P=>P.keys.filter(u=>u.isSigner).map(u=>u.pubkey.toString())).flat()).values()].map(P=>a[P]).filter(P=>P!==void 0);nt({instructions:i?[...s.instructions,...g]:[...g],payer:this.feePayer,signers:p.map(P=>P.publicKey)})?r.push(new D.Transaction().add(...s.instructions,...g)):r.push(new D.Transaction().add(...g)),d.push(p)}return r.forEach(c=>c.feePayer=this.feePayer),(b=this.owner)!=null&&b.signer&&d.forEach(c=>{c.some(p=>p.publicKey.equals(this.owner.publicKey))||c.push(this.owner.signer)}),{builder:this,transactions:r,signers:d,instructionTypes:this.instructionTypes,execute:async c=>{var m;let{sequentially:p,onTxUpdate:P,skipTxCount:u=0,recentBlockHash:h,skipPreflight:w=!0}=c||{},x=h!=null?h:await Ke(this.connection,this.blockhashCommitment);if(r.forEach(async(f,y)=>{f.recentBlockhash=x,d[y].length&&f.sign(...d[y])}),Se(r),(m=this.owner)!=null&&m.isKeyPair){if(p){let f=0,y=[];for(let B of r){if(++f,f<=u){y.push("tx skipped");continue}let k=await(0,D.sendAndConfirmTransaction)(this.connection,B,this.signers.find(K=>K.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:w});y.push(k)}return{txIds:y,signedTxs:r}}return{txIds:await Promise.all(r.map(async f=>await this.connection.sendRawTransaction(f.serialize(),{skipPreflight:w}))),signedTxs:r}}if(this.signAllTransactions){let f=await this.signAllTransactions(r.slice(u,r.length)),y=[...r.slice(0,u),...f];if(p){let B=0,k=[],K=async()=>{if(!y[B])return;B<u&&(k.push({txId:"",status:"success",signedTx:y[B]}),P==null||P([...k]),B++,K());let L=await this.connection.sendRawTransaction(y[B].serialize(),{skipPreflight:w});k.push({txId:L,status:"sent",signedTx:y[B]}),P==null||P([...k]),B++;let C=!1,I=null,M=null,F=v=>{I!==null&&clearInterval(I),M!==null&&this.connection.removeSignatureListener(M);let W=k.findIndex(H=>H.txId===L);if(W>-1){if(k[W].status==="error"||k[W].status==="success")return;k[W].status=v.err?"error":"success"}P==null||P([...k]),v.err||K()};this.loopMultiTxStatus&&(I=setInterval(async()=>{var v;if(C){clearInterval(I);return}try{let W=await this.connection.getTransaction(L,{commitment:"confirmed",maxSupportedTransactionVersion:0});W&&(C=!0,clearInterval(I),F({err:((v=W.meta)==null?void 0:v.err)||null}),console.log("tx status from getTransaction:",L))}catch(W){C=!0,clearInterval(I),console.error("getTransaction timeout:",W,L)}},ot)),M=this.connection.onSignature(L,v=>{if(C){this.connection.removeSignatureListener(M);return}C=!0,F(v)},"confirmed"),this.connection.getSignatureStatus(L)};return await K(),{txIds:k.map(L=>L.txId),signedTxs:y}}else{let B=[];for(let k=0;k<y.length;k+=1){let K=await this.connection.sendRawTransaction(y[k].serialize(),{skipPreflight:w});B.push(K)}return{txIds:B,signedTxs:y}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:o||{}}}async sizeCheckBuildV0(t){var x;let w=t||{},{computeBudgetConfig:e,splitIns:i=[],lookupTableCache:o={},lookupTableAddress:s=[]}=w,a=ge(w,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),r=V(V({},this.cluster==="devnet"?await ht(this.connection):rt),o),d=Array.from(new Set([...this.lookupTableAddress,...s])),g=[];for(let m of d)r[m]===void 0&&g.push(new D.PublicKey(m));let A=await Tt({connection:this.connection,address:g});for(let[m,f]of Object.entries(A))r[m]=f;let l=e?et(e):{instructions:[],instructionTypes:[]},b=await Ke(this.connection,this.blockhashCommitment),c=this.signers.reduce((m,f)=>X(V({},m),{[f.publicKey.toBase58()]:f}),{}),p=[],P=[],u=[],h=0;if(this.allInstructions.forEach(m=>{let f=[...u,m],y=e?[...l.instructions,...f]:f;if(m!==i[h]&&u.length<12&&(ke({instructions:y,payer:this.feePayer,lookupTableAddressAccount:r})||ke({instructions:f,payer:this.feePayer,lookupTableAddressAccount:r})))u.push(m);else{if(u.length===0)throw Error("item ins too big");h+=m===i[h]?1:0;let B={};for(let k of[...new Set(d)])r[k]!==void 0&&(B[k]=r[k]);if(e&&ke({instructions:[...l.instructions,...u],payer:this.feePayer,lookupTableAddressAccount:r,recentBlockhash:b})){let k=new D.TransactionMessage({payerKey:this.feePayer,recentBlockhash:b,instructions:[...l.instructions,...u]}).compileToV0Message(Object.values(r));p.push(new D.VersionedTransaction(k))}else{let k=new D.TransactionMessage({payerKey:this.feePayer,recentBlockhash:b,instructions:[...u]}).compileToV0Message(Object.values(r));p.push(new D.VersionedTransaction(k))}P.push(Array.from(new Set(u.map(k=>k.keys.filter(K=>K.isSigner).map(K=>K.pubkey.toString())).flat())).map(k=>c[k]).filter(k=>k!==void 0)),u=[m]}}),u.length>0){let f=[...new Set(u.map(y=>y.keys.filter(B=>B.isSigner).map(B=>B.pubkey.toString())).flat()).values()].map(y=>c[y]).filter(y=>y!==void 0);if(e&&ke({instructions:[...l.instructions,...u],payer:this.feePayer,lookupTableAddressAccount:r,recentBlockhash:b})){let y=new D.TransactionMessage({payerKey:this.feePayer,recentBlockhash:b,instructions:[...l.instructions,...u]}).compileToV0Message(Object.values(r));p.push(new D.VersionedTransaction(y))}else{let y=new D.TransactionMessage({payerKey:this.feePayer,recentBlockhash:b,instructions:[...u]}).compileToV0Message(Object.values(r));p.push(new D.VersionedTransaction(y))}P.push(f)}return(x=this.owner)!=null&&x.signer&&P.forEach(m=>{m.some(f=>f.publicKey.equals(this.owner.publicKey))||m.push(this.owner.signer)}),p.forEach((m,f)=>{m.sign(P[f])}),{builder:this,transactions:p,buildProps:t,signers:P,blockHash:b,instructionTypes:this.instructionTypes,execute:async m=>{var L;let{sequentially:f,onTxUpdate:y,skipTxCount:B=0,recentBlockHash:k,skipPreflight:K=!0}=m||{};if(p.map(async(C,I)=>{P[I].length&&C.sign(P[I]),k&&(C.message.recentBlockhash=k)}),Se(p),(L=this.owner)!=null&&L.isKeyPair){if(f){let C=0,I=[];for(let M of p){if(++C,C<=B){console.log("skip tx: ",C),I.push("tx skipped");continue}let F=await this.connection.sendTransaction(M,{skipPreflight:K});await tt(this.connection,F),I.push(F)}return{txIds:I,signedTxs:p}}return{txIds:await Promise.all(p.map(async C=>await this.connection.sendTransaction(C,{skipPreflight:K}))),signedTxs:p}}if(this.signAllTransactions){let C=await this.signAllTransactions(p.slice(B,p.length)),I=[...p.slice(0,B),...C];if(f){let M=0,F=[],v=async()=>{if(!I[M])return;if(M<B){F.push({txId:"",status:"success",signedTx:I[M]}),y==null||y([...F]),M++,v();return}let W=await this.connection.sendTransaction(I[M],{skipPreflight:K});F.push({txId:W,status:"sent",signedTx:I[M]}),y==null||y([...F]),M++;let H=!1,$=null,le=null,Xe=se=>{$!==null&&clearInterval($),le!==null&&this.connection.removeSignatureListener(le);let J=F.findIndex(Dt=>Dt.txId===W);if(J>-1){if(F[J].status==="error"||F[J].status==="success")return;F[J].status=se.err?"error":"success"}y==null||y([...F]),se.err||v()};this.loopMultiTxStatus&&($=setInterval(async()=>{var se;if(H){clearInterval($);return}try{let J=await this.connection.getTransaction(W,{commitment:"confirmed",maxSupportedTransactionVersion:0});J&&(H=!0,clearInterval($),Xe({err:((se=J.meta)==null?void 0:se.err)||null}),console.log("tx status from getTransaction:",W))}catch(J){H=!0,clearInterval($),console.error("getTransaction timeout:",J,W)}},ot)),le=this.connection.onSignature(W,se=>{if(H){this.connection.removeSignatureListener(le);return}H=!0,Xe(se)},"confirmed"),this.connection.getSignatureStatus(W)};return v(),{txIds:[],signedTxs:I}}else{let M=[];for(let F=0;F<I.length;F+=1){let v=await this.connection.sendTransaction(I[F],{skipPreflight:K});M.push(v)}return{txIds:M,signedTxs:I}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:a||{}}}async buildSniperTransaction(t){var x;let w=t||{},{computeBudgetConfig:e,splitIns:i=[],lookupTableCache:o={},lookupTableAddress:s=[]}=w,a=ge(w,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),r=V(V({},this.cluster==="devnet"?await ht(this.connection):rt),o),d=Array.from(new Set([...this.lookupTableAddress,...s])),g=[];for(let m of d)r[m]===void 0&&g.push(new D.PublicKey(m));let A=await Tt({connection:this.connection,address:g});for(let[m,f]of Object.entries(A))r[m]=f;let l=e?et(e):{instructions:[],instructionTypes:[]},b=await Ke(this.connection,this.blockhashCommitment),c=this.signers.reduce((m,f)=>X(V({},m),{[f.publicKey.toBase58()]:f}),{}),p=[],P=[],u=[],h=0;if(this.allInstructions.forEach(m=>{let f=[...u,m],y=e?[...l.instructions,...f]:f;if(m!==i[h]&&u.length<12&&(ke({instructions:y,payer:this.feePayer,lookupTableAddressAccount:r})||ke({instructions:f,payer:this.feePayer,lookupTableAddressAccount:r})))u.push(m);else{if(u.length===0)throw Error("item ins too big");h+=m===i[h]?1:0;let B={};for(let k of[...new Set(d)])r[k]!==void 0&&(B[k]=r[k]);if(e&&ke({instructions:[...l.instructions,...u],payer:this.feePayer,lookupTableAddressAccount:r,recentBlockhash:b})){let k=new D.TransactionMessage({payerKey:this.feePayer,recentBlockhash:b,instructions:[...l.instructions,...u]}).compileToV0Message(Object.values(r));p.push(new D.VersionedTransaction(k))}else{let k=new D.TransactionMessage({payerKey:this.feePayer,recentBlockhash:b,instructions:[...u]}).compileToV0Message(Object.values(r));p.push(new D.VersionedTransaction(k))}P.push(Array.from(new Set(u.map(k=>k.keys.filter(K=>K.isSigner).map(K=>K.pubkey.toString())).flat())).map(k=>c[k]).filter(k=>k!==void 0)),u=[m]}}),u.length>0){let f=[...new Set(u.map(y=>y.keys.filter(B=>B.isSigner).map(B=>B.pubkey.toString())).flat()).values()].map(y=>c[y]).filter(y=>y!==void 0);if(e&&ke({instructions:[...l.instructions,...u],payer:this.feePayer,lookupTableAddressAccount:r,recentBlockhash:b})){let y=new D.TransactionMessage({payerKey:this.feePayer,recentBlockhash:b,instructions:[...l.instructions,...u]}).compileToV0Message(Object.values(r));p.push(new D.VersionedTransaction(y))}else{let y=new D.TransactionMessage({payerKey:this.feePayer,recentBlockhash:b,instructions:[...u]}).compileToV0Message(Object.values(r));p.push(new D.VersionedTransaction(y))}P.push(f)}return(x=this.owner)!=null&&x.signer&&P.forEach(m=>{m.some(f=>f.publicKey.equals(this.owner.publicKey))||m.push(this.owner.signer)}),p.forEach((m,f)=>{m.sign(P[f])}),{builder:this,transactions:p,buildProps:t,signers:P,instructionTypes:this.instructionTypes,execute:async m=>{var L;let{sequentially:f,onTxUpdate:y,skipTxCount:B=0,recentBlockHash:k,skipPreflight:K=!0}=m||{};if(p.map(async(C,I)=>{P[I].length&&C.sign(P[I]),k&&(C.message.recentBlockhash=k)}),Se(p),(L=this.owner)!=null&&L.isKeyPair){if(f){let C=0,I=[];for(let M of p){if(++C,C<=B){console.log("skip tx: ",C),I.push("tx skipped");continue}let F=await this.connection.sendTransaction(M,{skipPreflight:K});await tt(this.connection,F),I.push(F)}return{txIds:I,signedTxs:p}}return{txIds:await Promise.all(p.map(async C=>await this.connection.sendTransaction(C,{skipPreflight:K}))),signedTxs:p}}if(this.signAllTransactions){let C=await this.signAllTransactions(p.slice(B,p.length)),I=[...p.slice(0,B),...C];if(f){let M=0,F=[],v=async()=>{if(!I[M])return;if(M<B){F.push({txId:"",status:"success",signedTx:I[M]}),y==null||y([...F]),M++,v();return}let W=await this.connection.sendTransaction(I[M],{skipPreflight:K});F.push({txId:W,status:"sent",signedTx:I[M]}),y==null||y([...F]),M++;let H=!1,$=null,le=null,Xe=se=>{$!==null&&clearInterval($),le!==null&&this.connection.removeSignatureListener(le);let J=F.findIndex(Dt=>Dt.txId===W);if(J>-1){if(F[J].status==="error"||F[J].status==="success")return;F[J].status=se.err?"error":"success"}y==null||y([...F]),se.err||v()};this.loopMultiTxStatus&&($=setInterval(async()=>{var se;if(H){clearInterval($);return}try{let J=await this.connection.getTransaction(W,{commitment:"confirmed",maxSupportedTransactionVersion:0});J&&(H=!0,clearInterval($),Xe({err:((se=J.meta)==null?void 0:se.err)||null}),console.log("tx status from getTransaction:",W))}catch(J){H=!0,clearInterval($),console.error("getTransaction timeout:",J,W)}},ot)),le=this.connection.onSignature(W,se=>{if(H){this.connection.removeSignatureListener(le);return}H=!0,Xe(se)},"confirmed"),this.connection.getSignatureStatus(W)};return v(),{txIds:[],signedTxs:I}}else{let M=[];for(let F=0;F<I.length;F+=1){let v=await this.connection.sendTransaction(I[F],{skipPreflight:K});M.push(v)}return{txIds:M,signedTxs:I}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:a||{}}}};var Ei=require("@solana/web3.js"),Di=_(require("bn.js"));var vn=_(require("bn.js")),Bt=new vn.default(1e6);var Pa=ee("Raydium_amount"),Aa=Qe(Vn.default);var Jt=new ye.default(0),Ma=new ye.default(1),Oa=new ye.default(2),Fa=new ye.default(3),Ea=new ye.default(5),Vi=new ye.default(10),Da=new ye.default(100),va=new ye.default(1e3),Va=new ye.default(1e4);function Wn(n,t,e){return n.mul(t).add(e).sub(new ye.default(1)).div(e)}function $t(n,t,e){return n.mul(t).div(e)}var Ct=_(require("bn.js")),at=_(require("decimal.js-light"));var Ve=_(require("bn.js"));function xt(n,t){if(t.isZero())throw Error("divisor is zero");return n.mod(t)}function _i(n,t){if(t.isZero())throw Error("rhs is zero");let e=n.div(t);if(e.isZero())throw Error("quotient is zero");let i=xt(n,t);return i.gt(ve)&&(e=e.add(new Ve.default(1)),t=n.div(e),i=xt(n,e),i.gt(ve)&&(t=t.add(new Ve.default(1)))),[e,t]}var ve=new Ve.default(0),It=class{static swapWithoutFees(t,e,i){let o=e.mul(i),s=e.add(t),[a]=_i(o,s),r=i.sub(a);if(r.isZero())throw Error("destinationAmountSwapped is zero");return{destinationAmountSwapped:r}}static lpTokensToTradingTokens(t,e,i,o,s){let a=t.mul(i).div(e),r=t.mul(o).div(e);if(s===0)return{tokenAmount0:a,tokenAmount1:r};if(s===1)return xt(t.mul(i),e).gt(ve)&&a.gt(ve)&&(a=a.add(new Ve.default(1))),xt(t.mul(o),e).gt(ve)&&r.gt(ve)&&(r=r.add(new Ve.default(1))),{tokenAmount0:a,tokenAmount1:r};throw Error("roundDirection value error")}};var St=class{static tradingFee(t,e){return Wn(t,e,Bt)}static protocolFee(t,e){return $t(t,e,Bt)}static fundFee(t,e){return $t(t,e,Bt)}};var Kt=class{static validate_supply(t,e){if(t.isZero())throw Error("tokenAmount0 is zero");if(e.isZero())throw Error("tokenAmount1 is zero")}static swap(t,e,i,o){let s=St.tradingFee(t,o),a=t.sub(s),{destinationAmountSwapped:r}=It.swapWithoutFees(a,e,i);return{newSwapDestinationAmount:i.sub(r),sourceAmountSwapped:t,destinationAmountSwapped:r,tradeFee:s}}static swapBaseOut({poolMintA:t,poolMintB:e,tradeFeeRate:i,baseReserve:o,quoteReserve:s,outputMint:a,outputAmount:r}){let[d,g,A,l,b]=e.address===a.toString()?[o,s,t.decimals,e.decimals,t.address]:[s,o,e.decimals,t.decimals,e.address],c=new at.default(g.toString()).div(10**l).div(new at.default(d.toString()).div(10**A)),p=r.gte(g)?g.sub(new Ct.default(1)):r,P=g.sub(p),u=Ee(d.mul(p),P),h=Ee(u.mul(new Ct.default(1e6)),new Ct.default(1e6).sub(i)),w=h.sub(u),x=new at.default(p.toString()).div(10**l).div(new at.default(h.toString()).div(10**A)),m=c.isZero()?0:x.sub(c).div(c).abs().toNumber();return{amountRealOut:p,amountIn:h,amountInWithoutFee:u,tradeFee:w,priceImpact:m}}};var Q=_(require("bn.js")),ue=_(require("decimal.js"));var en=(...n)=>n.map(t=>{try{return typeof t=="object"?JSON.stringify(t):t}catch{return t}}).join(", "),We=class{constructor({scope:t,moduleName:e}){this.disabled=!1;this.scope=t,this.logger=ee(e)}createTxBuilder(t){return this.scope.checkOwner(),new st({connection:this.scope.connection,feePayer:t||this.scope.ownerPubKey,cluster:this.scope.cluster,owner:this.scope.owner,blockhashCommitment:this.scope.blockhashCommitment,loopMultiTxStatus:this.scope.loopMultiTxStatus,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}createSniperTxBuilder(t,e){let i=new Ae(t);return new st({connection:this.scope.connection,feePayer:e,cluster:this.scope.cluster,owner:i,blockhashCommitment:this.scope.blockhashCommitment,loopMultiTxStatus:this.scope.loopMultiTxStatus,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}logDebug(...t){this.logger.debug(en(t))}logInfo(...t){this.logger.info(en(t))}logAndCreateError(...t){let e=en(t);throw new Error(e)}checkDisabled(){(this.disabled||!this.scope)&&this.logAndCreateError("module not working")}};var Un=require("@solana/web3.js"),_e=_(require("bn.js"));var O=require("@solana/buffer-layout"),tn=O.Layout,_n=O.Structure;var nn=O.UInt;var qn=O.u8,Le=O.u16;var Te=O.s32;var Gn=O.seq;var re=O.blob;var qe=class extends tn{constructor(e,i,o){super(e,o);this.blob=re(e),this.signed=i}decode(e,i=0){let o=new _e.default(this.blob.decode(e,i),10,"le");return this.signed?o.fromTwos(this.span*8).clone():o}encode(e,i,o=0){return typeof e=="number"&&(e=new _e.default(e)),this.signed&&(e=e.toTwos(this.span*8)),this.blob.encode(e.toArrayLike(Buffer,"le",this.span),i,o)}};function Z(n){return new nn(1,n)}function he(n){return new nn(4,n)}function S(n){return new qe(8,!1,n)}function j(n){return new qe(16,!1,n)}function Xn(n){return new qe(8,!0,n)}function zn(n){return new qe(16,!0,n)}var Lt=class extends tn{constructor(e,i,o,s){super(e.span,s);this.layout=e,this.decoder=i,this.encoder=o}decode(e,i){return this.decoder(this.layout.decode(e,i))}encode(e,i,o){return this.layout.encode(this.encoder(e),i,o)}getSpan(e,i){return this.layout.getSpan(e,i)}};function E(n){return new Lt(re(32),t=>new Un.PublicKey(t),t=>t.toBuffer(),n)}function Re(n){return new Lt(qn(),qi,Gi,n)}function qi(n){if(n===0)return!1;if(n===1)return!0;throw new Error("Invalid bool: "+n)}function Gi(n){return n?1:0}var rn=class extends _n{decode(t,e){return super.decode(t,e)}};function G(n,t,e){return new rn(n,t,e)}function U(n,t,e){let i,o=typeof t=="number"?t:(0,_e.isBN)(t)?t.toNumber():new Proxy(t,{get(s,a){if(!i){let r=Reflect.get(s,"count");i=(0,_e.isBN)(r)?r.toNumber():r,Reflect.set(s,"count",i)}return Reflect.get(s,a)},set(s,a,r){return a==="count"&&(i=r),Reflect.set(s,a,r)}});return Gn(n,o,e)}var bc=G([he("mintAuthorityOption"),E("mintAuthority"),S("supply"),Z("decimals"),Z("isInitialized"),he("freezeAuthorityOption"),E("freezeAuthority")]);var Ui=require("@solana/web3.js"),Hn=require("@solana/spl-token");var Ne=o=>{var s=o,{address:n,programId:t,decimals:e}=s,i=ge(s,["address","programId","decimals"]);return V({chainId:101,address:je(n).toBase58(),programId:t,logoURI:"",symbol:"",name:"",decimals:e,tags:[],extensions:i.extensions||{}},i)},Ge=n=>n?X(V({},n),{transferFeeConfigAuthority:n.transferFeeConfigAuthority.toBase58(),withdrawWithheldAuthority:n.withdrawWithheldAuthority.toBase58(),withheldAmount:n.withheldAmount.toString(),olderTransferFee:X(V({},n.olderTransferFee),{epoch:n.olderTransferFee.epoch.toString(),maximumFee:n.olderTransferFee.maximumFee.toString()}),newerTransferFee:X(V({},n.newerTransferFee),{epoch:n.newerTransferFee.epoch.toString(),maximumFee:n.newerTransferFee.maximumFee.toString()})}):void 0;var te=require("@solana/web3.js"),oe=require("@solana/spl-token");var Xi=Buffer.from("vault_and_lp_mint_auth_seed","utf8"),Lc=Buffer.from("amm_config","utf8"),zi=Buffer.from("pool","utf8"),Hi=Buffer.from("pool_lp_mint","utf8"),Zi=Buffer.from("pool_vault","utf8"),ji=Buffer.from("observation","utf8");function Rt(n){return fe([Xi],n)}function on(n,t,e,i){return fe([zi,t.toBuffer(),e.toBuffer(),i.toBuffer()],n)}function Yi(n,t){return fe([Hi,t.toBuffer()],n)}function Zn(n,t,e){return fe([Zi,t.toBuffer(),e.toBuffer()],n)}function ct(n,t){return fe([ji,t.toBuffer()],n)}function jn({poolId:n,programId:t,configId:e,mintA:i,mintB:o}){let s=Rt(t).publicKey,a=n||on(t,e,i,o).publicKey,r=Yi(t,a).publicKey,d=Zn(t,a,i).publicKey,g=Zn(t,a,o).publicKey,A=ct(t,a).publicKey;return{poolId:a,configId:e,authority:s,lpMint:r,vaultA:d,vaultB:g,observationId:A}}var Qi=Buffer.from("locked_liquidity","utf8");function ut(n,t){return fe([Qi,t.toBuffer()],n)}var xr=require("@solana/web3.js"),Ir=_(require("bn.js")),Sr=_(require("decimal.js"));var Ft=require("@solana/spl-token");var Ot=require("@solana/web3.js"),Br=_(require("bn.js"));var pn=require("@solana/spl-token");var dr=_(require("bn.js")),pr=_(require("decimal.js"));var ce=_(require("bn.js")),sn=new ce.default(0),Yn=new ce.default(1),Qn=new ce.default(-1),Nt=new ce.default(1).shln(64),Jn=new ce.default(1).shln(128),Ji=Nt.sub(Yn);var $i=Jn.subn(1),Ue=-443636,lt=-Ue,an=new ce.default("4295048016"),cn=new ce.default("79226673521066979257578248091"),Nc=new ce.default("4295048017"),Mc=new ce.default("79226673521066979257578248090");var er=new ce.default(10).pow(new ce.default(6));var Oc=new ce.default("18446744073700000000");var lr=_(require("bn.js")),mr=_(require("decimal.js"));var _c=Buffer.from("amm_config","utf8"),qc=Buffer.from("pool","utf8"),Gc=Buffer.from("pool_vault","utf8"),Uc=Buffer.from("pool_reward_vault","utf8"),Xc=Buffer.from("position","utf8"),zc=Buffer.from("tick_array","utf8"),Hc=Buffer.from("operation","utf8"),Zc=Buffer.from("pool_tick_array_bitmap_extension","utf8"),jc=Buffer.from("observation","utf8");function un(n){return fe([Buffer.from("metadata","utf8"),Fe.toBuffer(),n.toBuffer()],Fe)}var Yc=Buffer.from("locked_position","utf8");var Qc=Buffer.from("support_mint","utf8");var or=require("@solana/web3.js"),sr=require("@solana/spl-token"),ar=_(require("bn.js")),cr=_(require("decimal.js"));var tr=_(require("bn.js")),nr=_(require("decimal.js"));var dn=14;var Mt=60;var fr=G([re(8),Z("bump"),Le("index"),E(""),he("protocolFeeRate"),he("tradeFeeRate"),Le("tickSpacing"),U(S(),8,"")]),br=G([he("blockTimestamp"),Xn("tickCumulative"),U(S(),4)]),ai=G([re(8),Re("initialized"),S("recentEpoch"),Le("observationIndex"),E("poolId"),U(br,100,"observations"),U(S(),4)]),yr=G([Z("rewardState"),S("openTime"),S("endTime"),S("lastUpdateTime"),j("emissionsPerSecondX64"),S("rewardTotalEmissioned"),S("rewardClaimed"),E("tokenMint"),E("tokenVault"),E("creator"),j("rewardGrowthGlobalX64")]),ri=G([re(8),Z("bump"),E("ammConfig"),E("creator"),E("mintA"),E("mintB"),E("vaultA"),E("vaultB"),E("observationId"),Z("mintDecimalsA"),Z("mintDecimalsB"),Le("tickSpacing"),j("liquidity"),j("sqrtPriceX64"),Te("tickCurrent"),he(),j("feeGrowthGlobalX64A"),j("feeGrowthGlobalX64B"),S("protocolFeesTokenA"),S("protocolFeesTokenB"),j("swapInAmountTokenA"),j("swapOutAmountTokenB"),j("swapInAmountTokenB"),j("swapOutAmountTokenA"),Z("status"),U(Z(),7,""),U(yr,3,"rewardInfos"),U(S(),16,"tickArrayBitmap"),S("totalFeesTokenA"),S("totalFeesClaimedTokenA"),S("totalFeesTokenB"),S("totalFeesClaimedTokenB"),S("fundFeesTokenA"),S("fundFeesTokenB"),S("startTime"),U(S(),15*4-3,"padding")]),gr=G([j("growthInsideLastX64"),S("rewardAmountOwed")]),oi=G([re(8),Z("bump"),E("nftMint"),E("poolId"),Te("tickLower"),Te("tickUpper"),j("liquidity"),j("feeGrowthInsideLastX64A"),j("feeGrowthInsideLastX64B"),S("tokenFeesOwedA"),S("tokenFeesOwedB"),U(gr,3,"rewardInfos"),U(S(),8,"")]),ll=G([re(8),Z("bump"),E("poolId"),Te("tickLowerIndex"),Te("tickUpperIndex"),j("liquidity"),j("feeGrowthInsideLastX64A"),j("feeGrowthInsideLastX64B"),S("tokenFeesOwedA"),S("tokenFeesOwedB"),U(j(),3,"rewardGrowthInside"),U(S(),8,"")]),Pr=G([Te("tick"),zn("liquidityNet"),j("liquidityGross"),j("feeGrowthOutsideX64A"),j("feeGrowthOutsideX64B"),U(j(),3,"rewardGrowthsOutsideX64"),U(he(),13,"")]),ti=G([re(8),E("poolId"),Te("startTickIndex"),U(Pr,Mt,"ticks"),Z("initializedTickCount"),U(Z(),115,"")]),Ar=G([re(329),U(E(),100,"whitelistMints")]),ur=G([re(8),E("poolId"),U(U(S(),8),dn,"positiveTickArrayBitmap"),U(U(S(),8),dn,"negativeTickArrayBitmap")]),ml=G([S(),Z("bump"),E("owner"),E("poolId"),E("positionId"),E("nftAccount"),U(S(),8)]),wr=G([re(8),Z("bump"),E("lockOwner"),E("poolId"),E("positionId"),E("nftAccount"),E("lockNftMint"),S("recentEpoch"),U(S(),8)]);ai.span;var Kl=ee("Raydium_Clmm");var Cr=ee("Raydium_cpmm"),Me={initialize:[175,175,109,31,13,152,155,237],deposit:[242,35,198,137,82,225,242,182],withdraw:[183,18,70,156,148,109,161,34],swapBaseInput:[143,190,90,218,196,30,51,222],swapBaseOutput:[55,217,98,86,163,74,180,173],lockCpLiquidity:[216,157,29,78,38,51,31,26],collectCpFee:[8,30,51,199,209,184,247,133]};function ci(n,t,e,i,o,s,a,r,d,g,A,l,b,c,p,P,u,h,w,x){let m=G([S("amountMaxA"),S("amountMaxB"),S("openTime")]),f=on(n,e,s,a).publicKey,y=[{pubkey:t,isSigner:!0,isWritable:!1},{pubkey:e,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!o.equals(f),isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:g,isSigner:!1,isWritable:!0},{pubkey:A,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:b,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:oe.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:p,isSigner:!1,isWritable:!1},{pubkey:P,isSigner:!1,isWritable:!1},{pubkey:oe.ASSOCIATED_TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:hn,isSigner:!1,isWritable:!1},{pubkey:bt,isSigner:!1,isWritable:!1}],B=Buffer.alloc(m.span);return m.encode({amountMaxA:h,amountMaxB:w,openTime:x},B),new te.TransactionInstruction({keys:y,programId:n,data:Buffer.from([...Me.initialize,...B])})}function ui(n,t,e,i,o,s,a,r,d,g,A,l,b,c,p){let P=G([S("lpAmount"),S("amountMaxA"),S("amountMaxB")]),u=[{pubkey:t,isSigner:!0,isWritable:!1},{pubkey:e,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:oe.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:oe.TOKEN_2022_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:g,isSigner:!1,isWritable:!1},{pubkey:A,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!0}],h=Buffer.alloc(P.span);return Cr.debug("cpmm deposit data",{lpAmount:b.toString(),amountMaxA:c.toString(),amountMaxB:p.toString()}),P.encode({lpAmount:b,amountMaxA:c,amountMaxB:p},h),new te.TransactionInstruction({keys:u,programId:n,data:Buffer.from([...Me.deposit,...h])})}function li(n,t,e,i,o,s,a,r,d,g,A,l,b,c,p){let P=G([S("lpAmount"),S("amountMinA"),S("amountMinB")]),u=[{pubkey:t,isSigner:!0,isWritable:!1},{pubkey:e,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:oe.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:oe.TOKEN_2022_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:g,isSigner:!1,isWritable:!1},{pubkey:A,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:ft,isSigner:!1,isWritable:!1}],h=Buffer.alloc(P.span);return P.encode({lpAmount:b,amountMinA:c,amountMinB:p},h),new te.TransactionInstruction({keys:u,programId:n,data:Buffer.from([...Me.withdraw,...h])})}function mi(n,t,e,i,o,s,a,r,d,g,A,l,b,c,p,P){let u=G([S("amountIn"),S("amounOutMin")]),h=[{pubkey:t,isSigner:!0,isWritable:!1},{pubkey:e,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:g,isSigner:!1,isWritable:!1},{pubkey:A,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:b,isSigner:!1,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!0}],w=Buffer.alloc(u.span);return u.encode({amountIn:p,amounOutMin:P},w),new te.TransactionInstruction({keys:h,programId:n,data:Buffer.from([...Me.swapBaseInput,...w])})}function di(n,t,e,i,o,s,a,r,d,g,A,l,b,c,p,P){let u=G([S("amountInMax"),S("amountOut")]),h=[{pubkey:t,isSigner:!0,isWritable:!1},{pubkey:e,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:g,isSigner:!1,isWritable:!1},{pubkey:A,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:b,isSigner:!1,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!0}],w=Buffer.alloc(u.span);return u.encode({amountInMax:p,amountOut:P},w),new te.TransactionInstruction({keys:h,programId:n,data:Buffer.from([...Me.swapBaseOutput,...w])})}async function pi(n){var u;let{ownerInfo:t,poolInfo:e,poolKeys:i,feeNftOwner:o,getEphemeralSigners:s}=n,a=[],[r,d]=[new te.PublicKey(e.id),new te.PublicKey(e.lpMint.address)],g;if(s)g=new te.PublicKey((await s(1))[0]);else{let h=te.Keypair.generate();a.push(h),g=h.publicKey}let{publicKey:A}=de(o,g,oe.TOKEN_PROGRAM_ID),{publicKey:l}=un(g),{publicKey:b}=ut(n.lockProgram,g),{publicKey:c}=de(t.wallet,d,oe.TOKEN_PROGRAM_ID),{publicKey:p}=de(n.lockAuthProgram,d,oe.TOKEN_PROGRAM_ID),P=Kr({programId:n.lockProgram,auth:n.lockAuthProgram,payer:t.feePayer,liquidityOwner:t.wallet,nftOwner:o,nftMint:g,nftAccount:A,poolId:r,lockPda:b,mintLp:d,userLpVault:c,lockLpVault:p,poolVaultA:new te.PublicKey(i.vault.A),poolVaultB:new te.PublicKey(i.vault.B),metadataAccount:l,lpAmount:n.lpAmount,withMetadata:(u=n.withMetadata)!=null?u:!0});return{address:{nftMint:g,nftAccount:A,metadataAccount:l,lockPda:b,userLpVault:c,lockLpVault:p},instructions:[P],signers:a,instructionTypes:[ne.CpmmLockLp],lookupTableAddress:[]}}function Kr({programId:n,auth:t,payer:e,liquidityOwner:i,nftOwner:o,nftMint:s,nftAccount:a,poolId:r,lockPda:d,mintLp:g,userLpVault:A,lockLpVault:l,poolVaultA:b,poolVaultB:c,metadataAccount:p,lpAmount:P,withMetadata:u}){let h=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:i,isSigner:!0,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!0,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:g,isSigner:!1,isWritable:!1},{pubkey:A,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:b,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:bt,isSigner:!1,isWritable:!1},{pubkey:te.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:oe.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:oe.ASSOCIATED_TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:Fe,isSigner:!1,isWritable:!1}],w=G([S("lpAmount"),Re("withMetadata")]),x=Buffer.alloc(w.span);w.encode({lpAmount:P,withMetadata:u},x);let m=Buffer.from([...Me.lockCpLiquidity,...x]);return new te.TransactionInstruction({keys:h,programId:n,data:m})}function fn({programId:n,nftOwner:t,auth:e,nftAccount:i,lockPda:o,poolId:s,mintLp:a,userVaultA:r,userVaultB:d,poolVaultA:g,poolVaultB:A,mintA:l,mintB:b,lockLpVault:c,lpFeeAmount:p,cpmmProgram:P,cpmmAuthProgram:u}){let h=[{pubkey:e,isSigner:!1,isWritable:!1},{pubkey:t,isSigner:!0,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:P!=null?P:On,isSigner:!1,isWritable:!1},{pubkey:u!=null?u:Fn,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:g,isSigner:!1,isWritable:!0},{pubkey:A,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:b,isSigner:!1,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:oe.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:oe.TOKEN_2022_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:ft,isSigner:!1,isWritable:!1}],w=G([S("lpFeeAmount")]),x=Buffer.alloc(w.span);w.encode({lpFeeAmount:p},x);let m=Buffer.from([...Me.collectCpFee,...x]);return new te.TransactionInstruction({keys:h,programId:n,data:m})}var fi=G([re(8),Z("bump"),Re("disableCreatePool"),Le("index"),S("tradeFeeRate"),S("protocolFeeRate"),S("fundFeeRate"),S("createPoolFee"),E("protocolOwner"),E("fundOwner"),U(S(),16)]),bi=G([re(8),E("configId"),E("poolCreator"),E("vaultA"),E("vaultB"),E("mintLp"),E("mintA"),E("mintB"),E("mintProgramA"),E("mintProgramB"),E("observationId"),Z("bump"),Z("status"),Z("lpDecimals"),Z("mintDecimalA"),Z("mintDecimalB"),S("lpAmount"),S("protocolFeesMintA"),S("protocolFeesMintB"),S("fundFeesMintA"),S("fundFeesMintB"),S("openTime"),U(S(),32)]);var Et=class extends We{constructor(t){super(t)}async load(){this.checkDisabled()}async getCpmmPoolKeys(t){return(await this.scope.api.fetchPoolKeysById({idList:[t]}))[0]}async getRpcPoolInfo(t,e){return(await this.getRpcPoolInfos([t],e))[t]}async getRpcPoolInfos(t,e){let i=await Ce(this.scope.connection,t.map(l=>({pubkey:new T.PublicKey(l)}))),o={},s=new Set,a=[];for(let l=0;l<t.length;l++){let b=i[l];if(b.accountInfo===null)throw Error("fetch pool info error: "+String(t[l]));let c=bi.decode(b.accountInfo.data);o[String(t[l])]=X(V({},c),{programId:b.accountInfo.owner}),s.add(String(c.configId)),a.push(c.vaultA,c.vaultB)}let r={};if(e){let l=[...s],b=await Ce(this.scope.connection,l.map(c=>({pubkey:new T.PublicKey(c)})));for(let c=0;c<l.length;c++){let p=b[c].accountInfo;if(p===null)throw Error("fetch pool config error: "+l[c]);r[l[c]]=fi.decode(p.data)}}let d={},g=await Ce(this.scope.connection,a.map(l=>({pubkey:new T.PublicKey(l)})));for(let l=0;l<a.length;l++){let b=g[l].accountInfo;if(b===null)throw Error("fetch vault info error: "+a[l]);d[String(a[l])]=new Q.default(Y.AccountLayout.decode(b.data).amount.toString())}let A={};for(let[l,b]of Object.entries(o)){let c=d[b.vaultA.toString()].sub(b.protocolFeesMintA).sub(b.fundFeesMintA),p=d[b.vaultB.toString()].sub(b.protocolFeesMintB).sub(b.fundFeesMintB);A[l]=X(V({},b),{baseReserve:c,quoteReserve:p,vaultAAmount:d[b.vaultA.toString()],vaultBAmount:d[b.vaultB.toString()],configInfo:r[b.configId.toString()],poolPrice:new ue.default(p.toString()).div(new ue.default(10).pow(b.mintDecimalB)).div(new ue.default(c.toString()).div(new ue.default(10).pow(b.mintDecimalA)))})}return A}toComputePoolInfos({pools:t,mintInfos:e}){return Object.keys(t).reduce((i,o)=>{var d,g,A,l;let s=t[o],[a,r]=[s.mintA.toBase58(),s.mintB.toBase58()];return X(V({},i),{[o]:X(V({},s),{id:new T.PublicKey(o),configInfo:s.configInfo,version:7,authority:Rt(s.programId).publicKey,mintA:Ne({address:a,decimals:s.mintDecimalA,programId:s.mintProgramA.toBase58(),extensions:{feeConfig:(d=e[a])!=null&&d.feeConfig?Ge((g=e[a])==null?void 0:g.feeConfig):void 0}}),mintB:Ne({address:r,decimals:s.mintDecimalB,programId:s.mintProgramB.toBase58(),extensions:{feeConfig:(A=e[r])!=null&&A.feeConfig?Ge((l=e[r])==null?void 0:l.feeConfig):void 0}})})})},{})}async getPoolInfoFromRpc(t){let e=await this.getRpcPoolInfo(t,!0),i=await Gt({connection:this.scope.connection,mints:[e.mintA,e.mintB]}),o=Ne({address:e.mintA.toBase58(),decimals:e.mintDecimalA,programId:e.mintProgramA.toBase58(),extensions:{feeConfig:i[e.mintA.toBase58()].feeConfig?Ge(i[e.mintA.toBase58()].feeConfig):void 0}}),s=Ne({address:e.mintB.toBase58(),decimals:e.mintDecimalB,programId:e.mintProgramB.toBase58(),extensions:{feeConfig:i[e.mintB.toBase58()].feeConfig?Ge(i[e.mintB.toBase58()].feeConfig):void 0}}),a=Ne({address:e.mintLp.toBase58(),decimals:e.lpDecimals,programId:Y.TOKEN_PROGRAM_ID.toBase58()}),r={id:e.configId.toBase58(),index:e.configInfo.index,protocolFeeRate:e.configInfo.protocolFeeRate.toNumber(),tradeFeeRate:e.configInfo.tradeFeeRate.toNumber(),fundFeeRate:e.configInfo.fundFeeRate.toNumber(),createPoolFee:e.configInfo.createPoolFee.toString()},d={volume:0,volumeQuote:0,volumeFee:0,apr:0,feeApr:0,priceMin:0,priceMax:0,rewardApr:[]};return{poolInfo:{programId:e.programId.toBase58(),id:t,type:"Standard",lpMint:a,lpPrice:0,lpAmount:e.lpAmount.toNumber(),config:r,mintA:o,mintB:s,rewardDefaultInfos:[],rewardDefaultPoolInfos:"Ecosystem",price:e.poolPrice.toNumber(),mintAmountA:new ue.default(e.vaultAAmount.toString()).div(10**o.decimals).toNumber(),mintAmountB:new ue.default(e.vaultBAmount.toString()).div(10**s.decimals).toNumber(),feeRate:e.configInfo.tradeFeeRate.toNumber(),openTime:e.openTime.toString(),tvl:0,burnPercent:0,day:d,week:d,month:d,pooltype:[],farmUpcomingCount:0,farmOngoingCount:0,farmFinishedCount:0},poolKeys:{programId:e.programId.toBase58(),id:t,mintA:o,mintB:s,openTime:e.openTime.toString(),vault:{A:e.vaultA.toBase58(),B:e.vaultB.toBase58()},authority:Rt(e.programId).publicKey.toBase58(),mintLp:a,config:r,observationId:ct(e.programId,new T.PublicKey(t)).publicKey.toBase58()},rpcData:e}}async createPool(p){var P=p,{poolId:t,programId:e,poolFeeAccount:i,startTime:o,ownerInfo:s,associatedOnly:a=!1,checkCreateATAOwner:r=!1,txVersion:d,feeConfig:g,computeBudgetConfig:A,txTipConfig:l,feePayer:b}=P,c=ge(P,["poolId","programId","poolFeeAccount","startTime","ownerInfo","associatedOnly","checkCreateATAOwner","txVersion","feeConfig","computeBudgetConfig","txTipConfig","feePayer"]);var W,H,$;let u=s.feePayer||((W=this.scope.owner)==null?void 0:W.publicKey),h=new Q.default(new T.PublicKey(c.mintA.address).toBuffer()).lte(new Q.default(new T.PublicKey(c.mintB.address).toBuffer())),[w,x]=h?[c.mintA,c.mintB]:[c.mintB,c.mintA],[m,f]=h?[c.mintAAmount,c.mintBAmount]:[c.mintBAmount,c.mintAAmount],y=s.useSOLBalance&&w.address===Y.NATIVE_MINT.toBase58(),B=s.useSOLBalance&&x.address===Y.NATIVE_MINT.toBase58(),[k,K]=[new T.PublicKey(w.address),new T.PublicKey(x.address)],L=this.createTxBuilder(b),{account:C,instructionParams:I}=await this.scope.account.getOrCreateTokenAccount({mint:k,tokenProgram:w.programId,owner:this.scope.ownerPubKey,createInfo:y?{payer:u,amount:m}:void 0,notUseTokenAccount:y,skipCloseAccount:!y,associatedOnly:y?!1:a,checkCreateATAOwner:r});L.addInstruction(I||{});let{account:M,instructionParams:F}=await this.scope.account.getOrCreateTokenAccount({mint:new T.PublicKey(x.address),tokenProgram:x.programId,owner:this.scope.ownerPubKey,createInfo:B?{payer:u,amount:f}:void 0,notUseTokenAccount:B,skipCloseAccount:!B,associatedOnly:B?!1:a,checkCreateATAOwner:r});if(L.addInstruction(F||{}),C===void 0||M===void 0)throw Error("you don't has some token account");let v=jn({poolId:t,programId:e,configId:new T.PublicKey(g.id),mintA:k,mintB:K});return L.addInstruction({instructions:[ci(e,this.scope.ownerPubKey,new T.PublicKey(g.id),v.authority,v.poolId,k,K,v.lpMint,C,M,de(this.scope.ownerPubKey,v.lpMint).publicKey,v.vaultA,v.vaultB,i,new T.PublicKey((H=w.programId)!=null?H:Y.TOKEN_PROGRAM_ID),new T.PublicKey(($=x.programId)!=null?$:Y.TOKEN_PROGRAM_ID),v.observationId,m,f,o)],instructionTypes:[ne.CpmmCreatePool]}),L.addCustomComputeBudget(A),L.addTipInstruction(l),L.versionBuild({txVersion:d,extInfo:{address:X(V({},v),{mintA:w,mintB:x,programId:e,poolFeeAccount:i,feeConfig:g})}})}async addLiquidity(t){let{poolInfo:e,poolKeys:i,inputAmount:o,baseIn:s,slippage:a,computeResult:r,computeBudgetConfig:d,txTipConfig:g,config:A,txVersion:l,feePayer:b}=t;this.scope.availability.addStandardPosition===!1&&this.logAndCreateError("add liquidity feature disabled in your region"),o.isZero()&&this.logAndCreateError("amounts must greater than zero","amountInA",{amountInA:o.toString()});let{account:c}=this.scope,{bypassAssociatedCheck:p,checkCreateATAOwner:P}=V({bypassAssociatedCheck:!1,checkCreateATAOwner:!1},A),u=r?void 0:await this.getRpcPoolInfo(e.id),{liquidity:h,inputAmountFee:w,anotherAmount:x}=r||this.computePairAmount({poolInfo:X(V({},e),{lpAmount:new ue.default(u.lpAmount.toString()).div(10**e.lpMint.decimals).toNumber()}),baseReserve:u.baseReserve,quoteReserve:u.quoteReserve,slippage:new me(0),baseIn:s,epochInfo:await this.scope.fetchEpochInfo(),amount:new ue.default(o.toString()).div(10**(s?e.mintA.decimals:e.mintB.decimals))}),m=x.amount,f=e.mintA.address===Y.NATIVE_MINT.toString(),y=e.mintB.address===Y.NATIVE_MINT.toString(),B=this.createTxBuilder(b),[k,K]=[new T.PublicKey(e.mintA.address),new T.PublicKey(e.mintB.address)],{account:L,instructionParams:C}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:e.mintA.programId,mint:new T.PublicKey(e.mintA.address),owner:this.scope.ownerPubKey,createInfo:f||(s?o:m).isZero()?{payer:this.scope.ownerPubKey,amount:s?o:m}:void 0,skipCloseAccount:!f,notUseTokenAccount:f,associatedOnly:!1,checkCreateATAOwner:P});B.addInstruction(C||{});let{account:I,instructionParams:M}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:e.mintB.programId,mint:new T.PublicKey(e.mintB.address),owner:this.scope.ownerPubKey,createInfo:y||(s?m:o).isZero()?{payer:this.scope.ownerPubKey,amount:s?m:o}:void 0,skipCloseAccount:!y,notUseTokenAccount:y,associatedOnly:!1,checkCreateATAOwner:P});B.addInstruction(M||{}),!L&&!I&&this.logAndCreateError("cannot found target token accounts","tokenAccounts",c.tokenAccounts);let F=await c.getCreatedTokenAccount({mint:new T.PublicKey(e.lpMint.address)}),le=await c.handleTokenAccount({side:"out",amount:0,mint:new T.PublicKey(e.lpMint.address),tokenAccount:F,bypassAssociatedCheck:p,checkCreateATAOwner:P}),{tokenAccount:v}=le,W=ge(le,["tokenAccount"]);B.addInstruction(W);let H=i!=null?i:await this.getCpmmPoolKeys(e.id),$=new me(new Q.default(1)).sub(a);return B.addInstruction({instructions:[ui(new T.PublicKey(e.programId),this.scope.ownerPubKey,new T.PublicKey(H.authority),new T.PublicKey(e.id),v,L,I,new T.PublicKey(H.vault.A),new T.PublicKey(H.vault.B),k,K,new T.PublicKey(e.lpMint.address),r?r==null?void 0:r.liquidity:$.mul(h).quotient,s?w.amount:m,s?m:w.amount)],instructionTypes:[ne.CpmmAddLiquidity],lookupTableAddress:H.lookupTableAccount?[H.lookupTableAccount]:[]}),B.addCustomComputeBudget(d),B.addTipInstruction(g),B.versionBuild({txVersion:l})}async withdrawLiquidity(t){var W,H;let{poolInfo:e,poolKeys:i,lpAmount:o,slippage:s,computeBudgetConfig:a,txTipConfig:r,txVersion:d,feePayer:g,closeWsol:A=!0}=t;this.scope.availability.addStandardPosition===!1&&this.logAndCreateError("add liquidity feature disabled in your region");let l=new me(new Q.default(1)).sub(s),b=await this.getRpcPoolInfo(e.id),[c,p]=[l.mul(o.mul(b.baseReserve).div(b.lpAmount)).quotient,l.mul(o.mul(b.quoteReserve).div(b.lpAmount)).quotient],P=await this.scope.fetchEpochInfo(),[u,h]=[we(c,e.mintA.extensions.feeConfig,P,!1),we(p,e.mintB.extensions.feeConfig,P,!1)],{account:w}=this.scope,x=this.createTxBuilder(g),[m,f]=[new T.PublicKey(e.mintA.address),new T.PublicKey(e.mintB.address)],y=m.equals(ae),B=f.equals(ae),k,K,{account:L,instructionParams:C}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:e.mintA.programId,mint:new T.PublicKey(e.mintA.address),notUseTokenAccount:y,owner:this.scope.ownerPubKey,createInfo:{payer:this.scope.ownerPubKey,amount:0},skipCloseAccount:!(y&&A),associatedOnly:!y,checkCreateATAOwner:!1});k=L,C&&x.addInstruction(C);let{account:I,instructionParams:M}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:e.mintB.programId,mint:new T.PublicKey(e.mintB.address),notUseTokenAccount:B,owner:this.scope.ownerPubKey,createInfo:{payer:this.scope.ownerPubKey,amount:0},skipCloseAccount:!(B&&A),associatedOnly:!B,checkCreateATAOwner:!1});K=I,M&&x.addInstruction(M),(!k||!K)&&this.logAndCreateError("cannot found target token accounts","tokenAccounts",w.tokenAccounts);let F=await w.getCreatedTokenAccount({mint:new T.PublicKey(e.lpMint.address)});F||this.logAndCreateError("cannot found lp token account","tokenAccounts",w.tokenAccounts);let v=i!=null?i:await this.getCpmmPoolKeys(e.id);return x.addInstruction({instructions:[li(new T.PublicKey(e.programId),this.scope.ownerPubKey,new T.PublicKey(v.authority),new T.PublicKey(e.id),F,k,K,new T.PublicKey(v.vault.A),new T.PublicKey(v.vault.B),m,f,new T.PublicKey(e.lpMint.address),o,c.sub((W=u.fee)!=null?W:new Q.default(0)),p.sub((H=h.fee)!=null?H:new Q.default(0)))],instructionTypes:[ne.CpmmWithdrawLiquidity],lookupTableAddress:v.lookupTableAccount?[v.lookupTableAccount]:[]}),x.addCustomComputeBudget(a),x.addTipInstruction(r),x.versionBuild({txVersion:d})}async swap(t){var C,I,M,F,v,W;let{poolInfo:e,poolKeys:i,baseIn:o,fixedOut:s,inputAmount:a,swapResult:r,slippage:d=0,config:g,computeBudgetConfig:A,txTipConfig:l,txVersion:b,feePayer:c}=t,{bypassAssociatedCheck:p,checkCreateATAOwner:P,associatedOnly:u}=V({bypassAssociatedCheck:!1,checkCreateATAOwner:!1,associatedOnly:!0},g),h=this.createTxBuilder(c),[w,x]=[new T.PublicKey(e.mintA.address),new T.PublicKey(e.mintB.address)];s?r.sourceAmountSwapped=r.sourceAmountSwapped.mul(new Q.default((1+d)*1e4)).div(new Q.default(1e4)):r.destinationAmountSwapped=r.destinationAmountSwapped.mul(new Q.default((1-d)*1e4)).div(new Q.default(1e4));let m=e.mintA.address===ae.toBase58(),f=e.mintB.address===ae.toBase58(),{account:y,instructionParams:B}=await this.scope.account.getOrCreateTokenAccount({mint:w,tokenProgram:new T.PublicKey((C=e.mintA.programId)!=null?C:Y.TOKEN_PROGRAM_ID),owner:this.scope.ownerPubKey,createInfo:m||!o?{payer:this.scope.ownerPubKey,amount:o?r.sourceAmountSwapped:0}:void 0,notUseTokenAccount:m,skipCloseAccount:!m,associatedOnly:m?!1:u,checkCreateATAOwner:P});B&&h.addInstruction(B);let{account:k,instructionParams:K}=await this.scope.account.getOrCreateTokenAccount({mint:x,tokenProgram:new T.PublicKey((I=e.mintB.programId)!=null?I:Y.TOKEN_PROGRAM_ID),owner:this.scope.ownerPubKey,createInfo:f||o?{payer:this.scope.ownerPubKey,amount:o?0:r.sourceAmountSwapped}:void 0,notUseTokenAccount:f,skipCloseAccount:!f,associatedOnly:f?!1:u,checkCreateATAOwner:P});K&&h.addInstruction(K),(!y||!k)&&this.logAndCreateError("user do not have token account",{mintA:e.mintA.symbol||e.mintA.address,mintB:e.mintB.symbol||e.mintB.address,mintATokenAcc:y,mintBTokenAcc:k,mintAUseSOLBalance:m,mintBUseSOLBalance:f,associatedOnly:u});let L=i!=null?i:await this.getCpmmPoolKeys(e.id);return h.addInstruction({instructions:[s?di(new T.PublicKey(e.programId),this.scope.ownerPubKey,new T.PublicKey(L.authority),new T.PublicKey(L.config.id),new T.PublicKey(e.id),o?y:k,o?k:y,new T.PublicKey(L.vault[o?"A":"B"]),new T.PublicKey(L.vault[o?"B":"A"]),new T.PublicKey((v=e[o?"mintA":"mintB"].programId)!=null?v:Y.TOKEN_PROGRAM_ID),new T.PublicKey((W=e[o?"mintB":"mintA"].programId)!=null?W:Y.TOKEN_PROGRAM_ID),o?w:x,o?x:w,ct(new T.PublicKey(e.programId),new T.PublicKey(e.id)).publicKey,r.sourceAmountSwapped,r.destinationAmountSwapped):mi(new T.PublicKey(e.programId),this.scope.ownerPubKey,new T.PublicKey(L.authority),new T.PublicKey(L.config.id),new T.PublicKey(e.id),o?y:k,o?k:y,new T.PublicKey(L.vault[o?"A":"B"]),new T.PublicKey(L.vault[o?"B":"A"]),new T.PublicKey((M=e[o?"mintA":"mintB"].programId)!=null?M:Y.TOKEN_PROGRAM_ID),new T.PublicKey((F=e[o?"mintB":"mintA"].programId)!=null?F:Y.TOKEN_PROGRAM_ID),o?w:x,o?x:w,ct(new T.PublicKey(e.programId),new T.PublicKey(e.id)).publicKey,a,r.destinationAmountSwapped)],instructionTypes:[s?ne.CpmmSwapBaseOut:ne.ClmmSwapBaseIn]}),h.addCustomComputeBudget(A),h.addTipInstruction(l),h.versionBuild({txVersion:b})}async lockLp(t){var b,c,p,P,u;let{poolInfo:e,lpAmount:i,computeBudgetConfig:o,txTipConfig:s,txVersion:a,feePayer:r,feeNftOwner:d}=t;i.isZero()&&this.logAndCreateError("lpAmount must greater than zero",{lpAmount:i.toString()});let g=this.createTxBuilder(r),A=(b=t.poolKeys)!=null?b:await this.getCpmmPoolKeys(e.id),l=await pi({poolInfo:e,poolKeys:A,ownerInfo:{wallet:this.scope.ownerPubKey,feePayer:(c=t.feePayer)!=null?c:this.scope.ownerPubKey},feeNftOwner:d!=null?d:this.scope.ownerPubKey,lockProgram:(p=t.programId)!=null?p:wt,lockAuthProgram:(P=t.authProgram)!=null?P:kt,lpAmount:i,withMetadata:(u=t.withMetadata)!=null?u:!0,getEphemeralSigners:t.getEphemeralSigners});return g.addInstruction(l),g.addCustomComputeBudget(o),g.addTipInstruction(s),g.versionBuild({txVersion:a,extInfo:l.address})}async harvestLockLp(t){var I;let{poolInfo:e,lpFeeAmount:i,nftMint:o,programId:s=wt,authProgram:a=kt,cpmmProgram:r,computeBudgetConfig:d,txTipConfig:g,txVersion:A,closeWsol:l=!0}=t;i.isZero()&&this.logAndCreateError("lpFeeAmount must greater than zero",{lpAmount:i.toString()});let b=t.feePayer||this.scope.ownerPubKey,c=this.createTxBuilder(b),[p,P]=[new T.PublicKey(e.mintA.address),new T.PublicKey(e.mintB.address)],u=p.equals(ae),h=P.equals(ae),w,x,{account:m,instructionParams:f}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:e.mintA.programId,mint:new T.PublicKey(e.mintA.address),notUseTokenAccount:u,owner:this.scope.ownerPubKey,createInfo:{payer:this.scope.ownerPubKey,amount:0},skipCloseAccount:!(u&&l),associatedOnly:!u,checkCreateATAOwner:!1});w=m,f&&c.addInstruction(f);let{account:y,instructionParams:B}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:e.mintB.programId,mint:new T.PublicKey(e.mintB.address),notUseTokenAccount:h,owner:this.scope.ownerPubKey,createInfo:{payer:this.scope.ownerPubKey,amount:0},skipCloseAccount:!(h&&l),associatedOnly:!h,checkCreateATAOwner:!1});x=y,B&&c.addInstruction(B),(!w||!x)&&this.logAndCreateError("cannot found target token accounts",{tokenAccountA:w,tokenAccountB:x});let k=(I=t.poolKeys)!=null?I:await this.getCpmmPoolKeys(e.id),{publicKey:K}=de(b,o,Y.TOKEN_PROGRAM_ID),{publicKey:L}=ut(s,o),{publicKey:C}=de(a,new T.PublicKey(e.lpMint.address),Y.TOKEN_PROGRAM_ID);return c.addInstruction({instructions:[fn({programId:s,nftOwner:this.scope.ownerPubKey,auth:a,nftMint:o,nftAccount:K,lockPda:L,poolId:new T.PublicKey(e.id),mintLp:new T.PublicKey(k.mintLp.address),userVaultA:w,userVaultB:x,poolVaultA:new T.PublicKey(k.vault.A),poolVaultB:new T.PublicKey(k.vault.B),mintA:p,mintB:P,lockLpVault:C,lpFeeAmount:i,cpmmProgram:r==null?void 0:r.programId,cpmmAuthProgram:r==null?void 0:r.authProgram})],instructionTypes:[ne.CpmmCollectLockFee]}),c.addCustomComputeBudget(d),c.addTipInstruction(g),c.versionBuild({txVersion:A})}async harvestMultiLockLp(t){let{lockInfo:e,programId:i=wt,authProgram:o=kt,cpmmProgram:s,computeBudgetConfig:a,txVersion:r,closeWsol:d=!0}=t,g=t.feePayer||this.scope.ownerPubKey,A=this.createTxBuilder(g),l={};return e.forEach(async b=>{var L;let{poolInfo:c,lpFeeAmount:p,nftMint:P}=b;if(p.isZero())return;let[u,h]=[new T.PublicKey(c.mintA.address),new T.PublicKey(c.mintB.address)],w=u.equals(ae),x=h.equals(ae),m=l[c.mintA.address],f=l[c.mintB.address];if(!m)if(w){let{account:C,instructionParams:I}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:c.mintA.programId,mint:new T.PublicKey(c.mintA.address),notUseTokenAccount:!0,owner:this.scope.ownerPubKey,createInfo:{payer:this.scope.ownerPubKey,amount:0},skipCloseAccount:!d,associatedOnly:!1,checkCreateATAOwner:!1});m=C,I&&A.addInstruction(I),l[c.mintA.address]=C}else{let C=new T.PublicKey(c.mintA.address);m=this.scope.account.getAssociatedTokenAccount(C,new T.PublicKey(c.mintA.programId)),A.addInstruction({instructions:[(0,Y.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,m,this.scope.ownerPubKey,C)]}),l[c.mintA.address]=m}if(!f)if(x){let{account:C,instructionParams:I}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:c.mintB.programId,mint:new T.PublicKey(c.mintB.address),notUseTokenAccount:!0,owner:this.scope.ownerPubKey,createInfo:{payer:this.scope.ownerPubKey,amount:0},skipCloseAccount:!d,associatedOnly:!1,checkCreateATAOwner:!1});f=C,I&&A.addInstruction(I),l[c.mintB.address]=C}else{let C=new T.PublicKey(c.mintB.address);f=this.scope.account.getAssociatedTokenAccount(C,new T.PublicKey(c.mintB.programId)),A.addInstruction({instructions:[(0,Y.createAssociatedTokenAccountIdempotentInstruction)(this.scope.ownerPubKey,f,this.scope.ownerPubKey,C)]}),l[c.mintB.address]=f}(!m||!f)&&this.logAndCreateError("cannot found target token accounts",{tokenAccountA:m,tokenAccountB:f});let y=(L=b.poolKeys)!=null?L:await this.getCpmmPoolKeys(c.id),{publicKey:B}=de(g,P,Y.TOKEN_PROGRAM_ID),{publicKey:k}=ut(i,P),{publicKey:K}=de(o,new T.PublicKey(c.lpMint.address),Y.TOKEN_PROGRAM_ID);A.addInstruction({instructions:[fn({programId:i,nftOwner:this.scope.ownerPubKey,auth:o,nftMint:P,nftAccount:B,lockPda:k,poolId:new T.PublicKey(c.id),mintLp:new T.PublicKey(y.mintLp.address),userVaultA:m,userVaultB:f,poolVaultA:new T.PublicKey(y.vault.A),poolVaultB:new T.PublicKey(y.vault.B),mintA:u,mintB:h,lockLpVault:K,lpFeeAmount:p,cpmmProgram:s==null?void 0:s.programId,cpmmAuthProgram:s==null?void 0:s.authProgram})],instructionTypes:[ne.CpmmCollectLockFee]})}),r===0?A.sizeCheckBuildV0({computeBudgetConfig:a}):A.sizeCheckBuild({computeBudgetConfig:a})}computeSwapAmount({pool:t,amountIn:e,outputMint:i,slippage:o}){let s=i.toString()===t.mintB.address,a=Kt.swap(e,s?t.baseReserve:t.quoteReserve,s?t.quoteReserve:t.baseReserve,t.configInfo.tradeFeeRate),r=new ue.default(a.destinationAmountSwapped.toString()).div(a.sourceAmountSwapped.toString()),d=a.destinationAmountSwapped.mul(new Q.default((1-o)*1e4)).div(new Q.default(1e4));return{allTrade:a.sourceAmountSwapped.eq(e),amountIn:e,amountOut:a.destinationAmountSwapped,minAmountOut:d,executionPrice:r,fee:a.tradeFee,priceImpact:t.poolPrice.sub(r).div(t.poolPrice)}}computePairAmount({poolInfo:t,baseReserve:e,quoteReserve:i,amount:o,slippage:s,epochInfo:a,baseIn:r}){var m,f,y,B,k,K,L,C,I;let d=1-Number(s.toSignificant())/100,g=new Q.default(new ue.default(o).mul(10**t[r?"mintA":"mintB"].decimals).mul(d).toFixed(0)),A=we(g,t[r?"mintA":"mintB"].extensions.feeConfig,a,!1),l=g.sub((m=A.fee)!=null?m:new Q.default(0)),b=new Q.default(new ue.default(t.lpAmount).mul(10**t.lpMint.decimals).toFixed(0,ue.default.ROUND_DOWN));this.logDebug("baseReserve:",e.toString(),"quoteReserve:",i.toString()),this.logDebug("tokenIn:",r?t.mintA.symbol:t.mintB.symbol,"amountIn:",g.toString(),"amountInFee:",(y=(f=A.fee)==null?void 0:f.toString())!=null?y:0,"anotherToken:",r?t.mintB.symbol:t.mintA.symbol,"slippage:",`${s.toSignificant()}%`);let c=r?"base":"quote";this.logDebug("input side:",c);let p=l.mul(b).div(c==="base"?e:i),P={amount:Jt,fee:void 0,expirationTime:void 0};if(!l.isZero()){let M=Lr(p,e,i,b);this.logDebug("lpAmountData:",{amountA:M.amountA.toString(),amountB:M.amountB.toString()}),P=we(M[r?"amountB":"amountA"],t[r?"mintB":"mintA"].extensions.feeConfig,a,!0)}let u=new me(new Q.default(1)).add(s),h=new me(new Q.default(1)).sub(s),w=we(u.mul(P.amount.sub((B=P.fee)!=null?B:new Q.default(0))).quotient,t[r?"mintB":"mintA"].extensions.feeConfig,a,!0),x=we(h.mul(P.amount.sub((k=P.fee)!=null?k:new Q.default(0))).quotient,t[r?"mintB":"mintA"].extensions.feeConfig,a,!0);return this.logDebug("anotherAmount:",P.amount.toString(),"anotherAmountFee:",(L=(K=P.fee)==null?void 0:K.toString())!=null?L:0,"maxAnotherAmount:",w.amount.toString(),"maxAnotherAmountFee:",(I=(C=w.fee)==null?void 0:C.toString())!=null?I:0),{inputAmountFee:A,anotherAmount:P,maxAnotherAmount:w,minAnotherAmount:x,liquidity:p}}};function Lr(n,t,e,i){let o=n.mul(t).div(i);!o.isZero()&&!n.mul(t).mod(i).isZero()&&(o=o.add(new Q.default(1)));let s=n.mul(e).div(i);return!s.isZero()&&!n.mul(e).mod(i).isZero()&&(s=s.add(new Q.default(1))),{amountA:o,amountB:s}}0&&(module.exports={});
//# sourceMappingURL=cpmm.js.map