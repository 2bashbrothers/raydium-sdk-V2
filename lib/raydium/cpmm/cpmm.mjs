var fi=Object.defineProperty,yi=Object.defineProperties;var bi=Object.getOwnPropertyDescriptors;var ft=Object.getOwnPropertySymbols;var Pn=Object.prototype.hasOwnProperty,An=Object.prototype.propertyIsEnumerable;var gn=(n,e,t)=>e in n?fi(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,v=(n,e)=>{for(var t in e||(e={}))Pn.call(e,t)&&gn(n,t,e[t]);if(ft)for(var t of ft(e))An.call(e,t)&&gn(n,t,e[t]);return n},U=(n,e)=>yi(n,bi(e));var le=(n,e)=>{var t={};for(var i in n)Pn.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&ft)for(var i of ft(n))e.indexOf(i)<0&&An.call(n,i)&&(t[i]=n[i]);return t};import{PublicKey as A}from"@solana/web3.js";import{AccountLayout as Vr,NATIVE_MINT as qe,TOKEN_PROGRAM_ID as ne,createAssociatedTokenAccountIdempotentInstruction as Ge}from"@solana/spl-token";import ye from"bn.js";import lc from"decimal.js";import Zi from"big.js";import Ya from"bn.js";import{get as wn,set as gi}from"lodash";var Mt=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:0,this.name=e.name}set level(e){this.logLevel=e}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let t=e.map(i=>typeof i=="object"?JSON.stringify(i):i).join(", ");throw new Error(t)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},kn={},Pi={};function Q(n){let e=wn(kn,n);if(!e){let t=wn(Pi,n);e=new Mt({name:n,logLevel:t}),gi(kn,n,e)}return e}import{PublicKey as Tn}from"@solana/web3.js";import{MINT_SIZE as Ai,TOKEN_PROGRAM_ID as wi,getTransferFeeConfig as ki,unpackMint as Ti}from"@solana/spl-token";var Ot=Q("Raydium_accountInfo_util");async function Xe(n,e,t){let{batchRequest:i,commitment:s="confirmed",chunkCount:o=100}=v({batchRequest:!1},t),c=Ft(e,o),r=new Array(c.length).fill([]);if(i){let p=c.map(u=>{let m=n._buildArgs([u.map(f=>f.toBase58())],s,"base64");return{methodName:"getMultipleAccounts",args:m}}),y=Ft(p,10);r=(await(await Promise.all(y.map(async u=>await n._rpcBatchRequest(u)))).flat()).map(u=>(u.error&&Ot.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${u.error.message}`),u.result.value.map(m=>{if(m){let{data:f,executable:a,lamports:g,owner:l,rentEpoch:h}=m;return f.length!==2&&f[1]!=="base64"&&Ot.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(f[0],"base64"),executable:a,lamports:g,owner:new Tn(l),rentEpoch:h}}return null})))}else try{r=await Promise.all(c.map(p=>n.getMultipleAccountsInfo(p,s)))}catch(p){p instanceof Error&&Ot.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${p.message}`)}return r.flat()}async function Ke(n,e,t){let i=await Xe(n,e.map(s=>s.pubkey),t);return e.map((s,o)=>U(v({},s),{accountInfo:i[o]}))}async function Et({connection:n,mints:e,config:t}){var o,c,r;if(e.length===0)return{};let i=await Ke(n,e.map(p=>({pubkey:ze(p)})),t),s={};for(let p of i){if(!p.accountInfo||p.accountInfo.data.length<Ai){console.log("invalid mint account",p.pubkey.toBase58());continue}let y=Ti(p.pubkey,p.accountInfo,(o=p.accountInfo)==null?void 0:o.owner);s[p.pubkey.toString()]=U(v({},y),{programId:((c=p.accountInfo)==null?void 0:c.owner)||wi,feeConfig:(r=ki(y))!=null?r:void 0})}return s[Tn.default.toBase58()]=s[ie.toBase58()],s}import He from"bn.js";var Bn=9007199254740991;function de(n){let e=Q("Raydium_parseBigNumberish");if(n instanceof He)return n;if(typeof n=="string"){if(n.match(/^-?[0-9]+$/))return new He(n);e.logWithError(`invalid BigNumberish string: ${n}`)}return typeof n=="number"?(n%1&&e.logWithError(`BigNumberish number underflow: ${n}`),(n>=Bn||n<=-Bn)&&e.logWithError(`BigNumberish number overflow: ${n}`),new He(String(n))):typeof n=="bigint"?new He(n.toString()):(e.error(`invalid BigNumberish value: ${n}`),new He(0))}import{PublicKey as Bi}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as hn}from"@solana/spl-token";var Vt={chainId:101,address:Bi.default.toBase58(),programId:hn.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},he={chainId:101,address:"So11111111111111111111111111111111111111112",programId:hn.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};import{PublicKey as Dt}from"@solana/web3.js";import{PublicKey as z,SystemProgram as xn,SYSVAR_RENT_PUBKEY as hi}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as xi}from"@solana/spl-token";function Wt({pubkey:n,isSigner:e=!1,isWritable:t=!0}){return{pubkey:n,isWritable:t,isSigner:e}}var so=[Wt({pubkey:xi,isWritable:!1}),Wt({pubkey:xn.programId,isWritable:!1}),Wt({pubkey:hi,isWritable:!1})];function vt({publicKey:n,transformSol:e}){let t=In(n.toString());if(t instanceof z)return e&&t.equals(Ye)?ie:t;if(e&&t.toString()===Ye.toBase58())return ie;if(typeof t=="string"){if(t===z.default.toBase58())return z.default;try{return new z(t)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function In(n){try{return new z(n)}catch{return n}}var Ii=new z("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),yt=new z("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),bt=new z("SysvarRent111111111111111111111111111111111"),ao=new z("SysvarC1ock11111111111111111111111111111111"),Fe=new z("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),co=new z("Sysvar1nstructions1111111111111111111111111"),Cn=xn.programId,uo=new z("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),lo=new z("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),mo=new z("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),po=new z("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),fo=new z("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),yo=new z("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),bo=new z("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),go=new z("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),Po=new z("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),Ao=new z("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),wo=new z("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),ie=new z("So11111111111111111111111111111111111111112"),Ye=z.default;function ze(n){return vt({publicKey:n,transformSol:!0})}var _t=class{constructor({mint:e,decimals:t,symbol:i,name:s,skipMint:o=!1,isToken2022:c=!1}){if(e===Ye.toBase58()||e instanceof Dt&&Ye.equals(e)){this.decimals=he.decimals,this.symbol=he.symbol,this.name=he.name,this.mint=new Dt(he.address),this.isToken2022=!1;return}this.decimals=t,this.symbol=i||e.toString().substring(0,6),this.name=s||e.toString().substring(0,6),this.mint=o?Dt.default:vt({publicKey:e}),this.isToken2022=c}equals(e){return this===e?!0:this.mint.equals(e.mint)}},xe=_t;xe.WSOL=new _t(U(v({},he),{mint:he.address}));var qt=class{constructor({decimals:e,symbol:t="UNKNOWN",name:i="UNKNOWN"}){this.decimals=e,this.symbol=t,this.name=i}equals(e){return this===e}},gt=qt;gt.SOL=new qt(Vt);import Ci from"toformat";var Si=Ci,Ze=Si;import At from"big.js";import Li from"bn.js";import Ri from"decimal.js-light";var Pt=Q("module/fraction"),Gt=Ze(At),je=Ze(Ri),Ni={[0]:je.ROUND_DOWN,[1]:je.ROUND_HALF_UP,[2]:je.ROUND_UP},Mi={[0]:At.roundDown,[1]:At.roundHalfUp,[2]:At.roundUp},X=class{constructor(e,t=new Li(1)){this.numerator=de(e),this.denominator=de(t)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new X(this.denominator,this.numerator)}add(e){let t=e instanceof X?e:new X(de(e));return this.denominator.eq(t.denominator)?new X(this.numerator.add(t.numerator),this.denominator):new X(this.numerator.mul(t.denominator).add(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}sub(e){let t=e instanceof X?e:new X(de(e));return this.denominator.eq(t.denominator)?new X(this.numerator.sub(t.numerator),this.denominator):new X(this.numerator.mul(t.denominator).sub(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}mul(e){let t=e instanceof X?e:new X(de(e));return new X(this.numerator.mul(t.numerator),this.denominator.mul(t.denominator))}div(e){let t=e instanceof X?e:new X(de(e));return new X(this.numerator.mul(t.denominator),this.denominator.mul(t.numerator))}toSignificant(e,t={groupSeparator:""},i=1){Number.isInteger(e)||Pt.logWithError(`${e} is not an integer.`),e<=0&&Pt.logWithError(`${e} is not positive.`),je.set({precision:e+1,rounding:Ni[i]});let s=new je(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return s.toFormat(s.decimalPlaces(),t)}toFixed(e,t={groupSeparator:""},i=1){return Number.isInteger(e)||Pt.logWithError(`${e} is not an integer.`),e<0&&Pt.logWithError(`${e} is negative.`),Gt.DP=e,Gt.RM=Mi[i]||1,new Gt(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,t)}isZero(){return this.numerator.isZero()}};import Oi from"bn.js";var Sn=new X(new Oi(100)),se=class extends X{toSignificant(e=5,t,i){return this.mul(Sn).toSignificant(e,t,i)}toFixed(e=2,t,i){return this.mul(Sn).toFixed(e,t,i)}};var Ho=Q("Raydium_price");function Ft(n,e=1,t=[]){let i=[...n];if(e<=0)return t;for(;i.length;)t.push(i.splice(0,e));return t}var pe=class{constructor(e){this._owner=e}get publicKey(){return pe.isKeyPair(this._owner)?this._owner.publicKey:this._owner}get signer(){return pe.isKeyPair(this._owner)?this._owner:void 0}get isKeyPair(){return pe.isKeyPair(this._owner)}get isPublicKey(){return pe.isPublicKey(this._owner)}static isKeyPair(e){return e.secretKey!==void 0}static isPublicKey(e){return!pe.isKeyPair(e)}};import{PublicKey as _i}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as qi}from"@solana/spl-token";import{ComputeBudgetProgram as Kn,Keypair as Rn,PublicKey as Fi,Transaction as Nn,TransactionMessage as Ei,VersionedTransaction as Mn}from"@solana/web3.js";var J={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",ClmmLockPosition:"ClmmLockPosition",ClmmHarvestLockPosition:"ClmmHarvestLockPosition",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV4Withdraw:"FarmV4Withdraw",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut",CpmmLockLp:"CpmmLockLp",CpmmCollectLockFee:"CpmmCollectLockFee",TransferTip:"TransferTip"};import{TOKEN_PROGRAM_ID as Vi}from"@solana/spl-token";var Ln=Q("Raydium_txUtil"),On=1644;function Qe(n){let e=[],t=[];return n.microLamports&&(e.push(Kn.setComputeUnitPrice({microLamports:n.microLamports})),t.push(J.SetComputeUnitPrice)),n.units&&(e.push(Kn.setComputeUnitLimit({units:n.units})),t.push(J.SetComputeUnitLimit)),{instructions:e,instructionTypes:t}}async function Le(n,e){var i,s;let t=e!=null?e:"confirmed";return(s=await((i=n.getLatestBlockhash)==null?void 0:i.call(n,{commitment:t})))==null?void 0:s.blockhash}async function Je(n,e){return n.getSignatureStatuses([e]),new Promise((t,i)=>{let s=setTimeout(i,6e4);n.onSignature(e,o=>{if(clearTimeout(s),!o.err){t("");return}i(Object.assign(o.err,{txId:e}))},"confirmed")})}function Wi(n,e){n.length<1&&Ln.logWithError(`no instructions provided: ${n.toString()}`),e.length<1&&Ln.logWithError(`no signers provided:, ${e.toString()}`);let t=new Nn;t.recentBlockhash="11111111111111111111111111111111",t.feePayer=e[0],t.add(...n);try{return Buffer.from(t.serialize({verifySignatures:!1})).toString("base64").length<On}catch{return!1}}function ae(n,e){let[t,i]=Fi.findProgramAddressSync(n,e);return{publicKey:t,nonce:i}}function $e({instructions:n,payer:e,signers:t}){return Wi(n,[e,...t])}function be({instructions:n,payer:e,lookupTableAddressAccount:t,recentBlockhash:i=Rn.generate().publicKey.toString()}){let o=new Ei({payerKey:e,recentBlockhash:i,instructions:n}).compileToV0Message(Object.values(t!=null?t:{}));try{return Buffer.from(new Mn(o).serialize()).toString("base64").length<On}catch{return!1}}var vi=n=>Buffer.isBuffer(n)?n:n instanceof Uint8Array?Buffer.from(n.buffer,n.byteOffset,n.byteLength):Buffer.from(n),Di=n=>{let e=n.serialize({requireAllSignatures:!1,verifySignatures:!1});n instanceof Mn&&(e=vi(e));try{return e instanceof Buffer?e.toString("base64"):Buffer.from(e).toString("base64")}catch{return e.toString("base64")}};function Ie(n){let e=[];return n.forEach(t=>{t instanceof Nn&&(t.recentBlockhash||(t.recentBlockhash=Vi.toBase58()),t.feePayer||(t.feePayer=Rn.generate().publicKey)),e.push(Di(t))}),console.log("simulate tx string:",e),e}function oe(n,e,t){return ae([n.toBuffer(),(t!=null?t:qi).toBuffer(),e.toBuffer()],new _i("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"))}import{PublicKey as O}from"@solana/web3.js";var Cs=new O("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),Ss=new O("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),Ks=new O("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),Ls=new O("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),Rs=new O("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),Ns=new O("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),Ms=new O("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),Os=new O("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),Fs=new O("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),Es=new O("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Gi=new O("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),Ui=new O("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),Xi=new O("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),Vs=new O("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Ws=new O("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),vs=new O("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),Ds=new O("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),_s=new O("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),qs=new O("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),Gs=new O("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),et=new O("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),Fn=new O("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),Us=new O("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),kt=new O("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),Tt=new O("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),Xs=new O("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),zs=new O("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),Hs=new O("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),Ys=new O("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),Zs=new O("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),js=new O("6s1xP3hpbAfFoNtUNF8mfHsjr2Bd97JxFJRWLbL6aHuX");var Qs={OPEN_BOOK_PROGRAM:new O("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),SERUM_PROGRAM_ID_V3:new O("Ray1111111111111111111111111111111111111111"),AMM_V4:new O("DRaya7Kj3aMWQSy19kSjvmuwq9docCHofyP9kanQGaav"),AMM_STABLE:new O("DRayDdXc1NZQ9C3hRWmoSf8zK4iapgMnjdNZWrfwsP8m"),CLMM_PROGRAM_ID:new O("DRayAUgENGQBKVaX8owNhgzkEDyoHTGVEGHVJT1E9pfH"),CLMM_LOCK_PROGRAM_ID:new O("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),CLMM_LOCK_AUTH_ID:new O("6Aoh8h2Lw2m5UGxYR8AdAL87jTWYeKoxM52mJRzfYwN"),CREATE_CPMM_POOL_PROGRAM:new O("DRaycpLY18LhpbydsBWbVJtxpNv9oXPgjRSfpF2bWpYb"),CREATE_CPMM_POOL_AUTH:new O("CXniRufdq5xL8t8jZAPxsPZDpuudwuJSPWnbcD5Y5Nxq"),CREATE_CPMM_POOL_FEE_ACC:new O("3oE58BKVt8KuYkGxx8zBojugnymWmBiyafWgMrnb6eYy"),LOCK_CPMM_PROGRAM:new O("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),LOCK_CPMM_AUTH:new O("7qWVV8UY2bRJfDLP4s37YzBPKUkVB46DStYJBpYbQzu3"),UTIL1216:O.default,Router:new O("DRaybByLpbUL57LJARs3j8BitTxVfzBg351EaMr5UTCd"),FARM_PROGRAM_ID_V3:new O("DRayWyrLmEW5KEeqs8kdTMMaBabapqagaBC7KWpGtJeZ"),FARM_PROGRAM_ID_V4:new O("Ray1111111111111111111111111111111111111111"),FARM_PROGRAM_ID_V5:new O("DRayiCGSZgku1GTK6rXD6mVDdingXy6APAH1R6R5L2LC"),FARM_PROGRAM_ID_V6:new O("DRayzbYakXs45ELHkzH6vC3fuhQqTAnv5A68gdFuvZyZ"),LAUNCHPAD_PROGRAM:new O("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),LAUNCHPAD_AUTH:new O("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),LAUNCHPAD_PLATFORM:new O("2Jx4KTDrVSdWNazuGpcA8n3ZLTRGGBDxAWhuKe2Xcj2a"),LAUNCHPAD_CONFIG:new O("7ZR4zD7PYfY2XxoG1Gxcy2EgEeGYrpxrwzPuwdUBssEt"),FEE_DESTINATION_ID:new O("9y8ENuuZ3b19quffx9hQvRVygG5ky6snHfRvGpuSfeJy"),MODEL_DATA_PUBKEY:new O("Ray1111111111111111111111111111111111111111")};import me from"bn.js";var tt=1e4;function fe(n,e,t,i){if(e===void 0)return{amount:n,fee:void 0,expirationTime:void 0};let s=U(v({},e),{olderTransferFee:{epoch:BigInt(e.olderTransferFee.epoch),maximumFee:BigInt(e.olderTransferFee.maximumFee),transferFeeBasisPoints:e.olderTransferFee.transferFeeBasisPoints},newerTransferFee:{epoch:BigInt(e.newerTransferFee.epoch),maximumFee:BigInt(e.newerTransferFee.maximumFee),transferFeeBasisPoints:e.newerTransferFee.transferFeeBasisPoints}}),o=t.epoch<s.newerTransferFee.epoch?s.olderTransferFee:s.newerTransferFee,c=new me(o.maximumFee.toString()),r=t.epoch<s.newerTransferFee.epoch?(Number(s.newerTransferFee.epoch)*t.slotsInEpoch-t.absoluteSlot)*400/1e3:void 0;if(i)if(o.transferFeeBasisPoints===tt){let p=new me(o.maximumFee.toString());return{amount:n.add(p),fee:p,expirationTime:r}}else{let p=zt(n.mul(new me(tt)),new me(tt-o.transferFeeBasisPoints)),y=new me(o.maximumFee.toString()),d=p.sub(n).gt(y)?n.add(y):p,u=zt(d.mul(new me(o.transferFeeBasisPoints)),new me(tt)),m=u.gt(c)?c:u;return{amount:d,fee:m,expirationTime:r}}else{let p=zt(n.mul(new me(o.transferFeeBasisPoints)),new me(tt)),y=p.gt(c)?c:p;return{amount:n,fee:y,expirationTime:r}}}function zt(n,e){let{div:t,mod:i}=n.divmod(e);return i.gt(new me(0))?t.add(new me(1)):t}import{PublicKey as Ht,AddressLookupTableAccount as Ve}from"@solana/web3.js";async function Bt({connection:n,address:e,cluster:t="mainnet"}){let i=await Xe(n,[...new Set(e.map(o=>o.toString()))].map(o=>new Ht(o))),s={};for(let o=0;o<e.length;o++){let c=i[o],r=e[o];if(!c)continue;let p=new Ve({key:r,state:Ve.deserialize(c.data)});s[r.toString()]=p,t==="devnet"?Ee[r.toString()]=p:Ce[r.toString()]=p}return s}var Ce={},Yt=async n=>{let e="AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU";if(Ce[e])return Ce;let t=new Ht(e),i=await n.getAccountInfo(t);return i&&(Ce[e]=new Ve({key:t,state:Ve.deserialize(i.data)})),Ce},Ee={},ht=async n=>{let e="EFhMuDw1PKEuckuFRW9PavNfTH4LKP5uKHgyXDmWpFCq";if(Ee[e])return Ee;let t=new Ht(e),i=await n.getAccountInfo(t);return i&&(Ee[e]=new Ve({key:t,state:Ve.deserialize(i.data)})),Ee};import{PublicKey as Re,sendAndConfirmTransaction as Zt,SystemProgram as zi,Transaction as nt,TransactionMessage as ge,VersionedTransaction as Pe}from"@solana/web3.js";import Hi from"axios";var it=2e3,rt=class{constructor(e){this.instructions=[];this.endInstructions=[];this.lookupTableAddress=[];this.signers=[];this.instructionTypes=[];this.endInstructionTypes=[];this.connection=e.connection,this.feePayer=e.feePayer,this.signAllTransactions=e.signAllTransactions,this.owner=e.owner,this.cluster=e.cluster,this.blockhashCommitment=e.blockhashCommitment,this.loopMultiTxStatus=!!e.loopMultiTxStatus}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers,instructionTypes:this.instructionTypes,endInstructionTypes:this.endInstructionTypes,lookupTableAddress:this.lookupTableAddress}}get allInstructions(){return[...this.instructions,...this.endInstructions]}async getComputeBudgetConfig(){var i;let e=(await Hi.get(`https://solanacompass.com/api/fees?cacheFreshTime=${3e5}`)).data,{avg:t}=(i=e==null?void 0:e[15])!=null?i:{};if(!!t)return{units:6e5,microLamports:Math.min(Math.ceil(t*1e6/6e5),25e3)}}addCustomComputeBudget(e){if(e){let{instructions:t,instructionTypes:i}=Qe(e);return this.instructions.unshift(...t),this.instructionTypes.unshift(...i),!0}return!1}addTipInstruction(e){var t;return e?(this.endInstructions.push(zi.transfer({fromPubkey:(t=e.feePayer)!=null?t:this.feePayer,toPubkey:new Re(e.address),lamports:BigInt(e.amount.toString())})),this.endInstructionTypes.push(J.TransferTip),!0):!1}async calComputeBudget({config:e,defaultIns:t}){try{let i=e||await this.getComputeBudgetConfig();if(this.addCustomComputeBudget(i))return;t&&this.instructions.unshift(...t)}catch{t&&this.instructions.unshift(...t)}}addInstruction({instructions:e=[],endInstructions:t=[],signers:i=[],instructionTypes:s=[],endInstructionTypes:o=[],lookupTableAddress:c=[]}){return this.instructions.push(...e),this.endInstructions.push(...t),this.signers.push(...i),this.instructionTypes.push(...s),this.endInstructionTypes.push(...o),this.lookupTableAddress.push(...c.filter(r=>r!==Re.default.toString())),this}async versionBuild({txVersion:e,extInfo:t}){return e===0?await this.buildV0(v({},t||{})):this.build(t)}build(e){var i;let t=new nt;return this.allInstructions.length&&t.add(...this.allInstructions),t.feePayer=this.feePayer,((i=this.owner)==null?void 0:i.signer)&&!this.signers.some(s=>s.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer),{builder:this,transaction:t,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async s=>{var d;let{recentBlockHash:o,skipPreflight:c=!0,sendAndConfirm:r,notSendToRpc:p}=s||{},y=o!=null?o:await Le(this.connection,this.blockhashCommitment);if(t.recentBlockhash=y,this.signers.length&&t.sign(...this.signers),Ie([t]),(d=this.owner)!=null&&d.isKeyPair)return{txId:r?await Zt(this.connection,t,this.signers.find(m=>m.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:c}):await this.connection.sendRawTransaction(t.serialize(),{skipPreflight:c}),signedTx:t};if(this.signAllTransactions){let u=await this.signAllTransactions([t]);if(this.signers.length)for(let m of u)try{m.sign(...this.signers)}catch{}return{txId:p?"":await this.connection.sendRawTransaction(u[0].serialize(),{skipPreflight:c}),signedTx:u[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:e||{}}}buildMultiTx(e){var y;let{extraPreBuildData:t=[],extInfo:i}=e,{transaction:s}=this.build(i),o=t.filter(d=>d.transaction.instructions.length>0),c=[s,...o.map(d=>d.transaction)],r=[this.signers,...o.map(d=>d.signers)],p=[...this.instructionTypes,...o.map(d=>d.instructionTypes).flat()];return(y=this.owner)!=null&&y.signer&&r.forEach(d=>{d.some(u=>u.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),{builder:this,transactions:c,signers:r,instructionTypes:p,execute:async d=>{var h;let{sequentially:u,onTxUpdate:m,skipTxCount:f=0,recentBlockHash:a,skipPreflight:g=!0}=d||{},l=a!=null?a:await Le(this.connection,this.blockhashCommitment);if((h=this.owner)!=null&&h.isKeyPair){if(u){let k=[],x=0;for(let w of c){if(++x,x<=f)continue;let P=await Zt(this.connection,w,this.signers.find(b=>b.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:g});k.push(P)}return{txIds:k,signedTxs:c}}return{txIds:await await Promise.all(c.map(async k=>(k.recentBlockhash=l,await this.connection.sendRawTransaction(k.serialize(),{skipPreflight:g})))),signedTxs:c}}if(this.signAllTransactions){let k=c.map((w,P)=>(w.recentBlockhash=l,r[P].length&&w.sign(...r[P]),w));Ie(k);let x=await this.signAllTransactions(k);if(u){let w=0,P=[],b=async()=>{if(!x[w])return;let B=await this.connection.sendRawTransaction(x[w].serialize(),{skipPreflight:g});P.push({txId:B,status:"sent",signedTx:x[w]}),m==null||m([...P]),w++;let T=!1,K=null,L=null,S=C=>{K!==null&&clearInterval(K),L!==null&&this.connection.removeSignatureListener(L);let R=P.findIndex(F=>F.txId===B);if(R>-1){if(P[R].status==="error"||P[R].status==="success")return;P[R].status=C.err?"error":"success"}m==null||m([...P]),C.err||b()};this.loopMultiTxStatus&&(K=setInterval(async()=>{var C;if(T){clearInterval(K);return}try{let R=await this.connection.getTransaction(B,{commitment:"confirmed",maxSupportedTransactionVersion:0});R&&(T=!0,clearInterval(K),S({err:((C=R.meta)==null?void 0:C.err)||null}),console.log("tx status from getTransaction:",B))}catch(R){T=!0,clearInterval(K),console.error("getTransaction timeout:",R,B)}},it)),L=this.connection.onSignature(B,C=>{if(T){this.connection.removeSignatureListener(L);return}T=!0,S(C)},"confirmed"),this.connection.getSignatureStatus(B)};return await b(),{txIds:P.map(B=>B.txId),signedTxs:x}}else{let w=[];for(let P=0;P<x.length;P+=1){let b=await this.connection.sendRawTransaction(x[P].serialize(),{skipPreflight:g});w.push(b)}return{txIds:w,signedTxs:x}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:i||{}}}async versionMultiBuild({extraPreBuildData:e,txVersion:t,extInfo:i}){return t===0?await this.buildV0MultiTx({extraPreBuildData:e,buildProps:i||{}}):this.buildMultiTx({extraPreBuildData:e,extInfo:i})}async buildV0(e){var g;let a=e||{},{lookupTableCache:t={},lookupTableAddress:i=[],forerunCreate:s,recentBlockhash:o}=a,c=le(a,["lookupTableCache","lookupTableAddress","forerunCreate","recentBlockhash"]),r=v(v({},this.cluster==="devnet"?await ht(this.connection):await Yt(this.connection)),t),p=Array.from(new Set([...i,...this.lookupTableAddress])),y=[];for(let l of p)r[l]===void 0&&y.push(new Re(l));let d=await Bt({connection:this.connection,address:y});for(let[l,h]of Object.entries(d))r[l]=h;let u=s?Re.default.toBase58():o!=null?o:await Le(this.connection,this.blockhashCommitment),m=new ge({payerKey:this.feePayer,recentBlockhash:u,instructions:[...this.allInstructions]}).compileToV0Message(Object.values(r));((g=this.owner)==null?void 0:g.signer)&&!this.signers.some(l=>l.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer);let f=new Pe(m);return f.sign(this.signers),{builder:this,transaction:f,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async l=>{var w;let{skipPreflight:h=!0,sendAndConfirm:k,notSendToRpc:x}=l||{};if(Ie([f]),(w=this.owner)!=null&&w.isKeyPair){let P=await this.connection.sendTransaction(f,{skipPreflight:h});return k&&await Je(this.connection,P),{txId:P,signedTx:f}}if(this.signAllTransactions){let P=await this.signAllTransactions([f]);if(this.signers.length)for(let b of P)try{b.sign(this.signers)}catch{}return{txId:x?"":await this.connection.sendTransaction(P[0],{skipPreflight:h}),signedTx:P[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:c||{}}}async buildV0MultiTx(e){var y;let{extraPreBuildData:t=[],buildProps:i}=e,{transaction:s}=await this.buildV0(i),o=t.filter(d=>d.builder.instructions.length>0),c=[s,...o.map(d=>d.transaction)],r=[this.signers,...o.map(d=>d.signers)],p=[...this.instructionTypes,...o.map(d=>d.instructionTypes).flat()];return(y=this.owner)!=null&&y.signer&&r.forEach(d=>{d.some(u=>u.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),c.forEach(async(d,u)=>{d.sign(r[u])}),{builder:this,transactions:c,signers:r,instructionTypes:p,buildProps:i,execute:async d=>{var g;let{sequentially:u,onTxUpdate:m,recentBlockHash:f,skipPreflight:a=!0}=d||{};if(f&&c.forEach(l=>l.message.recentBlockhash=f),Ie(c),(g=this.owner)!=null&&g.isKeyPair){if(u){let l=[];for(let h of c){let k=await this.connection.sendTransaction(h,{skipPreflight:a});await Je(this.connection,k),l.push(k)}return{txIds:l,signedTxs:c}}return{txIds:await Promise.all(c.map(async l=>await this.connection.sendTransaction(l,{skipPreflight:a}))),signedTxs:c}}if(this.signAllTransactions){let l=await this.signAllTransactions(c);if(u){let h=0,k=[],x=async()=>{if(!l[h])return;let w=await this.connection.sendTransaction(l[h],{skipPreflight:a});k.push({txId:w,status:"sent",signedTx:l[h]}),m==null||m([...k]),h++;let P=!1,b=null,B=null,T=K=>{b!==null&&clearInterval(b),B!==null&&this.connection.removeSignatureListener(B);let L=k.findIndex(S=>S.txId===w);if(L>-1){if(k[L].status==="error"||k[L].status==="success")return;k[L].status=K.err?"error":"success"}m==null||m([...k]),K.err||x()};this.loopMultiTxStatus&&(b=setInterval(async()=>{var K;if(P){clearInterval(b);return}try{let L=await this.connection.getTransaction(w,{commitment:"confirmed",maxSupportedTransactionVersion:0});L&&(P=!0,clearInterval(b),T({err:((K=L.meta)==null?void 0:K.err)||null}),console.log("tx status from getTransaction:",w))}catch(L){P=!0,clearInterval(b),console.error("getTransaction timeout:",L,w)}},it)),B=this.connection.onSignature(w,K=>{if(P){this.connection.removeSignatureListener(B);return}P=!0,T(K)},"confirmed"),this.connection.getSignatureStatus(w)};return x(),{txIds:[],signedTxs:l}}else{let h=[];for(let k=0;k<l.length;k+=1){let x=await this.connection.sendTransaction(l[k],{skipPreflight:a});h.push(x)}return{txIds:h,signedTxs:l}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:i||{}}}async sizeCheckBuild(e){var m;let u=e||{},{splitIns:t=[],computeBudgetConfig:i}=u,s=le(u,["splitIns","computeBudgetConfig"]),o=i?Qe(i):{instructions:[],instructionTypes:[]},c=this.signers.reduce((f,a)=>U(v({},f),{[a.publicKey.toBase58()]:a}),{}),r=[],p=[],y=[],d=0;if(this.allInstructions.forEach(f=>{let a=[...y,f],g=i?[...o.instructions,...a]:a,h=[...new Set(a.map(k=>k.keys.filter(x=>x.isSigner).map(x=>x.pubkey.toString())).flat()).values()].map(k=>new Re(k));if(f!==t[d]&&y.length<12&&($e({instructions:g,payer:this.feePayer,signers:h})||$e({instructions:a,payer:this.feePayer,signers:h})))y.push(f);else{if(y.length===0)throw Error("item ins too big");d+=f===t[d]?1:0,$e({instructions:i?[...o.instructions,...y]:[...y],payer:this.feePayer,signers:h})?r.push(new nt().add(...o.instructions,...y)):r.push(new nt().add(...y)),p.push(Array.from(new Set(y.map(k=>k.keys.filter(x=>x.isSigner).map(x=>x.pubkey.toString())).flat())).map(k=>c[k]).filter(k=>k!==void 0)),y=[f]}}),y.length>0){let a=[...new Set(y.map(g=>g.keys.filter(l=>l.isSigner).map(l=>l.pubkey.toString())).flat()).values()].map(g=>c[g]).filter(g=>g!==void 0);$e({instructions:i?[...o.instructions,...y]:[...y],payer:this.feePayer,signers:a.map(g=>g.publicKey)})?r.push(new nt().add(...o.instructions,...y)):r.push(new nt().add(...y)),p.push(a)}return r.forEach(f=>f.feePayer=this.feePayer),(m=this.owner)!=null&&m.signer&&p.forEach(f=>{f.some(a=>a.publicKey.equals(this.owner.publicKey))||f.push(this.owner.signer)}),{builder:this,transactions:r,signers:p,instructionTypes:this.instructionTypes,execute:async f=>{var w;let{sequentially:a,onTxUpdate:g,skipTxCount:l=0,recentBlockHash:h,skipPreflight:k=!0}=f||{},x=h!=null?h:await Le(this.connection,this.blockhashCommitment);if(r.forEach(async(P,b)=>{P.recentBlockhash=x,p[b].length&&P.sign(...p[b])}),Ie(r),(w=this.owner)!=null&&w.isKeyPair){if(a){let P=0,b=[];for(let B of r){if(++P,P<=l){b.push("tx skipped");continue}let T=await Zt(this.connection,B,this.signers.find(K=>K.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:k});b.push(T)}return{txIds:b,signedTxs:r}}return{txIds:await Promise.all(r.map(async P=>await this.connection.sendRawTransaction(P.serialize(),{skipPreflight:k}))),signedTxs:r}}if(this.signAllTransactions){let P=await this.signAllTransactions(r.slice(l,r.length)),b=[...r.slice(0,l),...P];if(a){let B=0,T=[],K=async()=>{if(!b[B])return;B<l&&(T.push({txId:"",status:"success",signedTx:b[B]}),g==null||g([...T]),B++,K());let L=await this.connection.sendRawTransaction(b[B].serialize(),{skipPreflight:k});T.push({txId:L,status:"sent",signedTx:b[B]}),g==null||g([...T]),B++;let S=!1,C=null,R=null,F=W=>{C!==null&&clearInterval(C),R!==null&&this.connection.removeSignatureListener(R);let E=T.findIndex(G=>G.txId===L);if(E>-1){if(T[E].status==="error"||T[E].status==="success")return;T[E].status=W.err?"error":"success"}g==null||g([...T]),W.err||K()};this.loopMultiTxStatus&&(C=setInterval(async()=>{var W;if(S){clearInterval(C);return}try{let E=await this.connection.getTransaction(L,{commitment:"confirmed",maxSupportedTransactionVersion:0});E&&(S=!0,clearInterval(C),F({err:((W=E.meta)==null?void 0:W.err)||null}),console.log("tx status from getTransaction:",L))}catch(E){S=!0,clearInterval(C),console.error("getTransaction timeout:",E,L)}},it)),R=this.connection.onSignature(L,W=>{if(S){this.connection.removeSignatureListener(R);return}S=!0,F(W)},"confirmed"),this.connection.getSignatureStatus(L)};return await K(),{txIds:T.map(L=>L.txId),signedTxs:b}}else{let B=[];for(let T=0;T<b.length;T+=1){let K=await this.connection.sendRawTransaction(b[T].serialize(),{skipPreflight:k});B.push(K)}return{txIds:B,signedTxs:b}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:s||{}}}async sizeCheckBuildV0(e){var x;let k=e||{},{computeBudgetConfig:t,splitIns:i=[],lookupTableCache:s={},lookupTableAddress:o=[]}=k,c=le(k,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),r=v(v({},this.cluster==="devnet"?await ht(this.connection):Ce),s),p=Array.from(new Set([...this.lookupTableAddress,...o])),y=[];for(let w of p)r[w]===void 0&&y.push(new Re(w));let d=await Bt({connection:this.connection,address:y});for(let[w,P]of Object.entries(d))r[w]=P;let u=t?Qe(t):{instructions:[],instructionTypes:[]},m=await Le(this.connection,this.blockhashCommitment),f=this.signers.reduce((w,P)=>U(v({},w),{[P.publicKey.toBase58()]:P}),{}),a=[],g=[],l=[],h=0;if(this.allInstructions.forEach(w=>{let P=[...l,w],b=t?[...u.instructions,...P]:P;if(w!==i[h]&&l.length<12&&(be({instructions:b,payer:this.feePayer,lookupTableAddressAccount:r})||be({instructions:P,payer:this.feePayer,lookupTableAddressAccount:r})))l.push(w);else{if(l.length===0)throw Error("item ins too big");h+=w===i[h]?1:0;let B={};for(let T of[...new Set(p)])r[T]!==void 0&&(B[T]=r[T]);if(t&&be({instructions:[...u.instructions,...l],payer:this.feePayer,lookupTableAddressAccount:r,recentBlockhash:m})){let T=new ge({payerKey:this.feePayer,recentBlockhash:m,instructions:[...u.instructions,...l]}).compileToV0Message(Object.values(r));a.push(new Pe(T))}else{let T=new ge({payerKey:this.feePayer,recentBlockhash:m,instructions:[...l]}).compileToV0Message(Object.values(r));a.push(new Pe(T))}g.push(Array.from(new Set(l.map(T=>T.keys.filter(K=>K.isSigner).map(K=>K.pubkey.toString())).flat())).map(T=>f[T]).filter(T=>T!==void 0)),l=[w]}}),l.length>0){let P=[...new Set(l.map(b=>b.keys.filter(B=>B.isSigner).map(B=>B.pubkey.toString())).flat()).values()].map(b=>f[b]).filter(b=>b!==void 0);if(t&&be({instructions:[...u.instructions,...l],payer:this.feePayer,lookupTableAddressAccount:r,recentBlockhash:m})){let b=new ge({payerKey:this.feePayer,recentBlockhash:m,instructions:[...u.instructions,...l]}).compileToV0Message(Object.values(r));a.push(new Pe(b))}else{let b=new ge({payerKey:this.feePayer,recentBlockhash:m,instructions:[...l]}).compileToV0Message(Object.values(r));a.push(new Pe(b))}g.push(P)}return(x=this.owner)!=null&&x.signer&&g.forEach(w=>{w.some(P=>P.publicKey.equals(this.owner.publicKey))||w.push(this.owner.signer)}),a.forEach((w,P)=>{w.sign(g[P])}),{builder:this,transactions:a,buildProps:e,signers:g,blockHash:m,instructionTypes:this.instructionTypes,execute:async w=>{var L;let{sequentially:P,onTxUpdate:b,skipTxCount:B=0,recentBlockHash:T,skipPreflight:K=!0}=w||{};if(a.map(async(S,C)=>{g[C].length&&S.sign(g[C]),T&&(S.message.recentBlockhash=T)}),Ie(a),(L=this.owner)!=null&&L.isKeyPair){if(P){let S=0,C=[];for(let R of a){if(++S,S<=B){console.log("skip tx: ",S),C.push("tx skipped");continue}let F=await this.connection.sendTransaction(R,{skipPreflight:K});await Je(this.connection,F),C.push(F)}return{txIds:C,signedTxs:a}}return{txIds:await Promise.all(a.map(async S=>await this.connection.sendTransaction(S,{skipPreflight:K}))),signedTxs:a}}if(this.signAllTransactions){let S=await this.signAllTransactions(a.slice(B,a.length)),C=[...a.slice(0,B),...S];if(P){let R=0,F=[],W=async()=>{if(!C[R])return;if(R<B){F.push({txId:"",status:"success",signedTx:C[R]}),b==null||b([...F]),R++,W();return}let E=await this.connection.sendTransaction(C[R],{skipPreflight:K});F.push({txId:E,status:"sent",signedTx:C[R]}),b==null||b([...F]),R++;let G=!1,Z=null,ee=null,Ue=te=>{Z!==null&&clearInterval(Z),ee!==null&&this.connection.removeSignatureListener(ee);let j=F.findIndex(Nt=>Nt.txId===E);if(j>-1){if(F[j].status==="error"||F[j].status==="success")return;F[j].status=te.err?"error":"success"}b==null||b([...F]),te.err||W()};this.loopMultiTxStatus&&(Z=setInterval(async()=>{var te;if(G){clearInterval(Z);return}try{let j=await this.connection.getTransaction(E,{commitment:"confirmed",maxSupportedTransactionVersion:0});j&&(G=!0,clearInterval(Z),Ue({err:((te=j.meta)==null?void 0:te.err)||null}),console.log("tx status from getTransaction:",E))}catch(j){G=!0,clearInterval(Z),console.error("getTransaction timeout:",j,E)}},it)),ee=this.connection.onSignature(E,te=>{if(G){this.connection.removeSignatureListener(ee);return}G=!0,Ue(te)},"confirmed"),this.connection.getSignatureStatus(E)};return W(),{txIds:[],signedTxs:C}}else{let R=[];for(let F=0;F<C.length;F+=1){let W=await this.connection.sendTransaction(C[F],{skipPreflight:K});R.push(W)}return{txIds:R,signedTxs:C}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:c||{}}}async buildSniperTransaction(e){var x;let k=e||{},{computeBudgetConfig:t,splitIns:i=[],lookupTableCache:s={},lookupTableAddress:o=[]}=k,c=le(k,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),r=v(v({},this.cluster==="devnet"?await ht(this.connection):await Yt(this.connection)),s),p=Array.from(new Set([...this.lookupTableAddress,...o])),y=[];for(let w of p)r[w]===void 0&&y.push(new Re(w));let d=await Bt({connection:this.connection,address:y});for(let[w,P]of Object.entries(d))r[w]=P;let u=t?Qe(t):{instructions:[],instructionTypes:[]},m=await Le(this.connection,this.blockhashCommitment),f=this.signers.reduce((w,P)=>U(v({},w),{[P.publicKey.toBase58()]:P}),{}),a=[],g=[],l=[],h=0;if(this.allInstructions.forEach(w=>{let P=[...l,w],b=t?[...u.instructions,...P]:P;if(w!==i[h]&&l.length<12&&(be({instructions:b,payer:this.feePayer,lookupTableAddressAccount:r})||be({instructions:P,payer:this.feePayer,lookupTableAddressAccount:r})))l.push(w);else{if(l.length===0)throw Error("item ins too big");h+=w===i[h]?1:0;let B={};for(let T of[...new Set(p)])r[T]!==void 0&&(B[T]=r[T]);if(t&&be({instructions:[...u.instructions,...l],payer:this.feePayer,lookupTableAddressAccount:r,recentBlockhash:m})){let T=new ge({payerKey:this.feePayer,recentBlockhash:m,instructions:[...u.instructions,...l]}).compileToV0Message(Object.values(r));a.push(new Pe(T))}else{let T=new ge({payerKey:this.feePayer,recentBlockhash:m,instructions:[...l]}).compileToV0Message(Object.values(r));a.push(new Pe(T))}g.push(Array.from(new Set(l.map(T=>T.keys.filter(K=>K.isSigner).map(K=>K.pubkey.toString())).flat())).map(T=>f[T]).filter(T=>T!==void 0)),l=[w]}}),l.length>0){let P=[...new Set(l.map(b=>b.keys.filter(B=>B.isSigner).map(B=>B.pubkey.toString())).flat()).values()].map(b=>f[b]).filter(b=>b!==void 0);if(t&&be({instructions:[...u.instructions,...l],payer:this.feePayer,lookupTableAddressAccount:r,recentBlockhash:m})){let b=new ge({payerKey:this.feePayer,recentBlockhash:m,instructions:[...u.instructions,...l]}).compileToV0Message(Object.values(r));a.push(new Pe(b))}else{let b=new ge({payerKey:this.feePayer,recentBlockhash:m,instructions:[...l]}).compileToV0Message(Object.values(r));a.push(new Pe(b))}g.push(P)}return(x=this.owner)!=null&&x.signer&&g.forEach(w=>{w.some(P=>P.publicKey.equals(this.owner.publicKey))||w.push(this.owner.signer)}),a.forEach((w,P)=>{w.sign(g[P])}),{builder:this,transactions:a,buildProps:e,signers:g,instructionTypes:this.instructionTypes,execute:async w=>{var L;let{sequentially:P,onTxUpdate:b,skipTxCount:B=0,recentBlockHash:T,skipPreflight:K=!0}=w||{};if(a.map(async(S,C)=>{g[C].length&&S.sign(g[C]),T&&(S.message.recentBlockhash=T)}),Ie(a),(L=this.owner)!=null&&L.isKeyPair){if(P){let S=0,C=[];for(let R of a){if(++S,S<=B){console.log("skip tx: ",S),C.push("tx skipped");continue}let F=await this.connection.sendTransaction(R,{skipPreflight:K});await Je(this.connection,F),C.push(F)}return{txIds:C,signedTxs:a}}return{txIds:await Promise.all(a.map(async S=>await this.connection.sendTransaction(S,{skipPreflight:K}))),signedTxs:a}}if(this.signAllTransactions){let S=await this.signAllTransactions(a.slice(B,a.length)),C=[...a.slice(0,B),...S];if(P){let R=0,F=[],W=async()=>{if(!C[R])return;if(R<B){F.push({txId:"",status:"success",signedTx:C[R]}),b==null||b([...F]),R++,W();return}let E=await this.connection.sendTransaction(C[R],{skipPreflight:K});F.push({txId:E,status:"sent",signedTx:C[R]}),b==null||b([...F]),R++;let G=!1,Z=null,ee=null,Ue=te=>{Z!==null&&clearInterval(Z),ee!==null&&this.connection.removeSignatureListener(ee);let j=F.findIndex(Nt=>Nt.txId===E);if(j>-1){if(F[j].status==="error"||F[j].status==="success")return;F[j].status=te.err?"error":"success"}b==null||b([...F]),te.err||W()};this.loopMultiTxStatus&&(Z=setInterval(async()=>{var te;if(G){clearInterval(Z);return}try{let j=await this.connection.getTransaction(E,{commitment:"confirmed",maxSupportedTransactionVersion:0});j&&(G=!0,clearInterval(Z),Ue({err:((te=j.meta)==null?void 0:te.err)||null}),console.log("tx status from getTransaction:",E))}catch(j){G=!0,clearInterval(Z),console.error("getTransaction timeout:",j,E)}},it)),ee=this.connection.onSignature(E,te=>{if(G){this.connection.removeSignatureListener(ee);return}G=!0,Ue(te)},"confirmed"),this.connection.getSignatureStatus(E)};return W(),{txIds:[],signedTxs:C}}else{let R=[];for(let F=0;F<C.length;F+=1){let W=await this.connection.sendTransaction(C[F],{skipPreflight:K});R.push(W)}return{txIds:R,signedTxs:C}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:c||{}}}};import{PublicKey as Aa}from"@solana/web3.js";import ka from"bn.js";import Yi from"bn.js";var Ne=new Yi(1e6);var ic=Q("Raydium_amount"),rc=Ze(Zi);var Xt=new ye(0),Ac=new ye(1),wc=new ye(2),kc=new ye(3),Tc=new ye(5),ji=new ye(10),Bc=new ye(100),hc=new ye(1e3),xc=new ye(1e4);function jt(n,e,t){return n.mul(e).add(t).sub(new ye(1)).div(t)}function xt(n,e,t){return n.mul(e).div(t)}import Vn from"bn.js";import It from"bn.js";function Qt(n,e){if(e.isZero())throw Error("divisor is zero");return n.mod(e)}function Qi(n,e){if(e.isZero())throw Error("rhs is zero");let t=n.div(e);return Qt(n,e).gt(ot)&&(t=t.add(new It(1))),[t,e]}var ot=new It(0),st=class{static swapBaseInputWithoutFees(e,t,i){let s=e.mul(i),o=t.add(e);return s.div(o)}static swapBaseOutputWithoutFees(e,t,i){let s=t.mul(e),o=i.sub(e),[c]=Qi(s,o);return c}static lpTokensToTradingTokens(e,t,i,s,o){let c=e.mul(i).div(t),r=e.mul(s).div(t);if(o===0)return{tokenAmount0:c,tokenAmount1:r};if(o===1)return Qt(e.mul(i),t).gt(ot)&&c.gt(ot)&&(c=c.add(new It(1))),Qt(e.mul(s),t).gt(ot)&&r.gt(ot)&&(r=r.add(new It(1))),{tokenAmount0:c,tokenAmount1:r};throw Error("roundDirection value error")}};import Ji from"bn.js";var re=class{static tradingFee(e,t){return jt(e,t,Ne)}static protocolFee(e,t){return xt(e,t,Ne)}static fundFee(e,t){return xt(e,t,Ne)}static creatorFee(e,t){return jt(e,t,Ne)}static splitCreatorFee(e,t,i){return xt(e,i,t.add(i))}static calculatePreFeeAmount(e,t){if(t.isZero())return e;let i=e.mul(Ne),s=Ne.sub(t);return i.add(s).sub(new Ji(1)).div(s)}};var at=class{static validate_supply(e,t){if(e.isZero())throw Error("tokenAmount0 is zero");if(t.isZero())throw Error("tokenAmount1 is zero")}static swapBaseInput(e,t,i,s,o,c,r,p){let y=new Vn(0),d=re.tradingFee(e,s),u;p?(y=re.creatorFee(e,o),u=e.sub(d).sub(y)):u=e.sub(d);let m=re.protocolFee(d,c),f=re.protocolFee(d,r),a=st.swapBaseInputWithoutFees(u,t,i),g;return p?g=a:(y=re.creatorFee(a,o),g=a.sub(y)),{newInputVaultAmount:t.add(u),newOutputVaultAmount:i.sub(a),inputAmount:e,outputAmount:g,tradeFee:d,protocolFee:m,fundFee:f,creatorFee:y}}static swapBaseOutput(e,t,i,s,o,c,r,p){let y,d=new Vn(0),u;if(p)u=e;else{let l=re.calculatePreFeeAmount(e,o);d=l.sub(e),u=l}let m=st.swapBaseOutputWithoutFees(u,t,i),f;if(p){let l=re.calculatePreFeeAmount(m,s.add(o)),h=l.sub(m);d=re.splitCreatorFee(h,s,o),y=h.sub(d),f=l}else{let l=re.calculatePreFeeAmount(m,s);y=l.sub(m),f=l}let a=re.protocolFee(y,c),g=re.fundFee(y,r);return{newInputVaultAmount:t.add(m),newOutputVaultAmount:e.sub(u),inputAmount:f,outputAmount:e,tradeFee:y,protocolFee:a,fundFee:g,creatorFee:d}}};import Y from"bn.js";import ue from"decimal.js";var Jt=(...n)=>n.map(e=>{try{return typeof e=="object"?JSON.stringify(e):e}catch{return e}}).join(", "),We=class{constructor({scope:e,moduleName:t}){this.disabled=!1;this.scope=e,this.logger=Q(t)}createTxBuilder(e){return this.scope.checkOwner(),new rt({connection:this.scope.connection,feePayer:e||this.scope.ownerPubKey,cluster:this.scope.cluster,owner:this.scope.owner,blockhashCommitment:this.scope.blockhashCommitment,loopMultiTxStatus:this.scope.loopMultiTxStatus,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}createSniperTxBuilder(e,t){let i=new pe(e);return new rt({connection:this.scope.connection,feePayer:t,cluster:this.scope.cluster,owner:i,blockhashCommitment:this.scope.blockhashCommitment,loopMultiTxStatus:this.scope.loopMultiTxStatus,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}logDebug(...e){this.logger.debug(Jt(e))}logInfo(...e){this.logger.info(Jt(e))}logAndCreateError(...e){let t=Jt(e);throw new Error(t)}checkDisabled(){(this.disabled||!this.scope)&&this.logAndCreateError("module not working")}};import{PublicKey as ar}from"@solana/web3.js";import _n,{isBN as qn}from"bn.js";import{bits as zc,BitStructure as Hc,blob as $i,Blob as Yc,cstr as Zc,f32 as jc,f32be as Qc,f64 as Jc,f64be as $c,greedy as eu,Layout as er,ns64 as tu,ns64be as nu,nu64 as iu,nu64be as ru,offset as ou,s16 as su,s16be as au,s24 as cu,s24be as uu,s32 as tr,s32be as lu,s40 as mu,s40be as du,s48 as pu,s48be as fu,s8 as yu,seq as nr,struct as bu,Structure as ir,u16 as rr,u16be as gu,u24 as Pu,u24be as Au,u32 as wu,u32be as ku,u40 as Tu,u40be as Bu,u48 as hu,u48be as xu,u8 as or,UInt as sr,union as Iu,Union as Cu,unionLayoutDiscriminator as Su,utf8 as Ku}from"@solana/buffer-layout";var $t=er,Wn=ir;var en=sr;var vn=or,Me=rr;var Ae=tr;var Dn=nr;var $=$i;var ve=class extends $t{constructor(t,i,s){super(t,s);this.blob=$(t),this.signed=i}decode(t,i=0){let s=new _n(this.blob.decode(t,i),10,"le");return this.signed?s.fromTwos(this.span*8).clone():s}encode(t,i,s=0){return typeof t=="number"&&(t=new _n(t)),this.signed&&(t=t.toTwos(this.span*8)),this.blob.encode(t.toArrayLike(Buffer,"le",this.span),i,s)}};function _(n){return new en(1,n)}function we(n){return new en(4,n)}function I(n){return new ve(8,!1,n)}function H(n){return new ve(16,!1,n)}function Gn(n){return new ve(8,!0,n)}function Un(n){return new ve(16,!0,n)}var Ct=class extends $t{constructor(t,i,s,o){super(t.span,o);this.layout=t,this.decoder=i,this.encoder=s}decode(t,i){return this.decoder(this.layout.decode(t,i))}encode(t,i,s){return this.layout.encode(this.encoder(t),i,s)}getSpan(t,i){return this.layout.getSpan(t,i)}};function V(n){return new Ct($(32),e=>new ar(e),e=>e.toBuffer(),n)}function Se(n){return new Ct(vn(),cr,ur,n)}function cr(n){if(n===0)return!1;if(n===1)return!0;throw new Error("Invalid bool: "+n)}function ur(n){return n?1:0}var tn=class extends Wn{decode(e,t){return super.decode(e,t)}};function D(n,e,t){return new tn(n,e,t)}function q(n,e,t){let i,s=typeof e=="number"?e:qn(e)?e.toNumber():new Proxy(e,{get(o,c){if(!i){let r=Reflect.get(o,"count");i=qn(r)?r.toNumber():r,Reflect.set(o,"count",i)}return Reflect.get(o,c)},set(o,c,r){return c==="count"&&(i=r),Reflect.set(o,c,r)}});return Dn(n,s,t)}var Gu=D([we("mintAuthorityOption"),V("mintAuthority"),I("supply"),_("decimals"),_("isInitialized"),we("freezeAuthorityOption"),V("freezeAuthority")]);import{PublicKey as Hu}from"@solana/web3.js";import{MintLayout as Zu,TOKEN_PROGRAM_ID as Qu}from"@solana/spl-token";var Oe=s=>{var o=s,{address:n,programId:e,decimals:t}=o,i=le(o,["address","programId","decimals"]);return v({chainId:101,address:ze(n).toBase58(),programId:e,logoURI:"",symbol:"",name:"",decimals:t,tags:[],extensions:i.extensions||{}},i)},De=n=>n?U(v({},n),{transferFeeConfigAuthority:n.transferFeeConfigAuthority.toBase58(),withdrawWithheldAuthority:n.withdrawWithheldAuthority.toBase58(),withheldAmount:n.withheldAmount.toString(),olderTransferFee:U(v({},n.olderTransferFee),{epoch:n.olderTransferFee.epoch.toString(),maximumFee:n.olderTransferFee.maximumFee.toString()}),newerTransferFee:U(v({},n.newerTransferFee),{epoch:n.newerTransferFee.epoch.toString(),maximumFee:n.newerTransferFee.maximumFee.toString()})}):void 0;import{PublicKey as pt,TransactionInstruction as Te,Keypair as Or,SystemProgram as dn}from"@solana/web3.js";import{ASSOCIATED_TOKEN_PROGRAM_ID as Rt,TOKEN_2022_PROGRAM_ID as pn,TOKEN_PROGRAM_ID as ke}from"@solana/spl-token";var lr=Buffer.from("vault_and_lp_mint_auth_seed","utf8"),ul=Buffer.from("amm_config","utf8"),mr=Buffer.from("pool","utf8"),dr=Buffer.from("pool_lp_mint","utf8"),pr=Buffer.from("pool_vault","utf8"),fr=Buffer.from("observation","utf8"),yr=Buffer.from("permission","utf8");function St(n){return ae([lr],n)}function nn(n,e,t,i){return ae([mr,e.toBuffer(),t.toBuffer(),i.toBuffer()],n)}function br(n,e){return ae([dr,e.toBuffer()],n)}function Xn(n,e,t){return ae([pr,e.toBuffer(),t.toBuffer()],n)}function ct(n,e){return ae([fr,e.toBuffer()],n)}function rn({poolId:n,programId:e,configId:t,mintA:i,mintB:s}){let o=St(e).publicKey,c=n||nn(e,t,i,s).publicKey,r=br(e,c).publicKey,p=Xn(e,c,i).publicKey,y=Xn(e,c,s).publicKey,d=ct(e,c).publicKey;return{poolId:c,configId:t,authority:o,lpMint:r,vaultA:p,vaultB:y,observationId:d}}var gr=Buffer.from("locked_liquidity","utf8");function ut(n,e){return ae([gr,e.toBuffer()],n)}function zn(n,e){return ae([yr,e.toBuffer()],n)}import{PublicKey as Yd}from"@solana/web3.js";import jd from"bn.js";import Jd from"decimal.js";import{AccountLayout as tp,createAssociatedTokenAccountIdempotentInstruction as np,TOKEN_2022_PROGRAM_ID as ip,TOKEN_PROGRAM_ID as rp}from"@solana/spl-token";import{Keypair as kd,PublicKey as Td,SystemProgram as hd,TransactionInstruction as xd}from"@solana/web3.js";import Cd from"bn.js";import{ASSOCIATED_TOKEN_PROGRAM_ID as Ld,TOKEN_2022_PROGRAM_ID as Rd,TOKEN_PROGRAM_ID as Nd}from"@solana/spl-token";import ed from"bn.js";import nd from"decimal.js";import ce from"bn.js";var on=new ce(0),Hn=new ce(1),Yn=new ce(-1),Kt=new ce(1).shln(64),Zn=new ce(1).shln(128),Pr=Kt.sub(Hn);var Ar=Zn.subn(1),_e=-443636,lt=-_e,sn=new ce("4295048016"),an=new ce("79226673521066979257578248091"),dl=new ce("4295048017"),pl=new ce("79226673521066979257578248090");var wr=new ce(10).pow(new ce(6));var fl=new ce("18446744073700000000");import vm from"bn.js";import _m from"decimal.js";var kl=Buffer.from("amm_config","utf8"),Tl=Buffer.from("pool","utf8"),Bl=Buffer.from("pool_vault","utf8"),hl=Buffer.from("pool_reward_vault","utf8"),xl=Buffer.from("position","utf8"),Il=Buffer.from("tick_array","utf8"),Cl=Buffer.from("operation","utf8"),Sl=Buffer.from("pool_tick_array_bitmap_extension","utf8"),Kl=Buffer.from("observation","utf8");function cn(n){return ae([Buffer.from("metadata","utf8"),Fe.toBuffer(),n.toBuffer()],Fe)}var Ll=Buffer.from("locked_position","utf8");var Rl=Buffer.from("support_mint","utf8");import{PublicKey as mm}from"@solana/web3.js";import{TOKEN_2022_PROGRAM_ID as pm}from"@solana/spl-token";import ym from"bn.js";import gm from"decimal.js";import Ol from"bn.js";import El from"decimal.js";var mn=14;var Lt=60;var hr=D([$(8),_("bump"),Me("index"),V(""),we("protocolFeeRate"),we("tradeFeeRate"),Me("tickSpacing"),q(I(),8,"")]),xr=D([we("blockTimestamp"),Gn("tickCumulative"),q(I(),4)]),ri=D([$(8),Se("initialized"),I("recentEpoch"),Me("observationIndex"),V("poolId"),q(xr,100,"observations"),q(I(),4)]),Ir=D([_("rewardState"),I("openTime"),I("endTime"),I("lastUpdateTime"),H("emissionsPerSecondX64"),I("rewardTotalEmissioned"),I("rewardClaimed"),V("tokenMint"),V("tokenVault"),V("creator"),H("rewardGrowthGlobalX64")]),ti=D([$(8),_("bump"),V("ammConfig"),V("creator"),V("mintA"),V("mintB"),V("vaultA"),V("vaultB"),V("observationId"),_("mintDecimalsA"),_("mintDecimalsB"),Me("tickSpacing"),H("liquidity"),H("sqrtPriceX64"),Ae("tickCurrent"),we(),H("feeGrowthGlobalX64A"),H("feeGrowthGlobalX64B"),I("protocolFeesTokenA"),I("protocolFeesTokenB"),H("swapInAmountTokenA"),H("swapOutAmountTokenB"),H("swapInAmountTokenB"),H("swapOutAmountTokenA"),_("status"),q(_(),7,""),q(Ir,3,"rewardInfos"),q(I(),16,"tickArrayBitmap"),I("totalFeesTokenA"),I("totalFeesClaimedTokenA"),I("totalFeesTokenB"),I("totalFeesClaimedTokenB"),I("fundFeesTokenA"),I("fundFeesTokenB"),I("startTime"),q(I(),15*4-3,"padding")]),Cr=D([H("growthInsideLastX64"),I("rewardAmountOwed")]),ni=D([$(8),_("bump"),V("nftMint"),V("poolId"),Ae("tickLower"),Ae("tickUpper"),H("liquidity"),H("feeGrowthInsideLastX64A"),H("feeGrowthInsideLastX64B"),I("tokenFeesOwedA"),I("tokenFeesOwedB"),q(Cr,3,"rewardInfos"),q(I(),8,"")]),md=D([$(8),_("bump"),V("poolId"),Ae("tickLowerIndex"),Ae("tickUpperIndex"),H("liquidity"),H("feeGrowthInsideLastX64A"),H("feeGrowthInsideLastX64B"),I("tokenFeesOwedA"),I("tokenFeesOwedB"),q(H(),3,"rewardGrowthInside"),q(I(),8,"")]),Sr=D([Ae("tick"),Un("liquidityNet"),H("liquidityGross"),H("feeGrowthOutsideX64A"),H("feeGrowthOutsideX64B"),q(H(),3,"rewardGrowthsOutsideX64"),q(we(),13,"")]),Jn=D([$(8),V("poolId"),Ae("startTickIndex"),q(Sr,Lt,"ticks"),_("initializedTickCount"),q(_(),115,"")]),Kr=D([$(329),q(V(),100,"whitelistMints")]),Br=D([$(8),V("poolId"),q(q(I(),8),mn,"positiveTickArrayBitmap"),q(q(I(),8),mn,"negativeTickArrayBitmap")]),dd=D([I(),_("bump"),V("owner"),V("poolId"),V("positionId"),V("nftAccount"),q(I(),8)]),Lr=D([$(8),_("bump"),V("lockOwner"),V("poolId"),V("positionId"),V("nftAccount"),V("lockNftMint"),I("recentEpoch"),q(I(),8)]);ri.span;var _d=Q("Raydium_Clmm");var Fr=Q("Raydium_cpmm"),Be={initialize:[175,175,109,31,13,152,155,237],deposit:[242,35,198,137,82,225,242,182],withdraw:[183,18,70,156,148,109,161,34],swapBaseInput:[143,190,90,218,196,30,51,222],swapBaseOutput:[55,217,98,86,163,74,180,173],lockCpLiquidity:[216,157,29,78,38,51,31,26],collectCpFee:[8,30,51,199,209,184,247,133],createPermissionPda:Buffer.from([135,136,2,216,137,169,181,202]),closePermissionPda:Buffer.from([156,84,32,118,69,135,70,123]),initializeWithPermission:Buffer.from([63,55,254,65,49,178,89,121]),collectCreatorFee:Buffer.from([20,22,86,123,198,28,219,132])};function oi(n,e,t,i,s,o,c,r,p,y,d,u,m,f,a,g,l,h,k,x){let w=D([I("amountMaxA"),I("amountMaxB"),I("openTime")]),P=nn(n,t,o,c).publicKey,b=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!s.equals(P),isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:y,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:ke,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:g,isSigner:!1,isWritable:!1},{pubkey:Rt,isSigner:!1,isWritable:!1},{pubkey:Cn,isSigner:!1,isWritable:!1},{pubkey:bt,isSigner:!1,isWritable:!1}],B=Buffer.alloc(w.span);return w.encode({amountMaxA:h,amountMaxB:k,openTime:x},B),new Te({keys:b,programId:n,data:Buffer.from([...Be.initialize,...B])})}function si(n,e,t,i,s,o,c,r,p,y,d,u,m,f,a){let g=D([I("lpAmount"),I("amountMaxA"),I("amountMaxB")]),l=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:ke,isSigner:!1,isWritable:!1},{pubkey:pn,isSigner:!1,isWritable:!1},{pubkey:y,isSigner:!1,isWritable:!1},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:u,isSigner:!1,isWritable:!0}],h=Buffer.alloc(g.span);return Fr.debug("cpmm deposit data",{lpAmount:m.toString(),amountMaxA:f.toString(),amountMaxB:a.toString()}),g.encode({lpAmount:m,amountMaxA:f,amountMaxB:a},h),new Te({keys:l,programId:n,data:Buffer.from([...Be.deposit,...h])})}function ai(n,e,t,i,s,o,c,r,p,y,d,u,m,f,a){let g=D([I("lpAmount"),I("amountMinA"),I("amountMinB")]),l=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:ke,isSigner:!1,isWritable:!1},{pubkey:pn,isSigner:!1,isWritable:!1},{pubkey:y,isSigner:!1,isWritable:!1},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:yt,isSigner:!1,isWritable:!1}],h=Buffer.alloc(g.span);return g.encode({lpAmount:m,amountMinA:f,amountMinB:a},h),new Te({keys:l,programId:n,data:Buffer.from([...Be.withdraw,...h])})}function ci(n,e,t,i,s,o,c,r,p,y,d,u,m,f,a,g){let l=D([I("amountIn"),I("amounOutMin")]),h=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:y,isSigner:!1,isWritable:!1},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:u,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:f,isSigner:!1,isWritable:!0}],k=Buffer.alloc(l.span);return l.encode({amountIn:a,amounOutMin:g},k),new Te({keys:h,programId:n,data:Buffer.from([...Be.swapBaseInput,...k])})}function ui(n,e,t,i,s,o,c,r,p,y,d,u,m,f,a,g){let l=D([I("amountInMax"),I("amountOut")]),h=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:y,isSigner:!1,isWritable:!1},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:u,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:f,isSigner:!1,isWritable:!0}],k=Buffer.alloc(l.span);return l.encode({amountInMax:a,amountOut:g},k),new Te({keys:h,programId:n,data:Buffer.from([...Be.swapBaseOutput,...k])})}async function li(n){var l;let{ownerInfo:e,poolInfo:t,poolKeys:i,feeNftOwner:s,getEphemeralSigners:o}=n,c=[],[r,p]=[new pt(t.id),new pt(t.lpMint.address)],y;if(o)y=new pt((await o(1))[0]);else{let h=Or.generate();c.push(h),y=h.publicKey}let{publicKey:d}=oe(s,y,ke),{publicKey:u}=cn(y),{publicKey:m}=ut(n.lockProgram,y),{publicKey:f}=oe(e.wallet,p,ke),{publicKey:a}=oe(n.lockAuthProgram,p,ke),g=Er({programId:n.lockProgram,auth:n.lockAuthProgram,payer:e.feePayer,liquidityOwner:e.wallet,nftOwner:s,nftMint:y,nftAccount:d,poolId:r,lockPda:m,mintLp:p,userLpVault:f,lockLpVault:a,poolVaultA:new pt(i.vault.A),poolVaultB:new pt(i.vault.B),metadataAccount:u,lpAmount:n.lpAmount,withMetadata:(l=n.withMetadata)!=null?l:!0});return{address:{nftMint:y,nftAccount:d,metadataAccount:u,lockPda:m,userLpVault:f,lockLpVault:a},instructions:[g],signers:c,instructionTypes:[J.CpmmLockLp],lookupTableAddress:[]}}function Er({programId:n,auth:e,payer:t,liquidityOwner:i,nftOwner:s,nftMint:o,nftAccount:c,poolId:r,lockPda:p,mintLp:y,userLpVault:d,lockLpVault:u,poolVaultA:m,poolVaultB:f,metadataAccount:a,lpAmount:g,withMetadata:l}){let h=[{pubkey:e,isSigner:!1,isWritable:!1},{pubkey:t,isSigner:!0,isWritable:!0},{pubkey:i,isSigner:!0,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!0,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:y,isSigner:!1,isWritable:!1},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:bt,isSigner:!1,isWritable:!1},{pubkey:dn.programId,isSigner:!1,isWritable:!1},{pubkey:ke,isSigner:!1,isWritable:!1},{pubkey:Rt,isSigner:!1,isWritable:!1},{pubkey:Fe,isSigner:!1,isWritable:!1}],k=D([I("lpAmount"),Se("withMetadata")]),x=Buffer.alloc(k.span);k.encode({lpAmount:g,withMetadata:l},x);let w=Buffer.from([...Be.lockCpLiquidity,...x]);return new Te({keys:h,programId:n,data:w})}function fn({programId:n,nftOwner:e,auth:t,nftAccount:i,lockPda:s,poolId:o,mintLp:c,userVaultA:r,userVaultB:p,poolVaultA:y,poolVaultB:d,mintA:u,mintB:m,lockLpVault:f,lpFeeAmount:a,cpmmProgram:g,cpmmAuthProgram:l}){let h=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:g!=null?g:et,isSigner:!1,isWritable:!1},{pubkey:l!=null?l:Fn,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:y,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:ke,isSigner:!1,isWritable:!1},{pubkey:pn,isSigner:!1,isWritable:!1},{pubkey:yt,isSigner:!1,isWritable:!1}],k=D([I("lpFeeAmount")]),x=Buffer.alloc(k.span);k.encode({lpFeeAmount:a},x);let w=Buffer.from([...Be.collectCpFee,...x]);return new Te({keys:h,programId:n,data:w})}function yn(n,e,t,i,s,o,c,r,p,y,d,u,m){let f=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:p,isSigner:!1,isWritable:!1},{pubkey:y,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:Rt,isSigner:!1,isWritable:!1},{pubkey:dn.programId,isSigner:!1,isWritable:!1}];return new Te({keys:f,programId:n,data:Be.collectCreatorFee})}function mi(n,e,t,i,s,o,c,r,p,y,d,u,m,f,a,g,l,h,k,x,w,P,b){let B=D([I("amountA"),I("amountB"),I("openTime"),_("feeOn")]),T=[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:y,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:k,isSigner:!1,isWritable:!0},{pubkey:ke,isSigner:!1,isWritable:!1},{pubkey:g,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:Rt,isSigner:!1,isWritable:!1},{pubkey:dn.programId,isSigner:!1,isWritable:!1}],K=Buffer.alloc(B.span);return B.encode({amountA:x,amountB:w,openTime:P,feeOn:b},K),new Te({keys:T,programId:n,data:Buffer.from([...Be.initializeWithPermission,...K])})}var di=D([$(8),_("bump"),Se("disableCreatePool"),Me("index"),I("tradeFeeRate"),I("protocolFeeRate"),I("fundFeeRate"),I("createPoolFee"),V("protocolOwner"),V("fundOwner"),I("creatorFeeRate"),q(I(),15)]),pi=D([$(8),V("configId"),V("poolCreator"),V("vaultA"),V("vaultB"),V("mintLp"),V("mintA"),V("mintB"),V("mintProgramA"),V("mintProgramB"),V("observationId"),_("bump"),_("status"),_("lpDecimals"),_("mintDecimalA"),_("mintDecimalB"),I("lpAmount"),I("protocolFeesMintA"),I("protocolFeesMintB"),I("fundFeesMintA"),I("fundFeesMintB"),I("openTime"),I("epoch"),_("feeOn"),Se("enableCreatorFee"),q(_(),6),I("creatorFeesMintA"),I("creatorFeesMintB"),q(I(),28)]),Qp=D([$(8),V("configId"),q(I(),30)]);var bn=class extends We{constructor(e){super(e)}async load(){this.checkDisabled()}async getCpmmPoolKeys(e){return(await this.scope.api.fetchPoolKeysById({idList:[e]}))[0]}async getRpcPoolInfo(e,t){return(await this.getRpcPoolInfos([e],t))[e]}async getRpcPoolInfos(e,t){let i=await Ke(this.scope.connection,e.map(u=>({pubkey:new A(u)}))),s={},o=new Set,c=[];for(let u=0;u<e.length;u++){let m=i[u];if(m.accountInfo===null)throw Error("fetch pool info error: "+String(e[u]));let f=pi.decode(m.accountInfo.data);s[String(e[u])]=U(v({},f),{programId:m.accountInfo.owner}),o.add(String(f.configId)),c.push(f.vaultA,f.vaultB)}let r={};if(t){let u=[...o],m=await Ke(this.scope.connection,u.map(f=>({pubkey:new A(f)})));for(let f=0;f<u.length;f++){let a=m[f].accountInfo;if(a===null)throw Error("fetch pool config error: "+u[f]);r[u[f]]=di.decode(a.data)}}let p={},y=await Ke(this.scope.connection,c.map(u=>({pubkey:new A(u)})));for(let u=0;u<c.length;u++){let m=y[u].accountInfo;if(m===null)throw Error("fetch vault info error: "+c[u]);p[String(c[u])]=new Y(Vr.decode(m.data).amount.toString())}let d={};for(let[u,m]of Object.entries(s)){let f=p[m.vaultA.toString()].sub(m.protocolFeesMintA).sub(m.fundFeesMintA).sub(m.creatorFeesMintA),a=p[m.vaultB.toString()].sub(m.protocolFeesMintB).sub(m.fundFeesMintB).sub(m.creatorFeesMintB);d[u]=U(v({},m),{baseReserve:f,quoteReserve:a,vaultAAmount:p[m.vaultA.toString()],vaultBAmount:p[m.vaultB.toString()],configInfo:r[m.configId.toString()],poolPrice:new ue(a.toString()).div(new ue(10).pow(m.mintDecimalB)).div(new ue(f.toString()).div(new ue(10).pow(m.mintDecimalA)))})}return d}toComputePoolInfos({pools:e,mintInfos:t}){return Object.keys(e).reduce((i,s)=>{var p,y,d,u;let o=e[s],[c,r]=[o.mintA.toBase58(),o.mintB.toBase58()];return U(v({},i),{[s]:U(v({},o),{id:new A(s),configInfo:o.configInfo,version:7,authority:St(o.programId).publicKey,mintA:Oe({address:c,decimals:o.mintDecimalA,programId:o.mintProgramA.toBase58(),extensions:{feeConfig:(p=t[c])!=null&&p.feeConfig?De((y=t[c])==null?void 0:y.feeConfig):void 0}}),mintB:Oe({address:r,decimals:o.mintDecimalB,programId:o.mintProgramB.toBase58(),extensions:{feeConfig:(d=t[r])!=null&&d.feeConfig?De((u=t[r])==null?void 0:u.feeConfig):void 0}})})})},{})}async getPoolInfoFromRpc(e){let t=await this.getRpcPoolInfo(e,!0),i=await Et({connection:this.scope.connection,mints:[t.mintA,t.mintB]}),s=Oe({address:t.mintA.toBase58(),decimals:t.mintDecimalA,programId:t.mintProgramA.toBase58(),extensions:{feeConfig:i[t.mintA.toBase58()].feeConfig?De(i[t.mintA.toBase58()].feeConfig):void 0}}),o=Oe({address:t.mintB.toBase58(),decimals:t.mintDecimalB,programId:t.mintProgramB.toBase58(),extensions:{feeConfig:i[t.mintB.toBase58()].feeConfig?De(i[t.mintB.toBase58()].feeConfig):void 0}}),c=Oe({address:t.mintLp.toBase58(),decimals:t.lpDecimals,programId:ne.toBase58()}),r={id:t.configId.toBase58(),index:t.configInfo.index,protocolFeeRate:t.configInfo.protocolFeeRate.toNumber(),tradeFeeRate:t.configInfo.tradeFeeRate.toNumber(),fundFeeRate:t.configInfo.fundFeeRate.toNumber(),createPoolFee:t.configInfo.createPoolFee.toString()},p={volume:0,volumeQuote:0,volumeFee:0,apr:0,feeApr:0,priceMin:0,priceMax:0,rewardApr:[]};return{poolInfo:{programId:t.programId.toBase58(),id:e,type:"Standard",lpMint:c,lpPrice:0,lpAmount:t.lpAmount.toNumber(),config:r,mintA:s,mintB:o,rewardDefaultInfos:[],rewardDefaultPoolInfos:"Ecosystem",price:t.poolPrice.toNumber(),mintAmountA:new ue(t.vaultAAmount.toString()).div(10**s.decimals).toNumber(),mintAmountB:new ue(t.vaultBAmount.toString()).div(10**o.decimals).toNumber(),feeRate:t.configInfo.tradeFeeRate.toNumber(),openTime:t.openTime.toString(),tvl:0,burnPercent:0,day:p,week:p,month:p,pooltype:[],farmUpcomingCount:0,farmOngoingCount:0,farmFinishedCount:0},poolKeys:{programId:t.programId.toBase58(),id:e,mintA:s,mintB:o,openTime:t.openTime.toString(),vault:{A:t.vaultA.toBase58(),B:t.vaultB.toBase58()},authority:St(t.programId).publicKey.toBase58(),mintLp:c,config:r,observationId:ct(t.programId,new A(e)).publicKey.toBase58()},rpcData:t}}async createPool(a){var g=a,{poolId:e,programId:t,poolFeeAccount:i,startTime:s,ownerInfo:o,associatedOnly:c=!1,checkCreateATAOwner:r=!1,txVersion:p,feeConfig:y,computeBudgetConfig:d,txTipConfig:u,feePayer:m}=g,f=le(g,["poolId","programId","poolFeeAccount","startTime","ownerInfo","associatedOnly","checkCreateATAOwner","txVersion","feeConfig","computeBudgetConfig","txTipConfig","feePayer"]);var E,G,Z;let l=o.feePayer||((E=this.scope.owner)==null?void 0:E.publicKey),h=new Y(new A(f.mintA.address).toBuffer()).lte(new Y(new A(f.mintB.address).toBuffer())),[k,x]=h?[f.mintA,f.mintB]:[f.mintB,f.mintA],[w,P]=h?[f.mintAAmount,f.mintBAmount]:[f.mintBAmount,f.mintAAmount],b=o.useSOLBalance&&k.address===qe.toBase58(),B=o.useSOLBalance&&x.address===qe.toBase58(),[T,K]=[new A(k.address),new A(x.address)],L=this.createTxBuilder(m),{account:S,instructionParams:C}=await this.scope.account.getOrCreateTokenAccount({mint:T,tokenProgram:k.programId,owner:this.scope.ownerPubKey,createInfo:b?{payer:l,amount:w}:void 0,notUseTokenAccount:b,skipCloseAccount:!b,associatedOnly:b?!1:c,checkCreateATAOwner:r});L.addInstruction(C||{});let{account:R,instructionParams:F}=await this.scope.account.getOrCreateTokenAccount({mint:new A(x.address),tokenProgram:x.programId,owner:this.scope.ownerPubKey,createInfo:B?{payer:l,amount:P}:void 0,notUseTokenAccount:B,skipCloseAccount:!B,associatedOnly:B?!1:c,checkCreateATAOwner:r});if(L.addInstruction(F||{}),S===void 0||R===void 0)throw Error("you don't has some token account");let W=rn({poolId:e,programId:t,configId:new A(y.id),mintA:T,mintB:K});return L.addInstruction({instructions:[oi(t,this.scope.ownerPubKey,new A(y.id),W.authority,W.poolId,T,K,W.lpMint,S,R,oe(this.scope.ownerPubKey,W.lpMint).publicKey,W.vaultA,W.vaultB,i,new A((G=k.programId)!=null?G:ne),new A((Z=x.programId)!=null?Z:ne),W.observationId,w,P,s)],instructionTypes:[J.CpmmCreatePool]}),L.addCustomComputeBudget(d),L.addTipInstruction(u),L.versionBuild({txVersion:p,extInfo:{address:U(v({},W),{mintA:k,mintB:x,programId:t,poolFeeAccount:i,feeConfig:y})}})}async addLiquidity(e){let{poolInfo:t,poolKeys:i,inputAmount:s,baseIn:o,slippage:c,computeResult:r,computeBudgetConfig:p,txTipConfig:y,config:d,txVersion:u,feePayer:m}=e;this.scope.availability.addStandardPosition===!1&&this.logAndCreateError("add liquidity feature disabled in your region"),s.isZero()&&this.logAndCreateError("amounts must greater than zero","amountInA",{amountInA:s.toString()});let{account:f}=this.scope,{bypassAssociatedCheck:a,checkCreateATAOwner:g}=v({bypassAssociatedCheck:!1,checkCreateATAOwner:!1},d),l=r?void 0:await this.getRpcPoolInfo(t.id),{liquidity:h,inputAmountFee:k,anotherAmount:x}=r||this.computePairAmount({poolInfo:U(v({},t),{lpAmount:new ue(l.lpAmount.toString()).div(10**t.lpMint.decimals).toNumber()}),baseReserve:l.baseReserve,quoteReserve:l.quoteReserve,slippage:new se(0),baseIn:o,epochInfo:await this.scope.fetchEpochInfo(),amount:new ue(s.toString()).div(10**(o?t.mintA.decimals:t.mintB.decimals))}),w=x.amount,P=t.mintA.address===qe.toString(),b=t.mintB.address===qe.toString(),B=this.createTxBuilder(m),[T,K]=[new A(t.mintA.address),new A(t.mintB.address)],{account:L,instructionParams:S}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:t.mintA.programId,mint:new A(t.mintA.address),owner:this.scope.ownerPubKey,createInfo:P||(o?s:w).isZero()?{payer:this.scope.ownerPubKey,amount:o?s:w}:void 0,skipCloseAccount:!P,notUseTokenAccount:P,associatedOnly:!1,checkCreateATAOwner:g});B.addInstruction(S||{});let{account:C,instructionParams:R}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:t.mintB.programId,mint:new A(t.mintB.address),owner:this.scope.ownerPubKey,createInfo:b||(o?w:s).isZero()?{payer:this.scope.ownerPubKey,amount:o?w:s}:void 0,skipCloseAccount:!b,notUseTokenAccount:b,associatedOnly:!1,checkCreateATAOwner:g});B.addInstruction(R||{}),!L&&!C&&this.logAndCreateError("cannot found target token accounts","tokenAccounts",f.tokenAccounts);let F=await f.getCreatedTokenAccount({mint:new A(t.lpMint.address)}),ee=await f.handleTokenAccount({side:"out",amount:0,mint:new A(t.lpMint.address),tokenAccount:F,bypassAssociatedCheck:a,checkCreateATAOwner:g}),{tokenAccount:W}=ee,E=le(ee,["tokenAccount"]);B.addInstruction(E);let G=i!=null?i:await this.getCpmmPoolKeys(t.id),Z=new se(new Y(1)).sub(c);return B.addInstruction({instructions:[si(new A(t.programId),this.scope.ownerPubKey,new A(G.authority),new A(t.id),W,L,C,new A(G.vault.A),new A(G.vault.B),T,K,new A(t.lpMint.address),r?r==null?void 0:r.liquidity:Z.mul(h).quotient,o?k.amount:w,o?w:k.amount)],instructionTypes:[J.CpmmAddLiquidity],lookupTableAddress:G.lookupTableAccount?[G.lookupTableAccount]:[]}),B.addCustomComputeBudget(p),B.addTipInstruction(y),B.versionBuild({txVersion:u})}async withdrawLiquidity(e){var E,G;let{poolInfo:t,poolKeys:i,lpAmount:s,slippage:o,computeBudgetConfig:c,txTipConfig:r,txVersion:p,feePayer:y,closeWsol:d=!0}=e;this.scope.availability.addStandardPosition===!1&&this.logAndCreateError("add liquidity feature disabled in your region");let u=new se(new Y(1)).sub(o),m=await this.getRpcPoolInfo(t.id),[f,a]=[u.mul(s.mul(m.baseReserve).div(m.lpAmount)).quotient,u.mul(s.mul(m.quoteReserve).div(m.lpAmount)).quotient],g=await this.scope.fetchEpochInfo(),[l,h]=[fe(f,t.mintA.extensions.feeConfig,g,!1),fe(a,t.mintB.extensions.feeConfig,g,!1)],{account:k}=this.scope,x=this.createTxBuilder(y),[w,P]=[new A(t.mintA.address),new A(t.mintB.address)],b=w.equals(ie),B=P.equals(ie),T,K,{account:L,instructionParams:S}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:t.mintA.programId,mint:new A(t.mintA.address),notUseTokenAccount:b,owner:this.scope.ownerPubKey,createInfo:{payer:this.scope.ownerPubKey,amount:0},skipCloseAccount:!(b&&d),associatedOnly:!b,checkCreateATAOwner:!1});T=L,S&&x.addInstruction(S);let{account:C,instructionParams:R}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:t.mintB.programId,mint:new A(t.mintB.address),notUseTokenAccount:B,owner:this.scope.ownerPubKey,createInfo:{payer:this.scope.ownerPubKey,amount:0},skipCloseAccount:!(B&&d),associatedOnly:!B,checkCreateATAOwner:!1});K=C,R&&x.addInstruction(R),(!T||!K)&&this.logAndCreateError("cannot found target token accounts","tokenAccounts",k.tokenAccounts);let F=await k.getCreatedTokenAccount({mint:new A(t.lpMint.address)});F||this.logAndCreateError("cannot found lp token account","tokenAccounts",k.tokenAccounts);let W=i!=null?i:await this.getCpmmPoolKeys(t.id);return x.addInstruction({instructions:[ai(new A(t.programId),this.scope.ownerPubKey,new A(W.authority),new A(t.id),F,T,K,new A(W.vault.A),new A(W.vault.B),w,P,new A(t.lpMint.address),s,f.sub((E=l.fee)!=null?E:new Y(0)),a.sub((G=h.fee)!=null?G:new Y(0)))],instructionTypes:[J.CpmmWithdrawLiquidity],lookupTableAddress:W.lookupTableAccount?[W.lookupTableAccount]:[]}),x.addCustomComputeBudget(c),x.addTipInstruction(r),x.versionBuild({txVersion:p})}async swap(e){var S,C,R,F,W,E;let{poolInfo:t,poolKeys:i,baseIn:s,fixedOut:o,inputAmount:c,swapResult:r,slippage:p=0,config:y,computeBudgetConfig:d,txTipConfig:u,txVersion:m,feePayer:f}=e,{bypassAssociatedCheck:a,checkCreateATAOwner:g,associatedOnly:l}=v({bypassAssociatedCheck:!1,checkCreateATAOwner:!1,associatedOnly:!0},y),h=this.createTxBuilder(f),[k,x]=[new A(t.mintA.address),new A(t.mintB.address)];o?r.inputAmount=r.inputAmount.mul(new Y((1+p)*1e4)).div(new Y(1e4)):r.outputAmount=r.outputAmount.mul(new Y((1-p)*1e4)).div(new Y(1e4));let w=t.mintA.address===ie.toBase58(),P=t.mintB.address===ie.toBase58(),{account:b,instructionParams:B}=await this.scope.account.getOrCreateTokenAccount({mint:k,tokenProgram:new A((S=t.mintA.programId)!=null?S:ne),owner:this.scope.ownerPubKey,createInfo:w||!s?{payer:this.scope.ownerPubKey,amount:s?r.inputAmount:0}:void 0,notUseTokenAccount:w,skipCloseAccount:!w,associatedOnly:w?!1:l,checkCreateATAOwner:g});B&&h.addInstruction(B);let{account:T,instructionParams:K}=await this.scope.account.getOrCreateTokenAccount({mint:x,tokenProgram:new A((C=t.mintB.programId)!=null?C:ne),owner:this.scope.ownerPubKey,createInfo:P||s?{payer:this.scope.ownerPubKey,amount:s?0:r.inputAmount}:void 0,notUseTokenAccount:P,skipCloseAccount:!P,associatedOnly:P?!1:l,checkCreateATAOwner:g});K&&h.addInstruction(K),(!b||!T)&&this.logAndCreateError("user do not have token account",{mintA:t.mintA.symbol||t.mintA.address,mintB:t.mintB.symbol||t.mintB.address,mintATokenAcc:b,mintBTokenAcc:T,mintAUseSOLBalance:w,mintBUseSOLBalance:P,associatedOnly:l});let L=i!=null?i:await this.getCpmmPoolKeys(t.id);return h.addInstruction({instructions:[o?ui(new A(t.programId),this.scope.ownerPubKey,new A(L.authority),new A(L.config.id),new A(t.id),s?b:T,s?T:b,new A(L.vault[s?"A":"B"]),new A(L.vault[s?"B":"A"]),new A((W=t[s?"mintA":"mintB"].programId)!=null?W:ne),new A((E=t[s?"mintB":"mintA"].programId)!=null?E:ne),s?k:x,s?x:k,ct(new A(t.programId),new A(t.id)).publicKey,r.inputAmount,r.outputAmount):ci(new A(t.programId),this.scope.ownerPubKey,new A(L.authority),new A(L.config.id),new A(t.id),s?b:T,s?T:b,new A(L.vault[s?"A":"B"]),new A(L.vault[s?"B":"A"]),new A((R=t[s?"mintA":"mintB"].programId)!=null?R:ne),new A((F=t[s?"mintB":"mintA"].programId)!=null?F:ne),s?k:x,s?x:k,ct(new A(t.programId),new A(t.id)).publicKey,c,r.outputAmount)],instructionTypes:[o?J.CpmmSwapBaseOut:J.ClmmSwapBaseIn]}),h.addCustomComputeBudget(d),h.addTipInstruction(u),h.versionBuild({txVersion:m})}async lockLp(e){var m,f,a,g,l;let{poolInfo:t,lpAmount:i,computeBudgetConfig:s,txTipConfig:o,txVersion:c,feePayer:r,feeNftOwner:p}=e;i.isZero()&&this.logAndCreateError("lpAmount must greater than zero",{lpAmount:i.toString()});let y=this.createTxBuilder(r),d=(m=e.poolKeys)!=null?m:await this.getCpmmPoolKeys(t.id),u=await li({poolInfo:t,poolKeys:d,ownerInfo:{wallet:this.scope.ownerPubKey,feePayer:(f=e.feePayer)!=null?f:this.scope.ownerPubKey},feeNftOwner:p!=null?p:this.scope.ownerPubKey,lockProgram:(a=e.programId)!=null?a:kt,lockAuthProgram:(g=e.authProgram)!=null?g:Tt,lpAmount:i,withMetadata:(l=e.withMetadata)!=null?l:!0,getEphemeralSigners:e.getEphemeralSigners});return y.addInstruction(u),y.addCustomComputeBudget(s),y.addTipInstruction(o),y.versionBuild({txVersion:c,extInfo:u.address})}async harvestLockLp(e){var C;let{poolInfo:t,lpFeeAmount:i,nftMint:s,programId:o=kt,authProgram:c=Tt,cpmmProgram:r,computeBudgetConfig:p,txTipConfig:y,txVersion:d,closeWsol:u=!0}=e;i.isZero()&&this.logAndCreateError("lpFeeAmount must greater than zero",{lpAmount:i.toString()});let m=e.feePayer||this.scope.ownerPubKey,f=this.createTxBuilder(m),[a,g]=[new A(t.mintA.address),new A(t.mintB.address)],l=a.equals(ie),h=g.equals(ie),k,x,{account:w,instructionParams:P}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:t.mintA.programId,mint:new A(t.mintA.address),notUseTokenAccount:l,owner:this.scope.ownerPubKey,createInfo:{payer:this.scope.ownerPubKey,amount:0},skipCloseAccount:!(l&&u),associatedOnly:!l,checkCreateATAOwner:!1});k=w,P&&f.addInstruction(P);let{account:b,instructionParams:B}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:t.mintB.programId,mint:new A(t.mintB.address),notUseTokenAccount:h,owner:this.scope.ownerPubKey,createInfo:{payer:this.scope.ownerPubKey,amount:0},skipCloseAccount:!(h&&u),associatedOnly:!h,checkCreateATAOwner:!1});x=b,B&&f.addInstruction(B),(!k||!x)&&this.logAndCreateError("cannot found target token accounts",{tokenAccountA:k,tokenAccountB:x});let T=(C=e.poolKeys)!=null?C:await this.getCpmmPoolKeys(t.id),{publicKey:K}=oe(m,s,ne),{publicKey:L}=ut(o,s),{publicKey:S}=oe(c,new A(t.lpMint.address),ne);return f.addInstruction({instructions:[fn({programId:o,nftOwner:this.scope.ownerPubKey,auth:c,nftMint:s,nftAccount:K,lockPda:L,poolId:new A(t.id),mintLp:new A(T.mintLp.address),userVaultA:k,userVaultB:x,poolVaultA:new A(T.vault.A),poolVaultB:new A(T.vault.B),mintA:a,mintB:g,lockLpVault:S,lpFeeAmount:i,cpmmProgram:r==null?void 0:r.programId,cpmmAuthProgram:r==null?void 0:r.authProgram})],instructionTypes:[J.CpmmCollectLockFee]}),f.addCustomComputeBudget(p),f.addTipInstruction(y),f.versionBuild({txVersion:d})}async harvestMultiLockLp(e){var m;let{lockInfo:t,programId:i=kt,authProgram:s=Tt,cpmmProgram:o,computeBudgetConfig:c,txVersion:r,closeWsol:p=!0}=e,y=e.feePayer||this.scope.ownerPubKey,d=this.createTxBuilder(y),u={};for(let f of t){let{poolInfo:a,lpFeeAmount:g,nftMint:l}=f;if(g.isZero())continue;let[h,k]=[new A(a.mintA.address),new A(a.mintB.address)],x=h.equals(ie),w=k.equals(ie),P=u[a.mintA.address],b=u[a.mintB.address];if(!P)if(x){let{account:S,instructionParams:C}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:a.mintA.programId,mint:new A(a.mintA.address),notUseTokenAccount:!0,owner:this.scope.ownerPubKey,createInfo:{payer:this.scope.ownerPubKey,amount:0},skipCloseAccount:!p,associatedOnly:!1,checkCreateATAOwner:!1});P=S,C&&d.addInstruction(C),u[a.mintA.address]=S}else{let S=new A(a.mintA.address);P=this.scope.account.getAssociatedTokenAccount(S,new A(a.mintA.programId)),d.addInstruction({instructions:[Ge(this.scope.ownerPubKey,P,this.scope.ownerPubKey,S,new A(a.mintA.programId))]}),u[a.mintA.address]=P}if(!b)if(w){let{account:S,instructionParams:C}=await this.scope.account.getOrCreateTokenAccount({tokenProgram:a.mintB.programId,mint:new A(a.mintB.address),notUseTokenAccount:!0,owner:this.scope.ownerPubKey,createInfo:{payer:this.scope.ownerPubKey,amount:0},skipCloseAccount:!p,associatedOnly:!1,checkCreateATAOwner:!1});b=S,C&&d.addInstruction(C),u[a.mintB.address]=S}else{let S=new A(a.mintB.address);b=this.scope.account.getAssociatedTokenAccount(S,new A(a.mintB.programId)),d.addInstruction({instructions:[Ge(this.scope.ownerPubKey,b,this.scope.ownerPubKey,S,new A(a.mintB.programId))]}),u[a.mintB.address]=b}(!P||!b)&&this.logAndCreateError("cannot found target token accounts",{tokenAccountA:P,tokenAccountB:b});let B=(m=f.poolKeys)!=null?m:await this.getCpmmPoolKeys(a.id),{publicKey:T}=oe(y,l,ne),{publicKey:K}=ut(i,l),{publicKey:L}=oe(s,new A(a.lpMint.address),ne);d.addInstruction({instructions:[fn({programId:i,nftOwner:this.scope.ownerPubKey,auth:s,nftMint:l,nftAccount:T,lockPda:K,poolId:new A(a.id),mintLp:new A(B.mintLp.address),userVaultA:P,userVaultB:b,poolVaultA:new A(B.vault.A),poolVaultB:new A(B.vault.B),mintA:h,mintB:k,lockLpVault:L,lpFeeAmount:g,cpmmProgram:o==null?void 0:o.programId,cpmmAuthProgram:o==null?void 0:o.authProgram})],instructionTypes:[J.CpmmCollectLockFee]})}return r===0?d.sizeCheckBuildV0({computeBudgetConfig:c}):d.sizeCheckBuild({computeBudgetConfig:c})}async createPoolWithPermission(g){var l=g,{poolId:e,programId:t,poolFeeAccount:i,startTime:s,ownerInfo:o,associatedOnly:c=!1,checkCreateATAOwner:r=!1,txVersion:p,feeConfig:y,computeBudgetConfig:d,txTipConfig:u,feePayer:m,feeOn:f}=l,a=le(l,["poolId","programId","poolFeeAccount","startTime","ownerInfo","associatedOnly","checkCreateATAOwner","txVersion","feeConfig","computeBudgetConfig","txTipConfig","feePayer","feeOn"]);var G,Z,ee;console.log("***this method only available for wallet with permissions***");let h=o.feePayer||((G=this.scope.owner)==null?void 0:G.publicKey),k=new Y(new A(a.mintA.address).toBuffer()).lte(new Y(new A(a.mintB.address).toBuffer())),[x,w]=k?[a.mintA,a.mintB]:[a.mintB,a.mintA],[P,b]=k?[a.mintAAmount,a.mintBAmount]:[a.mintBAmount,a.mintAAmount],B=o.useSOLBalance&&x.address===qe.toBase58(),T=o.useSOLBalance&&w.address===qe.toBase58(),[K,L]=[new A(x.address),new A(w.address)],S=this.createTxBuilder(m),{account:C,instructionParams:R}=await this.scope.account.getOrCreateTokenAccount({mint:K,tokenProgram:x.programId,owner:this.scope.ownerPubKey,createInfo:B?{payer:h,amount:P}:void 0,notUseTokenAccount:B,skipCloseAccount:!B,associatedOnly:B?!1:c,checkCreateATAOwner:r});S.addInstruction(R||{});let{account:F,instructionParams:W}=await this.scope.account.getOrCreateTokenAccount({mint:new A(w.address),tokenProgram:w.programId,owner:this.scope.ownerPubKey,createInfo:T?{payer:h,amount:b}:void 0,notUseTokenAccount:T,skipCloseAccount:!T,associatedOnly:T?!1:c,checkCreateATAOwner:r});if(S.addInstruction(W||{}),C===void 0||F===void 0)throw Error("you don't has some token account");let E=rn({poolId:e,programId:t,configId:new A(y.id),mintA:K,mintB:L});return S.addInstruction({instructions:[mi(t,this.scope.ownerPubKey,this.scope.ownerPubKey,new A(y.id),E.authority,E.poolId,K,L,E.lpMint,C,F,oe(this.scope.ownerPubKey,E.lpMint).publicKey,E.vaultA,E.vaultB,i,new A((Z=x.programId)!=null?Z:ne),new A((ee=w.programId)!=null?ee:ne),E.observationId,zn(t,this.scope.ownerPubKey).publicKey,P,b,s,f)],instructionTypes:[J.CpmmCreatePool]}),S.addCustomComputeBudget(d),S.addTipInstruction(u),S.versionBuild({txVersion:p,extInfo:{address:U(v({},E),{mintA:x,mintB:w,programId:t,poolFeeAccount:i,feeConfig:y})}})}async collectCreatorFees({poolInfo:e,poolKeys:t,programId:i=et,txVersion:s,computeBudgetConfig:o,txTipConfig:c,feePayer:r}){let p=r||this.scope.ownerPubKey,y=this.createTxBuilder(p),d=t!=null?t:await this.getCpmmPoolKeys(e.id),[u,m,f,a]=[new A(e.mintA.address),new A(e.mintB.address),new A(e.mintA.programId),new A(e.mintB.programId)],g=this.scope.account.getAssociatedTokenAccount(u,f),l=this.scope.account.getAssociatedTokenAccount(m,a);return y.addInstruction({instructions:[Ge(this.scope.ownerPubKey,g,this.scope.ownerPubKey,u,new A(e.mintA.programId)),Ge(this.scope.ownerPubKey,l,this.scope.ownerPubKey,m,new A(e.mintB.programId))]}),y.addInstruction({instructions:[yn(i,this.scope.ownerPubKey,new A(d.authority),new A(d.id),new A(d.config.id),new A(d.vault.A),new A(d.vault.B),u,m,g,l,f,a)],instructionTypes:[]}),y.addCustomComputeBudget(o),y.addTipInstruction(c),y.versionBuild({txVersion:s})}async collectMultiCreatorFees({poolInfoList:e,programId:t=et,txVersion:i,computeBudgetConfig:s,feePayer:o}){let c=o||this.scope.ownerPubKey,r=this.createTxBuilder(c),p={},y=await this.scope.api.fetchPoolKeysById({idList:e.map(d=>d.id)});for(let d of e){let u=y.find(k=>k.id===d.id)||await this.getCpmmPoolKeys(d.id),[m,f,a,g]=[new A(d.mintA.address),new A(d.mintB.address),new A(d.mintA.programId),new A(d.mintB.programId)],l=p[d.mintA.address]||this.scope.account.getAssociatedTokenAccount(m,a),h=p[d.mintB.address]||this.scope.account.getAssociatedTokenAccount(f,g);p[d.mintA.address]||r.addInstruction({instructions:[Ge(this.scope.ownerPubKey,l,this.scope.ownerPubKey,m,a)]}),p[d.mintB.address]||r.addInstruction({instructions:[Ge(this.scope.ownerPubKey,h,this.scope.ownerPubKey,f,g)]}),p[d.mintA.address]=l,p[d.mintB.address]=h,r.addInstruction({instructions:[yn(t,this.scope.ownerPubKey,new A(u.authority),new A(u.id),new A(u.config.id),new A(u.vault.A),new A(u.vault.B),m,f,l,h,a,g)],instructionTypes:[]})}return i===0?r.sizeCheckBuildV0({computeBudgetConfig:s}):r.sizeCheckBuild({computeBudgetConfig:s})}computeSwapAmount({pool:e,amountIn:t,outputMint:i,slippage:s}){let o=i.toString()===e.mintB.address,c=e.feeOn===0||e.feeOn===2,r=o?at.swapBaseInput(t,o?e.baseReserve:e.quoteReserve,o?e.quoteReserve:e.baseReserve,e.configInfo.tradeFeeRate,e.configInfo.creatorFeeRate,e.configInfo.protocolFeeRate,e.configInfo.fundFeeRate,c):at.swapBaseOutput(t,o?e.baseReserve:e.quoteReserve,o?e.quoteReserve:e.baseReserve,e.configInfo.tradeFeeRate,e.configInfo.creatorFeeRate,e.configInfo.protocolFeeRate,e.configInfo.fundFeeRate,c),p=new ue(r.outputAmount.toString()).div(r.inputAmount.toString()),y=r.outputAmount.mul(new Y((1-s)*1e4)).div(new Y(1e4));return{allTrade:r.inputAmount.eq(t),amountIn:t,amountOut:r.outputAmount,minAmountOut:y,executionPrice:p,fee:r.tradeFee,priceImpact:e.poolPrice.sub(p).div(e.poolPrice)}}computePairAmount({poolInfo:e,baseReserve:t,quoteReserve:i,amount:s,slippage:o,epochInfo:c,baseIn:r}){var w,P,b,B,T,K,L,S,C;let p=1-Number(o.toSignificant())/100,y=new Y(new ue(s).mul(10**e[r?"mintA":"mintB"].decimals).mul(p).toFixed(0)),d=fe(y,e[r?"mintA":"mintB"].extensions.feeConfig,c,!1),u=y.sub((w=d.fee)!=null?w:new Y(0)),m=new Y(new ue(e.lpAmount).mul(10**e.lpMint.decimals).toFixed(0,ue.ROUND_DOWN));this.logDebug("baseReserve:",t.toString(),"quoteReserve:",i.toString()),this.logDebug("tokenIn:",r?e.mintA.symbol:e.mintB.symbol,"amountIn:",y.toString(),"amountInFee:",(b=(P=d.fee)==null?void 0:P.toString())!=null?b:0,"anotherToken:",r?e.mintB.symbol:e.mintA.symbol,"slippage:",`${o.toSignificant()}%`);let f=r?"base":"quote";this.logDebug("input side:",f);let a=u.mul(m).div(f==="base"?t:i),g={amount:Xt,fee:void 0,expirationTime:void 0};if(!u.isZero()){let R=Wr(a,t,i,m);this.logDebug("lpAmountData:",{amountA:R.amountA.toString(),amountB:R.amountB.toString()}),g=fe(R[r?"amountB":"amountA"],e[r?"mintB":"mintA"].extensions.feeConfig,c,!0)}let l=new se(new Y(1)).add(o),h=new se(new Y(1)).sub(o),k=fe(l.mul(g.amount.sub((B=g.fee)!=null?B:new Y(0))).quotient,e[r?"mintB":"mintA"].extensions.feeConfig,c,!0),x=fe(h.mul(g.amount.sub((T=g.fee)!=null?T:new Y(0))).quotient,e[r?"mintB":"mintA"].extensions.feeConfig,c,!0);return this.logDebug("anotherAmount:",g.amount.toString(),"anotherAmountFee:",(L=(K=g.fee)==null?void 0:K.toString())!=null?L:0,"maxAnotherAmount:",k.amount.toString(),"maxAnotherAmountFee:",(C=(S=k.fee)==null?void 0:S.toString())!=null?C:0),{inputAmountFee:d,anotherAmount:g,maxAnotherAmount:k,minAnotherAmount:x,liquidity:a}}};function Wr(n,e,t,i){let s=n.mul(e).div(i);!s.isZero()&&!n.mul(e).mod(i).isZero()&&(s=s.add(new Y(1)));let o=n.mul(t).div(i);return!o.isZero()&&!n.mul(t).mod(i).isZero()&&(o=o.add(new Y(1))),{amountA:s,amountB:o}}export{bn as default};
//# sourceMappingURL=cpmm.mjs.map