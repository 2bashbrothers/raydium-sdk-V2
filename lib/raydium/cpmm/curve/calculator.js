var Me=Object.create;var D=Object.defineProperty,Fe=Object.defineProperties,Le=Object.getOwnPropertyDescriptor,De=Object.getOwnPropertyDescriptors,Ee=Object.getOwnPropertyNames,ae=Object.getOwnPropertySymbols,_e=Object.getPrototypeOf,ue=Object.prototype.hasOwnProperty,Oe=Object.prototype.propertyIsEnumerable;var ce=(n,e,t)=>e in n?D(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,k=(n,e)=>{for(var t in e||(e={}))ue.call(e,t)&&ce(n,t,e[t]);if(ae)for(var t of ae(e))Oe.call(e,t)&&ce(n,t,e[t]);return n},C=(n,e)=>Fe(n,De(e));var Ve=(n,e)=>{for(var t in e)D(n,t,{get:e[t],enumerable:!0})},le=(n,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of Ee(e))!ue.call(n,a)&&a!==t&&D(n,a,{get:()=>e[a],enumerable:!(i=Le(e,a))||i.enumerable});return n};var u=(n,e,t)=>(t=n!=null?Me(_e(n)):{},le(e||!n||!n.__esModule?D(t,"default",{value:n,enumerable:!0}):t,n)),ve=n=>le(D({},"__esModule",{value:!0}),n);var ot={};Ve(ot,{CurveCalculator:()=>oe,RoundDirection:()=>Z,TradeDirection:()=>Ie,TradeDirectionOpposite:()=>Re});module.exports=ve(ot);var ie=u(require("bn.js"));var _=u(require("bn.js"));function Y(n,e){if(e.isZero())throw Error("divisor is zero");return n.mod(e)}function We(n,e){if(e.isZero())throw Error("rhs is zero");let t=n.div(e);return Y(n,e).gt(E)&&(t=t.add(new _.default(1))),[t,e]}var E=new _.default(0),O=class{static swapBaseInputWithoutFees(e,t,i){let a=e.mul(i),l=t.add(e);return a.div(l)}static swapBaseOutputWithoutFees(e,t,i){let a=t.mul(e),l=i.sub(e),[m]=We(a,l);return m}static lpTokensToTradingTokens(e,t,i,a,l){let m=e.mul(i).div(t),T=e.mul(a).div(t);if(l===0)return{tokenAmount0:m,tokenAmount1:T};if(l===1)return Y(e.mul(i),t).gt(E)&&m.gt(E)&&(m=m.add(new _.default(1))),Y(e.mul(a),t).gt(E)&&T.gt(E)&&(T=T.add(new _.default(1))),{tokenAmount0:m,tokenAmount1:T};throw Error("roundDirection value error")}};var Ne=u(require("bn.js"));var g=u(require("bn.js")),it=u(require("decimal.js"));var Ce=u(require("big.js")),nt=u(require("bn.js"));var V=require("lodash");var J=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:0,this.name=e.name}set level(e){this.logLevel=e}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let t=e.map(i=>typeof i=="object"?JSON.stringify(i):i).join(", ");throw new Error(t)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},me={},Ke={};function f(n){let e=(0,V.get)(me,n);if(!e){let t=(0,V.get)(Ke,n);e=new J({name:n,logLevel:t}),(0,V.set)(me,n,e)}return e}var qe=require("@solana/web3.js");var U=require("@solana/spl-token"),ht=f("Raydium_accountInfo_util");var N=u(require("bn.js"));var pe=9007199254740991;function y(n){let e=f("Raydium_parseBigNumberish");if(n instanceof N.default)return n;if(typeof n=="string"){if(n.match(/^-?[0-9]+$/))return new N.default(n);e.logWithError(`invalid BigNumberish string: ${n}`)}return typeof n=="number"?(n%1&&e.logWithError(`BigNumberish number underflow: ${n}`),(n>=pe||n<=-pe)&&e.logWithError(`BigNumberish number overflow: ${n}`),new N.default(String(n))):typeof n=="bigint"?new N.default(n.toString()):(e.error(`invalid BigNumberish value: ${n}`),new N.default(0))}var de=require("@solana/web3.js"),Q=require("@solana/spl-token"),fe={chainId:101,address:de.PublicKey.default.toBase58(),programId:Q.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},B={chainId:101,address:"So11111111111111111111111111111111111111112",programId:Q.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};var G=require("@solana/web3.js");var s=require("@solana/web3.js"),ge=require("@solana/spl-token");function $({pubkey:n,isSigner:e=!1,isWritable:t=!0}){return{pubkey:n,isWritable:t,isSigner:e}}var St=[$({pubkey:ge.TOKEN_PROGRAM_ID,isWritable:!1}),$({pubkey:s.SystemProgram.programId,isWritable:!1}),$({pubkey:s.SYSVAR_RENT_PUBKEY,isWritable:!1})];function he({publicKey:n,transformSol:e}){let t=Te(n.toString());if(t instanceof s.PublicKey)return e&&t.equals(v)?X:t;if(e&&t.toString()===v.toBase58())return X;if(typeof t=="string"){if(t===s.PublicKey.default.toBase58())return s.PublicKey.default;try{return new s.PublicKey(t)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function Te(n){try{return new s.PublicKey(n)}catch{return n}}var kt=new s.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),Ct=new s.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),Nt=new s.PublicKey("SysvarRent111111111111111111111111111111111"),It=new s.PublicKey("SysvarC1ock11111111111111111111111111111111"),Rt=new s.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),Mt=new s.PublicKey("Sysvar1nstructions1111111111111111111111111"),Ft=s.SystemProgram.programId,Lt=new s.PublicKey("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),Dt=new s.PublicKey("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),Et=new s.PublicKey("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),_t=new s.PublicKey("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),Ot=new s.PublicKey("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),Vt=new s.PublicKey("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),vt=new s.PublicKey("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),Wt=new s.PublicKey("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),Kt=new s.PublicKey("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),qt=new s.PublicKey("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),Ut=new s.PublicKey("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),X=new s.PublicKey("So11111111111111111111111111111111111111112"),v=s.PublicKey.default;var ee=class{constructor({mint:e,decimals:t,symbol:i,name:a,skipMint:l=!1,isToken2022:m=!1}){if(e===v.toBase58()||e instanceof G.PublicKey&&v.equals(e)){this.decimals=B.decimals,this.symbol=B.symbol,this.name=B.name,this.mint=new G.PublicKey(B.address),this.isToken2022=!1;return}this.decimals=t,this.symbol=i||e.toString().substring(0,6),this.name=a||e.toString().substring(0,6),this.mint=l?G.PublicKey.default:he({publicKey:e}),this.isToken2022=m}equals(e){return this===e?!0:this.mint.equals(e.mint)}},I=ee;I.WSOL=new ee(C(k({},B),{mint:B.address}));var te=class{constructor({decimals:e,symbol:t="UNKNOWN",name:i="UNKNOWN"}){this.decimals=e,this.symbol=t,this.name=i}equals(e){return this===e}},H=te;H.SOL=new te(fe);var be=u(require("toformat")),Ue=be.default,W=Ue;var K=u(require("big.js")),ye=u(require("bn.js")),we=u(require("decimal.js-light"));var j=f("module/fraction"),ne=W(K.default),q=W(we.default),He={[0]:q.ROUND_DOWN,[1]:q.ROUND_HALF_UP,[2]:q.ROUND_UP},je={[0]:K.default.roundDown,[1]:K.default.roundHalfUp,[2]:K.default.roundUp},c=class{constructor(e,t=new ye.default(1)){this.numerator=y(e),this.denominator=y(t)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new c(this.denominator,this.numerator)}add(e){let t=e instanceof c?e:new c(y(e));return this.denominator.eq(t.denominator)?new c(this.numerator.add(t.numerator),this.denominator):new c(this.numerator.mul(t.denominator).add(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}sub(e){let t=e instanceof c?e:new c(y(e));return this.denominator.eq(t.denominator)?new c(this.numerator.sub(t.numerator),this.denominator):new c(this.numerator.mul(t.denominator).sub(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}mul(e){let t=e instanceof c?e:new c(y(e));return new c(this.numerator.mul(t.numerator),this.denominator.mul(t.denominator))}div(e){let t=e instanceof c?e:new c(y(e));return new c(this.numerator.mul(t.denominator),this.denominator.mul(t.numerator))}toSignificant(e,t={groupSeparator:""},i=1){Number.isInteger(e)||j.logWithError(`${e} is not an integer.`),e<=0&&j.logWithError(`${e} is not positive.`),q.set({precision:e+1,rounding:He[i]});let a=new q(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return a.toFormat(a.decimalPlaces(),t)}toFixed(e,t={groupSeparator:""},i=1){return Number.isInteger(e)||j.logWithError(`${e} is not an integer.`),e<0&&j.logWithError(`${e} is negative.`),ne.DP=e,ne.RM=je[i]||1,new ne(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,t)}isZero(){return this.numerator.isZero()}};var xe=u(require("bn.js"));var sn=new c(new xe.default(100));var pn=f("Raydium_price");var Je=require("@solana/web3.js"),Xe=require("@solana/spl-token");var R=require("@solana/web3.js");var Ze=require("@solana/spl-token"),Vn=f("Raydium_txUtil");var r=require("@solana/web3.js"),Un=new r.PublicKey("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),Gn=new r.PublicKey("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),Hn=new r.PublicKey("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),jn=new r.PublicKey("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),zn=new r.PublicKey("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),Yn=new r.PublicKey("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),Zn=new r.PublicKey("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),Jn=new r.PublicKey("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),Xn=new r.PublicKey("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),Qn=new r.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),$n=new r.PublicKey("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),er=new r.PublicKey("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),tr=new r.PublicKey("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),nr=new r.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),rr=new r.PublicKey("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),ir=new r.PublicKey("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),or=new r.PublicKey("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),sr=new r.PublicKey("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),ar=new r.PublicKey("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),cr=new r.PublicKey("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),ur=new r.PublicKey("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),lr=new r.PublicKey("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),mr=new r.PublicKey("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),pr=new r.PublicKey("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),dr=new r.PublicKey("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),fr=new r.PublicKey("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),gr=new r.PublicKey("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),hr=new r.PublicKey("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),Tr=new r.PublicKey("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),br=new r.PublicKey("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),yr=new r.PublicKey("6s1xP3hpbAfFoNtUNF8mfHsjr2Bd97JxFJRWLbL6aHuX");var wr={OPEN_BOOK_PROGRAM:new r.PublicKey("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),SERUM_PROGRAM_ID_V3:new r.PublicKey("Ray1111111111111111111111111111111111111111"),AMM_V4:new r.PublicKey("DRaya7Kj3aMWQSy19kSjvmuwq9docCHofyP9kanQGaav"),AMM_STABLE:new r.PublicKey("DRayDdXc1NZQ9C3hRWmoSf8zK4iapgMnjdNZWrfwsP8m"),CLMM_PROGRAM_ID:new r.PublicKey("DRayAUgENGQBKVaX8owNhgzkEDyoHTGVEGHVJT1E9pfH"),CLMM_LOCK_PROGRAM_ID:new r.PublicKey("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),CLMM_LOCK_AUTH_ID:new r.PublicKey("6Aoh8h2Lw2m5UGxYR8AdAL87jTWYeKoxM52mJRzfYwN"),CREATE_CPMM_POOL_PROGRAM:new r.PublicKey("DRaycpLY18LhpbydsBWbVJtxpNv9oXPgjRSfpF2bWpYb"),CREATE_CPMM_POOL_AUTH:new r.PublicKey("CXniRufdq5xL8t8jZAPxsPZDpuudwuJSPWnbcD5Y5Nxq"),CREATE_CPMM_POOL_FEE_ACC:new r.PublicKey("3oE58BKVt8KuYkGxx8zBojugnymWmBiyafWgMrnb6eYy"),LOCK_CPMM_PROGRAM:new r.PublicKey("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),LOCK_CPMM_AUTH:new r.PublicKey("7qWVV8UY2bRJfDLP4s37YzBPKUkVB46DStYJBpYbQzu3"),UTIL1216:r.PublicKey.default,Router:new r.PublicKey("DRaybByLpbUL57LJARs3j8BitTxVfzBg351EaMr5UTCd"),FARM_PROGRAM_ID_V3:new r.PublicKey("DRayWyrLmEW5KEeqs8kdTMMaBabapqagaBC7KWpGtJeZ"),FARM_PROGRAM_ID_V4:new r.PublicKey("Ray1111111111111111111111111111111111111111"),FARM_PROGRAM_ID_V5:new r.PublicKey("DRayiCGSZgku1GTK6rXD6mVDdingXy6APAH1R6R5L2LC"),FARM_PROGRAM_ID_V6:new r.PublicKey("DRayzbYakXs45ELHkzH6vC3fuhQqTAnv5A68gdFuvZyZ"),LAUNCHPAD_PROGRAM:new r.PublicKey("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),LAUNCHPAD_AUTH:new r.PublicKey("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),LAUNCHPAD_PLATFORM:new r.PublicKey("2Jx4KTDrVSdWNazuGpcA8n3ZLTRGGBDxAWhuKe2Xcj2a"),LAUNCHPAD_CONFIG:new r.PublicKey("7ZR4zD7PYfY2XxoG1Gxcy2EgEeGYrpxrwzPuwdUBssEt"),FEE_DESTINATION_ID:new r.PublicKey("9y8ENuuZ3b19quffx9hQvRVygG5ky6snHfRvGpuSfeJy"),MODEL_DATA_PUBKEY:new r.PublicKey("Ray1111111111111111111111111111111111111111")};var Qe=u(require("bn.js"));var Se=require("@solana/web3.js");var M=require("@solana/web3.js"),$e=u(require("axios"));var et=require("@solana/web3.js"),tt=u(require("bn.js"));var ke=u(require("bn.js")),A=new ke.default(1e6);var Ci=f("Raydium_amount"),Ni=W(Ce.default);var ze=new g.default(0),Wi=new g.default(1),Ki=new g.default(2),qi=new g.default(3),Ui=new g.default(5),rt=new g.default(10),Gi=new g.default(100),Hi=new g.default(1e3),ji=new g.default(1e4);function re(n,e,t){return n.mul(e).add(t).sub(new g.default(1)).div(t)}function z(n,e,t){return n.mul(e).div(t)}var p=class{static tradingFee(e,t){return re(e,t,A)}static protocolFee(e,t){return z(e,t,A)}static fundFee(e,t){return z(e,t,A)}static creatorFee(e,t){return re(e,t,A)}static splitCreatorFee(e,t,i){return z(e,i,t.add(i))}static calculatePreFeeAmount(e,t){if(t.isZero())return e;let i=e.mul(A),a=A.sub(t);return i.add(a).sub(new Ne.default(1)).div(a)}};var Z=(t=>(t[t.Floor=0]="Floor",t[t.Ceiling=1]="Ceiling",t))(Z||{}),Ie=(t=>(t[t.ZeroForOne=0]="ZeroForOne",t[t.OneForZero=1]="OneForZero",t))(Ie||{}),Re=(t=>(t[t.OneForZero=0]="OneForZero",t[t.ZeroForOne=1]="ZeroForOne",t))(Re||{}),oe=class{static validate_supply(e,t){if(e.isZero())throw Error("tokenAmount0 is zero");if(t.isZero())throw Error("tokenAmount1 is zero")}static swapBaseInput(e,t,i,a,l,m,T,P){let d=new ie.default(0),h=p.tradingFee(e,a),b;P?(d=p.creatorFee(e,l),b=e.sub(h).sub(d)):b=e.sub(h);let x=p.protocolFee(h,m),F=p.protocolFee(h,T),S=O.swapBaseInputWithoutFees(b,t,i),L;return P?L=S:(d=p.creatorFee(S,l),L=S.sub(d)),{newInputVaultAmount:t.add(b),newOutputVaultAmount:i.sub(S),inputAmount:e,outputAmount:L,tradeFee:h,protocolFee:x,fundFee:F,creatorFee:d}}static swapBaseOutput(e,t,i,a,l,m,T,P){let d,h=new ie.default(0),b;if(P)b=e;else{let w=p.calculatePreFeeAmount(e,l);h=w.sub(e),b=w}let x=O.swapBaseOutputWithoutFees(b,t,i),F;if(P){let w=p.calculatePreFeeAmount(x,a.add(l)),se=w.sub(x);h=p.splitCreatorFee(se,a,l),d=se.sub(h),F=w}else{let w=p.calculatePreFeeAmount(x,a);d=w.sub(x),F=w}let S=p.protocolFee(d,m),L=p.fundFee(d,T);return{newInputVaultAmount:t.add(x),newOutputVaultAmount:e.sub(b),inputAmount:F,outputAmount:e,tradeFee:d,protocolFee:S,fundFee:L,creatorFee:h}}};0&&(module.exports={CurveCalculator,RoundDirection,TradeDirection,TradeDirectionOpposite});
//# sourceMappingURL=calculator.js.map