var ct=Object.create;var oe=Object.defineProperty,ut=Object.defineProperties,lt=Object.getOwnPropertyDescriptor,mt=Object.getOwnPropertyDescriptors,pt=Object.getOwnPropertyNames,be=Object.getOwnPropertySymbols,dt=Object.getPrototypeOf,Be=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable;var Ve=(n,e,t)=>e in n?oe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,K=(n,e)=>{for(var t in e||(e={}))Be.call(e,t)&&Ve(n,t,e[t]);if(be)for(var t of be(e))ve.call(e,t)&&Ve(n,t,e[t]);return n},J=(n,e)=>ut(n,mt(e));var se=(n,e)=>{var t={};for(var r in n)Be.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&be)for(var r of be(n))e.indexOf(r)<0&&ve.call(n,r)&&(t[r]=n[r]);return t};var ft=(n,e)=>{for(var t in e)oe(n,t,{get:e[t],enumerable:!0})},Ke=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let w of pt(e))!Be.call(n,w)&&w!==t&&oe(n,w,{get:()=>e[w],enumerable:!(r=lt(e,w))||r.enumerable});return n};var q=(n,e,t)=>(t=n!=null?ct(dt(n)):{},Ke(e||!n||!n.__esModule?oe(t,"default",{value:n,enumerable:!0}):t,n)),gt=n=>Ke(oe({},"__esModule",{value:!0}),n);var Nt={};ft(Nt,{TxBuilder:()=>Oe});module.exports=gt(Nt);var S=require("@solana/web3.js"),at=q(require("axios"));var j=require("@solana/web3.js");var ot=require("@solana/web3.js");var z=q(require("bn.js")),Bt=q(require("decimal.js"));var He=q(require("big.js")),xt=q(require("bn.js"));var ae=require("lodash");var Ce=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:0,this.name=e.name}set level(e){this.logLevel=e}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let t=e.map(r=>typeof r=="object"?JSON.stringify(r):r).join(", ");throw new Error(t)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},_e={},ht={};function H(n){let e=(0,ae.get)(_e,n);if(!e){let t=(0,ae.get)(ht,n);e=new Ce({name:n,logLevel:t}),(0,ae.set)(_e,n,e)}return e}var We=q(require("toformat")),Tt=We.default,ce=Tt;var ue=q(require("big.js")),Ue=q(require("bn.js")),Ge=q(require("decimal.js-light"));var te=q(require("bn.js"));var qe=9007199254740991;function X(n){let e=H("Raydium_parseBigNumberish");if(n instanceof te.default)return n;if(typeof n=="string"){if(n.match(/^-?[0-9]+$/))return new te.default(n);e.logWithError(`invalid BigNumberish string: ${n}`)}return typeof n=="number"?(n%1&&e.logWithError(`BigNumberish number underflow: ${n}`),(n>=qe||n<=-qe)&&e.logWithError(`BigNumberish number overflow: ${n}`),new te.default(String(n))):typeof n=="bigint"?new te.default(n.toString()):(e.error(`invalid BigNumberish value: ${n}`),new te.default(0))}var ye=H("module/fraction"),Ie=ce(ue.default),le=ce(Ge.default),yt={[0]:le.ROUND_DOWN,[1]:le.ROUND_HALF_UP,[2]:le.ROUND_UP},wt={[0]:ue.default.roundDown,[1]:ue.default.roundHalfUp,[2]:ue.default.roundUp},O=class{constructor(e,t=new Ue.default(1)){this.numerator=X(e),this.denominator=X(t)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new O(this.denominator,this.numerator)}add(e){let t=e instanceof O?e:new O(X(e));return this.denominator.eq(t.denominator)?new O(this.numerator.add(t.numerator),this.denominator):new O(this.numerator.mul(t.denominator).add(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}sub(e){let t=e instanceof O?e:new O(X(e));return this.denominator.eq(t.denominator)?new O(this.numerator.sub(t.numerator),this.denominator):new O(this.numerator.mul(t.denominator).sub(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}mul(e){let t=e instanceof O?e:new O(X(e));return new O(this.numerator.mul(t.numerator),this.denominator.mul(t.denominator))}div(e){let t=e instanceof O?e:new O(X(e));return new O(this.numerator.mul(t.denominator),this.denominator.mul(t.numerator))}toSignificant(e,t={groupSeparator:""},r=1){Number.isInteger(e)||ye.logWithError(`${e} is not an integer.`),e<=0&&ye.logWithError(`${e} is not positive.`),le.set({precision:e+1,rounding:yt[r]});let w=new le(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return w.toFormat(w.decimalPlaces(),t)}toFixed(e,t={groupSeparator:""},r=1){return Number.isInteger(e)||ye.logWithError(`${e} is not an integer.`),e<0&&ye.logWithError(`${e} is negative.`),Ie.DP=e,Ie.RM=wt[r]||1,new Ie(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,t)}isZero(){return this.numerator.isZero()}};var Yt=H("Raydium_amount"),$t=ce(He.default);var je=require("@solana/web3.js"),Re=require("@solana/spl-token"),ze={chainId:101,address:je.PublicKey.default.toBase58(),programId:Re.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},$={chainId:101,address:"So11111111111111111111111111111111111111112",programId:Re.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};var we=require("@solana/web3.js");var N=require("@solana/web3.js"),Ze=require("@solana/spl-token");function Me({pubkey:n,isSigner:e=!1,isWritable:t=!0}){return{pubkey:n,isWritable:t,isSigner:e}}var rn=[Me({pubkey:Ze.TOKEN_PROGRAM_ID,isWritable:!1}),Me({pubkey:N.SystemProgram.programId,isWritable:!1}),Me({pubkey:N.SYSVAR_RENT_PUBKEY,isWritable:!1})];function Je({publicKey:n,transformSol:e}){let t=Xe(n.toString());if(t instanceof N.PublicKey)return e&&t.equals(me)?De:t;if(e&&t.toString()===me.toBase58())return De;if(typeof t=="string"){if(t===N.PublicKey.default.toBase58())return N.PublicKey.default;try{return new N.PublicKey(t)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function Xe(n){try{return new N.PublicKey(n)}catch{return n}}var on=new N.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),sn=new N.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),an=new N.PublicKey("SysvarRent111111111111111111111111111111111"),cn=new N.PublicKey("SysvarC1ock11111111111111111111111111111111"),un=new N.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),ln=new N.PublicKey("Sysvar1nstructions1111111111111111111111111"),mn=N.SystemProgram.programId,pn=new N.PublicKey("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),dn=new N.PublicKey("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),fn=new N.PublicKey("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),gn=new N.PublicKey("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),hn=new N.PublicKey("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),Tn=new N.PublicKey("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),bn=new N.PublicKey("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),yn=new N.PublicKey("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),wn=new N.PublicKey("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),xn=new N.PublicKey("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),An=new N.PublicKey("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),De=new N.PublicKey("So11111111111111111111111111111111111111112"),me=N.PublicKey.default;var Le=class{constructor({mint:e,decimals:t,symbol:r,name:w,skipMint:h=!1,isToken2022:T=!1}){if(e===me.toBase58()||e instanceof we.PublicKey&&me.equals(e)){this.decimals=$.decimals,this.symbol=$.symbol,this.name=$.name,this.mint=new we.PublicKey($.address),this.isToken2022=!1;return}this.decimals=t,this.symbol=r||e.toString().substring(0,6),this.name=w||e.toString().substring(0,6),this.mint=h?we.PublicKey.default:Je({publicKey:e}),this.isToken2022=T}equals(e){return this===e?!0:this.mint.equals(e.mint)}},ne=Le;ne.WSOL=new Le(J(K({},$),{mint:$.address}));var Ne=class{constructor({decimals:e,symbol:t="UNKNOWN",name:r="UNKNOWN"}){this.decimals=e,this.symbol=t,this.name=r}equals(e){return this===e}},xe=Ne;xe.SOL=new Ne(ze);var Qe=q(require("bn.js"));var Ln=new O(new Qe.default(100));var vn=H("Raydium_price");var St=require("@solana/web3.js"),kt=q(require("bn.js"));var Pt=new z.default(0),gr=new z.default(1),hr=new z.default(2),Tr=new z.default(3),br=new z.default(5),At=new z.default(10),yr=new z.default(100),wr=new z.default(1e3),xr=new z.default(1e4);function Fe(n,e=1,t=[]){let r=[...n];if(e<=0)return t;for(;r.length;)t.push(r.splice(0,e));return t}var Mt=require("@solana/web3.js"),Dt=require("@solana/spl-token");var W=require("@solana/web3.js");var pe={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",ClmmLockPosition:"ClmmLockPosition",ClmmHarvestLockPosition:"ClmmHarvestLockPosition",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV4Withdraw:"FarmV4Withdraw",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut",CpmmLockLp:"CpmmLockLp",CpmmCollectLockFee:"CpmmCollectLockFee",TransferTip:"TransferTip"};var nt=require("@solana/spl-token"),tt=H("Raydium_txUtil"),rt=1644;function de(n){let e=[],t=[];return n.microLamports&&(e.push(W.ComputeBudgetProgram.setComputeUnitPrice({microLamports:n.microLamports})),t.push(pe.SetComputeUnitPrice)),n.units&&(e.push(W.ComputeBudgetProgram.setComputeUnitLimit({units:n.units})),t.push(pe.SetComputeUnitLimit)),{instructions:e,instructionTypes:t}}async function ee(n,e){var r,w;let t=e!=null?e:"confirmed";return(w=await((r=n.getLatestBlockhash)==null?void 0:r.call(n,{commitment:t})))==null?void 0:w.blockhash}async function fe(n,e){return n.getSignatureStatuses([e]),new Promise((t,r)=>{let w=setTimeout(r,6e4);n.onSignature(e,h=>{if(clearTimeout(w),!h.err){t("");return}r(Object.assign(h.err,{txId:e}))},"confirmed")})}function Ct(n,e){n.length<1&&tt.logWithError(`no instructions provided: ${n.toString()}`),e.length<1&&tt.logWithError(`no signers provided:, ${e.toString()}`);let t=new W.Transaction;t.recentBlockhash="11111111111111111111111111111111",t.feePayer=e[0],t.add(...n);try{return Buffer.from(t.serialize({verifySignatures:!1})).toString("base64").length<rt}catch{return!1}}function ge({instructions:n,payer:e,signers:t}){return Ct(n,[e,...t])}function Q({instructions:n,payer:e,lookupTableAddressAccount:t,recentBlockhash:r=W.Keypair.generate().publicKey.toString()}){let h=new W.TransactionMessage({payerKey:e,recentBlockhash:r,instructions:n}).compileToV0Message(Object.values(t!=null?t:{}));try{return Buffer.from(new W.VersionedTransaction(h).serialize()).toString("base64").length<rt}catch{return!1}}var It=n=>Buffer.isBuffer(n)?n:n instanceof Uint8Array?Buffer.from(n.buffer,n.byteOffset,n.byteLength):Buffer.from(n),Rt=n=>{let e=n.serialize({requireAllSignatures:!1,verifySignatures:!1});n instanceof W.VersionedTransaction&&(e=It(e));try{return e instanceof Buffer?e.toString("base64"):Buffer.from(e).toString("base64")}catch{return e.toString("base64")}};function Y(n){let e=[];return n.forEach(t=>{t instanceof W.Transaction&&(t.recentBlockhash||(t.recentBlockhash=nt.TOKEN_PROGRAM_ID.toBase58()),t.feePayer||(t.feePayer=W.Keypair.generate().publicKey)),e.push(Rt(t))}),console.log("simulate tx string:",e),e}var m=require("@solana/web3.js"),vr=new m.PublicKey("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),Kr=new m.PublicKey("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),_r=new m.PublicKey("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),Wr=new m.PublicKey("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),qr=new m.PublicKey("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),Ur=new m.PublicKey("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),Gr=new m.PublicKey("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),Hr=new m.PublicKey("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),jr=new m.PublicKey("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),zr=new m.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Zr=new m.PublicKey("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),Jr=new m.PublicKey("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),Xr=new m.PublicKey("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),Qr=new m.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),Yr=new m.PublicKey("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),$r=new m.PublicKey("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),ei=new m.PublicKey("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),ti=new m.PublicKey("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),ni=new m.PublicKey("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),ri=new m.PublicKey("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),ii=new m.PublicKey("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),oi=new m.PublicKey("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),si=new m.PublicKey("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),ai=new m.PublicKey("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),ci=new m.PublicKey("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),ui=new m.PublicKey("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),li=new m.PublicKey("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),mi=new m.PublicKey("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),pi=new m.PublicKey("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),di=new m.PublicKey("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),fi=new m.PublicKey("6s1xP3hpbAfFoNtUNF8mfHsjr2Bd97JxFJRWLbL6aHuX");var gi={OPEN_BOOK_PROGRAM:new m.PublicKey("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),SERUM_PROGRAM_ID_V3:new m.PublicKey("Ray1111111111111111111111111111111111111111"),AMM_V4:new m.PublicKey("DRaya7Kj3aMWQSy19kSjvmuwq9docCHofyP9kanQGaav"),AMM_STABLE:new m.PublicKey("DRayDdXc1NZQ9C3hRWmoSf8zK4iapgMnjdNZWrfwsP8m"),CLMM_PROGRAM_ID:new m.PublicKey("DRayAUgENGQBKVaX8owNhgzkEDyoHTGVEGHVJT1E9pfH"),CLMM_LOCK_PROGRAM_ID:new m.PublicKey("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),CLMM_LOCK_AUTH_ID:new m.PublicKey("6Aoh8h2Lw2m5UGxYR8AdAL87jTWYeKoxM52mJRzfYwN"),CREATE_CPMM_POOL_PROGRAM:new m.PublicKey("DRaycpLY18LhpbydsBWbVJtxpNv9oXPgjRSfpF2bWpYb"),CREATE_CPMM_POOL_AUTH:new m.PublicKey("CXniRufdq5xL8t8jZAPxsPZDpuudwuJSPWnbcD5Y5Nxq"),CREATE_CPMM_POOL_FEE_ACC:new m.PublicKey("3oE58BKVt8KuYkGxx8zBojugnymWmBiyafWgMrnb6eYy"),LOCK_CPMM_PROGRAM:new m.PublicKey("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),LOCK_CPMM_AUTH:new m.PublicKey("7qWVV8UY2bRJfDLP4s37YzBPKUkVB46DStYJBpYbQzu3"),UTIL1216:m.PublicKey.default,Router:new m.PublicKey("DRaybByLpbUL57LJARs3j8BitTxVfzBg351EaMr5UTCd"),FARM_PROGRAM_ID_V3:new m.PublicKey("DRayWyrLmEW5KEeqs8kdTMMaBabapqagaBC7KWpGtJeZ"),FARM_PROGRAM_ID_V4:new m.PublicKey("Ray1111111111111111111111111111111111111111"),FARM_PROGRAM_ID_V5:new m.PublicKey("DRayiCGSZgku1GTK6rXD6mVDdingXy6APAH1R6R5L2LC"),FARM_PROGRAM_ID_V6:new m.PublicKey("DRayzbYakXs45ELHkzH6vC3fuhQqTAnv5A68gdFuvZyZ"),LAUNCHPAD_PROGRAM:new m.PublicKey("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),LAUNCHPAD_AUTH:new m.PublicKey("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),LAUNCHPAD_PLATFORM:new m.PublicKey("2Jx4KTDrVSdWNazuGpcA8n3ZLTRGGBDxAWhuKe2Xcj2a"),LAUNCHPAD_CONFIG:new m.PublicKey("7ZR4zD7PYfY2XxoG1Gxcy2EgEeGYrpxrwzPuwdUBssEt"),FEE_DESTINATION_ID:new m.PublicKey("9y8ENuuZ3b19quffx9hQvRVygG5ky6snHfRvGpuSfeJy"),MODEL_DATA_PUBKEY:new m.PublicKey("Ray1111111111111111111111111111111111111111")};var Lt=q(require("bn.js"));var it=q(require("bn.js")),bi=new it.default(1e6);var Ae=require("@solana/spl-token"),Ee=H("Raydium_accountInfo_util");async function st(n,e,t){let{batchRequest:r,commitment:w="confirmed",chunkCount:h=100}=K({batchRequest:!1},t),T=Fe(e,h),c=new Array(T.length).fill([]);if(r){let D=T.map(b=>{let y=n._buildArgs([b.map(x=>x.toBase58())],w,"base64");return{methodName:"getMultipleAccounts",args:y}}),C=Fe(D,10);c=(await(await Promise.all(C.map(async b=>await n._rpcBatchRequest(b)))).flat()).map(b=>(b.error&&Ee.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${b.error.message}`),b.result.value.map(y=>{if(y){let{data:x,executable:u,lamports:d,owner:a,rentEpoch:I}=y;return x.length!==2&&x[1]!=="base64"&&Ee.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(x[0],"base64"),executable:u,lamports:d,owner:new ot.PublicKey(a),rentEpoch:I}}return null})))}else try{c=await Promise.all(T.map(D=>n.getMultipleAccountsInfo(D,w)))}catch(D){D instanceof Error&&Ee.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${D.message}`)}return c.flat()}async function Pe({connection:n,address:e,cluster:t="mainnet"}){let r=await st(n,[...new Set(e.map(h=>h.toString()))].map(h=>new j.PublicKey(h))),w={};for(let h=0;h<e.length;h++){let T=r[h],c=e[h];if(!T)continue;let D=new j.AddressLookupTableAccount({key:c,state:j.AddressLookupTableAccount.deserialize(T.data)});w[c.toString()]=D,t==="devnet"?re[c.toString()]=D:he[c.toString()]=D}return w}var he={AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU:new j.AddressLookupTableAccount({key:new j.PublicKey("AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU"),state:j.AddressLookupTableAccount.deserialize(Buffer.from("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","base64"))})},re={},Se=async n=>{let e="EFhMuDw1PKEuckuFRW9PavNfTH4LKP5uKHgyXDmWpFCq";if(re[e])return re;let t=new j.PublicKey(e),r=await n.getAccountInfo(t);return r&&(re[e]=new j.AddressLookupTableAccount({key:t,state:j.AddressLookupTableAccount.deserialize(r.data)})),re};var Te=2e3,Oe=class{constructor(e){this.instructions=[];this.endInstructions=[];this.lookupTableAddress=[];this.signers=[];this.instructionTypes=[];this.endInstructionTypes=[];this.connection=e.connection,this.feePayer=e.feePayer,this.signAllTransactions=e.signAllTransactions,this.owner=e.owner,this.cluster=e.cluster,this.blockhashCommitment=e.blockhashCommitment,this.loopMultiTxStatus=!!e.loopMultiTxStatus}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers,instructionTypes:this.instructionTypes,endInstructionTypes:this.endInstructionTypes,lookupTableAddress:this.lookupTableAddress}}get allInstructions(){return[...this.instructions,...this.endInstructions]}async getComputeBudgetConfig(){var r;let e=(await at.default.get(`https://solanacompass.com/api/fees?cacheFreshTime=${3e5}`)).data,{avg:t}=(r=e==null?void 0:e[15])!=null?r:{};if(!!t)return{units:6e5,microLamports:Math.min(Math.ceil(t*1e6/6e5),25e3)}}addCustomComputeBudget(e){if(e){let{instructions:t,instructionTypes:r}=de(e);return this.instructions.unshift(...t),this.instructionTypes.unshift(...r),!0}return!1}addTipInstruction(e){var t;return e?(this.endInstructions.push(S.SystemProgram.transfer({fromPubkey:(t=e.feePayer)!=null?t:this.feePayer,toPubkey:new S.PublicKey(e.address),lamports:BigInt(e.amount.toString())})),this.endInstructionTypes.push(pe.TransferTip),!0):!1}async calComputeBudget({config:e,defaultIns:t}){try{let r=e||await this.getComputeBudgetConfig();if(this.addCustomComputeBudget(r))return;t&&this.instructions.unshift(...t)}catch{t&&this.instructions.unshift(...t)}}addInstruction({instructions:e=[],endInstructions:t=[],signers:r=[],instructionTypes:w=[],endInstructionTypes:h=[],lookupTableAddress:T=[]}){return this.instructions.push(...e),this.endInstructions.push(...t),this.signers.push(...r),this.instructionTypes.push(...w),this.endInstructionTypes.push(...h),this.lookupTableAddress.push(...T.filter(c=>c!==S.PublicKey.default.toString())),this}async versionBuild({txVersion:e,extInfo:t}){return e===0?await this.buildV0(K({},t||{})):this.build(t)}build(e){var r;let t=new S.Transaction;return this.allInstructions.length&&t.add(...this.allInstructions),t.feePayer=this.feePayer,((r=this.owner)==null?void 0:r.signer)&&!this.signers.some(w=>w.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer),{builder:this,transaction:t,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async w=>{var k;let{recentBlockHash:h,skipPreflight:T=!0,sendAndConfirm:c,notSendToRpc:D}=w||{},C=h!=null?h:await ee(this.connection,this.blockhashCommitment);if(t.recentBlockhash=C,this.signers.length&&t.sign(...this.signers),Y([t]),(k=this.owner)!=null&&k.isKeyPair)return{txId:c?await(0,S.sendAndConfirmTransaction)(this.connection,t,this.signers.find(y=>y.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:T}):await this.connection.sendRawTransaction(t.serialize(),{skipPreflight:T}),signedTx:t};if(this.signAllTransactions){let b=await this.signAllTransactions([t]);if(this.signers.length)for(let y of b)try{y.sign(...this.signers)}catch{}return{txId:D?"":await this.connection.sendRawTransaction(b[0].serialize(),{skipPreflight:T}),signedTx:b[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:e||{}}}buildMultiTx(e){var C;let{extraPreBuildData:t=[],extInfo:r}=e,{transaction:w}=this.build(r),h=t.filter(k=>k.transaction.instructions.length>0),T=[w,...h.map(k=>k.transaction)],c=[this.signers,...h.map(k=>k.signers)],D=[...this.instructionTypes,...h.map(k=>k.instructionTypes).flat()];return(C=this.owner)!=null&&C.signer&&c.forEach(k=>{k.some(b=>b.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),{builder:this,transactions:T,signers:c,instructionTypes:D,execute:async k=>{var I;let{sequentially:b,onTxUpdate:y,skipTxCount:x=0,recentBlockHash:u,skipPreflight:d=!0}=k||{},a=u!=null?u:await ee(this.connection,this.blockhashCommitment);if((I=this.owner)!=null&&I.isKeyPair){if(b){let f=[],R=0;for(let s of T){if(++R,R<=x)continue;let i=await(0,S.sendAndConfirmTransaction)(this.connection,s,this.signers.find(o=>o.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:d});f.push(i)}return{txIds:f,signedTxs:T}}return{txIds:await await Promise.all(T.map(async f=>(f.recentBlockhash=a,await this.connection.sendRawTransaction(f.serialize(),{skipPreflight:d})))),signedTxs:T}}if(this.signAllTransactions){let f=T.map((s,i)=>(s.recentBlockhash=a,c[i].length&&s.sign(...c[i]),s));Y(f);let R=await this.signAllTransactions(f);if(b){let s=0,i=[],o=async()=>{if(!R[s])return;let p=await this.connection.sendRawTransaction(R[s].serialize(),{skipPreflight:d});i.push({txId:p,status:"sent",signedTx:R[s]}),y==null||y([...i]),s++;let l=!1,A=null,L=null,M=g=>{A!==null&&clearInterval(A),L!==null&&this.connection.removeSignatureListener(L);let P=i.findIndex(B=>B.txId===p);if(P>-1){if(i[P].status==="error"||i[P].status==="success")return;i[P].status=g.err?"error":"success"}y==null||y([...i]),g.err||o()};this.loopMultiTxStatus&&(A=setInterval(async()=>{var g;if(l){clearInterval(A);return}try{let P=await this.connection.getTransaction(p,{commitment:"confirmed",maxSupportedTransactionVersion:0});P&&(l=!0,clearInterval(A),M({err:((g=P.meta)==null?void 0:g.err)||null}),console.log("tx status from getTransaction:",p))}catch(P){l=!0,clearInterval(A),console.error("getTransaction timeout:",P,p)}},Te)),L=this.connection.onSignature(p,g=>{if(l){this.connection.removeSignatureListener(L);return}l=!0,M(g)},"confirmed"),this.connection.getSignatureStatus(p)};return await o(),{txIds:i.map(p=>p.txId),signedTxs:R}}else{let s=[];for(let i=0;i<R.length;i+=1){let o=await this.connection.sendRawTransaction(R[i].serialize(),{skipPreflight:d});s.push(o)}return{txIds:s,signedTxs:R}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async versionMultiBuild({extraPreBuildData:e,txVersion:t,extInfo:r}){return t===0?await this.buildV0MultiTx({extraPreBuildData:e,buildProps:r||{}}):this.buildMultiTx({extraPreBuildData:e,extInfo:r})}async buildV0(e){var d;let u=e||{},{lookupTableCache:t={},lookupTableAddress:r=[],forerunCreate:w,recentBlockhash:h}=u,T=se(u,["lookupTableCache","lookupTableAddress","forerunCreate","recentBlockhash"]),c=K(K({},this.cluster==="devnet"?await Se(this.connection):he),t),D=Array.from(new Set([...r,...this.lookupTableAddress])),C=[];for(let a of D)c[a]===void 0&&C.push(new S.PublicKey(a));let k=await Pe({connection:this.connection,address:C});for(let[a,I]of Object.entries(k))c[a]=I;let b=w?S.PublicKey.default.toBase58():h!=null?h:await ee(this.connection,this.blockhashCommitment),y=new S.TransactionMessage({payerKey:this.feePayer,recentBlockhash:b,instructions:[...this.allInstructions]}).compileToV0Message(Object.values(c));((d=this.owner)==null?void 0:d.signer)&&!this.signers.some(a=>a.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer);let x=new S.VersionedTransaction(y);return x.sign(this.signers),{builder:this,transaction:x,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async a=>{var s;let{skipPreflight:I=!0,sendAndConfirm:f,notSendToRpc:R}=a||{};if(Y([x]),(s=this.owner)!=null&&s.isKeyPair){let i=await this.connection.sendTransaction(x,{skipPreflight:I});return f&&await fe(this.connection,i),{txId:i,signedTx:x}}if(this.signAllTransactions){let i=await this.signAllTransactions([x]);if(this.signers.length)for(let o of i)try{o.sign(this.signers)}catch{}return{txId:R?"":await this.connection.sendTransaction(i[0],{skipPreflight:I}),signedTx:i[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:T||{}}}async buildV0MultiTx(e){var C;let{extraPreBuildData:t=[],buildProps:r}=e,{transaction:w}=await this.buildV0(r),h=t.filter(k=>k.builder.instructions.length>0),T=[w,...h.map(k=>k.transaction)],c=[this.signers,...h.map(k=>k.signers)],D=[...this.instructionTypes,...h.map(k=>k.instructionTypes).flat()];return(C=this.owner)!=null&&C.signer&&c.forEach(k=>{k.some(b=>b.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),T.forEach(async(k,b)=>{k.sign(c[b])}),{builder:this,transactions:T,signers:c,instructionTypes:D,buildProps:r,execute:async k=>{var d;let{sequentially:b,onTxUpdate:y,recentBlockHash:x,skipPreflight:u=!0}=k||{};if(x&&T.forEach(a=>a.message.recentBlockhash=x),Y(T),(d=this.owner)!=null&&d.isKeyPair){if(b){let a=[];for(let I of T){let f=await this.connection.sendTransaction(I,{skipPreflight:u});await fe(this.connection,f),a.push(f)}return{txIds:a,signedTxs:T}}return{txIds:await Promise.all(T.map(async a=>await this.connection.sendTransaction(a,{skipPreflight:u}))),signedTxs:T}}if(this.signAllTransactions){let a=await this.signAllTransactions(T);if(b){let I=0,f=[],R=async()=>{if(!a[I])return;let s=await this.connection.sendTransaction(a[I],{skipPreflight:u});f.push({txId:s,status:"sent",signedTx:a[I]}),y==null||y([...f]),I++;let i=!1,o=null,p=null,l=A=>{o!==null&&clearInterval(o),p!==null&&this.connection.removeSignatureListener(p);let L=f.findIndex(M=>M.txId===s);if(L>-1){if(f[L].status==="error"||f[L].status==="success")return;f[L].status=A.err?"error":"success"}y==null||y([...f]),A.err||R()};this.loopMultiTxStatus&&(o=setInterval(async()=>{var A;if(i){clearInterval(o);return}try{let L=await this.connection.getTransaction(s,{commitment:"confirmed",maxSupportedTransactionVersion:0});L&&(i=!0,clearInterval(o),l({err:((A=L.meta)==null?void 0:A.err)||null}),console.log("tx status from getTransaction:",s))}catch(L){i=!0,clearInterval(o),console.error("getTransaction timeout:",L,s)}},Te)),p=this.connection.onSignature(s,A=>{if(i){this.connection.removeSignatureListener(p);return}i=!0,l(A)},"confirmed"),this.connection.getSignatureStatus(s)};return R(),{txIds:[],signedTxs:a}}else{let I=[];for(let f=0;f<a.length;f+=1){let R=await this.connection.sendTransaction(a[f],{skipPreflight:u});I.push(R)}return{txIds:I,signedTxs:a}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async sizeCheckBuild(e){var y;let b=e||{},{splitIns:t=[],computeBudgetConfig:r}=b,w=se(b,["splitIns","computeBudgetConfig"]),h=r?de(r):{instructions:[],instructionTypes:[]},T=this.signers.reduce((x,u)=>J(K({},x),{[u.publicKey.toBase58()]:u}),{}),c=[],D=[],C=[],k=0;if(this.allInstructions.forEach(x=>{let u=[...C,x],d=r?[...h.instructions,...u]:u,I=[...new Set(u.map(f=>f.keys.filter(R=>R.isSigner).map(R=>R.pubkey.toString())).flat()).values()].map(f=>new S.PublicKey(f));if(x!==t[k]&&C.length<12&&(ge({instructions:d,payer:this.feePayer,signers:I})||ge({instructions:u,payer:this.feePayer,signers:I})))C.push(x);else{if(C.length===0)throw Error("item ins too big");k+=x===t[k]?1:0,ge({instructions:r?[...h.instructions,...C]:[...C],payer:this.feePayer,signers:I})?c.push(new S.Transaction().add(...h.instructions,...C)):c.push(new S.Transaction().add(...C)),D.push(Array.from(new Set(C.map(f=>f.keys.filter(R=>R.isSigner).map(R=>R.pubkey.toString())).flat())).map(f=>T[f]).filter(f=>f!==void 0)),C=[x]}}),C.length>0){let u=[...new Set(C.map(d=>d.keys.filter(a=>a.isSigner).map(a=>a.pubkey.toString())).flat()).values()].map(d=>T[d]).filter(d=>d!==void 0);ge({instructions:r?[...h.instructions,...C]:[...C],payer:this.feePayer,signers:u.map(d=>d.publicKey)})?c.push(new S.Transaction().add(...h.instructions,...C)):c.push(new S.Transaction().add(...C)),D.push(u)}return c.forEach(x=>x.feePayer=this.feePayer),(y=this.owner)!=null&&y.signer&&D.forEach(x=>{x.some(u=>u.publicKey.equals(this.owner.publicKey))||x.push(this.owner.signer)}),{builder:this,transactions:c,signers:D,instructionTypes:this.instructionTypes,execute:async x=>{var s;let{sequentially:u,onTxUpdate:d,skipTxCount:a=0,recentBlockHash:I,skipPreflight:f=!0}=x||{},R=I!=null?I:await ee(this.connection,this.blockhashCommitment);if(c.forEach(async(i,o)=>{i.recentBlockhash=R,D[o].length&&i.sign(...D[o])}),Y(c),(s=this.owner)!=null&&s.isKeyPair){if(u){let i=0,o=[];for(let p of c){if(++i,i<=a){o.push("tx skipped");continue}let l=await(0,S.sendAndConfirmTransaction)(this.connection,p,this.signers.find(A=>A.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:f});o.push(l)}return{txIds:o,signedTxs:c}}return{txIds:await Promise.all(c.map(async i=>await this.connection.sendRawTransaction(i.serialize(),{skipPreflight:f}))),signedTxs:c}}if(this.signAllTransactions){let i=await this.signAllTransactions(c.slice(a,c.length)),o=[...c.slice(0,a),...i];if(u){let p=0,l=[],A=async()=>{if(!o[p])return;p<a&&(l.push({txId:"",status:"success",signedTx:o[p]}),d==null||d([...l]),p++,A());let L=await this.connection.sendRawTransaction(o[p].serialize(),{skipPreflight:f});l.push({txId:L,status:"sent",signedTx:o[p]}),d==null||d([...l]),p++;let M=!1,g=null,P=null,B=V=>{g!==null&&clearInterval(g),P!==null&&this.connection.removeSignatureListener(P);let E=l.findIndex(U=>U.txId===L);if(E>-1){if(l[E].status==="error"||l[E].status==="success")return;l[E].status=V.err?"error":"success"}d==null||d([...l]),V.err||A()};this.loopMultiTxStatus&&(g=setInterval(async()=>{var V;if(M){clearInterval(g);return}try{let E=await this.connection.getTransaction(L,{commitment:"confirmed",maxSupportedTransactionVersion:0});E&&(M=!0,clearInterval(g),B({err:((V=E.meta)==null?void 0:V.err)||null}),console.log("tx status from getTransaction:",L))}catch(E){M=!0,clearInterval(g),console.error("getTransaction timeout:",E,L)}},Te)),P=this.connection.onSignature(L,V=>{if(M){this.connection.removeSignatureListener(P);return}M=!0,B(V)},"confirmed"),this.connection.getSignatureStatus(L)};return await A(),{txIds:l.map(L=>L.txId),signedTxs:o}}else{let p=[];for(let l=0;l<o.length;l+=1){let A=await this.connection.sendRawTransaction(o[l].serialize(),{skipPreflight:f});p.push(A)}return{txIds:p,signedTxs:o}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:w||{}}}async sizeCheckBuildV0(e){var R;let f=e||{},{computeBudgetConfig:t,splitIns:r=[],lookupTableCache:w={},lookupTableAddress:h=[]}=f,T=se(f,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),c=K(K({},this.cluster==="devnet"?await Se(this.connection):he),w),D=Array.from(new Set([...this.lookupTableAddress,...h])),C=[];for(let s of D)c[s]===void 0&&C.push(new S.PublicKey(s));let k=await Pe({connection:this.connection,address:C});for(let[s,i]of Object.entries(k))c[s]=i;let b=t?de(t):{instructions:[],instructionTypes:[]},y=await ee(this.connection,this.blockhashCommitment),x=this.signers.reduce((s,i)=>J(K({},s),{[i.publicKey.toBase58()]:i}),{}),u=[],d=[],a=[],I=0;if(this.allInstructions.forEach(s=>{let i=[...a,s],o=t?[...b.instructions,...i]:i;if(s!==r[I]&&a.length<12&&(Q({instructions:o,payer:this.feePayer,lookupTableAddressAccount:c})||Q({instructions:i,payer:this.feePayer,lookupTableAddressAccount:c})))a.push(s);else{if(a.length===0)throw Error("item ins too big");I+=s===r[I]?1:0;let p={};for(let l of[...new Set(D)])c[l]!==void 0&&(p[l]=c[l]);if(t&&Q({instructions:[...b.instructions,...a],payer:this.feePayer,lookupTableAddressAccount:c,recentBlockhash:y})){let l=new S.TransactionMessage({payerKey:this.feePayer,recentBlockhash:y,instructions:[...b.instructions,...a]}).compileToV0Message(Object.values(c));u.push(new S.VersionedTransaction(l))}else{let l=new S.TransactionMessage({payerKey:this.feePayer,recentBlockhash:y,instructions:[...a]}).compileToV0Message(Object.values(c));u.push(new S.VersionedTransaction(l))}d.push(Array.from(new Set(a.map(l=>l.keys.filter(A=>A.isSigner).map(A=>A.pubkey.toString())).flat())).map(l=>x[l]).filter(l=>l!==void 0)),a=[s]}}),a.length>0){let i=[...new Set(a.map(o=>o.keys.filter(p=>p.isSigner).map(p=>p.pubkey.toString())).flat()).values()].map(o=>x[o]).filter(o=>o!==void 0);if(t&&Q({instructions:[...b.instructions,...a],payer:this.feePayer,lookupTableAddressAccount:c,recentBlockhash:y})){let o=new S.TransactionMessage({payerKey:this.feePayer,recentBlockhash:y,instructions:[...b.instructions,...a]}).compileToV0Message(Object.values(c));u.push(new S.VersionedTransaction(o))}else{let o=new S.TransactionMessage({payerKey:this.feePayer,recentBlockhash:y,instructions:[...a]}).compileToV0Message(Object.values(c));u.push(new S.VersionedTransaction(o))}d.push(i)}return(R=this.owner)!=null&&R.signer&&d.forEach(s=>{s.some(i=>i.publicKey.equals(this.owner.publicKey))||s.push(this.owner.signer)}),u.forEach((s,i)=>{s.sign(d[i])}),{builder:this,transactions:u,buildProps:e,signers:d,instructionTypes:this.instructionTypes,execute:async s=>{var L;let{sequentially:i,onTxUpdate:o,skipTxCount:p=0,recentBlockHash:l,skipPreflight:A=!0}=s||{};if(u.map(async(M,g)=>{d[g].length&&M.sign(d[g]),l&&(M.message.recentBlockhash=l)}),Y(u),(L=this.owner)!=null&&L.isKeyPair){if(i){let M=0,g=[];for(let P of u){if(++M,M<=p){console.log("skip tx: ",M),g.push("tx skipped");continue}let B=await this.connection.sendTransaction(P,{skipPreflight:A});await fe(this.connection,B),g.push(B)}return{txIds:g,signedTxs:u}}return{txIds:await Promise.all(u.map(async M=>await this.connection.sendTransaction(M,{skipPreflight:A}))),signedTxs:u}}if(this.signAllTransactions){let M=await this.signAllTransactions(u.slice(p,u.length)),g=[...u.slice(0,p),...M];if(i){let P=0,B=[],V=async()=>{if(!g[P])return;if(P<p){B.push({txId:"",status:"success",signedTx:g[P]}),o==null||o([...B]),P++,V();return}let E=await this.connection.sendTransaction(g[P],{skipPreflight:A});B.push({txId:E,status:"sent",signedTx:g[P]}),o==null||o([...B]),P++;let U=!1,G=null,Z=null,ie=_=>{G!==null&&clearInterval(G),Z!==null&&this.connection.removeSignatureListener(Z);let v=B.findIndex(ke=>ke.txId===E);if(v>-1){if(B[v].status==="error"||B[v].status==="success")return;B[v].status=_.err?"error":"success"}o==null||o([...B]),_.err||V()};this.loopMultiTxStatus&&(G=setInterval(async()=>{var _;if(U){clearInterval(G);return}try{let v=await this.connection.getTransaction(E,{commitment:"confirmed",maxSupportedTransactionVersion:0});v&&(U=!0,clearInterval(G),ie({err:((_=v.meta)==null?void 0:_.err)||null}),console.log("tx status from getTransaction:",E))}catch(v){U=!0,clearInterval(G),console.error("getTransaction timeout:",v,E)}},Te)),Z=this.connection.onSignature(E,_=>{if(U){this.connection.removeSignatureListener(Z);return}U=!0,ie(_)},"confirmed"),this.connection.getSignatureStatus(E)};return V(),{txIds:[],signedTxs:g}}else{let P=[];for(let B=0;B<g.length;B+=1){let V=await this.connection.sendTransaction(g[B],{skipPreflight:A});P.push(V)}return{txIds:P,signedTxs:g}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:T||{}}}async buildSniperTransaction(e){var R;let f=e||{},{computeBudgetConfig:t,splitIns:r=[],lookupTableCache:w={},lookupTableAddress:h=[]}=f,T=se(f,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),c=K(K({},this.cluster==="devnet"?await Se(this.connection):he),w),D=Array.from(new Set([...this.lookupTableAddress,...h])),C=[];for(let s of D)c[s]===void 0&&C.push(new S.PublicKey(s));let k=await Pe({connection:this.connection,address:C});for(let[s,i]of Object.entries(k))c[s]=i;let b=t?de(t):{instructions:[],instructionTypes:[]},y=await ee(this.connection,this.blockhashCommitment),x=this.signers.reduce((s,i)=>J(K({},s),{[i.publicKey.toBase58()]:i}),{}),u=[],d=[],a=[],I=0;if(this.allInstructions.forEach(s=>{let i=[...a,s],o=t?[...b.instructions,...i]:i;if(s!==r[I]&&a.length<12&&(Q({instructions:o,payer:this.feePayer,lookupTableAddressAccount:c})||Q({instructions:i,payer:this.feePayer,lookupTableAddressAccount:c})))a.push(s);else{if(a.length===0)throw Error("item ins too big");I+=s===r[I]?1:0;let p={};for(let l of[...new Set(D)])c[l]!==void 0&&(p[l]=c[l]);if(t&&Q({instructions:[...b.instructions,...a],payer:this.feePayer,lookupTableAddressAccount:c,recentBlockhash:y})){let l=new S.TransactionMessage({payerKey:this.feePayer,recentBlockhash:y,instructions:[...b.instructions,...a]}).compileToV0Message(Object.values(c));u.push(new S.VersionedTransaction(l))}else{let l=new S.TransactionMessage({payerKey:this.feePayer,recentBlockhash:y,instructions:[...a]}).compileToV0Message(Object.values(c));u.push(new S.VersionedTransaction(l))}d.push(Array.from(new Set(a.map(l=>l.keys.filter(A=>A.isSigner).map(A=>A.pubkey.toString())).flat())).map(l=>x[l]).filter(l=>l!==void 0)),a=[s]}}),a.length>0){let i=[...new Set(a.map(o=>o.keys.filter(p=>p.isSigner).map(p=>p.pubkey.toString())).flat()).values()].map(o=>x[o]).filter(o=>o!==void 0);if(t&&Q({instructions:[...b.instructions,...a],payer:this.feePayer,lookupTableAddressAccount:c,recentBlockhash:y})){let o=new S.TransactionMessage({payerKey:this.feePayer,recentBlockhash:y,instructions:[...b.instructions,...a]}).compileToV0Message(Object.values(c));u.push(new S.VersionedTransaction(o))}else{let o=new S.TransactionMessage({payerKey:this.feePayer,recentBlockhash:y,instructions:[...a]}).compileToV0Message(Object.values(c));u.push(new S.VersionedTransaction(o))}d.push(i)}return(R=this.owner)!=null&&R.signer&&d.forEach(s=>{s.some(i=>i.publicKey.equals(this.owner.publicKey))||s.push(this.owner.signer)}),u.forEach((s,i)=>{s.sign(d[i])}),{builder:this,transactions:u,buildProps:e,signers:d,instructionTypes:this.instructionTypes,execute:async s=>{var L;let{sequentially:i,onTxUpdate:o,skipTxCount:p=0,recentBlockHash:l,skipPreflight:A=!0}=s||{};if(u.map(async(M,g)=>{d[g].length&&M.sign(d[g]),l&&(M.message.recentBlockhash=l)}),Y(u),(L=this.owner)!=null&&L.isKeyPair){if(i){let M=0,g=[];for(let P of u){if(++M,M<=p){console.log("skip tx: ",M),g.push("tx skipped");continue}let B=await this.connection.sendTransaction(P,{skipPreflight:A});await fe(this.connection,B),g.push(B)}return{txIds:g,signedTxs:u}}return{txIds:await Promise.all(u.map(async M=>await this.connection.sendTransaction(M,{skipPreflight:A}))),signedTxs:u}}if(this.signAllTransactions){let M=await this.signAllTransactions(u.slice(p,u.length)),g=[...u.slice(0,p),...M];if(i){let P=0,B=[],V=async()=>{if(!g[P])return;if(P<p){B.push({txId:"",status:"success",signedTx:g[P]}),o==null||o([...B]),P++,V();return}let E=await this.connection.sendTransaction(g[P],{skipPreflight:A});B.push({txId:E,status:"sent",signedTx:g[P]}),o==null||o([...B]),P++;let U=!1,G=null,Z=null,ie=_=>{G!==null&&clearInterval(G),Z!==null&&this.connection.removeSignatureListener(Z);let v=B.findIndex(ke=>ke.txId===E);if(v>-1){if(B[v].status==="error"||B[v].status==="success")return;B[v].status=_.err?"error":"success"}o==null||o([...B]),_.err||V()};this.loopMultiTxStatus&&(G=setInterval(async()=>{var _;if(U){clearInterval(G);return}try{let v=await this.connection.getTransaction(E,{commitment:"confirmed",maxSupportedTransactionVersion:0});v&&(U=!0,clearInterval(G),ie({err:((_=v.meta)==null?void 0:_.err)||null}),console.log("tx status from getTransaction:",E))}catch(v){U=!0,clearInterval(G),console.error("getTransaction timeout:",v,E)}},Te)),Z=this.connection.onSignature(E,_=>{if(U){this.connection.removeSignatureListener(Z);return}U=!0,ie(_)},"confirmed"),this.connection.getSignatureStatus(E)};return V(),{txIds:[],signedTxs:g}}else{let P=[];for(let B=0;B<g.length;B+=1){let V=await this.connection.sendTransaction(g[B],{skipPreflight:A});P.push(V)}return{txIds:P,signedTxs:g}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:T||{}}}};0&&(module.exports={TxBuilder});
//# sourceMappingURL=txTool.js.map