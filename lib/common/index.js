var In=Object.create;var Ce=Object.defineProperty,Rn=Object.defineProperties,Mn=Object.getOwnPropertyDescriptor,Dn=Object.getOwnPropertyDescriptors,Ln=Object.getOwnPropertyNames,Oe=Object.getOwnPropertySymbols,Nn=Object.getPrototypeOf,$e=Object.prototype.hasOwnProperty,wt=Object.prototype.propertyIsEnumerable;var yt=(n,e,t)=>e in n?Ce(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,v=(n,e)=>{for(var t in e||(e={}))$e.call(e,t)&&yt(n,t,e[t]);if(Oe)for(var t of Oe(e))wt.call(e,t)&&yt(n,t,e[t]);return n},X=(n,e)=>Rn(n,Dn(e));var Ie=(n,e)=>{var t={};for(var r in n)$e.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&Oe)for(var r of Oe(n))e.indexOf(r)<0&&wt.call(n,r)&&(t[r]=n[r]);return t};var Fn=(n,e)=>{for(var t in e)Ce(n,t,{get:e[t],enumerable:!0})},xt=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Ln(e))!$e.call(n,i)&&i!==t&&Ce(n,i,{get:()=>e[i],enumerable:!(r=Mn(e,i))||r.enumerable});return n};var Y=(n,e,t)=>(t=n!=null?In(Nn(n)):{},xt(e||!n||!n.__esModule?Ce(t,"default",{value:n,enumerable:!0}):t,n)),En=n=>xt(Ce({},"__esModule",{value:!0}),n);var si={};Fn(si,{ACCOUNT_TYPE_SIZE:()=>On,ALL_PROGRAM_ID:()=>Jr,AMM_STABLE:()=>nn,AMM_V4:()=>tn,ANAMint:()=>sr,AccountType:()=>kt,BNDivCeil:()=>re,BN_100:()=>Pr,BN_1000:()=>Ar,BN_10000:()=>Sr,BN_FIVE:()=>xr,BN_ONE:()=>br,BN_TEN:()=>de,BN_THREE:()=>wr,BN_TWO:()=>yr,BN_ZERO:()=>ae,CLMM_LOCK_AUTH_ID:()=>sn,CLMM_LOCK_PROGRAM_ID:()=>on,CLMM_PROGRAM_ID:()=>rn,CLOCK_PROGRAM_ID:()=>zn,CREATE_CPMM_POOL_AUTH:()=>gn,CREATE_CPMM_POOL_FEE_ACC:()=>hn,CREATE_CPMM_POOL_PROGRAM:()=>fn,DEVNET_PROGRAM_ID:()=>Zr,DEV_LAUNCHPAD_AUTH:()=>zr,DEV_LAUNCHPAD_PROGRAM:()=>jr,DEV_LOOKUP_TABLE_CACHE:()=>ye,ETHMint:()=>ar,FARM_PROGRAM_ID_V3:()=>Yt,FARM_PROGRAM_ID_V4:()=>Jt,FARM_PROGRAM_ID_V5:()=>Zt,FARM_PROGRAM_ID_V6:()=>Xt,FEE_DESTINATION_ID:()=>un,FEE_RATE_DENOMINATOR_VALUE:()=>oi,IDO_ALL_PROGRAM:()=>Yr,IDO_PROGRAM_ID_V1:()=>ln,IDO_PROGRAM_ID_V2:()=>mn,IDO_PROGRAM_ID_V3:()=>pn,IDO_PROGRAM_ID_V4:()=>dn,INSTRUCTION_PROGRAM_ID:()=>Jn,InstructionType:()=>Pe,LAUNCHPAD_AUTH:()=>wn,LAUNCHPAD_CONFIG:()=>Pn,LAUNCHPAD_PLATFORM:()=>xn,LAUNCHPAD_PROGRAM:()=>yn,LIQUIDITY_POOL_PROGRAM_ID_V5_MODEL:()=>Hr,LOCK_CPMM_AUTH:()=>bn,LOCK_CPMM_PROGRAM:()=>Tn,LOOKUP_TABLE_CACHE:()=>me,LogLevel:()=>Pt,Logger:()=>Ve,MAX_BASE64_SIZE:()=>dt,MEMO_PROGRAM_ID:()=>Gn,MEMO_PROGRAM_ID2:()=>Hn,METADATA_PROGRAM_ID:()=>Yn,MODEL_DATA_PUBKEY:()=>an,NRVMint:()=>or,OPEN_BOOK_PROGRAM:()=>$t,Owner:()=>ce,PAIMint:()=>Qn,RAYMint:()=>Xn,RENT_PROGRAM_ID:()=>jn,Rounding:()=>We,Router:()=>cn,SERUM_PROGRAM_ID_V3:()=>en,SOLMint:()=>xe,SRMMint:()=>$n,SYSTEM_PROGRAM_ID:()=>Zn,TxBuilder:()=>Tt,TxVersion:()=>pt,USDCMint:()=>er,USDHMint:()=>ir,USDTMint:()=>tr,UTIL1216:()=>Qt,WSOLMint:()=>Re,accountMeta:()=>Ge,add:()=>Tr,addComputeBudget:()=>Ae,ceilDiv:()=>Br,ceilDivBN:()=>ei,checkLegacyTxSize:()=>ke,checkV0TxSize:()=>ne,chunkArray:()=>ve,commonSystemAccountMeta:()=>Un,confirmTransaction:()=>Se,createLogger:()=>j,decimalToFraction:()=>Dr,div:()=>dr,divCeil:()=>kr,eq:()=>Vt,fetchMultipleMintInfos:()=>Vn,findProgramAddress:()=>gt,floorDiv:()=>Cr,forecastTransactionSize:()=>ft,getATAAddress:()=>Gr,getDate:()=>mt,getDevLookupTableCache:()=>Ee,getEpochInfo:()=>qr,getMainLookupTableCache:()=>Xe,getMax:()=>hr,getMultipleAccountsInfo:()=>Ke,getMultipleAccountsInfoWithCustomFlags:()=>St,getMultipleLookupTableInfo:()=>Fe,getRecentBlockHash:()=>ge,getTime:()=>qt,getTimestamp:()=>ii,getTransferAmountFee:()=>Xr,getTransferAmountFeeFromPost:()=>ni,getTransferAmountFeeFromPre:()=>ti,getTransferAmountFeeV2:()=>Qr,gt:()=>Ot,gte:()=>pr,intersection:()=>_r,isDateAfter:()=>Fr,isDateBefore:()=>Nr,isDecimal:()=>Lr,isMeaningfulNumber:()=>gr,isNumber:()=>lt,jsonInfo2PoolKeys:()=>bt,lt:()=>lr,lte:()=>mr,mSOLMint:()=>nr,minExpirationTime:()=>$r,mul:()=>Je,notInnerObject:()=>Bn,offsetDateTime:()=>Er,parseBigNumberish:()=>G,parseNumberInfo:()=>fe,parseSimulateLogToJson:()=>Kr,parseSimulateValue:()=>Wr,printSimulate:()=>le,setLoggerLevel:()=>_n,shakeFractionDecimal:()=>Kt,simulateMultipleInstruction:()=>vr,simulateTransaction:()=>Gt,sleep:()=>ri,solToWSol:()=>rt,stSOLMint:()=>rr,sub:()=>fr,tenExponential:()=>Ye,toBN:()=>Wt,toBuffer:()=>ht,toFraction:()=>ut,toFractionWithDecimals:()=>ur,toPercent:()=>Ir,toTokenPrice:()=>Rr,toTotalPrice:()=>Mr,toUsdCurrency:()=>ct,transformTxToBase64:()=>Ur,tryParsePublicKey:()=>je,txToBase64:()=>Ht,uniq:()=>Vr,validateAndParsePublicKey:()=>He,xor:()=>Or});module.exports=En(si);var nt=require("@solana/web3.js");var he=require("lodash"),Pt=(i=>(i[i.Error=0]="Error",i[i.Warning=1]="Warning",i[i.Info=2]="Info",i[i.Debug=3]="Debug",i))(Pt||{}),Ve=class{constructor(e){this.logLevel=e.logLevel!==void 0?e.logLevel:0,this.name=e.name}set level(e){this.logLevel=e}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(e){return e<=this.logLevel}error(...e){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...e),this):this}logWithError(...e){let t=e.map(r=>typeof r=="object"?JSON.stringify(r):r).join(", ");throw new Error(t)}warning(...e){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...e),this):this}info(...e){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...e),this):this}debug(...e){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...e),this):this}},et={},At={};function j(n){let e=(0,he.get)(et,n);if(!e){let t=(0,he.get)(At,n);e=new Ve({name:n,logLevel:t}),(0,he.set)(et,n,e)}return e}function _n(n,e){(0,he.set)(At,n,e);let t=(0,he.get)(et,n);t&&(t.level=e)}var pe=require("@solana/spl-token"),tt=j("Raydium_accountInfo_util");async function Ke(n,e,t){let{batchRequest:r,commitment:i="confirmed",chunkCount:s=100}=v({batchRequest:!1},t),a=ve(e,s),o=new Array(a.length).fill([]);if(r){let c=a.map(T=>{let A=n._buildArgs([T.map(k=>k.toBase58())],i,"base64");return{methodName:"getMultipleAccounts",args:A}}),u=ve(c,10);o=(await(await Promise.all(u.map(async T=>await n._rpcBatchRequest(T)))).flat()).map(T=>(T.error&&tt.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${T.error.message}`),T.result.value.map(A=>{if(A){let{data:k,executable:f,lamports:w,owner:d,rentEpoch:M}=A;return k.length!==2&&k[1]!=="base64"&&tt.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(k[0],"base64"),executable:f,lamports:w,owner:new nt.PublicKey(d),rentEpoch:M}}return null})))}else try{o=await Promise.all(a.map(c=>n.getMultipleAccountsInfo(c,i)))}catch(c){c instanceof Error&&tt.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${c.message}`)}return o.flat()}async function St(n,e,t){let r=await Ke(n,e.map(i=>i.pubkey),t);return e.map((i,s)=>X(v({},i),{accountInfo:r[s]}))}var kt=(r=>(r[r.Uninitialized=0]="Uninitialized",r[r.Mint=1]="Mint",r[r.Account=2]="Account",r))(kt||{}),On=1;async function Vn({connection:n,mints:e,config:t}){var s,a,o;if(e.length===0)return{};let r=await St(n,e.map(c=>({pubkey:rt(c)})),t),i={};for(let c of r){if(!c.accountInfo||c.accountInfo.data.length<pe.MINT_SIZE){console.log("invalid mint account",c.pubkey.toBase58());continue}let u=(0,pe.unpackMint)(c.pubkey,c.accountInfo,(s=c.accountInfo)==null?void 0:s.owner);i[c.pubkey.toString()]=X(v({},u),{programId:((a=c.accountInfo)==null?void 0:a.owner)||pe.TOKEN_PROGRAM_ID,feeConfig:(o=(0,pe.getTransferFeeConfig)(u))!=null?o:void 0})}return i[nt.PublicKey.default.toBase58()]=i[Re.toBase58()],i}var V=Y(require("bn.js")),vt=Y(require("decimal.js"));var Mt=Y(require("big.js")),oe=Y(require("bn.js"));var Bt=Y(require("toformat")),vn=Bt.default,Me=vn;var De=Y(require("big.js")),It=Y(require("bn.js")),Rt=Y(require("decimal.js-light"));var we=Y(require("bn.js"));var We=(r=>(r[r.ROUND_DOWN=0]="ROUND_DOWN",r[r.ROUND_HALF_UP=1]="ROUND_HALF_UP",r[r.ROUND_UP=2]="ROUND_UP",r))(We||{}),Ct=9007199254740991;function G(n){let e=j("Raydium_parseBigNumberish");if(n instanceof we.default)return n;if(typeof n=="string"){if(n.match(/^-?[0-9]+$/))return new we.default(n);e.logWithError(`invalid BigNumberish string: ${n}`)}return typeof n=="number"?(n%1&&e.logWithError(`BigNumberish number underflow: ${n}`),(n>=Ct||n<=-Ct)&&e.logWithError(`BigNumberish number overflow: ${n}`),new we.default(String(n))):typeof n=="bigint"?new we.default(n.toString()):(e.error(`invalid BigNumberish value: ${n}`),new we.default(0))}var qe=j("module/fraction"),it=Me(De.default),Le=Me(Rt.default),Kn={[0]:Le.ROUND_DOWN,[1]:Le.ROUND_HALF_UP,[2]:Le.ROUND_UP},Wn={[0]:De.default.roundDown,[1]:De.default.roundHalfUp,[2]:De.default.roundUp},S=class{constructor(e,t=new It.default(1)){this.numerator=G(e),this.denominator=G(t)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new S(this.denominator,this.numerator)}add(e){let t=e instanceof S?e:new S(G(e));return this.denominator.eq(t.denominator)?new S(this.numerator.add(t.numerator),this.denominator):new S(this.numerator.mul(t.denominator).add(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}sub(e){let t=e instanceof S?e:new S(G(e));return this.denominator.eq(t.denominator)?new S(this.numerator.sub(t.numerator),this.denominator):new S(this.numerator.mul(t.denominator).sub(t.numerator.mul(this.denominator)),this.denominator.mul(t.denominator))}mul(e){let t=e instanceof S?e:new S(G(e));return new S(this.numerator.mul(t.numerator),this.denominator.mul(t.denominator))}div(e){let t=e instanceof S?e:new S(G(e));return new S(this.numerator.mul(t.denominator),this.denominator.mul(t.numerator))}toSignificant(e,t={groupSeparator:""},r=1){Number.isInteger(e)||qe.logWithError(`${e} is not an integer.`),e<=0&&qe.logWithError(`${e} is not positive.`),Le.set({precision:e+1,rounding:Kn[r]});let i=new Le(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(e);return i.toFormat(i.decimalPlaces(),t)}toFixed(e,t={groupSeparator:""},r=1){return Number.isInteger(e)||qe.logWithError(`${e} is not an integer.`),e<0&&qe.logWithError(`${e} is negative.`),it.DP=e,it.RM=Wn[r]||1,new it(this.numerator.toString()).div(this.denominator.toString()).toFormat(e,t)}isZero(){return this.numerator.isZero()}};var qn=j("Raydium_amount"),Ue=Me(Mt.default);function Dt(n,e){let t="0",r="0";if(n.includes(".")){let i=n.split(".");i.length===2?([t,r]=i,r=r.padEnd(e,"0")):qn.logWithError(`invalid number string, num: ${n}`)}else t=n;return[t,r.slice(0,e)||r]}var $=class extends S{constructor(t,r,i=!0,s){let a=new oe.default(0),o=de.pow(new oe.default(t.decimals));if(i)a=G(r);else{let c=new oe.default(0),u=new oe.default(0);if(typeof r=="string"||typeof r=="number"||typeof r=="bigint"){let[g,T]=Dt(r.toString(),t.decimals);c=G(g),u=G(T)}c=c.mul(o),a=c.add(u)}super(a,o);this.logger=j(s||"TokenAmount"),this.token=t}get raw(){return this.numerator}isZero(){return this.raw.isZero()}gt(t){return this.token.equals(t.token)||this.logger.logWithError("gt token not equals"),this.raw.gt(t.raw)}lt(t){return this.token.equals(t.token)||this.logger.logWithError("lt token not equals"),this.raw.lt(t.raw)}add(t){return this.token.equals(t.token)||this.logger.logWithError("add token not equals"),new $(this.token,this.raw.add(t.raw))}subtract(t){return this.token.equals(t.token)||this.logger.logWithError("sub token not equals"),new $(this.token,this.raw.sub(t.raw))}toSignificant(t=this.token.decimals,r,i=0){return super.toSignificant(t,r,i)}toFixed(t=this.token.decimals,r,i=0){return t>this.token.decimals&&this.logger.logWithError("decimals overflow"),super.toFixed(t,r,i)}toExact(t={groupSeparator:""}){return Ue.DP=this.token.decimals,new Ue(this.numerator.toString()).div(this.denominator.toString()).toFormat(t)}},Te=class extends S{constructor(t,r,i=!0,s){let a=new oe.default(0),o=de.pow(new oe.default(t.decimals));if(i)a=G(r);else{let c=new oe.default(0),u=new oe.default(0);if(typeof r=="string"||typeof r=="number"||typeof r=="bigint"){let[g,T]=Dt(r.toString(),t.decimals);c=G(g),u=G(T)}c=c.mul(o),a=c.add(u)}super(a,o);this.logger=j(s||"TokenAmount"),this.currency=t}get raw(){return this.numerator}isZero(){return this.raw.isZero()}gt(t){return this.currency.equals(t.currency)||this.logger.logWithError("gt currency not equals"),this.raw.gt(t.raw)}lt(t){return this.currency.equals(t.currency)||this.logger.logWithError("lt currency not equals"),this.raw.lt(t.raw)}add(t){return this.currency.equals(t.currency)||this.logger.logWithError("add currency not equals"),new Te(this.currency,this.raw.add(t.raw))}sub(t){return this.currency.equals(t.currency)||this.logger.logWithError("sub currency not equals"),new Te(this.currency,this.raw.sub(t.raw))}toSignificant(t=this.currency.decimals,r,i=0){return super.toSignificant(t,r,i)}toFixed(t=this.currency.decimals,r,i=0){return t>this.currency.decimals&&this.logger.logWithError("decimals overflow"),super.toFixed(t,r,i)}toExact(t={groupSeparator:""}){return Ue.DP=this.currency.decimals,new Ue(this.numerator.toString()).div(this.denominator.toString()).toFormat(t)}};var Lt=require("@solana/web3.js"),ot=require("@solana/spl-token"),Nt={chainId:101,address:Lt.PublicKey.default.toBase58(),programId:ot.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},be={chainId:101,address:"So11111111111111111111111111111111111111112",programId:ot.TOKEN_PROGRAM_ID.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};var ze=require("@solana/web3.js");var E=require("@solana/web3.js"),Ft=require("@solana/spl-token");function Ge({pubkey:n,isSigner:e=!1,isWritable:t=!0}){return{pubkey:n,isWritable:t,isSigner:e}}var Un=[Ge({pubkey:Ft.TOKEN_PROGRAM_ID,isWritable:!1}),Ge({pubkey:E.SystemProgram.programId,isWritable:!1}),Ge({pubkey:E.SYSVAR_RENT_PUBKEY,isWritable:!1})];function He({publicKey:n,transformSol:e}){let t=je(n.toString());if(t instanceof E.PublicKey)return e&&t.equals(xe)?Re:t;if(e&&t.toString()===xe.toBase58())return Re;if(typeof t=="string"){if(t===E.PublicKey.default.toBase58())return E.PublicKey.default;try{return new E.PublicKey(t)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function je(n){try{return new E.PublicKey(n)}catch{return n}}var Gn=new E.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),Hn=new E.PublicKey("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),jn=new E.PublicKey("SysvarRent111111111111111111111111111111111"),zn=new E.PublicKey("SysvarC1ock11111111111111111111111111111111"),Yn=new E.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),Jn=new E.PublicKey("Sysvar1nstructions1111111111111111111111111"),Zn=E.SystemProgram.programId,Xn=new E.PublicKey("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),Qn=new E.PublicKey("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),$n=new E.PublicKey("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),er=new E.PublicKey("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),tr=new E.PublicKey("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),nr=new E.PublicKey("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),rr=new E.PublicKey("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),ir=new E.PublicKey("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),or=new E.PublicKey("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),sr=new E.PublicKey("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),ar=new E.PublicKey("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),Re=new E.PublicKey("So11111111111111111111111111111111111111112"),xe=E.PublicKey.default;function rt(n){return He({publicKey:n,transformSol:!0})}var st=class{constructor({mint:e,decimals:t,symbol:r,name:i,skipMint:s=!1,isToken2022:a=!1}){if(e===xe.toBase58()||e instanceof ze.PublicKey&&xe.equals(e)){this.decimals=be.decimals,this.symbol=be.symbol,this.name=be.name,this.mint=new ze.PublicKey(be.address),this.isToken2022=!1;return}this.decimals=t,this.symbol=r||e.toString().substring(0,6),this.name=i||e.toString().substring(0,6),this.mint=s?ze.PublicKey.default:He({publicKey:e}),this.isToken2022=a}equals(e){return this===e?!0:this.mint.equals(e.mint)}},se=st;se.WSOL=new st(X(v({},be),{mint:be.address}));var at=class{constructor({decimals:e,symbol:t="UNKNOWN",name:r="UNKNOWN"}){this.decimals=e,this.symbol=t,this.name=r}equals(e){return this===e}},Ne=at;Ne.SOL=new at(Nt);var _t=Y(require("bn.js"));var Et=new S(new _t.default(100)),te=class extends S{toSignificant(e=5,t,r){return this.mul(Et).toSignificant(e,t,r)}toFixed(e=2,t,r){return this.mul(Et).toFixed(e,t,r)}};var cr=j("Raydium_price"),Q=class extends S{constructor(t){let{baseToken:r,quoteToken:i,numerator:s,denominator:a}=t;super(s,a);this.baseToken=r,this.quoteToken=i,this.scalar=new S(Ye(r.decimals),Ye(i.decimals))}get raw(){return new S(this.numerator,this.denominator)}get adjusted(){return super.mul(this.scalar)}invert(){return new Q({baseToken:this.quoteToken,quoteToken:this.baseToken,denominator:this.numerator,numerator:this.denominator})}mul(t){this.quoteToken!==t.baseToken&&cr.logWithError("mul token not equals");let r=super.mul(t);return new Q({baseToken:this.baseToken,quoteToken:t.quoteToken,denominator:r.denominator,numerator:r.numerator})}toSignificant(t=this.quoteToken.decimals,r,i){return this.adjusted.toSignificant(t,r,i)}toFixed(t=this.quoteToken.decimals,r,i){return this.adjusted.toFixed(t,r,i)}};function K(n){if(n instanceof te)return new S(n.numerator,n.denominator);if(n instanceof Q)return n.adjusted;if(n instanceof $)try{return K(n.toExact())}catch{return new S(ae)}if(n instanceof S)return n;let e=String(n),t=fe(e);return new S(t.numerator,t.denominator)}function ur(n){var r;if(n instanceof te)return{fr:new S(n.numerator,n.denominator)};if(n instanceof Q)return{fr:n.adjusted};if(n instanceof $)return{fr:K(n.toExact()),decimals:n.token.decimals};if(n instanceof S)return{fr:n};let e=String(n),t=fe(e);return{fr:new S(t.numerator,t.denominator),decimals:(r=t.dec)==null?void 0:r.length}}function lr(n,e){if(n==null||e==null)return!1;let t=K(n),r=K(e);return t.sub(r).numerator,t.sub(r).numerator.lt(ae)}function Ot(n,e){if(n==null||e==null)return!1;let t=K(n),r=K(e);return t.sub(r).numerator.gt(ae)}function mr(n,e){if(n==null||e==null)return!1;let t=K(n),r=K(e);return t.sub(r).numerator.lte(ae)}function pr(n,e){if(n==null||e==null)return!1;let t=K(n),r=K(e);return t.sub(r).numerator.gte(ae)}function Vt(n,e){if(n==null||e==null)return!1;let t=K(n),r=K(e);return t.sub(r).numerator.eq(ae)}function dr(n,e){if(n==null||e==null)return;let t=K(n),r=K(e);try{return t.div(r)}catch{return t}}function fr(n,e){if(n==null||e==null)return;let t=K(n),r=K(e);return t.sub(r)}function gr(n){return n==null?!1:!Vt(n,0)}function hr(n,e){return Ot(e,n)?e:n}function Je(n,e){if(n==null||e==null)return;let t=K(n),r=K(e);return t.mul(r)}function Tr(n,e){if(n==null||e==null)return;let t=K(n),r=K(e);return t.add(r)}var ae=new V.default(0),br=new V.default(1),yr=new V.default(2),wr=new V.default(3),xr=new V.default(5),de=new V.default(10),Pr=new V.default(100),Ar=new V.default(1e3),Sr=new V.default(1e4);function Ye(n){return de.pow(G(n))}function fe(n){var o;if(n===void 0)return{denominator:"1",numerator:"0"};if(n instanceof V.default)return{numerator:n.toString(),denominator:"1"};if(n instanceof S)return{denominator:n.denominator.toString(),numerator:n.numerator.toString()};let e=String(n),[,t="",r="",i=""]=(o=e.replace(",","").match(/(-?)(\d*)\.?(\d*)/))!=null?o:[],s="1"+"0".repeat(i.length),a=t+(r==="0"?"":r)+i||"0";return{denominator:s,numerator:a,sign:t,int:r,dec:i}}function kr(n,e){let t=n.divmod(e);return t.mod.isZero()?t.div:t.div.isNeg()?t.div.isubn(1):t.div.iaddn(1)}function Kt(n){var r;let[,e="",t=""]=(r=n.toFixed(2).match(/(-?)(\d*)\.?(\d*)/))!=null?r:[];return`${e}${t}`}function Wt(n,e=0){return n instanceof V.default?n:new V.default(Kt(ut(n).mul(de.pow(new V.default(String(e))))))}function ut(n){if(n instanceof te)return new S(n.numerator,n.denominator);if(n instanceof Q)return n.adjusted;if(n instanceof $)try{return ut(n.toExact())}catch{return new S(ae)}if(n instanceof S)return n;let e=String(n),t=fe(e);return new S(t.numerator,t.denominator)}function Br(n,e,t){return n.mul(e).add(t).sub(new V.default(1)).div(t)}function Cr(n,e,t){return n.mul(e).div(t)}function Ir(n,e){let{numerator:t,denominator:r}=fe(n);return new te(new V.default(t),new V.default(r).mul(e!=null&&e.alreadyDecimaled?new V.default(100):new V.default(1)))}function Rr(n){let{token:e,numberPrice:t,decimalDone:r}=n,i=new se({mint:"",decimals:6,symbol:"usd",name:"usd",skipMint:!0}),{numerator:s,denominator:a}=fe(t),o=r?new V.default(s).mul(de.pow(new V.default(e.decimals))):s,c=new V.default(a).mul(de.pow(new V.default(i.decimals)));return new Q({baseToken:i,denominator:c.toString(),quoteToken:new se(X(v({},e),{skipMint:!0,mint:""})),numerator:o.toString()})}function ct(n){let e=new Ne({decimals:6,symbol:"usd",name:"usd"}),t=Wt(Je(n,10**e.decimals));return new Te(e,t)}function Mr(n,e){return ct(!e||!n?0:Je(n,e))}function Dr(n){if(n==null)return;let{numerator:e,denominator:t}=fe(n.toString());return new S(e,t)}function Lr(n){return n instanceof vt.default}var lt=n=>typeof n=="number",mt=n=>n?new Date(n):new Date,qt=n=>mt(n).getTime();function Nr(n,e,t){let r=lt(e)?e*((t==null?void 0:t.unit)==="s"?1e3:1):e;return new Date(n).getTime()<=r}function Fr(n,e,t){let r=lt(e)?e*((t==null?void 0:t.unit)==="s"?1e3:1):e;return new Date(n).getTime()>r}function Er(n,e){let r=qt(n)+(e.days?e.days*24*60*60*1e3:0)+(e.hours?e.hours*60*60*1e3:0)+(e.minutes?e.minutes*60*1e3:0)+(e.seconds?e.seconds*1e3:0)+(e.milliseconds?e.milliseconds:0);return mt(r)}function ve(n,e=1,t=[]){let r=[...n];if(e<=0)return t;for(;r.length;)t.push(r.splice(0,e));return t}function _r(n,...e){return n.filter(t=>e.every(r=>r.includes(t)))}function Or(n,...e){return n.filter(t=>e.every(r=>!r.includes(t)))}function Vr(n){return[...new Set(n)]}var ce=class{constructor(e){this._owner=e}get publicKey(){return ce.isKeyPair(this._owner)?this._owner.publicKey:this._owner}get signer(){return ce.isKeyPair(this._owner)?this._owner:void 0}get isKeyPair(){return ce.isKeyPair(this._owner)}get isPublicKey(){return ce.isPublicKey(this._owner)}static isKeyPair(e){return e.secretKey!==void 0}static isPublicKey(e){return!ce.isKeyPair(e)}};var jt=require("@solana/web3.js"),zt=require("@solana/spl-token");var W=require("@solana/web3.js");var pt=(t=>(t[t.V0=0]="V0",t[t.LEGACY=1]="LEGACY",t))(pt||{}),Pe={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",ClmmLockPosition:"ClmmLockPosition",ClmmHarvestLockPosition:"ClmmHarvestLockPosition",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV4Withdraw:"FarmV4Withdraw",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut",CpmmLockLp:"CpmmLockLp",CpmmCollectLockFee:"CpmmCollectLockFee",TransferTip:"TransferTip"};var Ut=require("@solana/spl-token"),ue=j("Raydium_txUtil"),dt=1644;function Ae(n){let e=[],t=[];return n.microLamports&&(e.push(W.ComputeBudgetProgram.setComputeUnitPrice({microLamports:n.microLamports})),t.push(Pe.SetComputeUnitPrice)),n.units&&(e.push(W.ComputeBudgetProgram.setComputeUnitLimit({units:n.units})),t.push(Pe.SetComputeUnitLimit)),{instructions:e,instructionTypes:t}}async function ge(n,e){var r,i;let t=e!=null?e:"confirmed";return(i=await((r=n.getLatestBlockhash)==null?void 0:r.call(n,{commitment:t})))==null?void 0:i.blockhash}async function Se(n,e){return n.getSignatureStatuses([e]),new Promise((t,r)=>{let i=setTimeout(r,6e4);n.onSignature(e,s=>{if(clearTimeout(i),!s.err){t("");return}r(Object.assign(s.err,{txId:e}))},"confirmed")})}function ft(n,e){n.length<1&&ue.logWithError(`no instructions provided: ${n.toString()}`),e.length<1&&ue.logWithError(`no signers provided:, ${e.toString()}`);let t=new W.Transaction;t.recentBlockhash="11111111111111111111111111111111",t.feePayer=e[0],t.add(...n);try{return Buffer.from(t.serialize({verifySignatures:!1})).toString("base64").length<dt}catch{return!1}}async function vr(n,e,t,r=!0){let i=new W.PublicKey("RaydiumSimuLateTransaction11111111111111111"),s=[],a=new W.Transaction;a.feePayer=i;for(let u of e)ft([...a.instructions,u],[i])||(s.push(a),a=new W.Transaction,a.feePayer=i),a.add(u);a.instructions.length>0&&s.push(a);let o=[];try{if(o=await Gt(n,s,r),o.find(u=>u.err!==null))throw Error("rpc simulateTransaction error")}catch(u){u instanceof Error&&ue.logWithError("failed to simulate for instructions","RPC_ERROR",{message:u.message})}let c=[];for(let u of o)if(ue.debug("simulate result:",u),u.logs){let g=u.logs.filter(T=>T&&T.includes(t));ue.debug("filteredLog:",c),g.length||ue.logWithError("simulate log not match keyword","keyword",t),c.push(...g)}return c}function Kr(n,e){let t=n.match(/{["\w:,]+}/g);return!t||t.length!==1?ue.logWithError(`simulate log fail to match json, keyword: ${e}`):t[0]}function Wr(n,e){let r=new RegExp(`"${e}":(\\d+)`,"g").exec(n);return!r||r.length!==2?ue.logWithError(`simulate log fail to match key", key: ${e}`):r[1]}function gt(n,e){let[t,r]=W.PublicKey.findProgramAddressSync(n,e);return{publicKey:t,nonce:r}}async function Gt(n,e,t){let r=[];if(t){let i=await n.getLatestBlockhash(),s=[];for(let u of e){u.recentBlockhash=i.blockhash,u.lastValidBlockHeight=i.lastValidBlockHeight;let T=u._compile().serialize(),k=u._serialize(T).toString("base64");s.push(k)}let a=s.map(u=>{let g=n._buildArgs([u],void 0,"base64");return{methodName:"simulateTransaction",args:g}}),o=[],c=20;for(let u=0;u<Math.ceil(a.length/c);u++)o.push(a.slice(u*c,(u+1)*c));r=await(await Promise.all(o.map(async u=>(await n._rpcBatchRequest(u)).map(g=>g.result.value)))).flat()}else try{r=await Promise.all(e.map(async i=>await(await n.simulateTransaction(i)).value))}catch(i){i instanceof Error&&ue.logWithError("failed to get info for multiple accounts","RPC_ERROR",{message:i.message})}return r}function ke({instructions:n,payer:e,signers:t}){return ft(n,[e,...t])}function ne({instructions:n,payer:e,lookupTableAddressAccount:t,recentBlockhash:r=W.Keypair.generate().publicKey.toString()}){let s=new W.TransactionMessage({payerKey:e,recentBlockhash:r,instructions:n}).compileToV0Message(Object.values(t!=null?t:{}));try{return Buffer.from(new W.VersionedTransaction(s).serialize()).toString("base64").length<dt}catch{return!1}}var Ze={time:0,data:void 0};async function qr(n){if(!Ze.data||(Date.now()-Ze.time)/1e3>30){let e=await n.getEpochInfo();return Ze={time:Date.now(),data:e},e}else return Ze.data}var ht=n=>Buffer.isBuffer(n)?n:n instanceof Uint8Array?Buffer.from(n.buffer,n.byteOffset,n.byteLength):Buffer.from(n),Ht=n=>{let e=n.serialize({requireAllSignatures:!1,verifySignatures:!1});n instanceof W.VersionedTransaction&&(e=ht(e));try{return e instanceof Buffer?e.toString("base64"):Buffer.from(e).toString("base64")}catch{return e.toString("base64")}};function le(n){let e=[];return n.forEach(t=>{t instanceof W.Transaction&&(t.recentBlockhash||(t.recentBlockhash=Ut.TOKEN_PROGRAM_ID.toBase58()),t.feePayer||(t.feePayer=W.Keypair.generate().publicKey)),e.push(Ht(t))}),console.log("simulate tx string:",e),e}function Ur(n){let e=n.serialize({requireAllSignatures:!1,verifySignatures:!1});return n instanceof W.VersionedTransaction&&(e=ht(e)),e.toString("base64")}function Gr(n,e,t){return gt([n.toBuffer(),(t!=null?t:zt.TOKEN_PROGRAM_ID).toBuffer(),e.toBuffer()],new jt.PublicKey("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"))}var b=require("@solana/web3.js"),Yt=new b.PublicKey("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),Jt=new b.PublicKey("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),Zt=new b.PublicKey("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),Xt=new b.PublicKey("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),Qt=new b.PublicKey("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),$t=new b.PublicKey("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),en=new b.PublicKey("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),tn=new b.PublicKey("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),nn=new b.PublicKey("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),Hr=new b.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),rn=new b.PublicKey("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),on=new b.PublicKey("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),sn=new b.PublicKey("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),an=new b.PublicKey("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),cn=new b.PublicKey("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),un=new b.PublicKey("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),ln=new b.PublicKey("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),mn=new b.PublicKey("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),pn=new b.PublicKey("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),dn=new b.PublicKey("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),fn=new b.PublicKey("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),gn=new b.PublicKey("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),hn=new b.PublicKey("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),Tn=new b.PublicKey("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),bn=new b.PublicKey("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),yn=new b.PublicKey("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),wn=new b.PublicKey("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),jr=new b.PublicKey("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),zr=new b.PublicKey("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),xn=new b.PublicKey("4Bu96XjU84XjPDSpveTVf6LYGCkfW5FK7SNkREWcEfV4"),Pn=new b.PublicKey("6s1xP3hpbAfFoNtUNF8mfHsjr2Bd97JxFJRWLbL6aHuX"),Yr={IDO_PROGRAM_ID_V1:ln,IDO_PROGRAM_ID_V2:mn,IDO_PROGRAM_ID_V3:pn,IDO_PROGRAM_ID_V4:dn},Jr={AMM_V4:tn,AMM_STABLE:nn,CLMM_PROGRAM_ID:rn,CLMM_LOCK_PROGRAM_ID:on,CLMM_LOCK_AUTH_ID:sn,FARM_PROGRAM_ID_V3:Yt,FARM_PROGRAM_ID_V4:Jt,FARM_PROGRAM_ID_V5:Zt,FARM_PROGRAM_ID_V6:Xt,OPEN_BOOK_PROGRAM:$t,SERUM_PROGRAM_ID_V3:en,UTIL1216:Qt,Router:cn,CREATE_CPMM_POOL_PROGRAM:fn,CREATE_CPMM_POOL_AUTH:gn,CREATE_CPMM_POOL_FEE_ACC:hn,LOCK_CPMM_PROGRAM:Tn,LOCK_CPMM_AUTH:bn,LAUNCHPAD_PROGRAM:yn,LAUNCHPAD_AUTH:wn,LAUNCHPAD_PLATFORM:xn,LAUNCHPAD_CONFIG:Pn,FEE_DESTINATION_ID:un,MODEL_DATA_PUBKEY:an},Zr={OPEN_BOOK_PROGRAM:new b.PublicKey("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),SERUM_PROGRAM_ID_V3:new b.PublicKey("Ray1111111111111111111111111111111111111111"),AMM_V4:new b.PublicKey("DRaya7Kj3aMWQSy19kSjvmuwq9docCHofyP9kanQGaav"),AMM_STABLE:new b.PublicKey("DRayDdXc1NZQ9C3hRWmoSf8zK4iapgMnjdNZWrfwsP8m"),CLMM_PROGRAM_ID:new b.PublicKey("DRayAUgENGQBKVaX8owNhgzkEDyoHTGVEGHVJT1E9pfH"),CLMM_LOCK_PROGRAM_ID:new b.PublicKey("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),CLMM_LOCK_AUTH_ID:new b.PublicKey("6Aoh8h2Lw2m5UGxYR8AdAL87jTWYeKoxM52mJRzfYwN"),CREATE_CPMM_POOL_PROGRAM:new b.PublicKey("DRaycpLY18LhpbydsBWbVJtxpNv9oXPgjRSfpF2bWpYb"),CREATE_CPMM_POOL_AUTH:new b.PublicKey("CXniRufdq5xL8t8jZAPxsPZDpuudwuJSPWnbcD5Y5Nxq"),CREATE_CPMM_POOL_FEE_ACC:new b.PublicKey("3oE58BKVt8KuYkGxx8zBojugnymWmBiyafWgMrnb6eYy"),LOCK_CPMM_PROGRAM:new b.PublicKey("DRay25Usp3YJAi7beckgpGUC7mGJ2cR1AVPxhYfwVCUX"),LOCK_CPMM_AUTH:new b.PublicKey("7qWVV8UY2bRJfDLP4s37YzBPKUkVB46DStYJBpYbQzu3"),UTIL1216:b.PublicKey.default,Router:new b.PublicKey("DRaybByLpbUL57LJARs3j8BitTxVfzBg351EaMr5UTCd"),FARM_PROGRAM_ID_V3:new b.PublicKey("DRayWyrLmEW5KEeqs8kdTMMaBabapqagaBC7KWpGtJeZ"),FARM_PROGRAM_ID_V4:new b.PublicKey("Ray1111111111111111111111111111111111111111"),FARM_PROGRAM_ID_V5:new b.PublicKey("DRayiCGSZgku1GTK6rXD6mVDdingXy6APAH1R6R5L2LC"),FARM_PROGRAM_ID_V6:new b.PublicKey("DRayzbYakXs45ELHkzH6vC3fuhQqTAnv5A68gdFuvZyZ"),LAUNCHPAD_PROGRAM:new b.PublicKey("DRay6fNdQ5J82H7xV6uq2aV3mNrUZ1J4PgSKsWgptcm6"),LAUNCHPAD_AUTH:new b.PublicKey("5xqNaZXX5eUi4p5HU4oz9i5QnwRNT2y6oN7yyn4qENeq"),LAUNCHPAD_PLATFORM:new b.PublicKey("2Jx4KTDrVSdWNazuGpcA8n3ZLTRGGBDxAWhuKe2Xcj2a"),LAUNCHPAD_CONFIG:new b.PublicKey("7ZR4zD7PYfY2XxoG1Gxcy2EgEeGYrpxrwzPuwdUBssEt"),FEE_DESTINATION_ID:new b.PublicKey("9y8ENuuZ3b19quffx9hQvRVygG5ky6snHfRvGpuSfeJy"),MODEL_DATA_PUBKEY:new b.PublicKey("Ray1111111111111111111111111111111111111111")};var D=Y(require("bn.js")),z=1e4;function Xr(n,e,t,r){if(e===void 0)return{amount:n,fee:void 0,expirationTime:void 0};let i=t.epoch<e.newerTransferFee.epoch?e.olderTransferFee:e.newerTransferFee,s=new D.default(i.maximumFee.toString()),a=t.epoch<e.newerTransferFee.epoch?(Number(e.newerTransferFee.epoch)*t.slotsInEpoch-t.absoluteSlot)*400/1e3:void 0;if(r)if(i.transferFeeBasisPoints===z){let o=new D.default(i.maximumFee.toString());return{amount:n.add(o),fee:o,expirationTime:a}}else{let o=re(n.mul(new D.default(z)),new D.default(z-i.transferFeeBasisPoints)),c=new D.default(i.maximumFee.toString()),u=o.sub(n).gt(c)?n.add(c):o,g=re(u.mul(new D.default(i.transferFeeBasisPoints)),new D.default(z)),T=g.gt(s)?s:g;return{amount:u,fee:T,expirationTime:a}}else{let o=re(n.mul(new D.default(i.transferFeeBasisPoints)),new D.default(z)),c=o.gt(s)?s:o;return{amount:n,fee:c,expirationTime:a}}}function Qr(n,e,t,r){if(e===void 0)return{amount:n,fee:void 0,expirationTime:void 0};let i=X(v({},e),{olderTransferFee:{epoch:BigInt(e.olderTransferFee.epoch),maximumFee:BigInt(e.olderTransferFee.maximumFee),transferFeeBasisPoints:e.olderTransferFee.transferFeeBasisPoints},newerTransferFee:{epoch:BigInt(e.newerTransferFee.epoch),maximumFee:BigInt(e.newerTransferFee.maximumFee),transferFeeBasisPoints:e.newerTransferFee.transferFeeBasisPoints}}),s=t.epoch<i.newerTransferFee.epoch?i.olderTransferFee:i.newerTransferFee,a=new D.default(s.maximumFee.toString()),o=t.epoch<i.newerTransferFee.epoch?(Number(i.newerTransferFee.epoch)*t.slotsInEpoch-t.absoluteSlot)*400/1e3:void 0;if(r)if(s.transferFeeBasisPoints===z){let c=new D.default(s.maximumFee.toString());return{amount:n.add(c),fee:c,expirationTime:o}}else{let c=re(n.mul(new D.default(z)),new D.default(z-s.transferFeeBasisPoints)),u=new D.default(s.maximumFee.toString()),g=c.sub(n).gt(u)?n.add(u):c,T=re(g.mul(new D.default(s.transferFeeBasisPoints)),new D.default(z)),A=T.gt(a)?a:T;return{amount:g,fee:A,expirationTime:o}}else{let c=re(n.mul(new D.default(s.transferFeeBasisPoints)),new D.default(z)),u=c.gt(a)?a:c;return{amount:n,fee:u,expirationTime:o}}}function $r(n,e){return n===void 0?e:e===void 0?n:Math.min(n,e)}function re(n,e){let{div:t,mod:r}=n.divmod(e);return r.gt(new D.default(0))?t.add(new D.default(1)):t}function ei(n,e){if(n.isZero())return new D.default(0);let t=n.div(e);return t.isZero()?new D.default(1):n.mod(e).gt(new D.default(0))?t.add(new D.default(1)):t}function ti(n,e,t){if(e===void 0)return{amount:n,fee:void 0,expirationTime:void 0};let r=Math.floor(t/432e3),i=r<e.newerTransferFee.epoch?e.olderTransferFee:e.newerTransferFee,s=new D.default(i.maximumFee.toString()),a=r<e.newerTransferFee.epoch?(Number(e.newerTransferFee.epoch)*432e3-t)*400/1e3:void 0,o=re(n.mul(new D.default(i.transferFeeBasisPoints)),new D.default(z)),c=o.gt(s)?s:o;return{amount:n,fee:c,expirationTime:a}}function ni(n,e,t){if(e===void 0)return{amount:n,fee:void 0,expirationTime:void 0};let r=Math.floor(t/432e3),i=r<e.newerTransferFee.epoch?e.olderTransferFee:e.newerTransferFee,s=new D.default(i.maximumFee.toString()),a=r<e.newerTransferFee.epoch?(Number(e.newerTransferFee.epoch)*432e3-t)*400/1e3:void 0;if(i.transferFeeBasisPoints===z){let o=new D.default(i.maximumFee.toString());return{amount:n.add(o),fee:o,expirationTime:a}}else{let o=re(n.mul(new D.default(z)),new D.default(z-i.transferFeeBasisPoints)),c=new D.default(i.maximumFee.toString()),u=o.sub(n).gt(c)?n.add(c):o,g=re(u.mul(new D.default(i.transferFeeBasisPoints)),new D.default(z)),T=g.gt(s)?s:g;return{amount:u,fee:T,expirationTime:a}}}var ee=require("@solana/web3.js");async function Fe({connection:n,address:e,cluster:t="mainnet"}){let r=await Ke(n,[...new Set(e.map(s=>s.toString()))].map(s=>new ee.PublicKey(s))),i={};for(let s=0;s<e.length;s++){let a=r[s],o=e[s];if(!a)continue;let c=new ee.AddressLookupTableAccount({key:o,state:ee.AddressLookupTableAccount.deserialize(a.data)});i[o.toString()]=c,t==="devnet"?ye[o.toString()]=c:me[o.toString()]=c}return i}var me={},Xe=async n=>{let e="AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU";if(me[e])return me;let t=new ee.PublicKey(e),r=await n.getAccountInfo(t);return r&&(me[e]=new ee.AddressLookupTableAccount({key:t,state:ee.AddressLookupTableAccount.deserialize(r.data)})),me},ye={},Ee=async n=>{let e="EFhMuDw1PKEuckuFRW9PavNfTH4LKP5uKHgyXDmWpFCq";if(ye[e])return ye;let t=new ee.PublicKey(e),r=await n.getAccountInfo(t);return r&&(ye[e]=new ee.AddressLookupTableAccount({key:t,state:ee.AddressLookupTableAccount.deserialize(r.data)})),ye};var I=require("@solana/web3.js"),An=Y(require("axios"));var _e=2e3,Tt=class{constructor(e){this.instructions=[];this.endInstructions=[];this.lookupTableAddress=[];this.signers=[];this.instructionTypes=[];this.endInstructionTypes=[];this.connection=e.connection,this.feePayer=e.feePayer,this.signAllTransactions=e.signAllTransactions,this.owner=e.owner,this.cluster=e.cluster,this.blockhashCommitment=e.blockhashCommitment,this.loopMultiTxStatus=!!e.loopMultiTxStatus}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers,instructionTypes:this.instructionTypes,endInstructionTypes:this.endInstructionTypes,lookupTableAddress:this.lookupTableAddress}}get allInstructions(){return[...this.instructions,...this.endInstructions]}async getComputeBudgetConfig(){var r;let e=(await An.default.get(`https://solanacompass.com/api/fees?cacheFreshTime=${3e5}`)).data,{avg:t}=(r=e==null?void 0:e[15])!=null?r:{};if(!!t)return{units:6e5,microLamports:Math.min(Math.ceil(t*1e6/6e5),25e3)}}addCustomComputeBudget(e){if(e){let{instructions:t,instructionTypes:r}=Ae(e);return this.instructions.unshift(...t),this.instructionTypes.unshift(...r),!0}return!1}addTipInstruction(e){var t;return e?(this.endInstructions.push(I.SystemProgram.transfer({fromPubkey:(t=e.feePayer)!=null?t:this.feePayer,toPubkey:new I.PublicKey(e.address),lamports:BigInt(e.amount.toString())})),this.endInstructionTypes.push(Pe.TransferTip),!0):!1}async calComputeBudget({config:e,defaultIns:t}){try{let r=e||await this.getComputeBudgetConfig();if(this.addCustomComputeBudget(r))return;t&&this.instructions.unshift(...t)}catch{t&&this.instructions.unshift(...t)}}addInstruction({instructions:e=[],endInstructions:t=[],signers:r=[],instructionTypes:i=[],endInstructionTypes:s=[],lookupTableAddress:a=[]}){return this.instructions.push(...e),this.endInstructions.push(...t),this.signers.push(...r),this.instructionTypes.push(...i),this.endInstructionTypes.push(...s),this.lookupTableAddress.push(...a.filter(o=>o!==I.PublicKey.default.toString())),this}async versionBuild({txVersion:e,extInfo:t}){return e===0?await this.buildV0(v({},t||{})):this.build(t)}build(e){var r;let t=new I.Transaction;return this.allInstructions.length&&t.add(...this.allInstructions),t.feePayer=this.feePayer,((r=this.owner)==null?void 0:r.signer)&&!this.signers.some(i=>i.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer),{builder:this,transaction:t,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async i=>{var g;let{recentBlockHash:s,skipPreflight:a=!0,sendAndConfirm:o,notSendToRpc:c}=i||{},u=s!=null?s:await ge(this.connection,this.blockhashCommitment);if(t.recentBlockhash=u,this.signers.length&&t.sign(...this.signers),le([t]),(g=this.owner)!=null&&g.isKeyPair)return{txId:o?await(0,I.sendAndConfirmTransaction)(this.connection,t,this.signers.find(A=>A.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:a}):await this.connection.sendRawTransaction(t.serialize(),{skipPreflight:a}),signedTx:t};if(this.signAllTransactions){let T=await this.signAllTransactions([t]);if(this.signers.length)for(let A of T)try{A.sign(...this.signers)}catch{}return{txId:c?"":await this.connection.sendRawTransaction(T[0].serialize(),{skipPreflight:a}),signedTx:T[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:e||{}}}buildMultiTx(e){var u;let{extraPreBuildData:t=[],extInfo:r}=e,{transaction:i}=this.build(r),s=t.filter(g=>g.transaction.instructions.length>0),a=[i,...s.map(g=>g.transaction)],o=[this.signers,...s.map(g=>g.signers)],c=[...this.instructionTypes,...s.map(g=>g.instructionTypes).flat()];return(u=this.owner)!=null&&u.signer&&o.forEach(g=>{g.some(T=>T.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),{builder:this,transactions:a,signers:o,instructionTypes:c,execute:async g=>{var M;let{sequentially:T,onTxUpdate:A,skipTxCount:k=0,recentBlockHash:f,skipPreflight:w=!0}=g||{},d=f!=null?f:await ge(this.connection,this.blockhashCommitment);if((M=this.owner)!=null&&M.isKeyPair){if(T){let x=[],L=0;for(let p of a){if(++L,L<=k)continue;let l=await(0,I.sendAndConfirmTransaction)(this.connection,p,this.signers.find(m=>m.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:w});x.push(l)}return{txIds:x,signedTxs:a}}return{txIds:await await Promise.all(a.map(async x=>(x.recentBlockhash=d,await this.connection.sendRawTransaction(x.serialize(),{skipPreflight:w})))),signedTxs:a}}if(this.signAllTransactions){let x=a.map((p,l)=>(p.recentBlockhash=d,o[l].length&&p.sign(...o[l]),p));le(x);let L=await this.signAllTransactions(x);if(T){let p=0,l=[],m=async()=>{if(!L[p])return;let y=await this.connection.sendRawTransaction(L[p].serialize(),{skipPreflight:w});l.push({txId:y,status:"sent",signedTx:L[p]}),A==null||A([...l]),p++;let h=!1,B=null,F=null,N=P=>{B!==null&&clearInterval(B),F!==null&&this.connection.removeSignatureListener(F);let C=l.findIndex(R=>R.txId===y);if(C>-1){if(l[C].status==="error"||l[C].status==="success")return;l[C].status=P.err?"error":"success"}A==null||A([...l]),P.err||m()};this.loopMultiTxStatus&&(B=setInterval(async()=>{var P;if(h){clearInterval(B);return}try{let C=await this.connection.getTransaction(y,{commitment:"confirmed",maxSupportedTransactionVersion:0});C&&(h=!0,clearInterval(B),N({err:((P=C.meta)==null?void 0:P.err)||null}),console.log("tx status from getTransaction:",y))}catch(C){h=!0,clearInterval(B),console.error("getTransaction timeout:",C,y)}},_e)),F=this.connection.onSignature(y,P=>{if(h){this.connection.removeSignatureListener(F);return}h=!0,N(P)},"confirmed"),this.connection.getSignatureStatus(y)};return await m(),{txIds:l.map(y=>y.txId),signedTxs:L}}else{let p=[];for(let l=0;l<L.length;l+=1){let m=await this.connection.sendRawTransaction(L[l].serialize(),{skipPreflight:w});p.push(m)}return{txIds:p,signedTxs:L}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async versionMultiBuild({extraPreBuildData:e,txVersion:t,extInfo:r}){return t===0?await this.buildV0MultiTx({extraPreBuildData:e,buildProps:r||{}}):this.buildMultiTx({extraPreBuildData:e,extInfo:r})}async buildV0(e){var w;let f=e||{},{lookupTableCache:t={},lookupTableAddress:r=[],forerunCreate:i,recentBlockhash:s}=f,a=Ie(f,["lookupTableCache","lookupTableAddress","forerunCreate","recentBlockhash"]),o=v(v({},this.cluster==="devnet"?await Ee(this.connection):await Xe(this.connection)),t),c=Array.from(new Set([...r,...this.lookupTableAddress])),u=[];for(let d of c)o[d]===void 0&&u.push(new I.PublicKey(d));let g=await Fe({connection:this.connection,address:u});for(let[d,M]of Object.entries(g))o[d]=M;let T=i?I.PublicKey.default.toBase58():s!=null?s:await ge(this.connection,this.blockhashCommitment),A=new I.TransactionMessage({payerKey:this.feePayer,recentBlockhash:T,instructions:[...this.allInstructions]}).compileToV0Message(Object.values(o));((w=this.owner)==null?void 0:w.signer)&&!this.signers.some(d=>d.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer);let k=new I.VersionedTransaction(A);return k.sign(this.signers),{builder:this,transaction:k,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async d=>{var p;let{skipPreflight:M=!0,sendAndConfirm:x,notSendToRpc:L}=d||{};if(le([k]),(p=this.owner)!=null&&p.isKeyPair){let l=await this.connection.sendTransaction(k,{skipPreflight:M});return x&&await Se(this.connection,l),{txId:l,signedTx:k}}if(this.signAllTransactions){let l=await this.signAllTransactions([k]);if(this.signers.length)for(let m of l)try{m.sign(this.signers)}catch{}return{txId:L?"":await this.connection.sendTransaction(l[0],{skipPreflight:M}),signedTx:l[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:a||{}}}async buildV0MultiTx(e){var u;let{extraPreBuildData:t=[],buildProps:r}=e,{transaction:i}=await this.buildV0(r),s=t.filter(g=>g.builder.instructions.length>0),a=[i,...s.map(g=>g.transaction)],o=[this.signers,...s.map(g=>g.signers)],c=[...this.instructionTypes,...s.map(g=>g.instructionTypes).flat()];return(u=this.owner)!=null&&u.signer&&o.forEach(g=>{g.some(T=>T.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),a.forEach(async(g,T)=>{g.sign(o[T])}),{builder:this,transactions:a,signers:o,instructionTypes:c,buildProps:r,execute:async g=>{var w;let{sequentially:T,onTxUpdate:A,recentBlockHash:k,skipPreflight:f=!0}=g||{};if(k&&a.forEach(d=>d.message.recentBlockhash=k),le(a),(w=this.owner)!=null&&w.isKeyPair){if(T){let d=[];for(let M of a){let x=await this.connection.sendTransaction(M,{skipPreflight:f});await Se(this.connection,x),d.push(x)}return{txIds:d,signedTxs:a}}return{txIds:await Promise.all(a.map(async d=>await this.connection.sendTransaction(d,{skipPreflight:f}))),signedTxs:a}}if(this.signAllTransactions){let d=await this.signAllTransactions(a);if(T){let M=0,x=[],L=async()=>{if(!d[M])return;let p=await this.connection.sendTransaction(d[M],{skipPreflight:f});x.push({txId:p,status:"sent",signedTx:d[M]}),A==null||A([...x]),M++;let l=!1,m=null,y=null,h=B=>{m!==null&&clearInterval(m),y!==null&&this.connection.removeSignatureListener(y);let F=x.findIndex(N=>N.txId===p);if(F>-1){if(x[F].status==="error"||x[F].status==="success")return;x[F].status=B.err?"error":"success"}A==null||A([...x]),B.err||L()};this.loopMultiTxStatus&&(m=setInterval(async()=>{var B;if(l){clearInterval(m);return}try{let F=await this.connection.getTransaction(p,{commitment:"confirmed",maxSupportedTransactionVersion:0});F&&(l=!0,clearInterval(m),h({err:((B=F.meta)==null?void 0:B.err)||null}),console.log("tx status from getTransaction:",p))}catch(F){l=!0,clearInterval(m),console.error("getTransaction timeout:",F,p)}},_e)),y=this.connection.onSignature(p,B=>{if(l){this.connection.removeSignatureListener(y);return}l=!0,h(B)},"confirmed"),this.connection.getSignatureStatus(p)};return L(),{txIds:[],signedTxs:d}}else{let M=[];for(let x=0;x<d.length;x+=1){let L=await this.connection.sendTransaction(d[x],{skipPreflight:f});M.push(L)}return{txIds:M,signedTxs:d}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async sizeCheckBuild(e){var A;let T=e||{},{splitIns:t=[],computeBudgetConfig:r}=T,i=Ie(T,["splitIns","computeBudgetConfig"]),s=r?Ae(r):{instructions:[],instructionTypes:[]},a=this.signers.reduce((k,f)=>X(v({},k),{[f.publicKey.toBase58()]:f}),{}),o=[],c=[],u=[],g=0;if(this.allInstructions.forEach(k=>{let f=[...u,k],w=r?[...s.instructions,...f]:f,M=[...new Set(f.map(x=>x.keys.filter(L=>L.isSigner).map(L=>L.pubkey.toString())).flat()).values()].map(x=>new I.PublicKey(x));if(k!==t[g]&&u.length<12&&(ke({instructions:w,payer:this.feePayer,signers:M})||ke({instructions:f,payer:this.feePayer,signers:M})))u.push(k);else{if(u.length===0)throw Error("item ins too big");g+=k===t[g]?1:0,ke({instructions:r?[...s.instructions,...u]:[...u],payer:this.feePayer,signers:M})?o.push(new I.Transaction().add(...s.instructions,...u)):o.push(new I.Transaction().add(...u)),c.push(Array.from(new Set(u.map(x=>x.keys.filter(L=>L.isSigner).map(L=>L.pubkey.toString())).flat())).map(x=>a[x]).filter(x=>x!==void 0)),u=[k]}}),u.length>0){let f=[...new Set(u.map(w=>w.keys.filter(d=>d.isSigner).map(d=>d.pubkey.toString())).flat()).values()].map(w=>a[w]).filter(w=>w!==void 0);ke({instructions:r?[...s.instructions,...u]:[...u],payer:this.feePayer,signers:f.map(w=>w.publicKey)})?o.push(new I.Transaction().add(...s.instructions,...u)):o.push(new I.Transaction().add(...u)),c.push(f)}return o.forEach(k=>k.feePayer=this.feePayer),(A=this.owner)!=null&&A.signer&&c.forEach(k=>{k.some(f=>f.publicKey.equals(this.owner.publicKey))||k.push(this.owner.signer)}),{builder:this,transactions:o,signers:c,instructionTypes:this.instructionTypes,execute:async k=>{var p;let{sequentially:f,onTxUpdate:w,skipTxCount:d=0,recentBlockHash:M,skipPreflight:x=!0}=k||{},L=M!=null?M:await ge(this.connection,this.blockhashCommitment);if(o.forEach(async(l,m)=>{l.recentBlockhash=L,c[m].length&&l.sign(...c[m])}),le(o),(p=this.owner)!=null&&p.isKeyPair){if(f){let l=0,m=[];for(let y of o){if(++l,l<=d){m.push("tx skipped");continue}let h=await(0,I.sendAndConfirmTransaction)(this.connection,y,this.signers.find(B=>B.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:x});m.push(h)}return{txIds:m,signedTxs:o}}return{txIds:await Promise.all(o.map(async l=>await this.connection.sendRawTransaction(l.serialize(),{skipPreflight:x}))),signedTxs:o}}if(this.signAllTransactions){let l=await this.signAllTransactions(o.slice(d,o.length)),m=[...o.slice(0,d),...l];if(f){let y=0,h=[],B=async()=>{if(!m[y])return;y<d&&(h.push({txId:"",status:"success",signedTx:m[y]}),w==null||w([...h]),y++,B());let F=await this.connection.sendRawTransaction(m[y].serialize(),{skipPreflight:x});h.push({txId:F,status:"sent",signedTx:m[y]}),w==null||w([...h]),y++;let N=!1,P=null,C=null,R=q=>{P!==null&&clearInterval(P),C!==null&&this.connection.removeSignatureListener(C);let O=h.findIndex(J=>J.txId===F);if(O>-1){if(h[O].status==="error"||h[O].status==="success")return;h[O].status=q.err?"error":"success"}w==null||w([...h]),q.err||B()};this.loopMultiTxStatus&&(P=setInterval(async()=>{var q;if(N){clearInterval(P);return}try{let O=await this.connection.getTransaction(F,{commitment:"confirmed",maxSupportedTransactionVersion:0});O&&(N=!0,clearInterval(P),R({err:((q=O.meta)==null?void 0:q.err)||null}),console.log("tx status from getTransaction:",F))}catch(O){N=!0,clearInterval(P),console.error("getTransaction timeout:",O,F)}},_e)),C=this.connection.onSignature(F,q=>{if(N){this.connection.removeSignatureListener(C);return}N=!0,R(q)},"confirmed"),this.connection.getSignatureStatus(F)};return await B(),{txIds:h.map(F=>F.txId),signedTxs:m}}else{let y=[];for(let h=0;h<m.length;h+=1){let B=await this.connection.sendRawTransaction(m[h].serialize(),{skipPreflight:x});y.push(B)}return{txIds:y,signedTxs:m}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:i||{}}}async sizeCheckBuildV0(e){var L;let x=e||{},{computeBudgetConfig:t,splitIns:r=[],lookupTableCache:i={},lookupTableAddress:s=[]}=x,a=Ie(x,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),o=v(v({},this.cluster==="devnet"?await Ee(this.connection):me),i),c=Array.from(new Set([...this.lookupTableAddress,...s])),u=[];for(let p of c)o[p]===void 0&&u.push(new I.PublicKey(p));let g=await Fe({connection:this.connection,address:u});for(let[p,l]of Object.entries(g))o[p]=l;let T=t?Ae(t):{instructions:[],instructionTypes:[]},A=await ge(this.connection,this.blockhashCommitment),k=this.signers.reduce((p,l)=>X(v({},p),{[l.publicKey.toBase58()]:l}),{}),f=[],w=[],d=[],M=0;if(this.allInstructions.forEach(p=>{let l=[...d,p],m=t?[...T.instructions,...l]:l;if(p!==r[M]&&d.length<12&&(ne({instructions:m,payer:this.feePayer,lookupTableAddressAccount:o})||ne({instructions:l,payer:this.feePayer,lookupTableAddressAccount:o})))d.push(p);else{if(d.length===0)throw Error("item ins too big");M+=p===r[M]?1:0;let y={};for(let h of[...new Set(c)])o[h]!==void 0&&(y[h]=o[h]);if(t&&ne({instructions:[...T.instructions,...d],payer:this.feePayer,lookupTableAddressAccount:o,recentBlockhash:A})){let h=new I.TransactionMessage({payerKey:this.feePayer,recentBlockhash:A,instructions:[...T.instructions,...d]}).compileToV0Message(Object.values(o));f.push(new I.VersionedTransaction(h))}else{let h=new I.TransactionMessage({payerKey:this.feePayer,recentBlockhash:A,instructions:[...d]}).compileToV0Message(Object.values(o));f.push(new I.VersionedTransaction(h))}w.push(Array.from(new Set(d.map(h=>h.keys.filter(B=>B.isSigner).map(B=>B.pubkey.toString())).flat())).map(h=>k[h]).filter(h=>h!==void 0)),d=[p]}}),d.length>0){let l=[...new Set(d.map(m=>m.keys.filter(y=>y.isSigner).map(y=>y.pubkey.toString())).flat()).values()].map(m=>k[m]).filter(m=>m!==void 0);if(t&&ne({instructions:[...T.instructions,...d],payer:this.feePayer,lookupTableAddressAccount:o,recentBlockhash:A})){let m=new I.TransactionMessage({payerKey:this.feePayer,recentBlockhash:A,instructions:[...T.instructions,...d]}).compileToV0Message(Object.values(o));f.push(new I.VersionedTransaction(m))}else{let m=new I.TransactionMessage({payerKey:this.feePayer,recentBlockhash:A,instructions:[...d]}).compileToV0Message(Object.values(o));f.push(new I.VersionedTransaction(m))}w.push(l)}return(L=this.owner)!=null&&L.signer&&w.forEach(p=>{p.some(l=>l.publicKey.equals(this.owner.publicKey))||p.push(this.owner.signer)}),f.forEach((p,l)=>{p.sign(w[l])}),{builder:this,transactions:f,buildProps:e,signers:w,blockHash:A,instructionTypes:this.instructionTypes,execute:async p=>{var F;let{sequentially:l,onTxUpdate:m,skipTxCount:y=0,recentBlockHash:h,skipPreflight:B=!0}=p||{};if(f.map(async(N,P)=>{w[P].length&&N.sign(w[P]),h&&(N.message.recentBlockhash=h)}),le(f),(F=this.owner)!=null&&F.isKeyPair){if(l){let N=0,P=[];for(let C of f){if(++N,N<=y){console.log("skip tx: ",N),P.push("tx skipped");continue}let R=await this.connection.sendTransaction(C,{skipPreflight:B});await Se(this.connection,R),P.push(R)}return{txIds:P,signedTxs:f}}return{txIds:await Promise.all(f.map(async N=>await this.connection.sendTransaction(N,{skipPreflight:B}))),signedTxs:f}}if(this.signAllTransactions){let N=await this.signAllTransactions(f.slice(y,f.length)),P=[...f.slice(0,y),...N];if(l){let C=0,R=[],q=async()=>{if(!P[C])return;if(C<y){R.push({txId:"",status:"success",signedTx:P[C]}),m==null||m([...R]),C++,q();return}let O=await this.connection.sendTransaction(P[C],{skipPreflight:B});R.push({txId:O,status:"sent",signedTx:P[C]}),m==null||m([...R]),C++;let J=!1,Z=null,ie=null,Be=H=>{Z!==null&&clearInterval(Z),ie!==null&&this.connection.removeSignatureListener(ie);let U=R.findIndex(Qe=>Qe.txId===O);if(U>-1){if(R[U].status==="error"||R[U].status==="success")return;R[U].status=H.err?"error":"success"}m==null||m([...R]),H.err||q()};this.loopMultiTxStatus&&(Z=setInterval(async()=>{var H;if(J){clearInterval(Z);return}try{let U=await this.connection.getTransaction(O,{commitment:"confirmed",maxSupportedTransactionVersion:0});U&&(J=!0,clearInterval(Z),Be({err:((H=U.meta)==null?void 0:H.err)||null}),console.log("tx status from getTransaction:",O))}catch(U){J=!0,clearInterval(Z),console.error("getTransaction timeout:",U,O)}},_e)),ie=this.connection.onSignature(O,H=>{if(J){this.connection.removeSignatureListener(ie);return}J=!0,Be(H)},"confirmed"),this.connection.getSignatureStatus(O)};return q(),{txIds:[],signedTxs:P}}else{let C=[];for(let R=0;R<P.length;R+=1){let q=await this.connection.sendTransaction(P[R],{skipPreflight:B});C.push(q)}return{txIds:C,signedTxs:P}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:a||{}}}async buildSniperTransaction(e){var L;let x=e||{},{computeBudgetConfig:t,splitIns:r=[],lookupTableCache:i={},lookupTableAddress:s=[]}=x,a=Ie(x,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),o=v(v({},this.cluster==="devnet"?await Ee(this.connection):await Xe(this.connection)),i),c=Array.from(new Set([...this.lookupTableAddress,...s])),u=[];for(let p of c)o[p]===void 0&&u.push(new I.PublicKey(p));let g=await Fe({connection:this.connection,address:u});for(let[p,l]of Object.entries(g))o[p]=l;let T=t?Ae(t):{instructions:[],instructionTypes:[]},A=await ge(this.connection,this.blockhashCommitment),k=this.signers.reduce((p,l)=>X(v({},p),{[l.publicKey.toBase58()]:l}),{}),f=[],w=[],d=[],M=0;if(this.allInstructions.forEach(p=>{let l=[...d,p],m=t?[...T.instructions,...l]:l;if(p!==r[M]&&d.length<12&&(ne({instructions:m,payer:this.feePayer,lookupTableAddressAccount:o})||ne({instructions:l,payer:this.feePayer,lookupTableAddressAccount:o})))d.push(p);else{if(d.length===0)throw Error("item ins too big");M+=p===r[M]?1:0;let y={};for(let h of[...new Set(c)])o[h]!==void 0&&(y[h]=o[h]);if(t&&ne({instructions:[...T.instructions,...d],payer:this.feePayer,lookupTableAddressAccount:o,recentBlockhash:A})){let h=new I.TransactionMessage({payerKey:this.feePayer,recentBlockhash:A,instructions:[...T.instructions,...d]}).compileToV0Message(Object.values(o));f.push(new I.VersionedTransaction(h))}else{let h=new I.TransactionMessage({payerKey:this.feePayer,recentBlockhash:A,instructions:[...d]}).compileToV0Message(Object.values(o));f.push(new I.VersionedTransaction(h))}w.push(Array.from(new Set(d.map(h=>h.keys.filter(B=>B.isSigner).map(B=>B.pubkey.toString())).flat())).map(h=>k[h]).filter(h=>h!==void 0)),d=[p]}}),d.length>0){let l=[...new Set(d.map(m=>m.keys.filter(y=>y.isSigner).map(y=>y.pubkey.toString())).flat()).values()].map(m=>k[m]).filter(m=>m!==void 0);if(t&&ne({instructions:[...T.instructions,...d],payer:this.feePayer,lookupTableAddressAccount:o,recentBlockhash:A})){let m=new I.TransactionMessage({payerKey:this.feePayer,recentBlockhash:A,instructions:[...T.instructions,...d]}).compileToV0Message(Object.values(o));f.push(new I.VersionedTransaction(m))}else{let m=new I.TransactionMessage({payerKey:this.feePayer,recentBlockhash:A,instructions:[...d]}).compileToV0Message(Object.values(o));f.push(new I.VersionedTransaction(m))}w.push(l)}return(L=this.owner)!=null&&L.signer&&w.forEach(p=>{p.some(l=>l.publicKey.equals(this.owner.publicKey))||p.push(this.owner.signer)}),f.forEach((p,l)=>{p.sign(w[l])}),{builder:this,transactions:f,buildProps:e,signers:w,instructionTypes:this.instructionTypes,execute:async p=>{var F;let{sequentially:l,onTxUpdate:m,skipTxCount:y=0,recentBlockHash:h,skipPreflight:B=!0}=p||{};if(f.map(async(N,P)=>{w[P].length&&N.sign(w[P]),h&&(N.message.recentBlockhash=h)}),le(f),(F=this.owner)!=null&&F.isKeyPair){if(l){let N=0,P=[];for(let C of f){if(++N,N<=y){console.log("skip tx: ",N),P.push("tx skipped");continue}let R=await this.connection.sendTransaction(C,{skipPreflight:B});await Se(this.connection,R),P.push(R)}return{txIds:P,signedTxs:f}}return{txIds:await Promise.all(f.map(async N=>await this.connection.sendTransaction(N,{skipPreflight:B}))),signedTxs:f}}if(this.signAllTransactions){let N=await this.signAllTransactions(f.slice(y,f.length)),P=[...f.slice(0,y),...N];if(l){let C=0,R=[],q=async()=>{if(!P[C])return;if(C<y){R.push({txId:"",status:"success",signedTx:P[C]}),m==null||m([...R]),C++,q();return}let O=await this.connection.sendTransaction(P[C],{skipPreflight:B});R.push({txId:O,status:"sent",signedTx:P[C]}),m==null||m([...R]),C++;let J=!1,Z=null,ie=null,Be=H=>{Z!==null&&clearInterval(Z),ie!==null&&this.connection.removeSignatureListener(ie);let U=R.findIndex(Qe=>Qe.txId===O);if(U>-1){if(R[U].status==="error"||R[U].status==="success")return;R[U].status=H.err?"error":"success"}m==null||m([...R]),H.err||q()};this.loopMultiTxStatus&&(Z=setInterval(async()=>{var H;if(J){clearInterval(Z);return}try{let U=await this.connection.getTransaction(O,{commitment:"confirmed",maxSupportedTransactionVersion:0});U&&(J=!0,clearInterval(Z),Be({err:((H=U.meta)==null?void 0:H.err)||null}),console.log("tx status from getTransaction:",O))}catch(U){J=!0,clearInterval(Z),console.error("getTransaction timeout:",U,O)}},_e)),ie=this.connection.onSignature(O,H=>{if(J){this.connection.removeSignatureListener(ie);return}J=!0,Be(H)},"confirmed"),this.connection.getSignatureStatus(O)};return q(),{txIds:[],signedTxs:P}}else{let C=[];for(let R=0;R<P.length;R+=1){let q=await this.connection.sendTransaction(P[R],{skipPreflight:B});C.push(q)}return{txIds:C,signedTxs:P}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:a||{}}}};var Sn=require("@solana/web3.js"),kn=Y(require("bn.js"));async function ri(n){new Promise(e=>setTimeout(e,n))}function ii(){return new Date().getTime()}function Bn(n){return typeof n=="object"&&n!==null&&![se,$,Sn.PublicKey,S,kn.default,Q,te].some(e=>typeof e=="object"&&n instanceof e)}function bt(n){return typeof n=="string"?je(n):Array.isArray(n)?n.map(e=>bt(e)):Bn(n)?Object.fromEntries(Object.entries(n).map(([e,t])=>[e,bt(t)])):n}var Cn=Y(require("bn.js")),oi=new Cn.default(1e6);0&&(module.exports={ACCOUNT_TYPE_SIZE,ALL_PROGRAM_ID,AMM_STABLE,AMM_V4,ANAMint,AccountType,BNDivCeil,BN_100,BN_1000,BN_10000,BN_FIVE,BN_ONE,BN_TEN,BN_THREE,BN_TWO,BN_ZERO,CLMM_LOCK_AUTH_ID,CLMM_LOCK_PROGRAM_ID,CLMM_PROGRAM_ID,CLOCK_PROGRAM_ID,CREATE_CPMM_POOL_AUTH,CREATE_CPMM_POOL_FEE_ACC,CREATE_CPMM_POOL_PROGRAM,DEVNET_PROGRAM_ID,DEV_LAUNCHPAD_AUTH,DEV_LAUNCHPAD_PROGRAM,DEV_LOOKUP_TABLE_CACHE,ETHMint,FARM_PROGRAM_ID_V3,FARM_PROGRAM_ID_V4,FARM_PROGRAM_ID_V5,FARM_PROGRAM_ID_V6,FEE_DESTINATION_ID,FEE_RATE_DENOMINATOR_VALUE,IDO_ALL_PROGRAM,IDO_PROGRAM_ID_V1,IDO_PROGRAM_ID_V2,IDO_PROGRAM_ID_V3,IDO_PROGRAM_ID_V4,INSTRUCTION_PROGRAM_ID,InstructionType,LAUNCHPAD_AUTH,LAUNCHPAD_CONFIG,LAUNCHPAD_PLATFORM,LAUNCHPAD_PROGRAM,LIQUIDITY_POOL_PROGRAM_ID_V5_MODEL,LOCK_CPMM_AUTH,LOCK_CPMM_PROGRAM,LOOKUP_TABLE_CACHE,LogLevel,Logger,MAX_BASE64_SIZE,MEMO_PROGRAM_ID,MEMO_PROGRAM_ID2,METADATA_PROGRAM_ID,MODEL_DATA_PUBKEY,NRVMint,OPEN_BOOK_PROGRAM,Owner,PAIMint,RAYMint,RENT_PROGRAM_ID,Rounding,Router,SERUM_PROGRAM_ID_V3,SOLMint,SRMMint,SYSTEM_PROGRAM_ID,TxBuilder,TxVersion,USDCMint,USDHMint,USDTMint,UTIL1216,WSOLMint,accountMeta,add,addComputeBudget,ceilDiv,ceilDivBN,checkLegacyTxSize,checkV0TxSize,chunkArray,commonSystemAccountMeta,confirmTransaction,createLogger,decimalToFraction,div,divCeil,eq,fetchMultipleMintInfos,findProgramAddress,floorDiv,forecastTransactionSize,getATAAddress,getDate,getDevLookupTableCache,getEpochInfo,getMainLookupTableCache,getMax,getMultipleAccountsInfo,getMultipleAccountsInfoWithCustomFlags,getMultipleLookupTableInfo,getRecentBlockHash,getTime,getTimestamp,getTransferAmountFee,getTransferAmountFeeFromPost,getTransferAmountFeeFromPre,getTransferAmountFeeV2,gt,gte,intersection,isDateAfter,isDateBefore,isDecimal,isMeaningfulNumber,isNumber,jsonInfo2PoolKeys,lt,lte,mSOLMint,minExpirationTime,mul,notInnerObject,offsetDateTime,parseBigNumberish,parseNumberInfo,parseSimulateLogToJson,parseSimulateValue,printSimulate,setLoggerLevel,shakeFractionDecimal,simulateMultipleInstruction,simulateTransaction,sleep,solToWSol,stSOLMint,sub,tenExponential,toBN,toBuffer,toFraction,toFractionWithDecimals,toPercent,toTokenPrice,toTotalPrice,toUsdCurrency,transformTxToBase64,tryParsePublicKey,txToBase64,uniq,validateAndParsePublicKey,xor});
//# sourceMappingURL=index.js.map